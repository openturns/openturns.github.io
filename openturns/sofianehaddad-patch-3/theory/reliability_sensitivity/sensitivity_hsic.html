
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sensitivity analysis using Hilbert-Schmidt Indepencence Criterion (HSIC) &#8212; OpenTURNS 1.19rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FORM" href="form_approximation.html" />
    <link rel="prev" title="Sensitivity Factors from FORM method" href="sensitivity_form.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="form_approximation.html" title="FORM"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sensitivity_form.html" title="Sensitivity Factors from FORM method"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.19rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" accesskey="U">Reliability, sensitivity</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sensitivity analysis using Hilbert-Schmidt Indepencence Criterion (HSIC)</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Sensitivity analysis using Hilbert-Schmidt Indepencence Criterion (HSIC)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#hsic-definition">HSIC definition</a></li>
<li><a class="reference internal" href="#hsic-estimators">HSIC estimators</a></li>
<li><a class="reference internal" href="#screening-with-hsic-based-statistical-tests">Screening with HSIC-based statistical tests</a></li>
<li><a class="reference internal" href="#target-sensitivity-analysis-using-hsic">Target sensitivity analysis using HSIC</a></li>
<li><a class="reference internal" href="#conditional-sensitivity-analysis-using-hsic">Conditional sensitivity analysis using HSIC</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="sensitivity_form.html"
                          title="previous chapter">Sensitivity Factors from FORM method</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="form_approximation.html"
                          title="next chapter">FORM</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/reliability_sensitivity/sensitivity_hsic.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sensitivity-analysis-using-hilbert-schmidt-indepencence-criterion-hsic">
<span id="sensitivity-hsic"></span><h1>Sensitivity analysis using Hilbert-Schmidt Indepencence Criterion (HSIC)<a class="headerlink" href="#sensitivity-analysis-using-hilbert-schmidt-indepencence-criterion-hsic" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Hilbert-Schmidt Indepencence Criterion deals with analyzing the influence that the random vector
<img class="math" src="../../_images/math/3dc65cc9da12c6bcee4d3ee0931d4f18d5bca2bf.svg" alt="\vect{X} = \left( X^1,\ldots,X^{d} \right)"/> has on a random variable
<img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/>, which is being studied for uncertainty. Here, we attempt to evaluate the influence
through the dependence between the two random variables <img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> and <img class="math" src="../../_images/math/497c30a1a2a6c10d87566cbee88c618eb6336b81.svg" alt="X^i"/>.
In practice, we compute the dependence between <img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> and <img class="math" src="../../_images/math/497c30a1a2a6c10d87566cbee88c618eb6336b81.svg" alt="X^i"/> as the
distance between the joint distribution <img class="math" src="../../_images/math/a77d361fbbbcd3cc17c7a108090867518aa970ab.svg" alt="P_{Y,X^i}"/> and the
product of the marginal distributions <img class="math" src="../../_images/math/d22de67a93da501e634f3b6f89e173a0150dd8d3.svg" alt="P_{X^i}P_{Y}"/>.</p>
<p>In the following paragraphs, we consider an independent and identically distributed
learning sample of size <img class="math" src="../../_images/math/80b394abd4fb264a3879675f92f191c3e346c3a0.svg" alt="n"/>, which can for instance be obtained through
Monte Carlo sampling or real life observations:</p>
<div class="math">
<p><img src="../../_images/math/302995b4aa9605627f3dd5be2ff7d6c7df8e4909.svg" alt="\left(\mathbf{X}^{(j)}, Y^{(j)}\right)_{(1\leq j\leq n)} = \left(X_1^{(j)}, X_2^{(j)}, \dots, X_d^{(j)}, Y^{(j)}\right)_{(1\leq j\leq n)}"/></p>
</div><p>where <img class="math" src="../../_images/math/c1e328ff1b2612d6a3fe69347424fef39ef5e58c.svg" alt="\mathbf{X}"/> and <img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> respectively follow <img class="math" src="../../_images/math/35fad662fa8bea5cf30e590605530e83c5990ff3.svg" alt="P_{\mathbf{X}}"/> and <img class="math" src="../../_images/math/cf47cd60bc136d149319571387d4fc15f07a9074.svg" alt="P_{Y}"/>.
In many cases, only <img class="math" src="../../_images/math/c1e328ff1b2612d6a3fe69347424fef39ef5e58c.svg" alt="\mathbf{X}"/> is sampled, while <img class="math" src="../../_images/math/cf47cd60bc136d149319571387d4fc15f07a9074.svg" alt="P_{Y}"/> is obtained
as the output of a computer code: <img class="math" src="../../_images/math/dce60ad78a9196195582976a3f79f889d6f6007c.svg" alt="Y^{(j)} = \mathcal{M}\left(X_1^{(j)}, X_2^{(j)}, \dots, X_d^{(j)}\right)"/></p>
</div>
<div class="section" id="hsic-definition">
<h2>HSIC definition<a class="headerlink" href="#hsic-definition" title="Permalink to this headline">¶</a></h2>
<p>Suppose <img class="math" src="../../_images/math/abae64a4b5d1deeb2232e59a68ddaa431648c01d.svg" alt="\cX_{i} \ \forall i \ \in \{1,\dots,d\}"/> and <img class="math" src="../../_images/math/52e2c1f63fdead4308ecbecb4e784e6eb7e044e4.svg" alt="\cY"/> are measurable spaces.
Let <img class="math" src="../../_images/math/0436cbcc9ee6a765d74c7e16723f8d11cd78af17.svg" alt="\cF_{i} : \cX_i \rightarrow \Rset"/> and <img class="math" src="../../_images/math/7a179071535d872c39dabc286bd5e4caf34a8e59.svg" alt="\cG : \cY \rightarrow \Rset"/>
be two (universal) Reproducing Kernel Hilbert Spaces (RKHS).
These functional spaces are equipped with their characteristic kernels: (resp.)
<img class="math" src="../../_images/math/fa03c21272fb452903e2dadfb076c6fb819921b6.svg" alt="\kappa_{i}(\cdot,\cdot)"/> and <img class="math" src="../../_images/math/c20cb01748a2589573ece905084746138fd75b7d.svg" alt="\kappa(\cdot,\cdot)"/> and the associated
scalar products are denoted by <img class="math" src="../../_images/math/9275459a8ba4fac1f3998b263191a374149cb866.svg" alt="\langle \cdot, \cdot \rangle_{\cF_{i}}"/> and
<img class="math" src="../../_images/math/a142c00f711e07a8e9bb55a9992515274c53b7b6.svg" alt="\langle \cdot, \cdot \rangle_{\cG}"/>. This allows to define the evaluation
operator: <img class="math" src="../../_images/math/41960d46b1e85702a34366ef2d2f44d12dd852b3.svg" alt="f \in \cF_i \rightarrow  f(\mathbf{x}) = \langle f, \kappa_i (\mathbf{x}, \cdot) \rangle_{\cF_{i}}"/></p>
<p>Let us now consider  <img class="math" src="../../_images/math/5b3d6e9b0aace147eae7ccec8ed994deba13f28a.svg" alt="\cV_{i}"/>, an RKHS over <img class="math" src="../../_images/math/a2220d120d7e539a35c9de3b223cd2d22169ae1c.svg" alt="\cX_{i} \times \cY"/>
with kernel <img class="math" src="../../_images/math/df9e83b6c17f7f115a5585af0dd3a94b38adbc06.svg" alt="v_{i}(\cdot, \cdot)"/>. We can define the mean embedding of <img class="math" src="../../_images/math/17f7fad34f4c07dd439d8c8eb8270ef59b8fce6b.svg" alt="P_YP_{X_i}"/>
and <img class="math" src="../../_images/math/e26bfe7cd2c93cb6dd7b1ea9959dec02f1f5bfc4.svg" alt="P_{Y,X_i}"/> in <img class="math" src="../../_images/math/f9271d7f16bde5e912ec94295881ba3449dcfa4f.svg" alt="\mathcal{V}_{i}"/> as:</p>
<div class="math">
<p><img src="../../_images/math/3b8db76e173be7593213192e47aae316b788098b.svg" alt="\mu [ P_YP_{X_i} ]  = \Eset_{Y} \Eset_{X_i} [v_{i}((Y, X_i),\cdot) ]"/></p>
</div><div class="math">
<p><img src="../../_images/math/8f6670dd8ae21665acc8e968ab35afbfd2617614.svg" alt="\mu [ P_{Y,X_i} ] = \Eset_{Y,X_i} [v_{i}((Y, X_i),\cdot) ]"/></p>
</div><p>We can then define a dependence measure between <img class="math" src="../../_images/math/8e76591c56ea3665146858b1b5613d3308a48bcf.svg" alt="Y^k"/> and <img class="math" src="../../_images/math/497c30a1a2a6c10d87566cbee88c618eb6336b81.svg" alt="X^i"/>, under
the form of HSIC, as the squared distance between the mean embeddings of
<img class="math" src="../../_images/math/17f7fad34f4c07dd439d8c8eb8270ef59b8fce6b.svg" alt="P_YP_{X_i}"/> and <img class="math" src="../../_images/math/e26bfe7cd2c93cb6dd7b1ea9959dec02f1f5bfc4.svg" alt="P_{Y,X_i}"/>:</p>
<div class="math">
<p><img src="../../_images/math/c8b7847370476ed5ea495155b8b5e1aaf94bb81f.svg" alt="\mathrm{HSIC}(X_i,Y)_{\cF_{i},\cG} := || \mu [ P_{Y,X_i} ] - \mu [ P_YP_{X_i} ]  ||^2"/></p>
</div><p>Assuming <img class="math" src="../../_images/math/aa6862aa76a675ff6cdf435aad0dedd55ae4230f.svg" alt="v_{i}((Y, X_i),(Y', X_i') ) = \kappa(Y,Y') \kappa_i (X_i, X_i')"/>, it can be shown that:</p>
<div class="math">
<p><img src="../../_images/math/bb6bf91127232dabd4365491062aab36e65d77fd.svg" alt="\mathrm{HSIC}(X_i,Y)_{\cF_{i},\cG} = \Eset[\kappa_i(X_i,X_i^{'})\kappa(Y,Y^{'})]
    + \Eset[\kappa_i(X_i,X_i^{'})]\Eset[\kappa(Y,Y^{'})] -
2\Eset[\Eset[\kappa_i(X_i,X_i^{'})|X_i]~\Eset[\kappa(Y,Y^{'})|Y]]"/></p>
</div><p>where <img class="math" src="../../_images/math/1a811ccb057bda795da42d8081f93116f150fb99.svg" alt="(X_i^{'}, Y^{'})"/> is an independent and identically distributed copy of <img class="math" src="../../_images/math/d9ca594cfca943b5f4d71b889cea9c6875571b35.svg" alt="(X_i,Y)"/>.</p>
</div>
<div class="section" id="hsic-estimators">
<h2>HSIC estimators<a class="headerlink" href="#hsic-estimators" title="Permalink to this headline">¶</a></h2>
<p>Two alternative estimators exist in order to compute the HSIC value.
The first one is a biased, but asymptotically unbiased estimator
based on V-statistics:</p>
<div class="math">
<p><img src="../../_images/math/b8135003f585083055b7cd81f1acf83087a414ca.svg" alt="\widehat{\mathrm{HSIC}}(X_i,Y) = \frac{1}{n^2} \mathrm{Tr}(\mat{L_iHLH})"/></p>
</div><p>where <img class="math" src="../../_images/math/9b63167e5ab37792ca6bd982d8bbbb87a1fe277b.svg" alt="\mat{L_i}"/> and <img class="math" src="../../_images/math/3f20cf1f51158f2c231394c928b74d01c5c9d5cf.svg" alt="\mat{L}"/> are Gram matrices computed with the respective kernels
<img class="math" src="../../_images/math/de7ccda003a09eee3b4e613d5e1001c78661b8cb.svg" alt="L_{i_{j,k}} = \kappa_i(x_i^j,x_i^k)"/> and <img class="math" src="../../_images/math/fecfef6da1eea224f5fb301f62aeab375d4a776e.svg" alt="L_{j,k}= \kappa(y^j,y^k)"/>,
while <img class="math" src="../../_images/math/11713383892a588c205edf0abc509f16512a9965.svg" alt="\mat{H}"/> a shift matrix defined as:
<img class="math" src="../../_images/math/64e0ba362c43373977a677ffa981885a06662a9f.svg" alt="H_{j,k} = \left(\delta_{j,k} - \frac{1}{n}\right)_{1 \leq j, k \leq n}"/>.</p>
<p>The second estimator is an unbiased estimator based on U-statistics:</p>
<div class="math">
<p><img src="../../_images/math/3e06b5946d80ea6c743d2dd5549a0957ce94f3d1.svg" alt="\widehat{\mathrm{HSIC}}(X_i,Y) = \frac{1}{n(n-3)} \left[\mathrm{Tr}(\mat{\tilde{L}_i \tilde{L}}) + \frac{\mathbf{1}^{\top} \mat{\tilde{L}_i} \mathbf{1}\mathbf{1}^{\top} \mat{\tilde{L}} \mathbf{1}}{(n-1)(n-2)} - \frac{2}{n-2} \mathbf{1}^{\top} \mat{\tilde{L}_i} \mat{\tilde{L}} \mathbf{1}\right]"/></p>
</div><p>where <img class="math" src="../../_images/math/495d5c060379dd5f9485c608bdb81ebf5e9cf4b4.svg" alt="\tilde{L}_{i_{j,k}}"/> and <img class="math" src="../../_images/math/6eae95e01e21214a8788472a4d1085deef854cdf.svg" alt="\tilde{L}_{j,k}"/> are computed as:</p>
<div class="math">
<p><img src="../../_images/math/51ae56dbac673306c89e73fbf39c189a2b1e07b6.svg" alt="\tilde{L}_{i_{j,k}} = (1-\delta_{j,k}) \kappa\left( Y^{(j)}, Y^{(k)}\right)

    \tilde{L}_{j,k} = (1-\delta_{j,k}) \kappa_i\left( X_i^{(j)}, X_i^{(k)}\right)"/></p>
</div><p>In order to compare the HSIC values associated to various input variables <img class="math" src="../../_images/math/497c30a1a2a6c10d87566cbee88c618eb6336b81.svg" alt="X^i"/>,
it is common practice to consider a normalized index (bounded between 0 and 1) called R2-HSIC,
and defined as:</p>
<div class="math">
<p><img src="../../_images/math/c6432bacf666202a0239eca18b96d593c30b7fa5.svg" alt="\widehat{R_{\mathrm{HSIC},i}^2} = \frac{\widehat{\mathrm{HSIC}}(X_i,Y)}{\sqrt{\widehat{\mathrm{HSIC}}(X_i,X_i)~\widehat{\mathrm{HSIC}}(Y,Y)}}"/></p>
</div><p>Please note that, differently from the Sobol indices typically used in the context
of sensitivity analysis, the sum of all normalized R2-HSIC indices for a given set
of considered input variables does not sum to 1.</p>
<p>Most covariance kernels that can be used in order to compute the Gram matrices of the
HSIC estimators are characterized by one or several hyper-parameters. No universal
rule exists allowing to determine the optimal value for these hyper-parameters, however,
for some specific kernels empirical rules are proposed. For instance, the squared
exponential (or Gaussian) kernel can be parameterized as a function of the sample
empirical variance. In this case, we obtain :</p>
<div class="math">
<p><img src="../../_images/math/f530dfef02869eb79a6cf8b93bbf8f861ce8a6ef.svg" alt="\kappa_i(x_i^j,x_i^k) = \exp ( (\frac{x_i^j - x_i^k}{\theta_i})^2)"/></p>
</div><p>with <img class="math" src="../../_images/math/25a131719a2d3502bea1b8f81d3c55089639b0cb.svg" alt="\theta_i = \sigma_i"/>, where <img class="math" src="../../_images/math/cfea43b069bfa35fcea80c72570203bbefddf1d4.svg" alt="\sigma_i"/> is the empirical
standard deviation of the sample <img class="math" src="../../_images/math/56c02f12d2f1519026c2ada380fc921e0d8a0a69.svg" alt="X_i"/>.</p>
</div>
<div class="section" id="screening-with-hsic-based-statistical-tests">
<h2>Screening with HSIC-based statistical tests<a class="headerlink" href="#screening-with-hsic-based-statistical-tests" title="Permalink to this headline">¶</a></h2>
<p>The HSIC can also be used in order to perform screening on a set of input variables.
This can be defined as the the process of identifying the input variables which are
significantly influential on the considered output.
More specifically, within the framework of HSIC this can be done by relying on
statistical hypothesis tests. In practice, we wish to test the the following hypothesis:</p>
<div class="math">
<p><img src="../../_images/math/f2a3912b2cb8f570192209fde874af796719d9e3.svg" alt="\cT: \textrm{Test}\quad (\cH_{0,i}):\mathrm{HSIC}(X_i,Y) = 0"/></p>
</div><p>which, thanks to the HSIC properties, is equivalent to assessing the hypothesis of
independence between <img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> and <img class="math" src="../../_images/math/497c30a1a2a6c10d87566cbee88c618eb6336b81.svg" alt="X^i"/>.</p>
<p>We define the test statistic as: <img class="math" src="../../_images/math/56b3a129ab459110e6db622c87fbb7945b45281c.svg" alt="\widehat{S}_{\cT} := n \times \widehat{\mathrm{HSIC}}(X_i,Y)"/>,
and the associated p-value:
<img class="math" src="../../_images/math/db17c7b957a21e9280ece3582fa3d581fe38b925.svg" alt="p_{\textrm{val}} = \Pset\left(\widehat{S}_{\cT} \geq \widehat{S}_{\cT,\textrm{obs}}~|~\cH_{0,i}\right)"/>,
where <img class="math" src="../../_images/math/77fb44ded0e3935e6d541fa7800c6ee7b7c42626.svg" alt="\widehat{S}_{\cT,\textrm{obs}}"/> is the stastistic observed on the given sample.
In other words, the p-value represents the probability of obtaining a
<img class="math" src="../../_images/math/f7d019727cd0d5437af98394e9d0eca5824336c5.svg" alt="\mbox{HSIC}(X_i,Y)"/> value as large as the observed one under the assumption
that <img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> and <img class="math" src="../../_images/math/56c02f12d2f1519026c2ada380fc921e0d8a0a69.svg" alt="X_i"/> are independent. Therefore, the lower the p-value is,
the higher are the chances that the two considered variables are actually dependent.
In order to discriminate influential inputs from non-influential ones, it is common
practice to fix an acceptance level <img class="math" src="../../_images/math/586e8e332570955fa6dfcb1ba54f5ce2823c0fb7.svg" alt="\alpha"/> (typically equal to 0.05, or 0.1),
and to consider all variables associated to a p-value larger than <img class="math" src="../../_images/math/586e8e332570955fa6dfcb1ba54f5ce2823c0fb7.svg" alt="\alpha"/>
as being non-influential, and all variables associated to p-values lower than <img class="math" src="../../_images/math/586e8e332570955fa6dfcb1ba54f5ce2823c0fb7.svg" alt="\alpha"/>
as having a non-negligible influence on the considered output.</p>
<p>Depending on the size of the available data set, the p-value of a given input variable
can be either computed with an asymptotic estimator, or with a permutation-based estimator.
The asymptotic estimator is used when dealing with sufficiently large data sets,
and stems from the fact that the considered test statistic <img class="math" src="../../_images/math/c77a8364a62d3e3a359200a132be778130ab8b9e.svg" alt="\widehat{S}_{\cT}"/>
can be approached by a Gamma distribution. As a consequence, the p-value can be approximated
as follows:</p>
<div class="math">
<p><img src="../../_images/math/5eca52211784f428e26e8c5357667ca5d016ed4c.svg" alt="p_{\textrm{val}} \approx 1 - F_{\textrm{Ga}}\left(n\times\widehat{\mathrm{HSIC}}(X_i,Y)_{\textrm{obs}}\right)"/></p>
</div><p>where <img class="math" src="../../_images/math/a2accc746b6ab30ca9c5cfbab564070e13353aef.svg" alt="F_{\textrm{Ga}}(\cdot)"/> is the cumulative distribution function of
the Gamma distribution. The parameters of this distribution are estimated as a
function of the sample values.</p>
<p>Alternatively, when dealing with small data sets, a permutation-based estimator of
the p-value can be considered. The underlying idea is that under the independence
hypothesis <img class="math" src="../../_images/math/f3a564e4d61986d85b6f4b358bb19009211da1e9.svg" alt="\cH_{0,i}"/>, considering a permutation of the considered output sample
<img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> should have no impact on the estimated HSIC value. We therefore consider
an initial n-size pair of samples <img class="math" src="../../_images/math/161fec8e353ccc80c13e0f5afd9837c9a2bade6c.svg" alt="Z_{n} := \left(X_i^{(j)}, Y^{(j)}\right)_{(1\leq j\leq n)}"/>
and <img class="math" src="../../_images/math/ec2809568c7b0618222d81020ca4465712a9fceb.svg" alt="\widehat{\mathrm{HSIC}}(Z_{n})"/>. From this samples, we can generate a set of
B independent permutations <img class="math" src="../../_images/math/92cfb849d9c4adcd65136de5dfc7456718eb8a99.svg" alt="\{\tau_1,\dots,\tau_B\}"/> of <img class="math" src="../../_images/math/10cde22a2831f721d4c1ded85f5bd60045697975.svg" alt="X^{(j)}_{i_{(1 \leq j \leq n)}}"/>
and compute the associated HSIC values:
<img class="math" src="../../_images/math/c8a30f00e04f227cc2091f7ad658ac4725e32479.svg" alt="\widehat{H}^{*b} := \widehat{\mathrm{HSIC}} \left(X^{(j)}, Y^{(\tau_{b}(j))}\right)_{(1\leq j\leq n)}"/>.
We can then finally estimate the p-value (under <img class="math" src="../../_images/math/f3a564e4d61986d85b6f4b358bb19009211da1e9.svg" alt="\cH_{0,i}"/>) as :</p>
<div class="math">
<p><img src="../../_images/math/e7b7a9737920959bc3b79420a0c4e3493b1ed1e9.svg" alt="p_{\textrm{val}} \approx \frac{1}{B} \sum_{b=1}^{B} \mathbf{1}_{\widehat{H}^{*b}&gt;\widehat{\mathrm{HSIC}}(X,Y)}"/></p>
</div></div>
<div class="section" id="target-sensitivity-analysis-using-hsic">
<h2>Target sensitivity analysis using HSIC<a class="headerlink" href="#target-sensitivity-analysis-using-hsic" title="Permalink to this headline">¶</a></h2>
<p>On top of the standard screening and global sensitivity analysis described in the
previous paragraphs, HSIC also allows to perform target sensitivity analysis.
The underlying concept is to identify the most influential input parameters which
cause the considered output <img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> to cross into a user-defined critical domain:
<img class="math" src="../../_images/math/374a759ed13937ce264126b91ed6c755fcfae766.svg" alt="\cC"/>. In practice, rather than directly computing the HSIC values on a given
set of output values <img class="math" src="../../_images/math/4855c27203d5c401bd757fe0b2e995aaf94cbde7.svg" alt="Y^{(j)}_{(1\leq j\leq n)}"/>, we first apply a transformation
through the use of a filter function <img class="math" src="../../_images/math/9c8c69a1586d907b5977b274eddf28ee45ad5c06.svg" alt="w(\cdot)"/> : <img class="math" src="../../_images/math/57f840932b27c700fafaa2089511ca55b744b900.svg" alt="\tilde{Y^j} = w(Y^j)"/>.
We can then estimate the target HSIC value associated to the input variable <img class="math" src="../../_images/math/56c02f12d2f1519026c2ada380fc921e0d8a0a69.svg" alt="X_i"/> as:</p>
<div class="math">
<p><img src="../../_images/math/80f54f451e28731668e41d0393f4b8b25afe38d1.svg" alt="\widehat{\mathrm{T-HSIC},i} = \widehat{\mathrm{HSIC}}(X_i,\tilde{Y})"/></p>
</div><p>Please note that both the U-statistics a the V-statistics estimators described
in the previous section can be used.</p>
<p>Depending on the application, different filter functions can be considered.
A first common example of filter function is the exponential function:</p>
<div class="math">
<p><img src="../../_images/math/febfd9350255cf074df1bba7895382803a9ad5bd.svg" alt="w(Y) = \exp (-d_{\cC}(Y) /s)"/></p>
</div><p>where <img class="math" src="../../_images/math/2c3662b30764356c6d2200695f016365d6f2a1c8.svg" alt="-d_{\cC}(Y)"/> characterizes the minimum distance between <img class="math" src="../../_images/math/d58d4863379b3eb734fd9d329f850fe196c3abc5.svg" alt="Y"/> and
any point contained in the critical domain <img class="math" src="../../_images/math/374a759ed13937ce264126b91ed6c755fcfae766.svg" alt="\cC"/>, while <img class="math" src="../../_images/math/29350e76247bfe6a307c4a905d5a756c0cd41091.svg" alt="s"/> is a tunable scale parameter.</p>
<p>Alternatively, we can also consider a step filter function defined as:</p>
<div class="math">
<p><img src="../../_images/math/5482972af9c9de89a7d49e7d8377dc77a51f8f50.svg" alt="w(Y) = \begin{cases}  0 \ \ \mathrm{ if } \ \ Y \notin \cC \\ 1 \ \  \mathrm{ if } \ \ Y \in \cC &amp; \end{cases}"/></p>
</div><p>This filter function presents the advantage of being simpler and requiring no parameterization.
However, it also makes no distinction between points being very close to the critical domain
and points which are far from it. This may  partially limit the performance of
the sensitivity analysis, especially when dealing with small data sets. It is
important to note that when considering this step filter function, it is advisable
to rely on a covariance kernel adapted to binary variables (for the considered output),
such as:</p>
<div class="math">
<p><img src="../../_images/math/72d96a206ba0c0f31cc7b381b217553a8c7fdb77.svg" alt="\kappa(\tilde{Y^j},\tilde{Y^k}) = \begin{cases}  1/n_z \ \ &amp; \mathrm{ if } \ \ \tilde{Y^j} = \tilde{Y^k} \\ 0 \ \  &amp; \mathrm{ if } \ \ \tilde{Y^j} \neq \tilde{Y^k} \end{cases}"/></p>
</div><p>where <img class="math" src="../../_images/math/5fec1fec8039126d2f6d801ac666c1a8969e3578.svg" alt="n_z"/> is the number of samples in the available data set belonging to
the same category as  <img class="math" src="../../_images/math/d225a400f37291ce6809f46eb6d5dfea8b590ada.svg" alt="\tilde{Y^j} \ \mathrm{ and } \ \tilde{Y^k}"/>.
Please note that this specific kernel can also be used when performing sensitivity
analysis on discrete variables.</p>
</div>
<div class="section" id="conditional-sensitivity-analysis-using-hsic">
<h2>Conditional sensitivity analysis using HSIC<a class="headerlink" href="#conditional-sensitivity-analysis-using-hsic" title="Permalink to this headline">¶</a></h2>
<p>Similarly to the target sensitivity analysis discussed in the previous paragraph,
the HSIC also allows the possibility of performing conditional sensitivity analysis.
In this case, the objective is to identify the most influential input variables under
the condition that the considered output variable is within a user-defined critical domain.
In other words, we are interested in identifying the variables that drive the
output variability within the critical domain.
This analysis can be achieved by relying on a diagonal weight matrix computed through
the use of a weight function <img class="math" src="../../_images/math/9c8c69a1586d907b5977b274eddf28ee45ad5c06.svg" alt="w(\cdot)"/> on the considered data set:
<img class="math" src="../../_images/math/d00845fee6f90daee6ec779fdf94507a0df3e828.svg" alt="W_{j,j} = w(Y^j)"/>. The underlying purpose of this matrix is to associate to
each sample in the data set a weight characterizing its distance from the critical domain.
Different definitions of the weight function can be considered. For instance, the exponential
and step weight functions defined in the previous paragraph can be used.</p>
<p>Having defined a proper weight function, the conditional HSIC values can be computed
by relying on an adapted V-statistics estimator:</p>
<div class="math">
<p><img src="../../_images/math/d8c5918d8efa9d657688cf5e81c72aa41c4c572b.svg" alt="\widehat{\mathrm{C-HSIC}} (X_i,Y) = \frac{1}{n^2} \mathrm{Tr} (\hat{W} L_i \hat{W} H_1 L H_2)"/></p>
</div><p>where <img class="math" src="../../_images/math/881fb70dc8c79cc24bfcb0a738d0fb298597961e.svg" alt="\hat{W} = \frac{W}{\frac{1}{n}\sum_{j = 1}^{n} W_{j,j} }"/>, <img class="math" src="../../_images/math/731725b9211de64d42b6a69f470bf71b420daab6.svg" alt="H_1 = I_n - \frac{1}{n} U\hat{W}"/>
and <img class="math" src="../../_images/math/c3cdfc6a00e98ef1aa2b43e539e0e62a3582f50f.svg" alt="H_2 = I_n - \frac{1}{n} \hat{W}U"/>.</p>
<p>Please note that no U-statistics estimator exists for the conditional HSIC. Furhtermore,
differently than in the target analysis case, standard continuous covariance kernels
can be used, regardless of the type of weight function that is being considered.</p>
<p>In most applications, it may be worth performing all three types of sensitivity
analysis presented in the previous paragaph, i.e., global, target and conditional,
in order to gain a more precise understanding of the degree and type of influence
of every input variable.</p>
<div class="topic">
<p class="topic-title">API:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.HSICEstimatorGlobalSensitivity.html#openturns.HSICEstimatorGlobalSensitivity" title="openturns.HSICEstimatorGlobalSensitivity"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSICEstimatorGlobalSensitivity</span></code></a> for global sensitivity analysis HSIC estimators</p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.HSICEstimatorTargetSensitivity.html#openturns.HSICEstimatorTargetSensitivity" title="openturns.HSICEstimatorTargetSensitivity"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSICEstimatorTargetSensitivity</span></code></a> for target sensitivity analysis HSIC estimators</p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.HSICEstimatorConditionalSensitivity.html#openturns.HSICEstimatorConditionalSensitivity" title="openturns.HSICEstimatorConditionalSensitivity"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSICEstimatorConditionalSensitivity</span></code></a> for conditional sensitivity analysis HSIC estimators</p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.HSICUStat.html#openturns.HSICUStat" title="openturns.HSICUStat"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSICUStat</span></code></a> for U-statistic specific HSIC computations</p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.HSICVStat.html#openturns.HSICVStat" title="openturns.HSICVStat"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSICVStat</span></code></a> for V-statistic specific HSIC computations</p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title">Examples:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../auto_reliability_sensitivity/sensitivity_analysis/plot_hsic_estimators_ishigami.html"><span class="doc">The HSIC sensitivity indices: the Ishigami model</span></a></p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title">References:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../bibliography.html#gretton2005" id="id1"><span>[gretton2005]</span></a></p></li>
<li><p><a class="reference internal" href="../../bibliography.html#daveiga2015" id="id2"><span>[daveiga2015]</span></a></p></li>
<li><p><a class="reference internal" href="../../bibliography.html#marrel2021" id="id3"><span>[marrel2021]</span></a></p></li>
</ul>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="form_approximation.html" title="FORM"
             >next</a> |</li>
        <li class="right" >
          <a href="sensitivity_form.html" title="Sensitivity Factors from FORM method"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.19rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" >Reliability, sensitivity</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sensitivity analysis using Hilbert-Schmidt Indepencence Criterion (HSIC)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on May 06, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>