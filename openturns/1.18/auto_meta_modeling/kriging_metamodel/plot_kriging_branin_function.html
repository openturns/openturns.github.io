
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Kriging: metamodel of the Branin-Hoo function &#8212; OpenTURNS 1.18rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Kriging : quick-start" href="plot_kriging_1d.html" />
    <link rel="prev" title="Kriging :configure the optimization solver" href="plot_kriging_hyperparameters_optimization.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_kriging_1d.html" title="Kriging : quick-start"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_kriging_hyperparameters_optimization.html" title="Kriging :configure the optimization solver"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.18rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" accesskey="U">Meta modeling</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Kriging: metamodel of the Branin-Hoo function</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Kriging: metamodel of the Branin-Hoo function</a><ul>
<li><a class="reference internal" href="#definition-of-the-kriging-metamodel">Definition of the Kriging metamodel</a></li>
<li><a class="reference internal" href="#metamodel-visualization">Metamodel visualization</a></li>
<li><a class="reference internal" href="#standard-deviation">Standard deviation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_kriging_hyperparameters_optimization.html"
                        title="previous chapter">Kriging :configure the optimization solver</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_kriging_1d.html"
                        title="next chapter">Kriging : quick-start</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_meta_modeling/kriging_metamodel/plot_kriging_branin_function.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-meta-modeling-kriging-metamodel-plot-kriging-branin-function-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="kriging-metamodel-of-the-branin-hoo-function">
<span id="sphx-glr-auto-meta-modeling-kriging-metamodel-plot-kriging-branin-function-py"></span><h1>Kriging: metamodel of the Branin-Hoo function<a class="headerlink" href="#kriging-metamodel-of-the-branin-hoo-function" title="Permalink to this headline">¶</a></h1>
<p>As a popular use case in optimization we briefly present the construction of a metamodel
of the Branin (also refered to as Branin-Hoo) function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">branin_function</span> <span class="k">as</span> <span class="n">branin_function</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
<p>We load the Branin-Hoo model from the usecases module and use the model (stored in <cite>objectiveFunction</cite>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bm</span> <span class="o">=</span> <span class="n">branin_function</span><span class="o">.</span><span class="n">BraninModel</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">objectiveFunction</span>
</pre></div>
</div>
<p>We shall represent this 2D function with isolines. We set the number of isolines to a maximum of 10
thanks to the following <cite>ResourceMap</cite> key :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Contour-DefaultLevelsNumber&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">graphBasic</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We get the values of all isolines :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">drawables</span> <span class="o">=</span> <span class="n">graphBasic</span><span class="o">.</span><span class="n">getDrawables</span><span class="p">()</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">contours</span> <span class="ow">in</span> <span class="n">drawables</span><span class="p">:</span>
    <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contours</span><span class="o">.</span><span class="n">getLevels</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>We now build fancy isolines :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take the first contour as the only one with multiple levels</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">graphBasic</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Build a range of colors</span>
<span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span>
    <span class="s1">&#39;Drawable-DefaultPalettePhase&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="c1"># Create the drawables list, appending each contour with its own color</span>
<span class="n">drawables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)):</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setLevels</span><span class="p">([</span><span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="c1"># Inline the level values</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setDrawLabels</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We have to copy the drawable because a Python list stores only pointers</span>
    <span class="n">drawables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="p">(</span><span class="n">contour</span><span class="p">))</span>

<span class="n">graphFineTune</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;The exact Branin model&quot;</span><span class="p">,</span>
                         <span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setDrawables</span><span class="p">(</span><span class="n">drawables</span><span class="p">)</span>  <span class="c1"># Replace the drawables</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Remove the legend</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>  <span class="c1"># Add colors</span>
</pre></div>
</div>
<p>We also represent the three minima of the Branin function with orange diamonds :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([</span><span class="n">bm</span><span class="o">.</span><span class="n">xexact1</span><span class="p">,</span> <span class="n">bm</span><span class="o">.</span><span class="n">xexact2</span><span class="p">,</span> <span class="n">bm</span><span class="o">.</span><span class="n">xexact3</span><span class="p">])</span>
<span class="n">cloud1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;First Cloud&#39;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud1</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphFineTune</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># The values of the exact model at these points are :</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">objectiveFunction</span><span class="p">(</span><span class="n">sample1</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_kriging_branin_function_001.png" srcset="../../_images/sphx_glr_plot_kriging_branin_function_001.png" alt="The exact Branin model" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    [ y0       ]
0 : [ -1.04741 ]
1 : [ -1.04741 ]
2 : [ -1.04741 ]
</pre></div>
</div>
<p>The Branin function has a global minimum attained at three different points. We shall build a
metamodel of this function that presents the same behaviour.</p>
<section id="definition-of-the-kriging-metamodel">
<h2>Definition of the Kriging metamodel<a class="headerlink" href="#definition-of-the-kriging-metamodel" title="Permalink to this headline">¶</a></h2>
<p>We use the <a class="reference internal" href="../../user_manual/response_surface/_generated/openturns.KrigingAlgorithm.html#openturns.KrigingAlgorithm" title="openturns.KrigingAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">KrigingAlgorithm</span></code></a> class to perform the kriging analysis.
We first generate a design of experiments with LHS and store the input trainig points in <cite>xdata</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LHSExperiment</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span>
    <span class="p">[</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]),</span> <span class="mi">28</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>We also get the output training values :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ydata</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">objectiveFunction</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
</pre></div>
</div>
<p>This use case is defined in dimension 2 and we use a constant basis for the trend estimation :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dimension</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">dim</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ConstantBasisFactory</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<p>We choose a squared exponential covariance model in dimension 2 :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">covarianceModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SquaredExponential</span><span class="p">([</span><span class="mf">0.1</span><span class="p">]</span><span class="o">*</span><span class="n">dimension</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
<p>We have all the components to build a kriging algorithm and run it :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KrigingAlgorithm</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">covarianceModel</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>We get the result of the kriging analysis with :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="metamodel-visualization">
<h2>Metamodel visualization<a class="headerlink" href="#metamodel-visualization" title="Permalink to this headline">¶</a></h2>
<p>We draw the kriging metamodel of the Branin function. It is the mean of the random process.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metamodel</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>


<span class="n">graphBasic</span> <span class="o">=</span> <span class="n">metamodel</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">drawables</span> <span class="o">=</span> <span class="n">graphBasic</span><span class="o">.</span><span class="n">getDrawables</span><span class="p">()</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drawables</span><span class="p">)):</span>
    <span class="n">contours</span> <span class="o">=</span> <span class="n">drawables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contours</span><span class="o">.</span><span class="n">getLevels</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Take the first contour as the only one with multiple levels</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">graphBasic</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Build a range of colors</span>
<span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span>
    <span class="s1">&#39;Drawable-DefaultPalettePhase&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="c1"># Create the drawables list, appending each contour with its own color</span>
<span class="n">drawables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)):</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setLevels</span><span class="p">([</span><span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="c1"># Inline the level values</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setDrawLabels</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We have to copy the drawable because a Python list stores only pointers</span>
    <span class="n">drawables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="p">(</span><span class="n">contour</span><span class="p">))</span>

<span class="n">graphFineTune</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Branin metamodel (mean)&quot;</span><span class="p">,</span>
                         <span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setDrawables</span><span class="p">(</span><span class="n">drawables</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
</pre></div>
</div>
<p>We also represent the location of the minima of the Branin function :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([</span><span class="n">bm</span><span class="o">.</span><span class="n">xexact1</span><span class="p">,</span> <span class="n">bm</span><span class="o">.</span><span class="n">xexact2</span><span class="p">,</span> <span class="n">bm</span><span class="o">.</span><span class="n">xexact3</span><span class="p">])</span>
<span class="n">cloud1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;First Cloud&#39;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud1</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphFineTune</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_kriging_branin_function_002.png" srcset="../../_images/sphx_glr_plot_kriging_branin_function_002.png" alt="Branin metamodel (mean)" class = "sphx-glr-single-img"/><p>We evaluate the metamodel at the minima locations :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">metamodel</span><span class="p">(</span><span class="n">sample1</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0 : [ -1.05296 ]
1 : [ -1.04014 ]
2 : [ -1.1114  ]
</pre></div>
</div>
<p>Graphically, both the metamodel and the exact function look the same. The metamodel also has three
basins around the minima and the value of the metamodel at each minimum location is comparable to
the exact value of -0.979476. We have roughly two correct digits for each isoline.</p>
</section>
<section id="standard-deviation">
<h2>Standard deviation<a class="headerlink" href="#standard-deviation" title="Permalink to this headline">¶</a></h2>
<p>We finally take a look at the standard deviation in the <img class="math" src="../../_images/math/2acb373abd6a055ff3b7078170087de6d620bcfb.svg" alt="[0,1] \times [0,1]"/> domain. It may be
seen as a measure of the error of the metamodel.</p>
<p>We discretize the domain with 22 points (N inside points and 2 endpoints) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">inputData</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>We compute the conditional variance of the model and take the square root to get the deviation :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">condCov</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getConditionalMarginalVariance</span><span class="p">(</span><span class="n">inputData</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">condCovSd</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">condCov</span><span class="p">)</span>
</pre></div>
</div>
<p>As we have previously done we build contours with the following levels ans labels :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.050</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.150</span><span class="p">,</span> <span class="mf">0.175</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0.01&#39;</span><span class="p">,</span> <span class="s1">&#39;0.025&#39;</span><span class="p">,</span> <span class="s1">&#39;0.050&#39;</span><span class="p">,</span> <span class="s1">&#39;0.075&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;0.125&#39;</span><span class="p">,</span> <span class="s1">&#39;0.150&#39;</span><span class="p">,</span> <span class="s1">&#39;0.175&#39;</span><span class="p">]</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Contour</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">condCovSd</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
</pre></div>
</div>
<p>We use fancy colored isolines for the contour plot :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">contour</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span>
    <span class="s1">&#39;Drawable-DefaultPalettePhase&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="n">drawables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)):</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setLevels</span><span class="p">([</span><span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setDrawLabels</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">drawables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="p">(</span><span class="n">contour</span><span class="p">))</span>

<span class="n">graphFineTune</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Standard deviation&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setDrawables</span><span class="p">(</span><span class="n">drawables</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
</pre></div>
</div>
<p>We superimpose the training sample :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;fcircle&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphFineTune</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_kriging_branin_function_003.png" srcset="../../_images/sphx_glr_plot_kriging_branin_function_003.png" alt="Standard deviation" class = "sphx-glr-single-img"/><p>We observe that the standard deviation is small in the center of the domain where we have enough
data to learn the model.
We can print the value of the variance at the first 5 training points (they all behave similarly) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getConditionalMarginalVariance</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    [ v0          ]
0 : [ 0.00106993  ]
1 : [ 0.000674665 ]
2 : [ 0.000840553 ]
3 : [ 0.000694642 ]
4 : [ 0.00108795  ]
</pre></div>
</div>
<p>These values are nearly zero which is expected as the kriging interpolates data. The value being
known it is not random anymore and the variance ought to be zero.</p>
<p>Display all figures</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.663 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-meta-modeling-kriging-metamodel-plot-kriging-branin-function-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/28f079a29c5116ba1066c28c4b045144/plot_kriging_branin_function.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_kriging_branin_function.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c287f6d71c0604cb99cf33e69837b5cc/plot_kriging_branin_function.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_kriging_branin_function.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_kriging_1d.html" title="Kriging : quick-start"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_kriging_hyperparameters_optimization.html" title="Kriging :configure the optimization solver"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.18rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Kriging: metamodel of the Branin-Hoo function</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2021 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Nov 08, 2021.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>