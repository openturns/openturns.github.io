
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Estimate Sobol’ indices for a function with multivariate output &#8212; OpenTURNS 1.22 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sobol’ sensitivity indices from chaos" href="plot_functional_chaos_sensitivity.html" />
    <link rel="prev" title="Parallel coordinates graph as sensitivity tool" href="plot_sensitivity_par_coo.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_functional_chaos_sensitivity.html" title="Sobol’ sensitivity indices from chaos"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_par_coo.html" title="Parallel coordinates graph as sensitivity tool"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate Sobol’ indices for a function with multivariate output</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Estimate Sobol’ indices for a function with multivariate output</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#define-the-model">Define the model</a></li>
<li><a class="reference internal" href="#estimate-the-sobol-indices">Estimate the Sobol’ indices</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_sensitivity_par_coo.html"
                          title="previous chapter">Parallel coordinates graph as sensitivity tool</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_functional_chaos_sensitivity.html"
                          title="next chapter">Sobol’ sensitivity indices from chaos</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/sensitivity_analysis/plot_sensitivity_sobol_multivariate.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-multivariate-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="estimate-sobol-indices-for-a-function-with-multivariate-output">
<span id="sphx-glr-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-multivariate-py"></span><h1>Estimate Sobol’ indices for a function with multivariate output<a class="headerlink" href="#estimate-sobol-indices-for-a-function-with-multivariate-output" title="Permalink to this heading">¶</a></h1>
<p>In this example, we estimate the Sobol’ indices of a function by sampling methods.
This function has several outputs, which leads to the need of aggregated Sobol’ indices.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>In this example we quantify the sensitivity of a function’s outputs to its inputs with Sobol’ indices.</p>
<p>The function we consider has 5 outputs. In this case, it may be convenient to consider each output separately.
It may also be interesting to aggregate the sensitivity indices to get a global understanding of the sensitivity of the inputs to the average output.</p>
</section>
<section id="define-the-model">
<h2>Define the model<a class="headerlink" href="#define-the-model" title="Permalink to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>We define a linear model with 5 independent Gaussian inputs and 2 outputs.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">inputDistribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">function</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;x0&quot;</span><span class="p">,</span> <span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;x3&quot;</span><span class="p">,</span> <span class="s2">&quot;x4&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;x0 + 4.0 * x1 ^ 2 + 3.0 * x2&quot;</span><span class="p">,</span> <span class="s2">&quot;-7.0 * x2 - 4.0 * x3 + x4&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="estimate-the-sobol-indices">
<h2>Estimate the Sobol’ indices<a class="headerlink" href="#estimate-the-sobol-indices" title="Permalink to this heading">¶</a></h2>
<p>We first create a design of experiments with <cite>SobolIndicesExperiment</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sie</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SobolIndicesExperiment</span><span class="p">(</span><span class="n">inputDistribution</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="n">inputDesign</span> <span class="o">=</span> <span class="n">sie</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">input_names</span> <span class="o">=</span> <span class="n">inputDistribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
<span class="n">inputDesign</span><span class="o">.</span><span class="n">setDescription</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample size: &quot;</span><span class="p">,</span> <span class="n">inputDesign</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Sample size:  7000
</pre></div>
</div>
<p>We see that 7000 function evaluations are required to estimate the first order and total Sobol’ indices.
Then we evaluate the outputs corresponding to this design of experiments.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">outputDesign</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we estimate the Sobol’ indices with the <cite>SaltelliSensitivityAlgorithm</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SaltelliSensitivityAlgorithm</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">,</span> <span class="n">outputDesign</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>getFirstOrderIndices</cite> and <cite>getTotalOrderIndices</cite> method respectively return estimates of first order and total Sobol’ indices with a given output.
Since these depend on the output marginal, the index of the output must
be specified (the default is to return the index for the first output).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">output_dimension</span> <span class="o">=</span> <span class="n">function</span><span class="o">.</span><span class="n">getOutputDimension</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">output_dimension</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output #&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">first_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getFirstOrderIndices</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">total_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getTotalOrderIndices</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    First order indices: &quot;</span><span class="p">,</span> <span class="n">first_order</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Total order indices: &quot;</span><span class="p">,</span> <span class="n">total_order</span><span class="p">)</span>

<span class="n">agg_first_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getAggregatedFirstOrderIndices</span><span class="p">()</span>
<span class="n">agg_total_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getAggregatedTotalOrderIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agg. first order indices: &quot;</span><span class="p">,</span> <span class="n">agg_first_order</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agg. total order indices: &quot;</span><span class="p">,</span> <span class="n">agg_total_order</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Output # 0
    First order indices:  [0.0691732,0.685404,0.239095,0.0384442,0.0384442]
    Total order indices:  [0.029214,0.732273,0.20024,-4.90215e-08,-4.90215e-08]
Output # 1
    First order indices:  [-0.00205559,-0.00205559,0.691061,0.214936,0.0176866]
    Total order indices:  [-5.29124e-08,-5.29124e-08,0.770164,0.218968,0.0131089]
Agg. first order indices:  [0.0248636,0.257753,0.520251,0.148235,0.0255314]
Agg. total order indices:  [0.0110407,0.276745,0.554775,0.136214,0.00815471]
</pre></div>
</div>
<p>We see that:</p>
<ul class="simple">
<li><p><cite>x1</cite> has a rather large first order index on the first output, but a small index on the second output,</p></li>
<li><p><cite>x2</cite> has a rather large first order index on the first output on both outputs,</p></li>
<li><p>the largest aggregated Sobol’ index is <cite>x2</cite>,</p></li>
<li><p><cite>x0</cite> and <cite>x5</cite> have Sobol’ indices which are close to zero regardless of whether the indices are aggregated or not.</p></li>
</ul>
<p>The <cite>draw</cite> method produces the following graph. The vertical bars represent the 95% confidence intervals of the estimates.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sensitivity_sobol_multivariate_001.png" srcset="../../_images/sphx_glr_plot_sensitivity_sobol_multivariate_001.png" alt="Aggregated Sobol' indices - SaltelliSensitivityAlgorithm" class = "sphx-glr-single-img"/><p>Since there are several outputs, the graph presents the aggregated Sobol’ indices.
The aggregated Sobol’ indices indicate that the input variable which has the largest impact on the variability of the several outputs is <cite>x2</cite>.</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-multivariate-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8b9b454e1deedf95dba642ced538dd3e/plot_sensitivity_sobol_multivariate.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sensitivity_sobol_multivariate.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f25408f623236a16fc3c6fe5be1acf3b/plot_sensitivity_sobol_multivariate.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sensitivity_sobol_multivariate.py</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_functional_chaos_sensitivity.html" title="Sobol’ sensitivity indices from chaos"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_par_coo.html" title="Parallel coordinates graph as sensitivity tool"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate Sobol’ indices for a function with multivariate output</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 13, 2024.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>