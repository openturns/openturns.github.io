<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estimate a probability using Line Sampling &#8212; OpenTURNS 1.27dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css?v=105494d3" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=4652c2b6" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sphx_glr.css?v=2ae27345" />
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=c75cadd3"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script src="../../_static/js/mysearchtools.js?v=40848abd"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Create unions or intersections of events" href="plot_event_system.html" />
    <link rel="prev" title="Time variant system reliability problem" href="plot_proba_system_event.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_event_system.html" title="Create unions or intersections of events"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_proba_system_event.html" title="Time variant system reliability problem"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.27dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Reliability analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate a probability using Line Sampling</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Estimate a probability using Line Sampling</a><ul>
<li><a class="reference internal" href="#define-the-limit-state-function-and-the-random-vector">Define the limit state function and the random vector</a></li>
<li><a class="reference internal" href="#define-the-event">Define the event</a></li>
<li><a class="reference internal" href="#run-form-approximation">Run FORM approximation</a></li>
<li><a class="reference internal" href="#run-line-sampling">Run Line Sampling</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_proba_system_event.html"
                          title="previous chapter">Time variant system reliability problem</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_event_system.html"
                          title="next chapter">Create unions or intersections of events</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability/reliability_analysis/plot_line_sampling.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-reliability-analysis-plot-line-sampling-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="estimate-a-probability-using-line-sampling">
<span id="sphx-glr-auto-reliability-reliability-analysis-plot-line-sampling-py"></span><h1>Estimate a probability using Line Sampling<a class="headerlink" href="#estimate-a-probability-using-line-sampling" title="Link to this heading">¶</a></h1>
<p>In this example, we estimate the probability that the output of a function exceeds a given threshold with the Line Sampling method.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">openturns</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns.experimental</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">otexp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns.viewer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">otv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
<section id="define-the-limit-state-function-and-the-random-vector">
<h2>Define the limit state function and the random vector<a class="headerlink" href="#define-the-limit-state-function-and-the-random-vector" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">g_twoBranch</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">],</span>
    <span class="p">[</span>
        <span class="s2">&quot;min(4 + 0.1 * (x1 - x2)^2 - (x1 + x2) / sqrt(2), 4 + 0.1 * (x1 - x2)^2 + (x1 + x2) / sqrt(2))&quot;</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RandomVector</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="define-the-event">
<h2>Define the event<a class="headerlink" href="#define-the-event" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">Y_twoBranch</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CompositeRandomVector</span><span class="p">(</span><span class="n">g_twoBranch</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">event_twoBranch</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ThresholdEvent</span><span class="p">(</span><span class="n">Y_twoBranch</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Less</span><span class="p">(),</span> <span class="n">threshold</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="run-form-approximation">
<h2>Run FORM approximation<a class="headerlink" href="#run-form-approximation" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">optimAlgo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cobyla</span><span class="p">()</span>
<span class="n">optimAlgo</span><span class="o">.</span><span class="n">setStartingPoint</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">getMean</span><span class="p">())</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FORM</span><span class="p">(</span><span class="n">optimAlgo</span><span class="p">,</span> <span class="n">event_twoBranch</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">resultFORM</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="run-line-sampling">
<h2>Run Line Sampling<a class="headerlink" href="#run-line-sampling" title="Link to this heading">¶</a></h2>
<p>The design point will define the initial important direction</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_twoBranch</span> <span class="o">=</span> <span class="n">resultFORM</span><span class="o">.</span><span class="n">getStandardSpaceDesignPoint</span><span class="p">()</span>
</pre></div>
</div>
<p>Define the root solver</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Brent</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">rootStrategy</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MediumSafe</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span>
</pre></div>
</div>
<p>Create the algorithm</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">LineSampling</span><span class="p">(</span><span class="n">event_twoBranch</span><span class="p">,</span> <span class="n">alpha_twoBranch</span><span class="p">,</span> <span class="n">rootStrategy</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumCoefficientOfVariation</span><span class="p">(</span><span class="mf">5e-2</span><span class="p">)</span>
<span class="c1"># disable adaptive important direction to make plots easier to interpret</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setAdaptiveImportantDirection</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Save the important direction history, and especially all root points</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">setStoreHistory</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Run the simulation</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>probabilityEstimate=8.191688e-03 varianceEstimate=1.672832e-07 standard deviation=4.09e-04 coefficient of variation=4.99e-02 confidenceLength(0.95)=1.60e-03 outerSampling=81 blockSize=1
</pre></div>
</div>
<p>Retrieve important directions</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getAlphaHistory</span><span class="p">()</span>
</pre></div>
</div>
<p>Retrieve root points and root values</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rootPoints</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getRootPointsHistory</span><span class="p">()</span>
<span class="n">rootValues</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getRootValuesHistory</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">drawLines</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw sampling lines and the corresponding roots.&quot;&quot;&quot;</span>
    <span class="n">rootPoints</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getRootPointsHistory</span><span class="p">()</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getAlphaHistory</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rootPoints</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># there can be several roots per sample</span>
        <span class="n">n_roots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rootPoints</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_roots</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n_roots=</span><span class="si">{</span><span class="n">n_roots</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">dp</span> <span class="o">=</span> <span class="n">rootPoints</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="c1"># project design point on the hyperplane orthogonal to alpha to get origin point</span>
            <span class="n">uPoint</span> <span class="o">=</span> <span class="n">dp</span>
            <span class="n">uDot</span> <span class="o">=</span> <span class="n">uPoint</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">uPoint</span> <span class="o">=</span> <span class="n">uPoint</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">uDot</span>
            <span class="c1"># draw segment origin -&gt; design point</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">uPoint</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="p">(</span><span class="n">uPoint</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># draw origin</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">uPoint</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uPoint</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="c1"># draw design point</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;bo&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">drawLSDesign</span><span class="p">(</span><span class="n">algo</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw sampling lines, roots, and the limit state function.&quot;&quot;&quot;</span>
    <span class="n">dmin</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">dmax</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">graph1</span> <span class="o">=</span> <span class="n">g_twoBranch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">dmin</span><span class="p">,</span> <span class="n">dmax</span><span class="p">)</span>
    <span class="n">contour_g</span> <span class="o">=</span> <span class="n">graph1</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span>
    <span class="n">contour_g</span><span class="o">.</span><span class="n">setColorBarPosition</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">contour_g</span><span class="o">.</span><span class="n">setColorMap</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">graph1</span><span class="o">.</span><span class="n">setDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">contour_g</span><span class="p">)</span>
    <span class="n">view1</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph1</span><span class="p">,</span> <span class="n">square_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># now draw the the limit state on same figure</span>
    <span class="n">graph2</span> <span class="o">=</span> <span class="n">g_twoBranch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">dmin</span><span class="p">,</span> <span class="n">dmax</span><span class="p">)</span>
    <span class="n">contour_g</span> <span class="o">=</span> <span class="n">graph2</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span>
    <span class="n">contour_g</span><span class="o">.</span><span class="n">setLevels</span><span class="p">([</span><span class="n">threshold</span><span class="p">])</span>
    <span class="n">contour_g</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">graph2</span><span class="o">.</span><span class="n">setDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">contour_g</span><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axline.html#matplotlib.pyplot.axline" title="matplotlib.pyplot.axline" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">axline</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">drawLines</span><span class="p">(</span><span class="n">algo</span><span class="p">)</span>
    <span class="n">graph2</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Line Sampling&quot;</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph2</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">view1</span><span class="o">.</span><span class="n">getFigure</span><span class="p">())</span>
</pre></div>
</div>
<p>Plot the limit state, a few design points and their origin</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">drawLSDesign</span><span class="p">(</span><span class="n">algo</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_line_sampling_001.svg" srcset="../../_images/sphx_glr_plot_line_sampling_001.svg" alt="Line Sampling" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>n_roots=2
</pre></div>
</div>
<p>Now we disable the opposite direction search to try to save function evaluations.
This practice is incorrect in this case, however, as the algorithm misses half the probability of the event.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setSearchOppositeDirection</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>probabilityEstimate=4.095844e-03 varianceEstimate=4.182085e-08 standard deviation=2.05e-04 coefficient of variation=4.99e-02 confidenceLength(0.95)=8.02e-04 outerSampling=81 blockSize=1
</pre></div>
</div>
<p>We plot the limit state, a few design points and their origin.
This time we see each origin sample point in the orthogonal hyperplane yields only one design point.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">drawLSDesign</span><span class="p">(</span><span class="n">algo</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_line_sampling_002.svg" srcset="../../_images/sphx_glr_plot_line_sampling_002.svg" alt="Line Sampling" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>n_roots=1
</pre></div>
</div>
<p>Now re-enable adaptive important direction search</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setAdaptiveImportantDirection</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setSearchOppositeDirection</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>probabilityEstimate=8.253432e-03 varianceEstimate=1.683218e-07 standard deviation=4.10e-04 coefficient of variation=4.97e-02 confidenceLength(0.95)=1.61e-03 outerSampling=80 blockSize=1
</pre></div>
</div>
<p>Inspect important directions (without duplicates from history)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">unique_alphas</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">algo</span><span class="o">.</span><span class="n">getAlphaHistory</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_alphas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="n">unique_alphas</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">unique_alphas</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unique alphas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">unique_alphas</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>unique alphas:
0 : [  0.707104  0.707109 ]
1 : [  0.939276  0.343163 ]
2 : [  0.634607  0.772835 ]
3 : [  0.671819  0.740716 ]
4 : [ -0.689475 -0.724309 ]
5 : [  0.71885   0.695165 ]
6 : [ -0.695049 -0.718963 ]
7 : [  0.69544   0.718584 ]
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-reliability-analysis-plot-line-sampling-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/87a74bf37686b0319433d6a664be8daa/plot_line_sampling.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_line_sampling.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/0b697a80b0935fb22f0b361fdceb5244/plot_line_sampling.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_line_sampling.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ce25103a3b31b58b40242ac535024274/plot_line_sampling.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_line_sampling.zip</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_event_system.html" title="Create unions or intersections of events"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_proba_system_event.html" title="Time variant system reliability problem"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.27dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Reliability analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate a probability using Line Sampling</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2005-2026 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>