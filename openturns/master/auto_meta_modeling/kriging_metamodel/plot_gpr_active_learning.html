<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gaussian Process-based active learning for reliability &#8212; OpenTURNS 1.25dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css?v=105494d3" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=4652c2b6" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sphx_glr.css?v=2ae27345" />
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=e2d0d5e7"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script src="../../_static/js/mysearchtools.js?v=a003391d"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Kriging: choose a polynomial trend" href="plot_kriging_chose_trend.html" />
    <link rel="prev" title="Kriging: configure the optimization solver" href="plot_kriging_hyperparameters_optimization.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_kriging_chose_trend.html" title="Kriging: choose a polynomial trend"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_kriging_hyperparameters_optimization.html" title="Kriging: configure the optimization solver"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.25dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Gaussian Process Regression metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Gaussian Process-based active learning for reliability</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Gaussian Process-based active learning for reliability</a><ul>
<li><a class="reference internal" href="#create-the-function-and-the-design-of-experiments">Create the function and the design of experiments</a></li>
<li><a class="reference internal" href="#define-the-reliability-analysis">Define the reliability analysis</a></li>
<li><a class="reference internal" href="#create-the-algorithms">Create the algorithms</a></li>
<li><a class="reference internal" href="#active-learning-gaussian-process-regressor-to-sequentially-add-new-points">Active learning Gaussian Process Regressor to sequentially add new points</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_kriging_hyperparameters_optimization.html"
                          title="previous chapter">Kriging: configure the optimization solver</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_kriging_chose_trend.html"
                          title="next chapter">Kriging: choose a polynomial trend</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_meta_modeling/kriging_metamodel/plot_gpr_active_learning.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-meta-modeling-kriging-metamodel-plot-gpr-active-learning-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="gaussian-process-based-active-learning-for-reliability">
<span id="sphx-glr-auto-meta-modeling-kriging-metamodel-plot-gpr-active-learning-py"></span><h1>Gaussian Process-based active learning for reliability<a class="headerlink" href="#gaussian-process-based-active-learning-for-reliability" title="Link to this heading">¶</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 13</span>
</pre></div>
</div>
<p>In this example, we show how to sequentially add new points to a Gaussian Progress Regression model (GPR).
The goal is to improve the predictivity of the surrogate model for reliability estimation.
This kind of strategy is called “active learning”.
In order to create simple graphs, we consider a 1-d function.</p>
<section id="create-the-function-and-the-design-of-experiments">
<h2>Create the function and the design of experiments<a class="headerlink" href="#create-the-function-and-the-design-of-experiments" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">openturns</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns.experimental</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">otexp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openturns.viewer</span><span class="w"> </span><span class="kn">import</span> <span class="n">View</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openturns</span><span class="w"> </span><span class="kn">import</span> <span class="n">viewer</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the function, the threshold above which the system is considered in failure, and the input probability distribution.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;0.5*x^2 + sin(5*x)&quot;</span><span class="p">])</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
<p>Create the design of experiments.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dimension</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">DoESize</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">xMin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="n">xMax</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">X_distr</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LHSExperiment</span><span class="p">(</span><span class="n">X_distr</span><span class="p">,</span> <span class="n">DoESize</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<p>We plot the limit state function, the initial design of experiments and the failure threshold.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">thresholdFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">([</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">],</span> <span class="p">[</span><span class="n">threshold</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Failure threshold&quot;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Design of Experiments&quot;</span><span class="p">)</span>

<span class="n">graphFunction</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">)</span>
<span class="n">graphFunction</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="s2">&quot;magenta&quot;</span><span class="p">])</span>
<span class="n">graphFunction</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Limit state function&quot;</span><span class="p">])</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">graphFunction</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">thresholdFunction</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setAxes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setGrid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_gpr_active_learning_001.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_001.png" alt="plot gpr active learning" class = "sphx-glr-single-img"/></section>
<section id="define-the-reliability-analysis">
<h2>Define the reliability analysis<a class="headerlink" href="#define-the-reliability-analysis" title="Link to this heading">¶</a></h2>
<p>We define the event and estimate the reference failure probability with Monte-Carlo algorithm.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">vect</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RandomVector</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MemoizeFunction</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CompositeRandomVector</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">vect</span><span class="p">)</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ThresholdEvent</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Greater</span><span class="p">(),</span> <span class="n">threshold</span><span class="p">)</span>

<span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MonteCarloExperiment</span><span class="p">()</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ProbabilitySimulationAlgorithm</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">experiment</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumCoefficientOfVariation</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">probability</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">()</span>
<span class="n">sampleX</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">getInputHistory</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reference probability on the real function =&quot;</span><span class="p">,</span> <span class="n">probability</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Reference probability on the real function = 0.016759776536312866
</pre></div>
</div>
</section>
<section id="create-the-algorithms">
<h2>Create the algorithms<a class="headerlink" href="#create-the-algorithms" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">createMyBasicGPR</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Gaussian Process from a pair of X and Y samples.</span>
<span class="sd">    We use a 3/2 Matérn covariance model and a constant trend.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ConstantBasisFactory</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="n">covarianceModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MaternModel</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">fitter</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">GaussianProcessFitter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">covarianceModel</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
    <span class="n">fitter</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">algo</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">GaussianProcessRegression</span><span class="p">(</span><span class="n">fitter</span><span class="o">.</span><span class="n">getResult</span><span class="p">())</span>
    <span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">gprResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">gprResult</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">linearSample</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">npoints</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a sample created from a regular grid</span>
<span class="sd">    from xmin to xmax with npoints points.&quot;&quot;&quot;</span>
    <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">npoints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">rg</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RegularGrid</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">getVertices</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">vertices</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plotMyBasicGPR</span><span class="p">(</span>
    <span class="n">gprResult</span><span class="p">,</span> <span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">sampleX</span><span class="p">,</span> <span class="n">refProbability</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mf">0.95</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a gaussian process result, plot the data, the GP metamodel</span>
<span class="sd">    and a confidence interval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">gprResult</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
    <span class="n">graphKriging</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">)</span>
    <span class="n">graphKriging</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;GPR&quot;</span><span class="p">])</span>
    <span class="c1"># Create a grid of points and evaluate the function and the kriging</span>
    <span class="n">nbpoints</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">xGrid</span> <span class="o">=</span> <span class="n">linearSample</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">nbpoints</span><span class="p">)</span>
    <span class="n">yFunction</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">xGrid</span><span class="p">)</span>
    <span class="n">yKrig</span> <span class="o">=</span> <span class="n">meta</span><span class="p">(</span><span class="n">xGrid</span><span class="p">)</span>
    <span class="c1"># Compute the conditional covariance</span>

    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">getOperator</span><span class="p">()</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">proba</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gprResult</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()(</span><span class="n">sampleX</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">event</span><span class="o">.</span><span class="n">getThreshold</span><span class="p">())</span>
            <span class="o">/</span> <span class="n">sampleX</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">proba</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gprResult</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()(</span><span class="n">sampleX</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">event</span><span class="o">.</span><span class="n">getThreshold</span><span class="p">())</span>
            <span class="o">/</span> <span class="n">sampleX</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="n">gpcc</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">GaussianProcessConditionalCovariance</span><span class="p">(</span><span class="n">gprResult</span><span class="p">)</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">nbpoints</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0e-8</span><span class="p">])</span>
    <span class="n">conditionalVariance</span> <span class="o">=</span> <span class="n">gpcc</span><span class="o">.</span><span class="n">getConditionalMarginalVariance</span><span class="p">(</span><span class="n">xGrid</span><span class="p">)</span> <span class="o">+</span> <span class="n">epsilon</span>
    <span class="n">conditionalSigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">conditionalVariance</span><span class="p">)</span>
    <span class="c1"># Compute the quantile of the Normal distribution</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">quantileAlpha</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">DistFunc</span><span class="o">.</span><span class="n">qNormal</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="c1"># Draw the bounds</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
    <span class="n">dataLower</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">yKrig</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">quantileAlpha</span> <span class="o">*</span> <span class="n">conditionalSigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbpoints</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">dataUpper</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">yKrig</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">quantileAlpha</span> <span class="o">*</span> <span class="n">conditionalSigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbpoints</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="c1"># Compute the Polygon graphics</span>
    <span class="n">boundsPoly</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Polygon</span><span class="o">.</span><span class="n">FillBetween</span><span class="p">(</span><span class="n">xGrid</span><span class="o">.</span><span class="n">asPoint</span><span class="p">(),</span> <span class="n">dataLower</span><span class="p">,</span> <span class="n">dataUpper</span><span class="p">)</span>
    <span class="n">boundsPoly</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;95% bounds&quot;</span><span class="p">)</span>

    <span class="c1"># Plot the function</span>
    <span class="n">graphFonction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">xGrid</span><span class="p">,</span> <span class="n">yFunction</span><span class="p">)</span>
    <span class="n">graphFonction</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="n">graphFonction</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
    <span class="n">graphFonction</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">graphFonction</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Function&quot;</span><span class="p">)</span>

    <span class="n">thresholdFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">([</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">],</span> <span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">getThreshold</span><span class="p">()]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">thresholdFunction</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">)</span>

    <span class="c1"># Draw the X and Y observed</span>
    <span class="n">cloudDOE</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">cloudDOE</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
    <span class="n">cloudDOE</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">cloudDOE</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
    <span class="c1"># Assemble the graph</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">boundsPoly</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">graphFonction</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">thresholdFunction</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloudDOE</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">graphKriging</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setAxes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setGrid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span>
        <span class="s2">&quot;Estimated probability = </span><span class="si">%f</span><span class="s2">, Reference probability =  </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="n">refProbability</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setYTitle</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>
</pre></div>
</div>
<p>We start by creating the initial Gaussian Process Regressor model <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC40IC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzE0LjM1Njk2MnB0JyBoZWlnaHQ9JzExLjMyNDE2OXB0JyB2aWV3Qm94PScwIC0xMS4zMjQxNjkgMTQuMzU2OTYyIDExLjMyNDE2OSc+CjxkZWZzPgo8cGF0aCBpZD0nZzAtNzcnIGQ9J000LjYwMjc0LTYuNjgyOTM5QzQuOTI1NTI5LTUuMTI4NzY3IDUuNDUxNTU3LTIuNTcwMzYxIDYuMTMzMDAxLTEuMTgzNTYyQzYuMzk2MDE1LS42Njk0ODkgNi41Mjc1MjItLjQwNjQ3NiA2LjY0NzA3My0uNDA2NDc2QzYuNjk0ODk0LS40MDY0NzYgNi43MTg4MDQtLjQwNjQ3NiA2LjkzMzk5OC0uNjIxNjY5QzcuODQyNTktMS40OTQzOTYgOC40NjQyNTktMi4xODc3OTYgOS4zMDExMjEtMy4xNDQyMDlMMTEuOTE5MzAzLTYuMTkyNzc3QzExLjc1MTkzLTUuMTc2NTg4IDExLjMyMTU0NC0yLjQ4NjY3NSAxMS4zMjE1NDQtMS4wODc5MkMxMS4zMjE1NDQtLjc2NTEzMSAxMS4zMzM0OTktLjQ1NDI5NiAxMS4zNjkzNjUtLjEzMTUwN0MxMS4zODEzMiAwIDExLjQyOTE0MSAuMzQ2NyAxMS45MzEyNTggLjM0NjdTMTMuMzQxOTY4LS4xNzkzMjggMTMuMzQxOTY4LS40MTg0MzFDMTMuMzQxOTY4LS40OTAxNjIgMTMuMjcwMjM3LS41MDIxMTcgMTMuMjM0MzcxLS41MDIxMTdDMTMuMDc4OTU0LS41MDIxMTcgMTIuODM5ODUxLS4zOTQ1MjEgMTIuNzA4MzQ0LS4zMTA4MzRDMTIuNDIxNDItLjM0NjcgMTIuMzk3NTA5LS41Mzc5ODMgMTIuMzczNTk5LS44MTI5NTFDMTIuMzM3NzMzLTEuMTk1NTE3IDEyLjMzNzczMy0xLjU1NDE3MiAxMi4zMzc3MzMtMS42MDE5OTNDMTIuMzM3NzMzLTIuOTI5MDE2IDEyLjg2Mzc2MS02LjU1MTQzMiAxMy4yMTA0NjEtOC4wMzM4NzNDMTMuMjIyNDE2LTguMTE3NTU5IDEzLjIzNDM3MS04LjE0MTQ2OSAxMy4yMzQzNzEtOC4yMzcxMTFDMTMuMjM0MzcxLTguMjg0OTMyIDEzLjIyMjQxNi04LjQxNjQzOCAxMy4xMzg3My04LjQxNjQzOEMxMy4wOTA5MDktOC40MTY0MzggMTMuMDc4OTU0LTguNDA0NDgzIDEyLjg1MTgwNi04LjE0MTQ2OUMxMS43MjgwMi02Ljc3ODU4IDguMjM3MTExLTIuNTk0MjcxIDcuMDUzNTQ5LTEuNTkwMDM3QzYuNzU0NjctMi4yMjM2NjEgNi41Mzk0NzctMi42Nzc5NTggNi4xMjEwNDYtNC4zNTE2ODFDNS43NzQzNDYtNS43MDI2MTUgNS41NzExMDgtNi42OTQ4OTQgNS4zNjc4Ny03Ljg1NDU0NUM1LjMzMjAwNS04LjAyMTkxOCA1LjI3MjIyOS04LjM0NDcwNyA1LjI3MjIyOS04LjM2ODYxOEM1LjIzNjM2NC04LjQyODM5NCA1LjE3NjU4OC04LjQyODM5NCA1LjE0MDcyMi04LjQyODM5NEM0LjkyNTUyOS04LjQyODM5NCA0LjQyMzQxMi04LjE2NTM4IDQuMzg3NTQ3LTcuOTE0MzIxQzQuMjQ0MDg1LTYuOTEwMDg3IDQuMDA0OTgxLTUuMzMyMDA1IDMuMTY4MTItMy4wNDg1NjhDMi4yMTE3MDYtLjUwMjExNyAxLjk0ODY5Mi0uNTAyMTE3IDEuNzIxNTQ0LS41MDIxMTdDMS41NjYxMjctLjUwMjExNyAxLjEyMzc4Ni0uNTk3NzU4IC44NjA3NzItLjgzNjg2MkMuODAwOTk2LS44OTY2MzggLjc3NzA4Ni0uODk2NjM4IC43NTMxNzYtLjg5NjYzOEMuNTg1ODAzLS44OTY2MzggLjMyMjc5LS4zNTg2NTUgLjMyMjc5LS4wMjM5MUMuMzIyNzkgLjA4MzY4NiAuMzIyNzkgLjIyNzE0OCAuNzA1MzU1IC40MzAzODZDMS4wMDQyMzQgLjU4NTgwMyAxLjI5MTE1OCAuNTk3NzU4IDEuMzUwOTM0IC41OTc3NThDMi4wOTIxNTQgLjU5Nzc1OCAyLjc5NzUwOS0xLjExMTgzMSAzLjAzNjYxMy0xLjcyMTU0NEMzLjU5ODUwNi0zLjA3MjQ3OCA0LjI2Nzk5NS00Ljk2MTM5NSA0LjYwMjc0LTYuNjgyOTM5WicvPgo8cGF0aCBpZD0nZzEtOTQnIGQ9J00yLjkyOTAxNi04LjI5Njg4N0wxLjM2Mjg4OS02LjY3MDk4NEwxLjU1NDE3Mi02LjQ5MTY1NkwyLjkxNzA2MS03LjcyMzAzOUw0LjI5MTkwNS02LjQ5MTY1Nkw0LjQ4MzE4OC02LjY3MDk4NEwyLjkyOTAxNi04LjI5Njg4N1onLz4KPC9kZWZzPgo8ZyBpZD0ncGFnZTEnPgo8dXNlIHg9JzUuOTEyNDc1JyB5PSctMy4wMjE5NzgnIHhsaW5rOmhyZWY9JyNnMS05NCcvPgo8dXNlIHg9JzAnIHk9JzAnIHhsaW5rOmhyZWY9JyNnMC03NycvPgo8L2c+Cjwvc3ZnPgo8IS0tIERFUFRIPTAgLS0+" alt="\hat{\mathcal{M}}" style="vertical-align: 0px"/> on the 4 points in the design of experiments.
We estimate the probability on this surrogate model and compare with the reference probability computed on the real limit state function.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gprResult</span> <span class="o">=</span> <span class="n">createMyBasicGPR</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">plotMyBasicGPR</span><span class="p">(</span><span class="n">gprResult</span><span class="p">,</span> <span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">sampleX</span><span class="p">,</span> <span class="n">probability</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_gpr_active_learning_002.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_002.png" alt="Estimated probability = 0.017606, Reference probability =  0.016760" class = "sphx-glr-single-img"/></section>
<section id="active-learning-gaussian-process-regressor-to-sequentially-add-new-points">
<h2>Active learning Gaussian Process Regressor to sequentially add new points<a class="headerlink" href="#active-learning-gaussian-process-regressor-to-sequentially-add-new-points" title="Link to this heading">¶</a></h2>
<p>To sequentially add the new points, the “U criterion” is used.
It consists in finding the new point as the sample <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC40IC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzcuMDk4MzgxcHQnIGhlaWdodD0nNS4zMTMzOTlwdCcgdmlld0JveD0nMCAtNS4zMTMzOTkgNy4wOTgzODEgNS4zMTMzOTknPgo8ZGVmcz4KPHBhdGggaWQ9J2cwLTEyMCcgZD0nTTQuMDI4ODkyLTIuOTUyOTI3TDUuNDE1NjkxLTQuNTQyOTY0QzUuNTQ3MTk4LTQuNjk4MzgxIDUuNjU0Nzk1LTQuNzk0MDIyIDYuNjQ3MDczLTQuNzk0MDIyVi01LjMwODA5NUM1Ljk3NzU4NC01LjI4NDE4NCA1Ljk1MzY3NC01LjI4NDE4NCA1LjU0NzE5OC01LjI4NDE4NEM1LjIwMDQ5OC01LjI4NDE4NCA0LjY4NjQyNi01LjI4NDE4NCA0LjM1MTY4MS01LjMwODA5NVYtNC43OTQwMjJDNC41Nzg4MjktNC43OTQwMjIgNC44Mjk4ODgtNC43MzQyNDcgNC44Mjk4ODgtNC42NTA1NkM0LjgyOTg4OC00LjYyNjY1IDQuNzcwMTEyLTQuNTQyOTY0IDQuNzQ2MjAyLTQuNTE5MDU0TDMuNzA2MTAyLTMuMzQ3NDQ3TDIuNTIyNTQtNC43OTQwMjJIMy4wMjQ2NThWLTUuMzA4MDk1QzIuNzQ5Njg5LTUuMjg0MTg0IDEuOTM2NzM3LTUuMjg0MTg0IDEuNjEzOTQ4LTUuMjg0MTg0QzEuMjU1MjkzLTUuMjg0MTg0IC42MDk3MTQtNS4yODQxODQgLjI3NDk2OS01LjMwODA5NVYtNC43OTQwMjJIMS4xMjM3ODZMMi45ODg3OTItMi41MjI1NEwxLjQzNDYyLS43NjUxMzFDMS4yOTExNTgtLjU5Nzc1OCAxLjIwNzQ3Mi0uNTE0MDcyIC4yMTUxOTMtLjUxNDA3MlYwQy45MzI1MDMtLjAyMzkxIC45NTY0MTMtLjAyMzkxIDEuMzI3MDI0LS4wMjM5MUMxLjY3MzcyNC0uMDIzOTEgMi4xNzU4NDEtLjAyMzkxIDIuNTEwNTg1IDBWLS41MTQwNzJDMi4yODM0MzctLjUxNDA3MiAyLjAzMjM3OS0uNTczODQ4IDIuMDMyMzc5LS42NTc1MzRDMi4wMzIzNzktLjY2OTQ4OSAyLjAzMjM3OS0uNjgxNDQ1IDIuMTE2MDY1LS43NzcwODZMMy4zMTE1ODItMi4xMjgwMkw0LjYzODYwNS0uNTE0MDcySDQuMTM2NDg4VjBDNC40MjM0MTItLjAyMzkxIDUuMjI0NDA4LS4wMjM5MSA1LjU1OTE1My0uMDIzOTFDNS45MTc4MDgtLjAyMzkxIDYuNTUxNDMyLS4wMjM5MSA2Ljg4NjE3NyAwVi0uNTE0MDcySDYuMDQ5MzE1TDQuMDI4ODkyLTIuOTUyOTI3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTEyMCcvPgo8L2c+Cjwvc3ZnPgo8IS0tIERFUFRIPTAgLS0+" alt="\mathbf{x}" style="vertical-align: 0px"/> in the Monte-Carlo experiment that minimizes  the following expression:
<img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC40IC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzQxLjE1MjQ3MXB0JyBoZWlnaHQ9JzIxLjc3NjQwMXB0JyB2aWV3Qm94PScxLjE5NTUxNCAtMTUuNjYxMjQxIDQxLjE1MjQ3MSAyMS43NzY0MDEnPgo8ZGVmcz4KPHBhdGggaWQ9J2cwLTEyMCcgZD0nTTIuOTY0ODgyLTEuOTQ0NzA3TDMuOTc3MDg2LTIuOTg4NzkyQzQuMTA0NjA4LTMuMTI0Mjg0IDQuMzQzNzExLTMuMTI0Mjg0IDQuNzU4MTU3LTMuMTI0Mjg0Vi0zLjUzODczQzQuNTE5MDU0LTMuNTE0ODE5IDQuMTYwMzk5LTMuNTE0ODE5IDQuMDAwOTk2LTMuNTE0ODE5QzMuOTI5MjY1LTMuNTE0ODE5IDMuNDY2OTk5LTMuNTE0ODE5IDMuMTg4MDQ1LTMuNTM4NzNWLTMuMTI0Mjg0QzMuMjY3NzQ2LTMuMTI0Mjg0IDMuNDAzMjM4LTMuMTAwMzc0IDMuNDAzMjM4LTMuMDUyNTUzQzMuNDAzMjM4LTMuMDI4NjQzIDMuMzU1NDE3LTIuOTgwODIyIDMuMzQ3NDQ3LTIuOTcyODUyTDIuNjY5OTg4LTIuMjcxNDgyTDEuODgwOTQ2LTMuMTI0Mjg0SDIuMTIwMDVWLTMuNTM4NzNDMS42NTc3ODMtMy41MTQ4MTkgMS41NTQxNzItMy41MTQ4MTkgMS4xNjM2MzYtMy41MTQ4MTlDMS4wMjAxNzQtMy41MTQ4MTkgLjU0OTkzOC0zLjUxNDgxOSAuMjcwOTg0LTMuNTM4NzNWLTMuMTI0Mjg0SC44Mjg4OTJMMi4xMjgwMi0xLjcxMzU3NEwxLjAyMDE3NC0uNTU3OTA4Qy45MzI1MDMtLjQ3MDIzNyAuODUyODAyLS40MTQ0NDYgLjM1ODY1NS0uNDE0NDQ2SC4yMjMxNjNWMEMuNDcwMjM3LS4wMjM5MSAuODM2ODYyLS4wMjM5MSAuOTgwMzI0LS4wMjM5MUMxLjAyODE0NC0uMDIzOTEgMS41MjIyOTEtLjAyMzkxIDEuODAxMjQ1IDBWLS40MTQ0NDZDMS42NDk4MTMtLjQxNDQ0NiAxLjYwOTk2My0uNDU0Mjk2IDEuNTcwMTEyLS40ODYxNzdMMi40MzA4ODQtMS4zODY4TDMuMzIzNTM3LS40MTQ0NDZIMy4wODQ0MzNWMEMzLjU0NjctLjAyMzkxIDMuNjUwMzExLS4wMjM5MSA0LjA0MDg0Ny0uMDIzOTFDNC4xNjAzOTktLjAyMzkxIDQuNjU0NTQ1LS4wMjM5MSA0LjkzMzQ5OSAwVi0uNDE0NDQ2SDQuMzc1NTkyTDIuOTY0ODgyLTEuOTQ0NzA3WicvPgo8cGF0aCBpZD0nZzQtNDAnIGQ9J00yLjY1NDA0NyAxLjk5MjUyOEMyLjcxNzgwOCAxLjk5MjUyOCAyLjgxMzQ1IDEuOTkyNTI4IDIuODEzNDUgMS44OTY4ODdDMi44MTM0NSAxLjg2NTAwNiAyLjgwNTQ3OSAxLjg1NzAzNiAyLjcwMTg2OCAxLjc1MzQyNUMxLjYwOTk2MyAuNzI1MjggMS4zMzg5NzktLjc1NzE2MSAxLjMzODk3OS0xLjk5MjUyOEMxLjMzODk3OS00LjI4NzkyIDIuMjg3NDIyLTUuMzYzODg1IDIuNjkzODk4LTUuNzMwNTExQzIuODA1NDc5LTUuODM0MTIyIDIuODEzNDUtNS44NDIwOTIgMi44MTM0NS01Ljg4MTk0M1MyLjc4MTU2OS01Ljk3NzU4NCAyLjcwMTg2OC01Ljk3NzU4NEMyLjU3NDM0Ni01Ljk3NzU4NCAyLjE3NTg0MS01LjU3MTEwOCAyLjExMjA4LTUuNDk5Mzc3QzEuMDQ0MDg1LTQuMzgzNTYyIC44MjA5MjItMi45NDg5NDEgLjgyMDkyMi0xLjk5MjUyOEMuODIwOTIyLS4yMDcyMjMgMS41NzAxMTIgMS4yMjczOTcgMi42NTQwNDcgMS45OTI1MjhaJy8+CjxwYXRoIGlkPSdnNC00MScgZD0nTTIuNDYyNzY1LTEuOTkyNTI4QzIuNDYyNzY1LTIuNzQ5Njg5IDIuMzM1MjQzLTMuNjU4MjgxIDEuODQxMDk2LTQuNTk4NzU1QzEuNDUwNTYtNS4zMzIwMDUgLjcyNTI4LTUuOTc3NTg0IC41ODE4MTgtNS45Nzc1ODRDLjUwMjExNy01Ljk3NzU4NCAuNDc4MjA3LTUuOTIxNzkzIC40NzgyMDctNS44ODE5NDNDLjQ3ODIwNy01Ljg1MDA2MiAuNDc4MjA3LTUuODM0MTIyIC41NzM4NDgtNS43Mzg0ODFDMS42ODk2NjQtNC42Nzg0NTYgMS45NDQ3MDctMy4yMTk5MjUgMS45NDQ3MDctMS45OTI1MjhDMS45NDQ3MDcgLjI5NDg5NCAuOTk2MjY0IDEuMzc4ODI5IC41ODk3ODggMS43NDU0NTVDLjQ4NjE3NyAxLjg0OTA2NiAuNDc4MjA3IDEuODU3MDM2IC40NzgyMDcgMS44OTY4ODdTLjUwMjExNyAxLjk5MjUyOCAuNTgxODE4IDEuOTkyNTI4Qy43MDkzNCAxLjk5MjUyOCAxLjEwNzg0NiAxLjU4NjA1MiAxLjE3MTYwNiAxLjUxNDMyMUMyLjIzOTYwMSAuMzk4NTA2IDIuNDYyNzY1LTEuMDM2MTE1IDIuNDYyNzY1LTEuOTkyNTI4WicvPgo8cGF0aCBpZD0nZzQtOTQnIGQ9J00yLjExMjA4LTUuNTMxMjU4TC45ODAzMjQtNC40NjMyNjNMMS4xMzk3MjYtNC4yNzE5OEwyLjExMjA4LTUuMDYxMDIxTDMuMDg0NDMzLTQuMjcxOThMMy4yNDM4MzYtNC40NTUyOTNMMi4xMTIwOC01LjUzMTI1OFonLz4KPHBhdGggaWQ9J2cxLTAnIGQ9J001LjU3MTEwOC0xLjgwOTIxNUM1LjY5ODYzLTEuODA5MjE1IDUuODczOTczLTEuODA5MjE1IDUuODczOTczLTEuOTkyNTI4UzUuNjk4NjMtMi4xNzU4NDEgNS41NzExMDgtMi4xNzU4NDFIMS4wMDQyMzRDLjg3NjcxMi0yLjE3NTg0MSAuNzAxMzctMi4xNzU4NDEgLjcwMTM3LTEuOTkyNTI4Uy44NzY3MTItMS44MDkyMTUgMS4wMDQyMzQtMS44MDkyMTVINS41NzExMDhaJy8+CjxwYXRoIGlkPSdnMS03NycgZD0nTTMuMTg4MDQ1LTQuNDM5MzUyQzMuODY1NTA0LTEuNTYyMTQyIDQuMjI0MTU5LS45NTY0MTMgNC41NDI5NjQtLjQzODM1NkM0LjY0NjU3NS0uMjc4OTU0IDQuNjU0NTQ1LS4yNzA5ODQgNC43MTAzMzYtLjI3MDk4NEM0Ljc1ODE1Ny0uMjcwOTg0IDQuNzc0MDk3LS4yODY5MjQgNC44NDU4MjgtLjM1ODY1NUM1LjcyMjU0LTEuMTM5NzI2IDYuMTY4ODY3LTEuNjMzODczIDguMzkyNTI4LTQuMTEyNTc4QzguMjgwOTQ2LTMuMzcxMzU3IDguMDI1OTAzLTEuNjg5NjY0IDguMDI1OTAzLS44MjA5MjJDOC4wMjU5MDMtLjU4OTc4OCA4LjA0MTg0My0uMzEwODM0IDguMDY1NzUzLS4xMDM2MTFDOC4xMDU2MDQgLjE1MTQzMiA4LjI4ODkxNyAuMjIzMTYzIDguNDY0MjU5IC4yMjMxNjNDOC44MjI5MTQgLjIyMzE2MyA5LjQ0NDU4My0uMTI3NTIyIDkuNDQ0NTgzLS4zMDI4NjRDOS40NDQ1ODMtLjM1ODY1NSA5LjM4MDgyMi0uMzU4NjU1IDkuMzU2OTEyLS4zNTg2NTVDOS4yMTM0NS0uMzU4NjU1IDkuMDkzODk4LS4yNzg5NTQgOS4wMjIxNjctLjIzOTEwM0M4Ljc5OTAwNC0uMjU1MDQ0IDguNzgzMDY0LS4zOTg1MDYgOC43NjcxMjMtLjYwNTcyOUM4LjczNTI0My0uODkyNjUzIDguNzM1MjQzLTEuMDgzOTM1IDguNzM1MjQzLTEuMTcxNjA2QzguNzM1MjQzLTEuOTM2NzM3IDkuMDE0MTk3LTQuMTUyNDI4IDkuMjc3MjEtNS4zNDc5NDVDOS4yODUxODEtNS4zNzk4MjYgOS4yOTMxNTEtNS40NDM1ODcgOS4yOTMxNTEtNS40NzU0NjdTOS4yODUxODEtNS42MDI5ODkgOS4yMjkzOS01LjYwMjk4OUM5LjE4MTU2OS01LjYwMjk4OSA5LjEyNTc3OC01LjUzOTIyOCA5LjAzODEwNy01LjQ0MzU4N0M4LjIyNTE1Ni00LjQ4NzE3MyA3LjM5NjI2NC0zLjUzODczIDYuNTM1NDkyLTIuNjIyMTY3QzUuNTM5MjI4LTEuNTYyMTQyIDUuMjM2MzY0LTEuMjk5MTI4IDQuOTg5MjktMS4wNzU5NjVDNC43MTAzMzYtMS41OTQwMjIgNC41NjY4NzQtMS45OTI1MjggNC4zNTk2NTEtMi42ODU5MjhDNC4wNDA4NDctMy43Mzc5ODMgMy44NDk1NjQtNC41NzQ4NDQgMy42OTAxNjItNS4zNTU5MTVDMy42NTAzMTEtNS41NTUxNjggMy42NTAzMTEtNS41NzExMDggMy42MzQzNzEtNS41ODcwNDlDMy42MTA0NjEtNS42MTA5NTkgMy41NzA2MS01LjYxMDk1OSAzLjU1NDY3LTUuNjEwOTU5QzMuNDU5MDI5LTUuNjEwOTU5IDMuMjkxNjU2LTUuNTM5MjI4IDMuMTY0MTM0LTUuNDQzNTg3QzMuMDM2NjEzLTUuMzM5OTc1IDMuMDI4NjQzLTUuMzAwMTI1IDMuMDEyNzAyLTUuMTMyNzUyQzIuNjc3OTU4LTIuNzAxODY4IDEuNzM3NDg0LS44Njg3NDIgMS42MDk5NjMtLjY2MTUxOUMxLjQ3NDQ3MS0uNDQ2MzI2IDEuMzU0OTE5LS4zNTg2NTUgMS4yMzUzNjctLjM1ODY1NUMuOTk2MjY0LS4zNTg2NTUgLjcxNzMxLS40NjIyNjcgLjU0OTkzOC0uNjM3NjA5Qy40NzAyMzctLjU5Nzc1OCAuNDA2NDc2LS41NzM4NDggLjMyNjc3NS0uMzgyNTY1Qy4yNzA5ODQtLjI3MDk4NCAuMjMxMTMzLS4xNDM0NjIgLjIzMTEzMy0uMDE1OTRDLjIzMTEzMyAuMDc5NzAxIC4yMzExMzMgLjE1MTQzMiAuNTE4MDU3IC4yOTQ4OTRDLjcwOTM0IC4zOTA1MzUgLjk0MDQ3MyAuNDA2NDc2IC45NzIzNTQgLjQwNjQ3NkMxLjUzMDI2MiAuNDA2NDc2IDIuMDQ4MzE5LS45MDA2MjMgMi4yNzE0ODItMS40NTA1NkMyLjY1NDA0Ny0yLjQyMjkxNCAyLjk5Njc2Mi0zLjQxMTIwOCAzLjE4ODA0NS00LjQzOTM1MlonLz4KPHBhdGggaWQ9J2czLTI3JyBkPSdNNC4zNzU1OTItMi45MDkwOTFDNC41MTkwNTQtMi45MDkwOTEgNC41NzQ4NDQtMi45MDkwOTEgNC42NzA0ODYtMi45NzI4NTJDNC43NTgxNTctMy4wNDQ1ODMgNC43OTAwMzctMy4xNTYxNjQgNC43OTAwMzctMy4yMTE5NTVDNC43OTAwMzctMy40MzUxMTggNC41OTA3ODUtMy40MzUxMTggNC40NTUyOTMtMy40MzUxMThIMi40OTQ2NDVDMS4yNjcyNDgtMy40MzUxMTggLjMyNjc3NS0yLjE3NTg0MSAuMzI2Nzc1LTEuMjExNDU3Qy4zMjY3NzUtLjQzMDM4NiAuODg0NjgyIC4wNzk3MDEgMS42MjU5MDMgLjA3OTcwMUMyLjYzMDEzNyAuMDc5NzAxIDMuNzIyMDQyLS44ODQ2ODIgMy43MjIwNDItMi4wNzIyMjlDMy43MjIwNDItMi41MDI2MTUgMy41NzA2MS0yLjc1NzY1OSAzLjQ4MjkzOS0yLjkwOTA5MUg0LjM3NTU5MlpNMS42MzM4NzMtLjE0MzQ2MkMxLjIzNTM2Ny0uMTQzNDYyIC44ODQ2ODItLjQwNjQ3NiAuODg0NjgyLS45ODgyOTRDLjg4NDY4Mi0xLjMyMzAzOSAxLjA4MzkzNS0yLjkwOTA5MSAyLjM2NzEyMy0yLjkwOTA5MUMzLjE0MDIyNC0yLjkwOTA5MSAzLjE0MDIyNC0yLjMxOTMwMyAzLjE0MDIyNC0yLjE1MTkzQzMuMTQwMjI0LTEuMzMxMDA5IDIuNTc0MzQ2LS4xNDM0NjIgMS42MzM4NzMtLjE0MzQ2MlonLz4KPHBhdGggaWQ9J2czLTg0JyBkPSdNMy42MDI0OTEtNC44MjE5MThDMy42NzQyMjItNS4xMDg4NDIgMy42ODIxOTItNS4xMjQ3ODIgNC4wMDg5NjYtNS4xMjQ3ODJINC42MTQ2OTVDNS40NDM1ODctNS4xMjQ3ODIgNS41MzkyMjgtNC44NjE3NjggNS41MzkyMjgtNC40NjMyNjNDNS41MzkyMjgtNC4yNjQwMSA1LjQ5MTQwNy0zLjkyMTI5NSA1LjQ4MzQzNy0zLjg4MTQ0NUM1LjQ2NzQ5Ny0zLjc5Mzc3MyA1LjQ1OTUyNy0zLjcyMjA0MiA1LjQ1OTUyNy0zLjcwNjEwMkM1LjQ1OTUyNy0zLjYwMjQ5MSA1LjUzMTI1OC0zLjU3ODU4IDUuNTc5MDc4LTMuNTc4NThDNS42NjY3NS0zLjU3ODU4IDUuNjk4NjMtMy42MjY0MDEgNS43MjI1NC0zLjc3NzgzM0w1LjkzNzczMy01LjI3NjIxNEM1LjkzNzczMy01LjM4Nzc5NiA1Ljg0MjA5Mi01LjM4Nzc5NiA1LjY5ODYzLTUuMzg3Nzk2SDEuMDA0MjM0Qy44MDQ5ODEtNS4zODc3OTYgLjc4OTA0MS01LjM4Nzc5NiAuNzMzMjUtNS4yMjA0MjNMLjI0NzA3My0zLjg0MTU5NEMuMjMxMTMzLTMuODAxNzQzIC4yMDcyMjMtMy43Mzc5ODMgLjIwNzIyMy0zLjY5MDE2MkMuMjA3MjIzLTMuNjI2NDAxIC4yNjMwMTQtMy41Nzg1OCAuMzI2Nzc1LTMuNTc4NThDLjQxNDQ0Ni0zLjU3ODU4IC40MzAzODYtMy42MTg0MzEgLjQ3ODIwNy0zLjc1MzkyM0MuOTMyNTAzLTUuMDI5MTQxIDEuMTYzNjM2LTUuMTI0NzgyIDIuMzc1MDkzLTUuMTI0NzgySDIuNjg1OTI4QzIuOTI1MDMxLTUuMTI0NzgyIDIuOTMzMDAxLTUuMTE2ODEyIDIuOTMzMDAxLTUuMDUzMDUxQzIuOTMzMDAxLTUuMDI5MTQxIDIuOTAxMTIxLTQuODY5NzM4IDIuODkzMTUxLTQuODM3ODU4TDEuODQxMDk2LS42NTM1NDlDMS43NjkzNjUtLjM1MDY4NSAxLjc0NTQ1NS0uMjYzMDE0IC45MTY1NjMtLjI2MzAxNEMuNjYxNTE5LS4yNjMwMTQgLjU4MTgxOC0uMjYzMDE0IC41ODE4MTgtLjExMTU4MkMuNTgxODE4LS4xMDM2MTEgLjU4MTgxOCAwIC43MTczMSAwQy45MzI1MDMgMCAxLjQ4MjQ0MS0uMDIzOTEgMS42OTc2MzQtLjAyMzkxSDIuMzc1MDkzQzIuNTk4MjU3LS4wMjM5MSAzLjE1NjE2NCAwIDMuMzc5MzI4IDBDMy40NDMwODggMCAzLjU2MjY0IDAgMy41NjI2NC0uMTUxNDMyQzMuNTYyNjQtLjI2MzAxNCAzLjQ3NDk2OS0uMjYzMDE0IDMuMjU5Nzc2LS4yNjMwMTRDMy4wNjg0OTMtLjI2MzAxNCAzLjAwNDczMi0uMjYzMDE0IDIuNzk3NTA5LS4yNzg5NTRDMi41NDI0NjYtLjMwMjg2NCAyLjUxMDU4NS0uMzM0NzQ1IDIuNTEwNTg1LS40MzgzNTZDMi41MTA1ODUtLjQ3MDIzNyAyLjUxODU1NS0uNTAyMTE3IDIuNTQyNDY2LS41ODE4MThMMy42MDI0OTEtNC44MjE5MThaJy8+CjxwYXRoIGlkPSdnMi0xMDYnIGQ9J00xLjkwMDg3Mi04LjUzNTk5QzEuOTAwODcyLTguNzUxMTgzIDEuOTAwODcyLTguOTY2Mzc2IDEuNjYxNzY4LTguOTY2Mzc2UzEuNDIyNjY1LTguNzUxMTgzIDEuNDIyNjY1LTguNTM1OTlWMi41NTg0MDZDMS40MjI2NjUgMi43NzM1OTkgMS40MjI2NjUgMi45ODg3OTIgMS42NjE3NjggMi45ODg3OTJTMS45MDA4NzIgMi43NzM1OTkgMS45MDA4NzIgMi41NTg0MDZWLTguNTM1OTlaJy8+CjwvZGVmcz4KPGcgaWQ9J3BhZ2UxJz4KPHVzZSB4PScxLjE5NTUxNCcgeT0nLTYuNjk0ODY1JyB4bGluazpocmVmPScjZzItMTA2Jy8+Cjx1c2UgeD0nNC41MTY0MDQnIHk9Jy03LjY5MTEyOScgeGxpbms6aHJlZj0nI2czLTg0Jy8+Cjx1c2UgeD0nMTAuNjIyNzYyJyB5PSctNy42OTExMjknIHhsaW5rOmhyZWY9JyNnMS0wJy8+Cjx1c2UgeD0nMjEuMzA3NTMzJyB5PSctOS43MDU3OTEnIHhsaW5rOmhyZWY9JyNnNC05NCcvPgo8dXNlIHg9JzE3LjIwOTI2OScgeT0nLTcuNjkxMTI5JyB4bGluazpocmVmPScjZzEtNzcnLz4KPHVzZSB4PScyNy4yODc2NCcgeT0nLTcuNjkxMTI5JyB4bGluazpocmVmPScjZzQtNDAnLz4KPHVzZSB4PSczMC41ODA4OTQnIHk9Jy03LjY5MTEyOScgeGxpbms6aHJlZj0nI2cwLTEyMCcvPgo8dXNlIHg9JzM1LjczMzg0MicgeT0nLTcuNjkxMTI5JyB4bGluazpocmVmPScjZzQtNDEnLz4KPHVzZSB4PSczOS4wMjcwOTUnIHk9Jy02LjY5NDg2NScgeGxpbms6aHJlZj0nI2cyLTEwNicvPgo8cmVjdCB4PScxLjE5NTUxNCcgeT0nLTMuMjI3ODg2JyBoZWlnaHQ9Jy40NzgxODcnIHdpZHRoPSc0MS4xNTI0NzEnLz4KPHVzZSB4PScxMy43ODQ5NDYnIHk9JzQuMTIyNjMyJyB4bGluazpocmVmPScjZzQtOTQnLz4KPHVzZSB4PScxMy4zMzkzODInIHk9JzQuMTIyNjMyJyB4bGluazpocmVmPScjZzMtMjcnLz4KPHVzZSB4PScxOC40NjQ2NzgnIHk9JzQuMTIyNjMyJyB4bGluazpocmVmPScjZzQtNDAnLz4KPHVzZSB4PScyMS43NTc5MzEnIHk9JzQuMTIyNjMyJyB4bGluazpocmVmPScjZzAtMTIwJy8+Cjx1c2UgeD0nMjYuOTEwODc5JyB5PSc0LjEyMjYzMicgeGxpbms6aHJlZj0nI2c0LTQxJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9OCAtLT4=" alt="\frac{ \left| T - \hat{\mathcal{M}} ( \mathbf{x}) \right|}{\hat{\sigma}(\mathbf{x})}" style="vertical-align: -8px"/>
with <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC40IC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzIzLjI4NTQzN3B0JyBoZWlnaHQ9JzExLjk1NTE2OHB0JyB2aWV3Qm94PScwIC04Ljk2NjM3NiAyMy4yODU0MzcgMTEuOTU1MTY4Jz4KPGRlZnM+CjxwYXRoIGlkPSdnMC0xMjAnIGQ9J000LjAyODg5Mi0yLjk1MjkyN0w1LjQxNTY5MS00LjU0Mjk2NEM1LjU0NzE5OC00LjY5ODM4MSA1LjY1NDc5NS00Ljc5NDAyMiA2LjY0NzA3My00Ljc5NDAyMlYtNS4zMDgwOTVDNS45Nzc1ODQtNS4yODQxODQgNS45NTM2NzQtNS4yODQxODQgNS41NDcxOTgtNS4yODQxODRDNS4yMDA0OTgtNS4yODQxODQgNC42ODY0MjYtNS4yODQxODQgNC4zNTE2ODEtNS4zMDgwOTVWLTQuNzk0MDIyQzQuNTc4ODI5LTQuNzk0MDIyIDQuODI5ODg4LTQuNzM0MjQ3IDQuODI5ODg4LTQuNjUwNTZDNC44Mjk4ODgtNC42MjY2NSA0Ljc3MDExMi00LjU0Mjk2NCA0Ljc0NjIwMi00LjUxOTA1NEwzLjcwNjEwMi0zLjM0NzQ0N0wyLjUyMjU0LTQuNzk0MDIySDMuMDI0NjU4Vi01LjMwODA5NUMyLjc0OTY4OS01LjI4NDE4NCAxLjkzNjczNy01LjI4NDE4NCAxLjYxMzk0OC01LjI4NDE4NEMxLjI1NTI5My01LjI4NDE4NCAuNjA5NzE0LTUuMjg0MTg0IC4yNzQ5NjktNS4zMDgwOTVWLTQuNzk0MDIySDEuMTIzNzg2TDIuOTg4NzkyLTIuNTIyNTRMMS40MzQ2Mi0uNzY1MTMxQzEuMjkxMTU4LS41OTc3NTggMS4yMDc0NzItLjUxNDA3MiAuMjE1MTkzLS41MTQwNzJWMEMuOTMyNTAzLS4wMjM5MSAuOTU2NDEzLS4wMjM5MSAxLjMyNzAyNC0uMDIzOTFDMS42NzM3MjQtLjAyMzkxIDIuMTc1ODQxLS4wMjM5MSAyLjUxMDU4NSAwVi0uNTE0MDcyQzIuMjgzNDM3LS41MTQwNzIgMi4wMzIzNzktLjU3Mzg0OCAyLjAzMjM3OS0uNjU3NTM0QzIuMDMyMzc5LS42Njk0ODkgMi4wMzIzNzktLjY4MTQ0NSAyLjExNjA2NS0uNzc3MDg2TDMuMzExNTgyLTIuMTI4MDJMNC42Mzg2MDUtLjUxNDA3Mkg0LjEzNjQ4OFYwQzQuNDIzNDEyLS4wMjM5MSA1LjIyNDQwOC0uMDIzOTEgNS41NTkxNTMtLjAyMzkxQzUuOTE3ODA4LS4wMjM5MSA2LjU1MTQzMi0uMDIzOTEgNi44ODYxNzcgMFYtLjUxNDA3Mkg2LjA0OTMxNUw0LjAyODg5Mi0yLjk1MjkyN1onLz4KPHBhdGggaWQ9J2cxLTI3JyBkPSdNNi4wNzMyMjUtNC41MDcwOThDNi4yMjg2NDMtNC41MDcwOTggNi42MjMxNjMtNC41MDcwOTggNi42MjMxNjMtNC44ODk2NjRDNi42MjMxNjMtNS4xNTI2NzcgNi4zOTYwMTUtNS4xNTI2NzcgNi4xODA4MjItNS4xNTI2NzdIMy41Mzg3M0MxLjc0NTQ1NS01LjE1MjY3NyAuNDU0Mjk2LTMuMTU2MTY0IC40NTQyOTYtMS43NDU0NTVDLjQ1NDI5Ni0uNzI5MjY1IDEuMTExODMxIC4xMTk1NTIgMi4xODc3OTYgLjExOTU1MkMzLjU5ODUwNiAuMTE5NTUyIDUuMTQwNzIyLTEuMzk4NzU1IDUuMTQwNzIyLTMuMTkyMDNDNS4xNDA3MjItMy42NTgyODEgNS4wMzMxMjYtNC4xMTI1NzggNC43NDYyMDItNC41MDcwOThINi4wNzMyMjVaTTIuMTk5NzUxLS4xMTk1NTJDMS41OTAwMzctLjExOTU1MiAxLjE0NzY5Ni0uNTg1ODAzIDEuMTQ3Njk2LTEuNDEwNzFDMS4xNDc2OTYtMi4xMjgwMiAxLjU3ODA4Mi00LjUwNzA5OCAzLjMzNTQ5Mi00LjUwNzA5OEMzLjg0OTU2NC00LjUwNzA5OCA0LjQyMzQxMi00LjI1NjA0IDQuNDIzNDEyLTMuMzM1NDkyQzQuNDIzNDEyLTIuOTE3MDYxIDQuMjMyMTMtMS45MTI4MjcgMy44MTM2OTktMS4yMTk0MjdDMy4zODMzMTMtLjUxNDA3MiAyLjczNzczMy0uMTE5NTUyIDIuMTk5NzUxLS4xMTk1NTJaJy8+CjxwYXRoIGlkPSdnMi00MCcgZD0nTTMuODg1NDMgMi45MDUxMDZDMy44ODU0MyAyLjg2OTI0IDMuODg1NDMgMi44NDUzMyAzLjY4MjE5MiAyLjY0MjA5MkMyLjQ4NjY3NSAxLjQzNDYyIDEuODE3MTg2LS41Mzc5ODMgMS44MTcxODYtMi45NzY4MzdDMS44MTcxODYtNS4yOTYxMzkgMi4zNzkwNzgtNy4yOTI2NTMgMy43NjU4NzgtOC43MDMzNjJDMy44ODU0My04LjgxMDk1OSAzLjg4NTQzLTguODM0ODY5IDMuODg1NDMtOC44NzA3MzVDMy44ODU0My04Ljk0MjQ2NiAzLjgyNTY1NC04Ljk2NjM3NiAzLjc3NzgzMy04Ljk2NjM3NkMzLjYyMjQxNi04Ljk2NjM3NiAyLjY0MjA5Mi04LjEwNTYwNCAyLjA1NjI4OS02LjkzMzk5OEMxLjQ0NjU3NS01LjcyNjUyNiAxLjE3MTYwNi00LjQ0NzMyMyAxLjE3MTYwNi0yLjk3NjgzN0MxLjE3MTYwNi0xLjkxMjgyNyAxLjMzODk3OS0uNDkwMTYyIDEuOTYwNjQ4IC43ODkwNDFDMi42NjYwMDIgMi4yMjM2NjEgMy42NDYzMjYgMy4wMDA3NDcgMy43Nzc4MzMgMy4wMDA3NDdDMy44MjU2NTQgMy4wMDA3NDcgMy44ODU0MyAyLjk3NjgzNyAzLjg4NTQzIDIuOTA1MTA2WicvPgo8cGF0aCBpZD0nZzItNDEnIGQ9J00zLjM3MTM1Ny0yLjk3NjgzN0MzLjM3MTM1Ny0zLjg4NTQzIDMuMjUxODA2LTUuMzY3ODcgMi41ODIzMTYtNi43NTQ2N0MxLjg3Njk2MS04LjE4OTI5IC44OTY2MzgtOC45NjYzNzYgLjc2NTEzMS04Ljk2NjM3NkMuNzE3MzEtOC45NjYzNzYgLjY1NzUzNC04Ljk0MjQ2NiAuNjU3NTM0LTguODcwNzM1Qy42NTc1MzQtOC44MzQ4NjkgLjY1NzUzNC04LjgxMDk1OSAuODYwNzcyLTguNjA3NzIxQzIuMDU2Mjg5LTcuNDAwMjQ5IDIuNzI1Nzc4LTUuNDI3NjQ2IDIuNzI1Nzc4LTIuOTg4NzkyQzIuNzI1Nzc4LS42Njk0ODkgMi4xNjM4ODUgMS4zMjcwMjQgLjc3NzA4NiAyLjczNzczM0MuNjU3NTM0IDIuODQ1MzMgLjY1NzUzNCAyLjg2OTI0IC42NTc1MzQgMi45MDUxMDZDLjY1NzUzNCAyLjk3NjgzNyAuNzE3MzEgMy4wMDA3NDcgLjc2NTEzMSAzLjAwMDc0N0MuOTIwNTQ4IDMuMDAwNzQ3IDEuOTAwODcyIDIuMTM5OTc1IDIuNDg2Njc1IC45NjgzNjlDMy4wOTYzODktLjI1MTA1OSAzLjM3MTM1Ny0xLjU0MjIxNyAzLjM3MTM1Ny0yLjk3NjgzN1onLz4KPHBhdGggaWQ9J2cyLTk0JyBkPSdNMi45MjkwMTYtOC4yOTY4ODdMMS4zNjI4ODktNi42NzA5ODRMMS41NTQxNzItNi40OTE2NTZMMi45MTcwNjEtNy43MjMwMzlMNC4yOTE5MDUtNi40OTE2NTZMNC40ODMxODgtNi42NzA5ODRMMi45MjkwMTYtOC4yOTY4ODdaJy8+CjwvZGVmcz4KPGcgaWQ9J3BhZ2UxJz4KPHVzZSB4PScuNjE0NzE0JyB5PScwJyB4bGluazpocmVmPScjZzItOTQnLz4KPHVzZSB4PScwJyB5PScwJyB4bGluazpocmVmPScjZzEtMjcnLz4KPHVzZSB4PSc3LjA4MjQwNCcgeT0nMCcgeGxpbms6aHJlZj0nI2cyLTQwJy8+Cjx1c2UgeD0nMTEuNjM0NzMnIHk9JzAnIHhsaW5rOmhyZWY9JyNnMC0xMjAnLz4KPHVzZSB4PScxOC43MzMxMTEnIHk9JzAnIHhsaW5rOmhyZWY9JyNnMi00MScvPgo8L2c+Cjwvc3ZnPgo8IS0tIERFUFRIPTQgLS0+" alt="\hat{\sigma}(\mathbf{x})" style="vertical-align: -4px"/> the square root of the marginal covariance of the Gaussian Process evaluated on <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC40IC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzcuMDk4MzgxcHQnIGhlaWdodD0nNS4zMTMzOTlwdCcgdmlld0JveD0nMCAtNS4zMTMzOTkgNy4wOTgzODEgNS4zMTMzOTknPgo8ZGVmcz4KPHBhdGggaWQ9J2cwLTEyMCcgZD0nTTQuMDI4ODkyLTIuOTUyOTI3TDUuNDE1NjkxLTQuNTQyOTY0QzUuNTQ3MTk4LTQuNjk4MzgxIDUuNjU0Nzk1LTQuNzk0MDIyIDYuNjQ3MDczLTQuNzk0MDIyVi01LjMwODA5NUM1Ljk3NzU4NC01LjI4NDE4NCA1Ljk1MzY3NC01LjI4NDE4NCA1LjU0NzE5OC01LjI4NDE4NEM1LjIwMDQ5OC01LjI4NDE4NCA0LjY4NjQyNi01LjI4NDE4NCA0LjM1MTY4MS01LjMwODA5NVYtNC43OTQwMjJDNC41Nzg4MjktNC43OTQwMjIgNC44Mjk4ODgtNC43MzQyNDcgNC44Mjk4ODgtNC42NTA1NkM0LjgyOTg4OC00LjYyNjY1IDQuNzcwMTEyLTQuNTQyOTY0IDQuNzQ2MjAyLTQuNTE5MDU0TDMuNzA2MTAyLTMuMzQ3NDQ3TDIuNTIyNTQtNC43OTQwMjJIMy4wMjQ2NThWLTUuMzA4MDk1QzIuNzQ5Njg5LTUuMjg0MTg0IDEuOTM2NzM3LTUuMjg0MTg0IDEuNjEzOTQ4LTUuMjg0MTg0QzEuMjU1MjkzLTUuMjg0MTg0IC42MDk3MTQtNS4yODQxODQgLjI3NDk2OS01LjMwODA5NVYtNC43OTQwMjJIMS4xMjM3ODZMMi45ODg3OTItMi41MjI1NEwxLjQzNDYyLS43NjUxMzFDMS4yOTExNTgtLjU5Nzc1OCAxLjIwNzQ3Mi0uNTE0MDcyIC4yMTUxOTMtLjUxNDA3MlYwQy45MzI1MDMtLjAyMzkxIC45NTY0MTMtLjAyMzkxIDEuMzI3MDI0LS4wMjM5MUMxLjY3MzcyNC0uMDIzOTEgMi4xNzU4NDEtLjAyMzkxIDIuNTEwNTg1IDBWLS41MTQwNzJDMi4yODM0MzctLjUxNDA3MiAyLjAzMjM3OS0uNTczODQ4IDIuMDMyMzc5LS42NTc1MzRDMi4wMzIzNzktLjY2OTQ4OSAyLjAzMjM3OS0uNjgxNDQ1IDIuMTE2MDY1LS43NzcwODZMMy4zMTE1ODItMi4xMjgwMkw0LjYzODYwNS0uNTE0MDcySDQuMTM2NDg4VjBDNC40MjM0MTItLjAyMzkxIDUuMjI0NDA4LS4wMjM5MSA1LjU1OTE1My0uMDIzOTFDNS45MTc4MDgtLjAyMzkxIDYuNTUxNDMyLS4wMjM5MSA2Ljg4NjE3NyAwVi0uNTE0MDcySDYuMDQ5MzE1TDQuMDI4ODkyLTIuOTUyOTI3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTEyMCcvPgo8L2c+Cjwvc3ZnPgo8IS0tIERFUFRIPTAgLS0+" alt="\mathbf{x}" style="vertical-align: 0px"/>, and <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC40IC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzguNDg2ODM2cHQnIGhlaWdodD0nOC4xNjkzNjZwdCcgdmlld0JveD0nMCAtOC4xNjkzNjYgOC40ODY4MzYgOC4xNjkzNjYnPgo8ZGVmcz4KPHBhdGggaWQ9J2cwLTg0JyBkPSdNNC45ODUzMDUtNy4yOTI2NTNDNS4wNTcwMzYtNy41Nzk1NzcgNS4wODA5NDYtNy42ODcxNzMgNS4yNjAyNzQtNy43MzQ5OTRDNS4zNTU5MTUtNy43NTg5MDQgNS43NTA0MzYtNy43NTg5MDQgNi4wMDE0OTQtNy43NTg5MDRDNy4xOTcwMTEtNy43NTg5MDQgNy43NTg5MDQtNy43MTEwODMgNy43NTg5MDQtNi43Nzg1OEM3Ljc1ODkwNC02LjU5OTI1MyA3LjcxMTA4My02LjE0NDk1NiA3LjYzOTM1Mi01LjcwMjYxNUw3LjYyNzM5Ny01LjU1OTE1M0M3LjYyNzM5Ny01LjUxMTMzMyA3LjY3NTIxOC01LjQzOTYwMSA3Ljc0Njk0OS01LjQzOTYwMUM3Ljg2NjUwMS01LjQzOTYwMSA3Ljg2NjUwMS01LjQ5OTM3NyA3LjkwMjM2Ni01LjY5MDY2TDguMjQ5MDY2LTcuODA2NzI1QzguMjcyOTc2LTcuOTE0MzIxIDguMjcyOTc2LTcuOTM4MjMyIDguMjcyOTc2LTcuOTc0MDk3QzguMjcyOTc2LTguMTA1NjA0IDguMjAxMjQ1LTguMTA1NjA0IDcuOTYyMTQyLTguMTA1NjA0SDEuNDIyNjY1QzEuMTQ3Njk2LTguMTA1NjA0IDEuMTM1NzQxLTguMDkzNjQ5IDEuMDY0MDEtNy44Nzg0NTZMLjMzNDc0NS01LjcyNjUyNkMuMzIyNzktNS43MDI2MTUgLjI4NjkyNC01LjU3MTEwOCAuMjg2OTI0LTUuNTU5MTUzQy4yODY5MjQtNS40OTkzNzcgLjMzNDc0NS01LjQzOTYwMSAuNDA2NDc2LTUuNDM5NjAxQy41MDIxMTctNS40Mzk2MDEgLjUyNjAyNy01LjQ4NzQyMiAuNTczODQ4LTUuNjQyODM5QzEuMDc1OTY1LTcuMDg5NDE1IDEuMzI3MDI0LTcuNzU4OTA0IDIuOTE3MDYxLTcuNzU4OTA0SDMuNzE4MDU3QzQuMDA0OTgxLTcuNzU4OTA0IDQuMTI0NTMzLTcuNzU4OTA0IDQuMTI0NTMzLTcuNjI3Mzk3QzQuMTI0NTMzLTcuNTkxNTMyIDQuMTI0NTMzLTcuNTY3NjIxIDQuMDY0NzU3LTcuMzUyNDI4TDIuNDYyNzY1LS45MzI1MDNDMi4zNDMyMTMtLjQ2NjI1MiAyLjMxOTMwMy0uMzQ2NyAxLjA1MjA1NS0uMzQ2N0MuNzUzMTc2LS4zNDY3IC42Njk0ODktLjM0NjcgLjY2OTQ4OS0uMTE5NTUyQy42Njk0ODkgMCAuODAwOTk2IDAgLjg2MDc3MiAwQzEuMTU5NjUxIDAgMS40NzA0ODYtLjAyMzkxIDEuNzY5MzY1LS4wMjM5MUgzLjYzNDM3MUMzLjkzMzI1LS4wMjM5MSA0LjI1NjA0IDAgNC41NTQ5MTkgMEM0LjY4NjQyNiAwIDQuODA1OTc4IDAgNC44MDU5NzgtLjIyNzE0OEM0LjgwNTk3OC0uMzQ2NyA0LjcyMjI5MS0uMzQ2NyA0LjQxMTQ1Ny0uMzQ2N0MzLjMzNTQ5Mi0uMzQ2NyAzLjMzNTQ5Mi0uNDU0Mjk2IDMuMzM1NDkyLS42MzM2MjRDMy4zMzU0OTItLjY0NTU3OSAzLjMzNTQ5Mi0uNzI5MjY1IDMuMzgzMzEzLS45MjA1NDhMNC45ODUzMDUtNy4yOTI2NTNaJy8+CjwvZGVmcz4KPGcgaWQ9J3BhZ2UxJz4KPHVzZSB4PScwJyB5PScwJyB4bGluazpocmVmPScjZzAtODQnLz4KPC9nPgo8L3N2Zz4KPCEtLSBERVBUSD0wIC0tPg==" alt="T" style="vertical-align: 0px"/> the event threshold (here 1.5)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">getNewPoint</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gprResult</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a new point to be added to the design of experiments.</span>
<span class="sd">    This point maximizes the U criterion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gpcc</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">GaussianProcessConditionalCovariance</span><span class="p">(</span><span class="n">gprResult</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">gprResult</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">conditionalVariance</span> <span class="o">=</span> <span class="n">gpcc</span><span class="o">.</span><span class="n">getConditionalMarginalVariance</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
        <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([</span><span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="n">event</span><span class="o">.</span><span class="n">getThreshold</span><span class="p">()])]</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span> <span class="o">-</span> <span class="n">response</span>
    <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">conditionalVariance</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">)</span>

    <span class="n">iMaxU</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">criterion</span><span class="p">))</span>
    <span class="n">xNew</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iMaxU</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">xNew</span>
</pre></div>
</div>
<p>We first call <cite>getNewPoint</cite> to get a point to add to the design of experiments.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">xNew</span> <span class="o">=</span> <span class="n">getNewPoint</span><span class="p">(</span><span class="n">sampleX</span><span class="p">,</span> <span class="n">gprResult</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">getThreshold</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xNew</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.821871]
</pre></div>
</div>
<p>Then we evaluate the function on the new point and add it to the training design of experiments.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">yNew</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">xNew</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">xNew</span><span class="p">)</span>
<span class="n">Y</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">yNew</span><span class="p">)</span>
</pre></div>
</div>
<p>We now plot the updated Gaussian Process Regressor.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gprResult</span> <span class="o">=</span> <span class="n">createMyBasicGPR</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">plotMyBasicGPR</span><span class="p">(</span><span class="n">gprResult</span><span class="p">,</span> <span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">sampleX</span><span class="p">,</span> <span class="n">probability</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_gpr_active_learning_003.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_003.png" alt="Estimated probability = 0.000000, Reference probability =  0.016760" class = "sphx-glr-single-img"/><p>The algorithm added in the domain.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">GPRStep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">xNew</span> <span class="o">=</span> <span class="n">getNewPoint</span><span class="p">(</span><span class="n">sampleX</span><span class="p">,</span> <span class="n">gprResult</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
    <span class="n">yNew</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">xNew</span><span class="p">)</span>
    <span class="n">X</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">xNew</span><span class="p">)</span>
    <span class="n">Y</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">yNew</span><span class="p">)</span>
    <span class="n">gprResult</span> <span class="o">=</span> <span class="n">createMyBasicGPR</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">plotMyBasicGPR</span><span class="p">(</span><span class="n">gprResult</span><span class="p">,</span> <span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">sampleX</span><span class="p">,</span> <span class="n">probability</span><span class="p">)</span>
    <span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_004.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_004.png" alt="Estimated probability = 0.000339, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_005.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_005.png" alt="Estimated probability = 0.000339, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_006.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_006.png" alt="Estimated probability = 0.000339, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_007.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_007.png" alt="Estimated probability = 0.000339, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_008.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_008.png" alt="Estimated probability = 0.000339, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_009.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_009.png" alt="Estimated probability = 0.005248, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_010.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_010.png" alt="Estimated probability = 0.012020, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_011.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_011.png" alt="Estimated probability = 0.016083, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_012.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_012.png" alt="Estimated probability = 0.016760, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_gpr_active_learning_013.png" srcset="../../_images/sphx_glr_plot_gpr_active_learning_013.png" alt="Estimated probability = 0.016760, Reference probability =  0.016760" class = "sphx-glr-multi-img"/></li>
</ul>
<p>We can see that the metamodel only needs to be accurate near the event threshold to retrieve a precise estimation probability of failure.
With only 10 points evaluated on the real limit state function, the metamodel accuracy is sufficient to estimate the failure probability.
Indeed, the estimated probability is very close to the reference probability.
This kind of active learning strategies allows one to save a large number of simulations.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>The current example presents the naive implementation on the creation of a sequential design of experiments (active learning) based on GPR for failure probability estimation.
See <a class="reference external" href="https://github.com/openturns/openturns/wiki/Modules">Modules</a> for module <cite>ot-ak</cite> that implements active learning algorithms for reliability.
More practical algorithms are presented in the following references.</p>
<ul class="simple">
<li><p>Echard, B., Gayton, N., &amp; Lemaire, M. (2011). AK-MCS: an active learning reliability method combining Kriging and Monte Carlo simulation. Structural Safety, 33(2), 145-154.</p></li>
<li><p>Echard, B. (2012). Assessment by kriging of the reliability of structures subjected to fatigue stress, Université Blaise Pascal, PhD thesis</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-meta-modeling-kriging-metamodel-plot-gpr-active-learning-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9d37b75a6cebdb49c10dd2d1900f6413/plot_gpr_active_learning.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_gpr_active_learning.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c461908d8357aa59c088a50bdc6ea2b6/plot_gpr_active_learning.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_gpr_active_learning.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b1a2044fd4dee9f29723d897f5d1fe97/plot_gpr_active_learning.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_gpr_active_learning.zip</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_kriging_chose_trend.html" title="Kriging: choose a polynomial trend"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_kriging_hyperparameters_optimization.html" title="Kriging: configure the optimization solver"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.25dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Gaussian Process Regression metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Gaussian Process-based active learning for reliability</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>