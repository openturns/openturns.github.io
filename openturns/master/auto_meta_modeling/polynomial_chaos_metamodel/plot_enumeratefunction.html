
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Plot enumeration rules &#8212; OpenTURNS 1.21dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chaos cross-validation" href="plot_chaos_cv.html" />
    <link rel="prev" title="Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos" href="plot_chaos_ishigami.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_chaos_cv.html" title="Chaos cross-validation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_chaos_ishigami.html" title="Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Polynomial chaos metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Plot enumeration rules</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_chaos_ishigami.html"
                          title="previous chapter">Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_chaos_cv.html"
                          title="next chapter">Chaos cross-validation</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_meta_modeling/polynomial_chaos_metamodel/plot_enumeratefunction.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-meta-modeling-polynomial-chaos-metamodel-plot-enumeratefunction-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="plot-enumeration-rules">
<span id="sphx-glr-auto-meta-modeling-polynomial-chaos-metamodel-plot-enumeratefunction-py"></span><h1>Plot enumeration rules<a class="headerlink" href="#plot-enumeration-rules" title="Permalink to this heading">¶</a></h1>
<p>In order to build up a functional chaos multivariate basis <img class="math" src="_images/math/131037f38fcb938d70d6db893608d67768dfb3bc.svg" alt="\{\psi_{\idx},\idx \in \NM\}"/>
by tensorization of univariate basis terms, we need to enumerate the multi-indices <img class="math" src="_images/math/413f99b81edd8ca0b40b6ec6cabf6f45f22cae3e.svg" alt="\vect{\alpha} \in \mathbb{N}^{n_X}"/>.
In this example we are going to explore properties of these enumeration rules.
Refer also to <a class="reference internal" href="../../theory/meta_modeling/enumeration_strategy.html#enumeration-strategy"><span class="std std-ref">Chaos basis enumeration strategies</span></a> in the theoric documentation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
</pre></div>
</div>
<p>The simplest way to generate the multi-indices is to enumerate the terms of increasing length.
In other words, we enumerate the multi-indices with length equal to 0, then 1, 2, 3, etc.
This is called “graded reverse-lexicographic ordering” in <a class="reference internal" href="../../bibliography.html#sullivan2015" id="id1"><span>[sullivan2015]</span></a>.
This is named the linear enumeration rule in the library; let us instanciate it in the 2-dimensional case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">enum_func</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearEnumerateFunction</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</pre></div>
</div>
<p>Print the 25 first multi-indices and their associated length.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">td_prev</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#  | multi-index | length&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---+-------------+-------------&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">multi_index</span> <span class="o">=</span> <span class="n">enum_func</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">td</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">multi_index</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">td</span> <span class="o">&gt;</span> <span class="n">td_prev</span><span class="p">:</span>
        <span class="n">td_prev</span> <span class="o">=</span> <span class="n">td</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---+-------------+-------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2</span><span class="si">}</span><span class="s2"> |       </span><span class="si">{</span><span class="n">multi_index</span><span class="si">}</span><span class="s2"> |           </span><span class="si">{</span><span class="n">td</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>#  | multi-index | length
---+-------------+-------------
 0 |       [0,0] |           0
---+-------------+-------------
 1 |       [1,0] |           1
 2 |       [0,1] |           1
---+-------------+-------------
 3 |       [2,0] |           2
 4 |       [1,1] |           2
 5 |       [0,2] |           2
---+-------------+-------------
 6 |       [3,0] |           3
 7 |       [2,1] |           3
 8 |       [1,2] |           3
 9 |       [0,3] |           3
---+-------------+-------------
10 |       [4,0] |           4
11 |       [3,1] |           4
12 |       [2,2] |           4
13 |       [1,3] |           4
14 |       [0,4] |           4
---+-------------+-------------
15 |       [5,0] |           5
16 |       [4,1] |           5
17 |       [3,2] |           5
18 |       [2,3] |           5
19 |       [1,4] |           5
20 |       [0,5] |           5
---+-------------+-------------
21 |       [6,0] |           6
22 |       [5,1] |           6
23 |       [4,2] |           6
24 |       [3,3] |           6
</pre></div>
</div>
<p>Plot the multi-indices of the enumeration rule by stratas.
In the specific case of the linear enumerate function, each strata contains
multi-indices of identical length that is also the index of the strata.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_stratas</span><span class="p">(</span><span class="n">enum_func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot enumeration rule by stratas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    enum_func : openturns.EnumerateFunction</span>
<span class="sd">        Enumerate function</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph : openturns.Graph</span>
<span class="sd">        Plot of the multi-indices colored by stratas</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">maximum_strata_index</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha_1$&quot;</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha_2$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">enum_func</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;LinearEnumerateFunction&quot;</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Linear enumeration rule&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">enum_func</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;HyperbolicAnisotropicEnumerateFunction&quot;</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;q=</span><span class="si">{</span><span class="n">enum_func</span><span class="o">.</span><span class="n">getQ</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">strata_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maximum_strata_index</span><span class="p">):</span>
        <span class="n">strata_cardinal</span> <span class="o">=</span> <span class="n">enum_func</span><span class="o">.</span><span class="n">getStrataCardinal</span><span class="p">(</span><span class="n">strata_index</span><span class="p">)</span>
        <span class="n">sample_in_layer</span> <span class="o">=</span> <span class="p">[</span><span class="n">enum_func</span><span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">strata_cardinal</span><span class="p">)]</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="n">strata_cardinal</span>
        <span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">sample_in_layer</span><span class="p">)</span>
        <span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">strata_index</span><span class="p">))</span>
        <span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
    <span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">DrawableImplementation</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="n">maximum_strata_index</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setIntegerXTick</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setIntegerYTick</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>


<span class="n">graph</span> <span class="o">=</span> <span class="n">draw_stratas</span><span class="p">(</span><span class="n">enum_func</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">axes_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;aspect&quot;</span><span class="p">:</span> <span class="s2">&quot;equal&quot;</span><span class="p">})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_enumeratefunction_001.png" srcset="../../_images/sphx_glr_plot_enumeratefunction_001.png" alt="Linear enumeration rule" class = "sphx-glr-single-img"/><p>When the number of input dimensions of a polynomial chaos expansion (PCE) increases,
each multi-index correspond to a coefficient in the expansion.
Hence, the number of multi-indices represents the number of coefficients in the PCE.
Plot the number of terms in the basis depending on the maximum total degree
for several dimension values.
We observe the exponential increase of the number of terms with the dimension
<img class="math" src="_images/math/5da6e6d65e4ae3032c58fe8c94955247fc4ebe22.svg" alt="d"/> (curse of dimensionality).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="s2">&quot;Full tensorized basis&quot;</span><span class="p">,</span> <span class="s2">&quot;Total degree&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of coefficients&quot;</span><span class="p">,</span> <span class="kc">True</span>
<span class="p">)</span>
<span class="n">degree_maximum</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">list_of_polynomial_degrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">point_styles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bullet&quot;</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="s2">&quot;fdiamond&quot;</span><span class="p">,</span> <span class="s2">&quot;fsquare&quot;</span><span class="p">,</span> <span class="s2">&quot;triangleup&quot;</span><span class="p">]</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">DrawableImplementation</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_polynomial_degrees</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_polynomial_degrees</span><span class="p">)):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">list_of_polynomial_degrees</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">number_of_coeff_array</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">degree_maximum</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">degree_maximum</span><span class="p">):</span>
        <span class="n">number_of_coeff_array</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
        <span class="n">number_of_coeff_array</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">number_of_coeff_array</span><span class="p">)</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="n">point_styles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$d=</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">palette</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setIntegerXTick</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLogScale</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">GraphImplementation</span><span class="o">.</span><span class="n">LOGY</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_enumeratefunction_002.png" srcset="../../_images/sphx_glr_plot_enumeratefunction_002.png" alt="Full tensorized basis" class = "sphx-glr-single-img"/><p>Plot the hyperbolic quasi norm for different values of q.
With q=1 stratas are hyperplanes, and in case of isotropy
it is equivalent to the linear enumeration rule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_qnorm</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">qnorm</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">+=</span> <span class="n">xi</span><span class="o">**</span><span class="n">q</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">norm</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">norm</span><span class="p">]</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">qnorm</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">setInputDescription</span><span class="p">([</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">])</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;q = </span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>


<span class="n">dln</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">GetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Contour-DefaultLevelsNumber&quot;</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Contour-DefaultLevelsNumber&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">draw_qnorm</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">draw_qnorm</span><span class="p">(</span><span class="mf">0.75</span><span class="p">))</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">draw_qnorm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">draw_qnorm</span><span class="p">(</span><span class="mf">0.25</span><span class="p">))</span>
<span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Contour-DefaultLevelsNumber&quot;</span><span class="p">,</span> <span class="n">dln</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Hyperbolic quasi norm&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">axes_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;aspect&quot;</span><span class="p">:</span> <span class="s2">&quot;equal&quot;</span><span class="p">})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_enumeratefunction_003.png" srcset="../../_images/sphx_glr_plot_enumeratefunction_003.png" alt="Hyperbolic quasi norm, q = 1.0, q = 0.75, q = 0.5, q = 0.25" class = "sphx-glr-single-img"/><p>Plot the multi-indices of the linear enumeration rule by stratas.
The lower the value of q the lower the number of interactions terms in stratas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">draw_stratas</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">HyperbolicAnisotropicEnumerateFunction</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">draw_stratas</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">HyperbolicAnisotropicEnumerateFunction</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)))</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">draw_stratas</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">HyperbolicAnisotropicEnumerateFunction</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)))</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">draw_stratas</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">HyperbolicAnisotropicEnumerateFunction</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)))</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Hyperbolic rule&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">axes_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;aspect&quot;</span><span class="p">:</span> <span class="s2">&quot;equal&quot;</span><span class="p">})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_enumeratefunction_004.png" srcset="../../_images/sphx_glr_plot_enumeratefunction_004.png" alt="Hyperbolic rule, q=1.0, q=0.75, q=0.5, q=0.25" class = "sphx-glr-single-img"/><p>Interaction multi-indices are presented in the center of the <img class="math" src="_images/math/917aa229503aba26d8480cbb8e407e8566e89f8a.svg" alt="(\alpha_1, \alpha_2)"/> space.
We see that when the quasi-norm parameter is close to zero, the enumeration rule
shows less interaction multi-indices.
Instead, multi-indices close to the X and Y axes represent multivariate polynomials
with high marginal degrees.
When q is close to zero, these polynomials with high marginal degrees appear
sooner with the hyperbolic enumeration rule.</p>
<p>Plot the number of terms in the basis depending on the maximum total degree
in dimension d=5 for several q-norm values.
We observe that the gap between high and low values of q can lead to a gap
in the numbers of terms of an order of magnitude.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="s2">&quot;Full tensorized basis. d = </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dim</span><span class="p">),</span>
    <span class="s2">&quot;Total degree&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Number of coefficients&quot;</span><span class="p">,</span>
    <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">degree_maximum</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">q_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">point_styles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bullet&quot;</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="s2">&quot;fdiamond&quot;</span><span class="p">,</span> <span class="s2">&quot;fsquare&quot;</span><span class="p">,</span> <span class="s2">&quot;triangleup&quot;</span><span class="p">]</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">DrawableImplementation</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_polynomial_degrees</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q_list</span><span class="p">)):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">enum_func</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HyperbolicAnisotropicEnumerateFunction</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">number_of_coeff_array</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">degree_maximum</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">degree_maximum</span><span class="p">):</span>
        <span class="n">number_of_coeff_array</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
        <span class="n">number_of_coeff_array</span><span class="p">[</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">enum_func</span><span class="o">.</span><span class="n">getMaximumDegreeCardinal</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">number_of_coeff_array</span><span class="p">)</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="n">point_styles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$q=</span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">palette</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setIntegerXTick</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLogScale</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">GraphImplementation</span><span class="o">.</span><span class="n">LOGY</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)})</span>


<span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_enumeratefunction_005.png" srcset="../../_images/sphx_glr_plot_enumeratefunction_005.png" alt="Full tensorized basis. d = 5" class = "sphx-glr-single-img"/><p>When the quasi-norm parameter is close to 1, then the hyperbolic rule is equal to the
linear enumeration rule and the number of coefficients is larger.</p>
<p>In practice, we often test several values of the parameter q, in the [0.5, 0.9] range,
for example <img class="math" src="_images/math/06a4288a5e9c88cee2f3bf97ef57859f858b81ff.svg" alt="q \in \{0.5, 0.6, 0.7, 0.8, 0.9\}"/>.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.097 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-meta-modeling-polynomial-chaos-metamodel-plot-enumeratefunction-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6e1a73329dfc3feeaff9a25d1e1e1780/plot_enumeratefunction.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_enumeratefunction.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9deff0d0ff85bc0db889944ab3bfdc25/plot_enumeratefunction.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_enumeratefunction.ipynb</span></code></a></p>
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_chaos_cv.html" title="Chaos cross-validation"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_chaos_ishigami.html" title="Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Polynomial chaos metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Plot enumeration rules</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>