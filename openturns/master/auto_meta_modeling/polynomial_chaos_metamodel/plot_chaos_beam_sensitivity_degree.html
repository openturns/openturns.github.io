<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Polynomial chaos is sensitive to the degree &#8212; OpenTURNS 1.25dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css?v=105494d3" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=4652c2b6" />
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=e2d0d5e7"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script src="../../_static/js/mysearchtools.js?v=a003391d"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Create a sparse chaos by integration" href="plot_chaos_cleaning_strategy.html" />
    <link rel="prev" title="Plot enumeration rules" href="plot_enumeratefunction.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_chaos_cleaning_strategy.html" title="Create a sparse chaos by integration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_enumeratefunction.html" title="Plot enumeration rules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.25dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Polynomial chaos metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Polynomial chaos is sensitive to the degree</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Polynomial chaos is sensitive to the degree</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#distribution-of-the-predictivity-coefficient">Distribution of the predictivity coefficient</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_enumeratefunction.html"
                          title="previous chapter">Plot enumeration rules</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_chaos_cleaning_strategy.html"
                          title="next chapter">Create a sparse chaos by integration</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_meta_modeling/polynomial_chaos_metamodel/plot_chaos_beam_sensitivity_degree.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-meta-modeling-polynomial-chaos-metamodel-plot-chaos-beam-sensitivity-degree-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="polynomial-chaos-is-sensitive-to-the-degree">
<span id="sphx-glr-auto-meta-modeling-polynomial-chaos-metamodel-plot-chaos-beam-sensitivity-degree-py"></span><h1>Polynomial chaos is sensitive to the degree<a class="headerlink" href="#polynomial-chaos-is-sensitive-to-the-degree" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>In this example, we observe the sensitivity of the polynomial chaos expansion to the total degree of the polynomial.
More precisely, we observe how this impacts the <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC4yIC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEzLjI0MjY5OHB0JyBoZWlnaHQ9JzkuNDc0NzM5cHQnIHZpZXdCb3g9JzAgLTkuNDc0NzM5IDEzLjI0MjY5OCA5LjQ3NDczOSc+CjxkZWZzPgo8cGF0aCBpZD0nZzEtNTAnIGQ9J00yLjI0NzU3Mi0xLjYyNTkwM0MyLjM3NTA5My0xLjc0NTQ1NSAyLjcwOTgzOC0yLjAwODQ2OCAyLjgzNzM2LTIuMTIwMDVDMy4zMzE1MDctMi41NzQzNDYgMy44MDE3NDMtMy4wMTI3MDIgMy44MDE3NDMtMy43Mzc5ODNDMy44MDE3NDMtNC42ODY0MjYgMy4wMDQ3MzItNS4zMDAxMjUgMi4wMDg0NjgtNS4zMDAxMjVDMS4wNTIwNTUtNS4zMDAxMjUgLjQyMjQxNi00LjU3NDg0NCAuNDIyNDE2LTMuODY1NTA0Qy40MjI0MTYtMy40NzQ5NjkgLjczMzI1LTMuNDE5MTc4IC44NDQ4MzItMy40MTkxNzhDMS4wMTIyMDQtMy40MTkxNzggMS4yNTkyNzgtMy41Mzg3MyAxLjI1OTI3OC0zLjg0MTU5NEMxLjI1OTI3OC00LjI1NjA0IC44NjA3NzItNC4yNTYwNCAuNzY1MTMxLTQuMjU2MDRDLjk5NjI2NC00LjgzNzg1OCAxLjUzMDI2Mi01LjAzNzExMSAxLjkyMDc5Ny01LjAzNzExMUMyLjY2MjAxNy01LjAzNzExMSAzLjA0NDU4My00LjQwNzQ3MiAzLjA0NDU4My0zLjczNzk4M0MzLjA0NDU4My0yLjkwOTA5MSAyLjQ2Mjc2NS0yLjMwMzM2MiAxLjUyMjI5MS0xLjMzODk3OUwuNTE4MDU3LS4zMDI4NjRDLjQyMjQxNi0uMjE1MTkzIC40MjI0MTYtLjE5OTI1MyAuNDIyNDE2IDBIMy41NzA2MUwzLjgwMTc0My0xLjQyNjY1SDMuNTU0NjdDMy41MzA3Ni0xLjI2NzI0OCAzLjQ2Njk5OS0uODY4NzQyIDMuMzcxMzU3LS43MTczMUMzLjMyMzUzNy0uNjUzNTQ5IDIuNzE3ODA4LS42NTM1NDkgMi41OTAyODYtLjY1MzU0OUgxLjE3MTYwNkwyLjI0NzU3Mi0xLjYyNTkwM1onLz4KPHBhdGggaWQ9J2cwLTgyJyBkPSdNNC4zOTk1MDItNy4zNTI0MjhDNC41MDcwOTgtNy43OTQ3NyA0LjU1NDkxOS03LjgxODY4IDUuMDIxMTcxLTcuODE4NjhINS44ODE5NDNDNi45MTAwODctNy44MTg2OCA3LjY3NTIxOC03LjUwNzg0NiA3LjY3NTIxOC02LjU3NTM0MkM3LjY3NTIxOC01Ljk2NTYyOSA3LjM2NDM4NC00LjIwODIxOSA0Ljk2MTM5NS00LjIwODIxOUgzLjYxMDQ2MUw0LjM5OTUwMi03LjM1MjQyOFpNNi4wNjEyNy00LjA2NDc1N0M3LjU0MzcxMS00LjM4NzU0NyA4LjcwMzM2Mi01LjM0Mzk2IDguNzAzMzYyLTYuMzcyMTA1QzguNzAzMzYyLTcuMzA0NjA4IDcuNzU4OTA0LTguMTY1MzggNi4wOTcxMzYtOC4xNjUzOEgyLjg1NzI4NUMyLjYxODE4Mi04LjE2NTM4IDIuNTEwNTg1LTguMTY1MzggMi41MTA1ODUtNy45MzgyMzJDMi41MTA1ODUtNy44MTg2OCAyLjU5NDI3MS03LjgxODY4IDIuODIxNDItNy44MTg2OEMzLjUzODczLTcuODE4NjggMy41Mzg3My03LjcyMzAzOSAzLjUzODczLTcuNTkxNTMyQzMuNTM4NzMtNy41Njc2MjEgMy41Mzg3My03LjQ5NTg5IDMuNDkwOTA5LTcuMzE2NTYzTDEuODc2OTYxLS44ODQ2ODJDMS43NjkzNjUtLjQ2NjI1MiAxLjc0NTQ1NS0uMzQ2NyAuOTIwNTQ4LS4zNDY3Qy42NDU1NzktLjM0NjcgLjU2MTg5My0uMzQ2NyAuNTYxODkzLS4xMTk1NTJDLjU2MTg5MyAwIC42OTM0IDAgLjcyOTI2NSAwQy45NDQ0NTggMCAxLjE5NTUxNy0uMDIzOTEgMS40MjI2NjUtLjAyMzkxSDIuODMzMzc1QzMuMDQ4NTY4LS4wMjM5MSAzLjI5OTYyNiAwIDMuNTE0ODE5IDBDMy42MTA0NjEgMCAzLjc0MTk2OCAwIDMuNzQxOTY4LS4yMjcxNDhDMy43NDE5NjgtLjM0NjcgMy42MzQzNzEtLjM0NjcgMy40NTUwNDQtLjM0NjdDMi43MjU3NzgtLjM0NjcgMi43MjU3NzgtLjQ0MjM0MSAyLjcyNTc3OC0uNTYxODkzQzIuNzI1Nzc4LS41NzM4NDggMi43MjU3NzgtLjY1NzUzNCAyLjc0OTY4OS0uNzUzMTc2TDMuNTUwNjg1LTMuOTY5MTE2SDQuOTg1MzA1QzYuMTIxMDQ2LTMuOTY5MTE2IDYuMzM2MjM5LTMuMjUxODA2IDYuMzM2MjM5LTIuODU3Mjg1QzYuMzM2MjM5LTIuNjc3OTU4IDYuMjE2Njg3LTIuMjExNzA2IDYuMTMzMDAxLTEuOTAwODcyQzYuMDAxNDk0LTEuMzUwOTM0IDUuOTY1NjI5LTEuMjE5NDI3IDUuOTY1NjI5LS45OTIyNzlDNS45NjU2MjktLjE0MzQ2MiA2LjY1OTAyOSAuMjUxMDU5IDcuNDYwMDI1IC4yNTEwNTlDOC40MjgzOTQgLjI1MTA1OSA4Ljg0NjgyNC0uOTMyNTAzIDguODQ2ODI0LTEuMDk5ODc1QzguODQ2ODI0LTEuMTgzNTYyIDguNzg3MDQ5LTEuMjE5NDI3IDguNzE1MzE4LTEuMjE5NDI3QzguNjE5Njc2LTEuMjE5NDI3IDguNTk1NzY2LTEuMTQ3Njk2IDguNTcxODU2LTEuMDUyMDU1QzguMjg0OTMyLS4yMDMyMzggNy43OTQ3NyAuMDExOTU1IDcuNDk1ODkgLjAxMTk1NVM3LjAwNTcyOS0uMTE5NTUyIDcuMDA1NzI5LS42NTc1MzRDNy4wMDU3MjktLjk0NDQ1OCA3LjE0OTE5MS0yLjAzMjM3OSA3LjE2MTE0Ni0yLjA5MjE1NEM3LjIyMDkyMi0yLjUzNDQ5NiA3LjIyMDkyMi0yLjU4MjMxNiA3LjIyMDkyMi0yLjY3Nzk1OEM3LjIyMDkyMi0zLjU1MDY4NSA2LjUxNTU2Ny0zLjkyMTI5NSA2LjA2MTI3LTQuMDY0NzU3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTgyJy8+Cjx1c2UgeD0nOS4wMDg1MTUnIHk9Jy00LjMzODQzNycgeGxpbms6aHJlZj0nI2cxLTUwJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9MCAtLT4=" alt="R^2" style="vertical-align: 0px"/> predictivity coefficient.</p>
<p>We consider the example of the cantilever beam. We create a sparse polynomial chaos with a linear enumeration rule
and the family of orthogonal polynomials corresponding to each input variable.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
</pre></div>
</div>
<p>The following parameter value leads to fast simulations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maxDegree</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>For real tests, we suggest using the following parameter value:</p>
<p><cite>maxDegree</cite> = 7</p>
<p>Let us define the parameters of the cantilever beam problem.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dist_E</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.8e7</span><span class="p">,</span> <span class="mf">4.8e7</span><span class="p">)</span>
<span class="n">dist_E</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;E&quot;</span><span class="p">])</span>
<span class="n">F_para</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LogNormalMuSigma</span><span class="p">(</span><span class="mf">3.0e4</span><span class="p">,</span> <span class="mf">9.0e3</span><span class="p">,</span> <span class="mf">15.0e3</span><span class="p">)</span>  <span class="c1"># in N</span>
<span class="n">dist_F</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametrizedDistribution</span><span class="p">(</span><span class="n">F_para</span><span class="p">)</span>
<span class="n">dist_F</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;F&quot;</span><span class="p">])</span>
<span class="n">dist_L</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">250.0</span><span class="p">,</span> <span class="mf">260.0</span><span class="p">)</span>  <span class="c1"># in cm</span>
<span class="n">dist_L</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;L&quot;</span><span class="p">])</span>
<span class="n">dist_I</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">310.0</span><span class="p">,</span> <span class="mf">450.0</span><span class="p">)</span>  <span class="c1"># in cm^4</span>
<span class="n">dist_I</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;I&quot;</span><span class="p">])</span>

<span class="n">myDistribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">([</span><span class="n">dist_E</span><span class="p">,</span> <span class="n">dist_F</span><span class="p">,</span> <span class="n">dist_L</span><span class="p">,</span> <span class="n">dist_I</span><span class="p">])</span>

<span class="n">dim_input</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># dimension of the input</span>
<span class="n">dim_output</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># dimension of the output</span>


<span class="k">def</span> <span class="nf">function_beam</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">E</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">II</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">L</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">II</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Y</span><span class="p">]</span>


<span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="n">dim_input</span><span class="p">,</span> <span class="n">dim_output</span><span class="p">,</span> <span class="n">function_beam</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">setInputDescription</span><span class="p">(</span><span class="n">myDistribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">())</span>
</pre></div>
</div>
<p>The following function creates a sparse polynomial chaos with a given total degree.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ComputeSparseLeastSquaresChaos</span><span class="p">(</span>
    <span class="n">inputTrain</span><span class="p">,</span> <span class="n">outputTrain</span><span class="p">,</span> <span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">totalDegree</span><span class="p">,</span> <span class="n">myDistribution</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a sparse polynomial chaos based on least squares.</span>

<span class="sd">    * Uses the enumerate rule in multivariateBasis.</span>
<span class="sd">    * Uses the LeastSquaresStrategy to compute the coefficients based on</span>
<span class="sd">      least squares.</span>
<span class="sd">    * Uses LeastSquaresMetaModelSelectionFactory to use the LARS selection method.</span>
<span class="sd">    * Uses FixedStrategy in order to keep all the coefficients that the</span>
<span class="sd">      LARS method selected.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inputTrain : ot.Sample</span>
<span class="sd">        The input design of experiments.</span>
<span class="sd">    outputTrain : ot.Sample</span>
<span class="sd">        The output design of experiments.</span>
<span class="sd">    multivariateBasis : ot.Basis</span>
<span class="sd">        The multivariate chaos basis.</span>
<span class="sd">    totalDegree : int</span>
<span class="sd">        The total degree of the chaos polynomial.</span>
<span class="sd">    myDistribution : ot.Distribution.</span>
<span class="sd">        The distribution of the input variable.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result : ot.PolynomialChaosResult</span>
<span class="sd">        The estimated polynomial chaos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">selectionAlgorithm</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LeastSquaresMetaModelSelectionFactory</span><span class="p">()</span>
    <span class="n">projectionStrategy</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LeastSquaresStrategy</span><span class="p">(</span><span class="n">selectionAlgorithm</span><span class="p">)</span>
    <span class="n">enumfunc</span> <span class="o">=</span> <span class="n">multivariateBasis</span><span class="o">.</span><span class="n">getEnumerateFunction</span><span class="p">()</span>
    <span class="n">basisSize</span> <span class="o">=</span> <span class="n">enumfunc</span><span class="o">.</span><span class="n">getBasisSizeFromTotalDegree</span><span class="p">(</span><span class="n">totalDegree</span><span class="p">)</span>
    <span class="n">adaptiveStrategy</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FixedStrategy</span><span class="p">(</span><span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">basisSize</span><span class="p">)</span>
    <span class="n">chaosalgo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FunctionalChaosAlgorithm</span><span class="p">(</span>
        <span class="n">inputTrain</span><span class="p">,</span> <span class="n">outputTrain</span><span class="p">,</span> <span class="n">myDistribution</span><span class="p">,</span> <span class="n">adaptiveStrategy</span><span class="p">,</span> <span class="n">projectionStrategy</span>
    <span class="p">)</span>
    <span class="n">chaosalgo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">chaosalgo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>The following function computes the sparsity rate of the polynomial chaos.
To do this, we compute the number of coefficients in the decomposition assuming a linear enumeration rule and a fixed truncation.
The sparsity rate is the complement of the ratio between the number of coefficients
selected from LARS and the total number of coefficients in the full polynomial basis.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeSparsityRate</span><span class="p">(</span><span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">totalDegree</span><span class="p">,</span> <span class="n">chaosResult</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the sparsity rate, assuming a FixedStrategy.&quot;&quot;&quot;</span>
    <span class="c1"># Get basisSize, the number of candidate coefficients</span>
    <span class="n">enumfunc</span> <span class="o">=</span> <span class="n">multivariateBasis</span><span class="o">.</span><span class="n">getEnumerateFunction</span><span class="p">()</span>
    <span class="n">basisSize</span> <span class="o">=</span> <span class="n">enumfunc</span><span class="o">.</span><span class="n">getStrataCumulatedCardinal</span><span class="p">(</span><span class="n">totalDegree</span><span class="p">)</span>
    <span class="c1"># Get number of coefficients in the selection</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">chaosResult</span><span class="o">.</span><span class="n">getIndices</span><span class="p">()</span>
    <span class="n">nbcoeffs</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
    <span class="c1"># Compute rate</span>
    <span class="n">sparsityRate</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">nbcoeffs</span> <span class="o">/</span> <span class="n">basisSize</span>
    <span class="k">return</span> <span class="n">sparsityRate</span>
</pre></div>
</div>
<p>The following functions compute and plot the <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC4yIC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEzLjI0MjY5OHB0JyBoZWlnaHQ9JzkuNDc0NzM5cHQnIHZpZXdCb3g9JzAgLTkuNDc0NzM5IDEzLjI0MjY5OCA5LjQ3NDczOSc+CjxkZWZzPgo8cGF0aCBpZD0nZzEtNTAnIGQ9J00yLjI0NzU3Mi0xLjYyNTkwM0MyLjM3NTA5My0xLjc0NTQ1NSAyLjcwOTgzOC0yLjAwODQ2OCAyLjgzNzM2LTIuMTIwMDVDMy4zMzE1MDctMi41NzQzNDYgMy44MDE3NDMtMy4wMTI3MDIgMy44MDE3NDMtMy43Mzc5ODNDMy44MDE3NDMtNC42ODY0MjYgMy4wMDQ3MzItNS4zMDAxMjUgMi4wMDg0NjgtNS4zMDAxMjVDMS4wNTIwNTUtNS4zMDAxMjUgLjQyMjQxNi00LjU3NDg0NCAuNDIyNDE2LTMuODY1NTA0Qy40MjI0MTYtMy40NzQ5NjkgLjczMzI1LTMuNDE5MTc4IC44NDQ4MzItMy40MTkxNzhDMS4wMTIyMDQtMy40MTkxNzggMS4yNTkyNzgtMy41Mzg3MyAxLjI1OTI3OC0zLjg0MTU5NEMxLjI1OTI3OC00LjI1NjA0IC44NjA3NzItNC4yNTYwNCAuNzY1MTMxLTQuMjU2MDRDLjk5NjI2NC00LjgzNzg1OCAxLjUzMDI2Mi01LjAzNzExMSAxLjkyMDc5Ny01LjAzNzExMUMyLjY2MjAxNy01LjAzNzExMSAzLjA0NDU4My00LjQwNzQ3MiAzLjA0NDU4My0zLjczNzk4M0MzLjA0NDU4My0yLjkwOTA5MSAyLjQ2Mjc2NS0yLjMwMzM2MiAxLjUyMjI5MS0xLjMzODk3OUwuNTE4MDU3LS4zMDI4NjRDLjQyMjQxNi0uMjE1MTkzIC40MjI0MTYtLjE5OTI1MyAuNDIyNDE2IDBIMy41NzA2MUwzLjgwMTc0My0xLjQyNjY1SDMuNTU0NjdDMy41MzA3Ni0xLjI2NzI0OCAzLjQ2Njk5OS0uODY4NzQyIDMuMzcxMzU3LS43MTczMUMzLjMyMzUzNy0uNjUzNTQ5IDIuNzE3ODA4LS42NTM1NDkgMi41OTAyODYtLjY1MzU0OUgxLjE3MTYwNkwyLjI0NzU3Mi0xLjYyNTkwM1onLz4KPHBhdGggaWQ9J2cwLTgyJyBkPSdNNC4zOTk1MDItNy4zNTI0MjhDNC41MDcwOTgtNy43OTQ3NyA0LjU1NDkxOS03LjgxODY4IDUuMDIxMTcxLTcuODE4NjhINS44ODE5NDNDNi45MTAwODctNy44MTg2OCA3LjY3NTIxOC03LjUwNzg0NiA3LjY3NTIxOC02LjU3NTM0MkM3LjY3NTIxOC01Ljk2NTYyOSA3LjM2NDM4NC00LjIwODIxOSA0Ljk2MTM5NS00LjIwODIxOUgzLjYxMDQ2MUw0LjM5OTUwMi03LjM1MjQyOFpNNi4wNjEyNy00LjA2NDc1N0M3LjU0MzcxMS00LjM4NzU0NyA4LjcwMzM2Mi01LjM0Mzk2IDguNzAzMzYyLTYuMzcyMTA1QzguNzAzMzYyLTcuMzA0NjA4IDcuNzU4OTA0LTguMTY1MzggNi4wOTcxMzYtOC4xNjUzOEgyLjg1NzI4NUMyLjYxODE4Mi04LjE2NTM4IDIuNTEwNTg1LTguMTY1MzggMi41MTA1ODUtNy45MzgyMzJDMi41MTA1ODUtNy44MTg2OCAyLjU5NDI3MS03LjgxODY4IDIuODIxNDItNy44MTg2OEMzLjUzODczLTcuODE4NjggMy41Mzg3My03LjcyMzAzOSAzLjUzODczLTcuNTkxNTMyQzMuNTM4NzMtNy41Njc2MjEgMy41Mzg3My03LjQ5NTg5IDMuNDkwOTA5LTcuMzE2NTYzTDEuODc2OTYxLS44ODQ2ODJDMS43NjkzNjUtLjQ2NjI1MiAxLjc0NTQ1NS0uMzQ2NyAuOTIwNTQ4LS4zNDY3Qy42NDU1NzktLjM0NjcgLjU2MTg5My0uMzQ2NyAuNTYxODkzLS4xMTk1NTJDLjU2MTg5MyAwIC42OTM0IDAgLjcyOTI2NSAwQy45NDQ0NTggMCAxLjE5NTUxNy0uMDIzOTEgMS40MjI2NjUtLjAyMzkxSDIuODMzMzc1QzMuMDQ4NTY4LS4wMjM5MSAzLjI5OTYyNiAwIDMuNTE0ODE5IDBDMy42MTA0NjEgMCAzLjc0MTk2OCAwIDMuNzQxOTY4LS4yMjcxNDhDMy43NDE5NjgtLjM0NjcgMy42MzQzNzEtLjM0NjcgMy40NTUwNDQtLjM0NjdDMi43MjU3NzgtLjM0NjcgMi43MjU3NzgtLjQ0MjM0MSAyLjcyNTc3OC0uNTYxODkzQzIuNzI1Nzc4LS41NzM4NDggMi43MjU3NzgtLjY1NzUzNCAyLjc0OTY4OS0uNzUzMTc2TDMuNTUwNjg1LTMuOTY5MTE2SDQuOTg1MzA1QzYuMTIxMDQ2LTMuOTY5MTE2IDYuMzM2MjM5LTMuMjUxODA2IDYuMzM2MjM5LTIuODU3Mjg1QzYuMzM2MjM5LTIuNjc3OTU4IDYuMjE2Njg3LTIuMjExNzA2IDYuMTMzMDAxLTEuOTAwODcyQzYuMDAxNDk0LTEuMzUwOTM0IDUuOTY1NjI5LTEuMjE5NDI3IDUuOTY1NjI5LS45OTIyNzlDNS45NjU2MjktLjE0MzQ2MiA2LjY1OTAyOSAuMjUxMDU5IDcuNDYwMDI1IC4yNTEwNTlDOC40MjgzOTQgLjI1MTA1OSA4Ljg0NjgyNC0uOTMyNTAzIDguODQ2ODI0LTEuMDk5ODc1QzguODQ2ODI0LTEuMTgzNTYyIDguNzg3MDQ5LTEuMjE5NDI3IDguNzE1MzE4LTEuMjE5NDI3QzguNjE5Njc2LTEuMjE5NDI3IDguNTk1NzY2LTEuMTQ3Njk2IDguNTcxODU2LTEuMDUyMDU1QzguMjg0OTMyLS4yMDMyMzggNy43OTQ3NyAuMDExOTU1IDcuNDk1ODkgLjAxMTk1NVM3LjAwNTcyOS0uMTE5NTUyIDcuMDA1NzI5LS42NTc1MzRDNy4wMDU3MjktLjk0NDQ1OCA3LjE0OTE5MS0yLjAzMjM3OSA3LjE2MTE0Ni0yLjA5MjE1NEM3LjIyMDkyMi0yLjUzNDQ5NiA3LjIyMDkyMi0yLjU4MjMxNiA3LjIyMDkyMi0yLjY3Nzk1OEM3LjIyMDkyMi0zLjU1MDY4NSA2LjUxNTU2Ny0zLjkyMTI5NSA2LjA2MTI3LTQuMDY0NzU3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTgyJy8+Cjx1c2UgeD0nOS4wMDg1MTUnIHk9Jy00LjMzODQzNycgeGxpbms6aHJlZj0nI2cxLTUwJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9MCAtLT4=" alt="R^2" style="vertical-align: 0px"/> predictivity coefficients within the validation plot.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeR2Chaos</span><span class="p">(</span><span class="n">chaosResult</span><span class="p">,</span> <span class="n">inputTest</span><span class="p">,</span> <span class="n">outputTest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the R2 of a chaos.&quot;&quot;&quot;</span>
    <span class="n">metamodel</span> <span class="o">=</span> <span class="n">chaosResult</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
    <span class="n">metamodelPredictions</span> <span class="o">=</span> <span class="n">metamodel</span><span class="p">(</span><span class="n">inputTest</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MetaModelValidation</span><span class="p">(</span><span class="n">outputTest</span><span class="p">,</span> <span class="n">metamodelPredictions</span><span class="p">)</span>
    <span class="n">r2Score</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">computeR2Score</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">r2Score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">r2Score</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># We are not lucky every day.</span>
    <span class="k">return</span> <span class="n">r2Score</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printChaosStats</span><span class="p">(</span><span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">chaosResult</span><span class="p">,</span> <span class="n">inputTest</span><span class="p">,</span> <span class="n">outputTest</span><span class="p">,</span> <span class="n">totalDegree</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print statistics of a chaos.&quot;&quot;&quot;</span>
    <span class="n">sparsityRate</span> <span class="o">=</span> <span class="n">computeSparsityRate</span><span class="p">(</span><span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">totalDegree</span><span class="p">,</span> <span class="n">chaosResult</span><span class="p">)</span>
    <span class="n">r2Score</span> <span class="o">=</span> <span class="n">computeR2Chaos</span><span class="p">(</span><span class="n">chaosResult</span><span class="p">,</span> <span class="n">inputTest</span><span class="p">,</span> <span class="n">outputTest</span><span class="p">)</span>
    <span class="n">metamodel</span> <span class="o">=</span> <span class="n">chaosResult</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
    <span class="n">metamodelPredictions</span> <span class="o">=</span> <span class="n">metamodel</span><span class="p">(</span><span class="n">inputTest</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MetaModelValidation</span><span class="p">(</span><span class="n">outputTest</span><span class="p">,</span> <span class="n">metamodelPredictions</span><span class="p">)</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">drawValidation</span><span class="p">()</span><span class="o">.</span><span class="n">getGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">legend1</span> <span class="o">=</span> <span class="s2">&quot;D=</span><span class="si">%d</span><span class="s2">, R2=</span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">totalDegree</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">r2Score</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">legend1</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Degree=</span><span class="si">%d</span><span class="s2">, R2=</span><span class="si">%.2f%%</span><span class="s2">, Sparsity=</span><span class="si">%.2f%%</span><span class="s2">&quot;</span>
        <span class="o">%</span> <span class="p">(</span><span class="n">totalDegree</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">r2Score</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">sparsityRate</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">multivariateBasis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">OrthogonalProductPolynomialFactory</span><span class="p">(</span>
    <span class="p">[</span><span class="n">dist_E</span><span class="p">,</span> <span class="n">dist_F</span><span class="p">,</span> <span class="n">dist_L</span><span class="p">,</span> <span class="n">dist_I</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># size of the train design</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">n_valid</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># size of the test design</span>
</pre></div>
</div>
<p>The seed is selected to get <em>interesting</em> results.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">magicSeed</span> <span class="o">=</span> <span class="mi">43</span>  <span class="c1"># 127 is funny too</span>
<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="n">magicSeed</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">inputTrain</span> <span class="o">=</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">outputTrain</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">inputTrain</span><span class="p">)</span>
<span class="n">inputTest</span> <span class="o">=</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">n_valid</span><span class="p">)</span>
<span class="n">outputTest</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">inputTest</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">totalDegree</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxDegree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">chaosResult</span> <span class="o">=</span> <span class="n">ComputeSparseLeastSquaresChaos</span><span class="p">(</span>
        <span class="n">inputTrain</span><span class="p">,</span> <span class="n">outputTrain</span><span class="p">,</span> <span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">totalDegree</span><span class="p">,</span> <span class="n">myDistribution</span>
    <span class="p">)</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">printChaosStats</span><span class="p">(</span>
        <span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">chaosResult</span><span class="p">,</span> <span class="n">inputTest</span><span class="p">,</span> <span class="n">outputTest</span><span class="p">,</span> <span class="n">totalDegree</span>
    <span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.add_subplot.html#matplotlib.figure.Figure.add_subplot" title="matplotlib.figure.Figure.add_subplot" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxDegree</span><span class="p">,</span> <span class="n">totalDegree</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">])</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Metamodel validation&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_001.png" srcset="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_001.png" alt="Metamodel validation" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Degree=1, R2=96.50%, Sparsity=20.00%
Degree=2, R2=93.57%, Sparsity=53.33%
Degree=3, R2=85.53%, Sparsity=80.00%
Degree=4, R2=85.54%, Sparsity=88.57%
</pre></div>
</div>
<p>We see that when the degree of the polynomial increases, the <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC4yIC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEzLjI0MjY5OHB0JyBoZWlnaHQ9JzkuNDc0NzM5cHQnIHZpZXdCb3g9JzAgLTkuNDc0NzM5IDEzLjI0MjY5OCA5LjQ3NDczOSc+CjxkZWZzPgo8cGF0aCBpZD0nZzEtNTAnIGQ9J00yLjI0NzU3Mi0xLjYyNTkwM0MyLjM3NTA5My0xLjc0NTQ1NSAyLjcwOTgzOC0yLjAwODQ2OCAyLjgzNzM2LTIuMTIwMDVDMy4zMzE1MDctMi41NzQzNDYgMy44MDE3NDMtMy4wMTI3MDIgMy44MDE3NDMtMy43Mzc5ODNDMy44MDE3NDMtNC42ODY0MjYgMy4wMDQ3MzItNS4zMDAxMjUgMi4wMDg0NjgtNS4zMDAxMjVDMS4wNTIwNTUtNS4zMDAxMjUgLjQyMjQxNi00LjU3NDg0NCAuNDIyNDE2LTMuODY1NTA0Qy40MjI0MTYtMy40NzQ5NjkgLjczMzI1LTMuNDE5MTc4IC44NDQ4MzItMy40MTkxNzhDMS4wMTIyMDQtMy40MTkxNzggMS4yNTkyNzgtMy41Mzg3MyAxLjI1OTI3OC0zLjg0MTU5NEMxLjI1OTI3OC00LjI1NjA0IC44NjA3NzItNC4yNTYwNCAuNzY1MTMxLTQuMjU2MDRDLjk5NjI2NC00LjgzNzg1OCAxLjUzMDI2Mi01LjAzNzExMSAxLjkyMDc5Ny01LjAzNzExMUMyLjY2MjAxNy01LjAzNzExMSAzLjA0NDU4My00LjQwNzQ3MiAzLjA0NDU4My0zLjczNzk4M0MzLjA0NDU4My0yLjkwOTA5MSAyLjQ2Mjc2NS0yLjMwMzM2MiAxLjUyMjI5MS0xLjMzODk3OUwuNTE4MDU3LS4zMDI4NjRDLjQyMjQxNi0uMjE1MTkzIC40MjI0MTYtLjE5OTI1MyAuNDIyNDE2IDBIMy41NzA2MUwzLjgwMTc0My0xLjQyNjY1SDMuNTU0NjdDMy41MzA3Ni0xLjI2NzI0OCAzLjQ2Njk5OS0uODY4NzQyIDMuMzcxMzU3LS43MTczMUMzLjMyMzUzNy0uNjUzNTQ5IDIuNzE3ODA4LS42NTM1NDkgMi41OTAyODYtLjY1MzU0OUgxLjE3MTYwNkwyLjI0NzU3Mi0xLjYyNTkwM1onLz4KPHBhdGggaWQ9J2cwLTgyJyBkPSdNNC4zOTk1MDItNy4zNTI0MjhDNC41MDcwOTgtNy43OTQ3NyA0LjU1NDkxOS03LjgxODY4IDUuMDIxMTcxLTcuODE4NjhINS44ODE5NDNDNi45MTAwODctNy44MTg2OCA3LjY3NTIxOC03LjUwNzg0NiA3LjY3NTIxOC02LjU3NTM0MkM3LjY3NTIxOC01Ljk2NTYyOSA3LjM2NDM4NC00LjIwODIxOSA0Ljk2MTM5NS00LjIwODIxOUgzLjYxMDQ2MUw0LjM5OTUwMi03LjM1MjQyOFpNNi4wNjEyNy00LjA2NDc1N0M3LjU0MzcxMS00LjM4NzU0NyA4LjcwMzM2Mi01LjM0Mzk2IDguNzAzMzYyLTYuMzcyMTA1QzguNzAzMzYyLTcuMzA0NjA4IDcuNzU4OTA0LTguMTY1MzggNi4wOTcxMzYtOC4xNjUzOEgyLjg1NzI4NUMyLjYxODE4Mi04LjE2NTM4IDIuNTEwNTg1LTguMTY1MzggMi41MTA1ODUtNy45MzgyMzJDMi41MTA1ODUtNy44MTg2OCAyLjU5NDI3MS03LjgxODY4IDIuODIxNDItNy44MTg2OEMzLjUzODczLTcuODE4NjggMy41Mzg3My03LjcyMzAzOSAzLjUzODczLTcuNTkxNTMyQzMuNTM4NzMtNy41Njc2MjEgMy41Mzg3My03LjQ5NTg5IDMuNDkwOTA5LTcuMzE2NTYzTDEuODc2OTYxLS44ODQ2ODJDMS43NjkzNjUtLjQ2NjI1MiAxLjc0NTQ1NS0uMzQ2NyAuOTIwNTQ4LS4zNDY3Qy42NDU1NzktLjM0NjcgLjU2MTg5My0uMzQ2NyAuNTYxODkzLS4xMTk1NTJDLjU2MTg5MyAwIC42OTM0IDAgLjcyOTI2NSAwQy45NDQ0NTggMCAxLjE5NTUxNy0uMDIzOTEgMS40MjI2NjUtLjAyMzkxSDIuODMzMzc1QzMuMDQ4NTY4LS4wMjM5MSAzLjI5OTYyNiAwIDMuNTE0ODE5IDBDMy42MTA0NjEgMCAzLjc0MTk2OCAwIDMuNzQxOTY4LS4yMjcxNDhDMy43NDE5NjgtLjM0NjcgMy42MzQzNzEtLjM0NjcgMy40NTUwNDQtLjM0NjdDMi43MjU3NzgtLjM0NjcgMi43MjU3NzgtLjQ0MjM0MSAyLjcyNTc3OC0uNTYxODkzQzIuNzI1Nzc4LS41NzM4NDggMi43MjU3NzgtLjY1NzUzNCAyLjc0OTY4OS0uNzUzMTc2TDMuNTUwNjg1LTMuOTY5MTE2SDQuOTg1MzA1QzYuMTIxMDQ2LTMuOTY5MTE2IDYuMzM2MjM5LTMuMjUxODA2IDYuMzM2MjM5LTIuODU3Mjg1QzYuMzM2MjM5LTIuNjc3OTU4IDYuMjE2Njg3LTIuMjExNzA2IDYuMTMzMDAxLTEuOTAwODcyQzYuMDAxNDk0LTEuMzUwOTM0IDUuOTY1NjI5LTEuMjE5NDI3IDUuOTY1NjI5LS45OTIyNzlDNS45NjU2MjktLjE0MzQ2MiA2LjY1OTAyOSAuMjUxMDU5IDcuNDYwMDI1IC4yNTEwNTlDOC40MjgzOTQgLjI1MTA1OSA4Ljg0NjgyNC0uOTMyNTAzIDguODQ2ODI0LTEuMDk5ODc1QzguODQ2ODI0LTEuMTgzNTYyIDguNzg3MDQ5LTEuMjE5NDI3IDguNzE1MzE4LTEuMjE5NDI3QzguNjE5Njc2LTEuMjE5NDI3IDguNTk1NzY2LTEuMTQ3Njk2IDguNTcxODU2LTEuMDUyMDU1QzguMjg0OTMyLS4yMDMyMzggNy43OTQ3NyAuMDExOTU1IDcuNDk1ODkgLjAxMTk1NVM3LjAwNTcyOS0uMTE5NTUyIDcuMDA1NzI5LS42NTc1MzRDNy4wMDU3MjktLjk0NDQ1OCA3LjE0OTE5MS0yLjAzMjM3OSA3LjE2MTE0Ni0yLjA5MjE1NEM3LjIyMDkyMi0yLjUzNDQ5NiA3LjIyMDkyMi0yLjU4MjMxNiA3LjIyMDkyMi0yLjY3Nzk1OEM3LjIyMDkyMi0zLjU1MDY4NSA2LjUxNTU2Ny0zLjkyMTI5NSA2LjA2MTI3LTQuMDY0NzU3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTgyJy8+Cjx1c2UgeD0nOS4wMDg1MTUnIHk9Jy00LjMzODQzNycgeGxpbms6aHJlZj0nI2cxLTUwJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9MCAtLT4=" alt="R^2" style="vertical-align: 0px"/> coefficient decreases.
We also see that the sparsity rate increases: while the basis size grows rapidly with the degree, the algorithm selects a smaller fraction of this basis.
This shows that the algorithm performs its task of selecting relevant coefficients.
However, this selection does not seem to be sufficient to mitigate the large number of coefficients.</p>
<p>Of course, this example is designed to make a predictivity decrease gradually.
We are going to see that this situation is actually easy to reproduce.</p>
</section>
<section id="distribution-of-the-predictivity-coefficient">
<h2>Distribution of the predictivity coefficient<a class="headerlink" href="#distribution-of-the-predictivity-coefficient" title="Link to this heading">¶</a></h2>
<p>Let us repeat the following experiment to see the variability of the <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC4yIC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEzLjI0MjY5OHB0JyBoZWlnaHQ9JzkuNDc0NzM5cHQnIHZpZXdCb3g9JzAgLTkuNDc0NzM5IDEzLjI0MjY5OCA5LjQ3NDczOSc+CjxkZWZzPgo8cGF0aCBpZD0nZzEtNTAnIGQ9J00yLjI0NzU3Mi0xLjYyNTkwM0MyLjM3NTA5My0xLjc0NTQ1NSAyLjcwOTgzOC0yLjAwODQ2OCAyLjgzNzM2LTIuMTIwMDVDMy4zMzE1MDctMi41NzQzNDYgMy44MDE3NDMtMy4wMTI3MDIgMy44MDE3NDMtMy43Mzc5ODNDMy44MDE3NDMtNC42ODY0MjYgMy4wMDQ3MzItNS4zMDAxMjUgMi4wMDg0NjgtNS4zMDAxMjVDMS4wNTIwNTUtNS4zMDAxMjUgLjQyMjQxNi00LjU3NDg0NCAuNDIyNDE2LTMuODY1NTA0Qy40MjI0MTYtMy40NzQ5NjkgLjczMzI1LTMuNDE5MTc4IC44NDQ4MzItMy40MTkxNzhDMS4wMTIyMDQtMy40MTkxNzggMS4yNTkyNzgtMy41Mzg3MyAxLjI1OTI3OC0zLjg0MTU5NEMxLjI1OTI3OC00LjI1NjA0IC44NjA3NzItNC4yNTYwNCAuNzY1MTMxLTQuMjU2MDRDLjk5NjI2NC00LjgzNzg1OCAxLjUzMDI2Mi01LjAzNzExMSAxLjkyMDc5Ny01LjAzNzExMUMyLjY2MjAxNy01LjAzNzExMSAzLjA0NDU4My00LjQwNzQ3MiAzLjA0NDU4My0zLjczNzk4M0MzLjA0NDU4My0yLjkwOTA5MSAyLjQ2Mjc2NS0yLjMwMzM2MiAxLjUyMjI5MS0xLjMzODk3OUwuNTE4MDU3LS4zMDI4NjRDLjQyMjQxNi0uMjE1MTkzIC40MjI0MTYtLjE5OTI1MyAuNDIyNDE2IDBIMy41NzA2MUwzLjgwMTc0My0xLjQyNjY1SDMuNTU0NjdDMy41MzA3Ni0xLjI2NzI0OCAzLjQ2Njk5OS0uODY4NzQyIDMuMzcxMzU3LS43MTczMUMzLjMyMzUzNy0uNjUzNTQ5IDIuNzE3ODA4LS42NTM1NDkgMi41OTAyODYtLjY1MzU0OUgxLjE3MTYwNkwyLjI0NzU3Mi0xLjYyNTkwM1onLz4KPHBhdGggaWQ9J2cwLTgyJyBkPSdNNC4zOTk1MDItNy4zNTI0MjhDNC41MDcwOTgtNy43OTQ3NyA0LjU1NDkxOS03LjgxODY4IDUuMDIxMTcxLTcuODE4NjhINS44ODE5NDNDNi45MTAwODctNy44MTg2OCA3LjY3NTIxOC03LjUwNzg0NiA3LjY3NTIxOC02LjU3NTM0MkM3LjY3NTIxOC01Ljk2NTYyOSA3LjM2NDM4NC00LjIwODIxOSA0Ljk2MTM5NS00LjIwODIxOUgzLjYxMDQ2MUw0LjM5OTUwMi03LjM1MjQyOFpNNi4wNjEyNy00LjA2NDc1N0M3LjU0MzcxMS00LjM4NzU0NyA4LjcwMzM2Mi01LjM0Mzk2IDguNzAzMzYyLTYuMzcyMTA1QzguNzAzMzYyLTcuMzA0NjA4IDcuNzU4OTA0LTguMTY1MzggNi4wOTcxMzYtOC4xNjUzOEgyLjg1NzI4NUMyLjYxODE4Mi04LjE2NTM4IDIuNTEwNTg1LTguMTY1MzggMi41MTA1ODUtNy45MzgyMzJDMi41MTA1ODUtNy44MTg2OCAyLjU5NDI3MS03LjgxODY4IDIuODIxNDItNy44MTg2OEMzLjUzODczLTcuODE4NjggMy41Mzg3My03LjcyMzAzOSAzLjUzODczLTcuNTkxNTMyQzMuNTM4NzMtNy41Njc2MjEgMy41Mzg3My03LjQ5NTg5IDMuNDkwOTA5LTcuMzE2NTYzTDEuODc2OTYxLS44ODQ2ODJDMS43NjkzNjUtLjQ2NjI1MiAxLjc0NTQ1NS0uMzQ2NyAuOTIwNTQ4LS4zNDY3Qy42NDU1NzktLjM0NjcgLjU2MTg5My0uMzQ2NyAuNTYxODkzLS4xMTk1NTJDLjU2MTg5MyAwIC42OTM0IDAgLjcyOTI2NSAwQy45NDQ0NTggMCAxLjE5NTUxNy0uMDIzOTEgMS40MjI2NjUtLjAyMzkxSDIuODMzMzc1QzMuMDQ4NTY4LS4wMjM5MSAzLjI5OTYyNiAwIDMuNTE0ODE5IDBDMy42MTA0NjEgMCAzLjc0MTk2OCAwIDMuNzQxOTY4LS4yMjcxNDhDMy43NDE5NjgtLjM0NjcgMy42MzQzNzEtLjM0NjcgMy40NTUwNDQtLjM0NjdDMi43MjU3NzgtLjM0NjcgMi43MjU3NzgtLjQ0MjM0MSAyLjcyNTc3OC0uNTYxODkzQzIuNzI1Nzc4LS41NzM4NDggMi43MjU3NzgtLjY1NzUzNCAyLjc0OTY4OS0uNzUzMTc2TDMuNTUwNjg1LTMuOTY5MTE2SDQuOTg1MzA1QzYuMTIxMDQ2LTMuOTY5MTE2IDYuMzM2MjM5LTMuMjUxODA2IDYuMzM2MjM5LTIuODU3Mjg1QzYuMzM2MjM5LTIuNjc3OTU4IDYuMjE2Njg3LTIuMjExNzA2IDYuMTMzMDAxLTEuOTAwODcyQzYuMDAxNDk0LTEuMzUwOTM0IDUuOTY1NjI5LTEuMjE5NDI3IDUuOTY1NjI5LS45OTIyNzlDNS45NjU2MjktLjE0MzQ2MiA2LjY1OTAyOSAuMjUxMDU5IDcuNDYwMDI1IC4yNTEwNTlDOC40MjgzOTQgLjI1MTA1OSA4Ljg0NjgyNC0uOTMyNTAzIDguODQ2ODI0LTEuMDk5ODc1QzguODQ2ODI0LTEuMTgzNTYyIDguNzg3MDQ5LTEuMjE5NDI3IDguNzE1MzE4LTEuMjE5NDI3QzguNjE5Njc2LTEuMjE5NDI3IDguNTk1NzY2LTEuMTQ3Njk2IDguNTcxODU2LTEuMDUyMDU1QzguMjg0OTMyLS4yMDMyMzggNy43OTQ3NyAuMDExOTU1IDcuNDk1ODkgLjAxMTk1NVM3LjAwNTcyOS0uMTE5NTUyIDcuMDA1NzI5LS42NTc1MzRDNy4wMDU3MjktLjk0NDQ1OCA3LjE0OTE5MS0yLjAzMjM3OSA3LjE2MTE0Ni0yLjA5MjE1NEM3LjIyMDkyMi0yLjUzNDQ5NiA3LjIyMDkyMi0yLjU4MjMxNiA3LjIyMDkyMi0yLjY3Nzk1OEM3LjIyMDkyMi0zLjU1MDY4NSA2LjUxNTU2Ny0zLjkyMTI5NSA2LjA2MTI3LTQuMDY0NzU3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTgyJy8+Cjx1c2UgeD0nOS4wMDg1MTUnIHk9Jy00LjMzODQzNycgeGxpbms6aHJlZj0nI2cxLTUwJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9MCAtLT4=" alt="R^2" style="vertical-align: 0px"/> coefficient.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeSampleR2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n_valid</span><span class="p">,</span> <span class="n">numberAttempts</span><span class="p">,</span> <span class="n">maxDegree</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;For a given sample size N, for degree from 1 to maxDegree,</span>
<span class="sd">    repeat the following experiment numberAttempts times:</span>
<span class="sd">    create a sparse least squares chaos and compute the R2</span>
<span class="sd">    using n_valid points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r2Sample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">numberAttempts</span><span class="p">,</span> <span class="n">maxDegree</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">totalDegree</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxDegree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Degree = </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">totalDegree</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberAttempts</span><span class="p">):</span>
            <span class="n">inputTrain</span> <span class="o">=</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">outputTrain</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">inputTrain</span><span class="p">)</span>
            <span class="n">inputTest</span> <span class="o">=</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">n_valid</span><span class="p">)</span>
            <span class="n">outputTest</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">inputTest</span><span class="p">)</span>
            <span class="n">chaosResult</span> <span class="o">=</span> <span class="n">ComputeSparseLeastSquaresChaos</span><span class="p">(</span>
                <span class="n">inputTrain</span><span class="p">,</span> <span class="n">outputTrain</span><span class="p">,</span> <span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">totalDegree</span><span class="p">,</span> <span class="n">myDistribution</span>
            <span class="p">)</span>
            <span class="n">r2Sample</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">totalDegree</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">computeR2Chaos</span><span class="p">(</span>
                <span class="n">chaosResult</span><span class="p">,</span> <span class="n">inputTest</span><span class="p">,</span> <span class="n">outputTest</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">r2Sample</span>
</pre></div>
</div>
<p>The following function uses a boxplot to see the distribution of the <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC4yIC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEzLjI0MjY5OHB0JyBoZWlnaHQ9JzkuNDc0NzM5cHQnIHZpZXdCb3g9JzAgLTkuNDc0NzM5IDEzLjI0MjY5OCA5LjQ3NDczOSc+CjxkZWZzPgo8cGF0aCBpZD0nZzEtNTAnIGQ9J00yLjI0NzU3Mi0xLjYyNTkwM0MyLjM3NTA5My0xLjc0NTQ1NSAyLjcwOTgzOC0yLjAwODQ2OCAyLjgzNzM2LTIuMTIwMDVDMy4zMzE1MDctMi41NzQzNDYgMy44MDE3NDMtMy4wMTI3MDIgMy44MDE3NDMtMy43Mzc5ODNDMy44MDE3NDMtNC42ODY0MjYgMy4wMDQ3MzItNS4zMDAxMjUgMi4wMDg0NjgtNS4zMDAxMjVDMS4wNTIwNTUtNS4zMDAxMjUgLjQyMjQxNi00LjU3NDg0NCAuNDIyNDE2LTMuODY1NTA0Qy40MjI0MTYtMy40NzQ5NjkgLjczMzI1LTMuNDE5MTc4IC44NDQ4MzItMy40MTkxNzhDMS4wMTIyMDQtMy40MTkxNzggMS4yNTkyNzgtMy41Mzg3MyAxLjI1OTI3OC0zLjg0MTU5NEMxLjI1OTI3OC00LjI1NjA0IC44NjA3NzItNC4yNTYwNCAuNzY1MTMxLTQuMjU2MDRDLjk5NjI2NC00LjgzNzg1OCAxLjUzMDI2Mi01LjAzNzExMSAxLjkyMDc5Ny01LjAzNzExMUMyLjY2MjAxNy01LjAzNzExMSAzLjA0NDU4My00LjQwNzQ3MiAzLjA0NDU4My0zLjczNzk4M0MzLjA0NDU4My0yLjkwOTA5MSAyLjQ2Mjc2NS0yLjMwMzM2MiAxLjUyMjI5MS0xLjMzODk3OUwuNTE4MDU3LS4zMDI4NjRDLjQyMjQxNi0uMjE1MTkzIC40MjI0MTYtLjE5OTI1MyAuNDIyNDE2IDBIMy41NzA2MUwzLjgwMTc0My0xLjQyNjY1SDMuNTU0NjdDMy41MzA3Ni0xLjI2NzI0OCAzLjQ2Njk5OS0uODY4NzQyIDMuMzcxMzU3LS43MTczMUMzLjMyMzUzNy0uNjUzNTQ5IDIuNzE3ODA4LS42NTM1NDkgMi41OTAyODYtLjY1MzU0OUgxLjE3MTYwNkwyLjI0NzU3Mi0xLjYyNTkwM1onLz4KPHBhdGggaWQ9J2cwLTgyJyBkPSdNNC4zOTk1MDItNy4zNTI0MjhDNC41MDcwOTgtNy43OTQ3NyA0LjU1NDkxOS03LjgxODY4IDUuMDIxMTcxLTcuODE4NjhINS44ODE5NDNDNi45MTAwODctNy44MTg2OCA3LjY3NTIxOC03LjUwNzg0NiA3LjY3NTIxOC02LjU3NTM0MkM3LjY3NTIxOC01Ljk2NTYyOSA3LjM2NDM4NC00LjIwODIxOSA0Ljk2MTM5NS00LjIwODIxOUgzLjYxMDQ2MUw0LjM5OTUwMi03LjM1MjQyOFpNNi4wNjEyNy00LjA2NDc1N0M3LjU0MzcxMS00LjM4NzU0NyA4LjcwMzM2Mi01LjM0Mzk2IDguNzAzMzYyLTYuMzcyMTA1QzguNzAzMzYyLTcuMzA0NjA4IDcuNzU4OTA0LTguMTY1MzggNi4wOTcxMzYtOC4xNjUzOEgyLjg1NzI4NUMyLjYxODE4Mi04LjE2NTM4IDIuNTEwNTg1LTguMTY1MzggMi41MTA1ODUtNy45MzgyMzJDMi41MTA1ODUtNy44MTg2OCAyLjU5NDI3MS03LjgxODY4IDIuODIxNDItNy44MTg2OEMzLjUzODczLTcuODE4NjggMy41Mzg3My03LjcyMzAzOSAzLjUzODczLTcuNTkxNTMyQzMuNTM4NzMtNy41Njc2MjEgMy41Mzg3My03LjQ5NTg5IDMuNDkwOTA5LTcuMzE2NTYzTDEuODc2OTYxLS44ODQ2ODJDMS43NjkzNjUtLjQ2NjI1MiAxLjc0NTQ1NS0uMzQ2NyAuOTIwNTQ4LS4zNDY3Qy42NDU1NzktLjM0NjcgLjU2MTg5My0uMzQ2NyAuNTYxODkzLS4xMTk1NTJDLjU2MTg5MyAwIC42OTM0IDAgLjcyOTI2NSAwQy45NDQ0NTggMCAxLjE5NTUxNy0uMDIzOTEgMS40MjI2NjUtLjAyMzkxSDIuODMzMzc1QzMuMDQ4NTY4LS4wMjM5MSAzLjI5OTYyNiAwIDMuNTE0ODE5IDBDMy42MTA0NjEgMCAzLjc0MTk2OCAwIDMuNzQxOTY4LS4yMjcxNDhDMy43NDE5NjgtLjM0NjcgMy42MzQzNzEtLjM0NjcgMy40NTUwNDQtLjM0NjdDMi43MjU3NzgtLjM0NjcgMi43MjU3NzgtLjQ0MjM0MSAyLjcyNTc3OC0uNTYxODkzQzIuNzI1Nzc4LS41NzM4NDggMi43MjU3NzgtLjY1NzUzNCAyLjc0OTY4OS0uNzUzMTc2TDMuNTUwNjg1LTMuOTY5MTE2SDQuOTg1MzA1QzYuMTIxMDQ2LTMuOTY5MTE2IDYuMzM2MjM5LTMuMjUxODA2IDYuMzM2MjM5LTIuODU3Mjg1QzYuMzM2MjM5LTIuNjc3OTU4IDYuMjE2Njg3LTIuMjExNzA2IDYuMTMzMDAxLTEuOTAwODcyQzYuMDAxNDk0LTEuMzUwOTM0IDUuOTY1NjI5LTEuMjE5NDI3IDUuOTY1NjI5LS45OTIyNzlDNS45NjU2MjktLjE0MzQ2MiA2LjY1OTAyOSAuMjUxMDU5IDcuNDYwMDI1IC4yNTEwNTlDOC40MjgzOTQgLjI1MTA1OSA4Ljg0NjgyNC0uOTMyNTAzIDguODQ2ODI0LTEuMDk5ODc1QzguODQ2ODI0LTEuMTgzNTYyIDguNzg3MDQ5LTEuMjE5NDI3IDguNzE1MzE4LTEuMjE5NDI3QzguNjE5Njc2LTEuMjE5NDI3IDguNTk1NzY2LTEuMTQ3Njk2IDguNTcxODU2LTEuMDUyMDU1QzguMjg0OTMyLS4yMDMyMzggNy43OTQ3NyAuMDExOTU1IDcuNDk1ODkgLjAxMTk1NVM3LjAwNTcyOS0uMTE5NTUyIDcuMDA1NzI5LS42NTc1MzRDNy4wMDU3MjktLjk0NDQ1OCA3LjE0OTE5MS0yLjAzMjM3OSA3LjE2MTE0Ni0yLjA5MjE1NEM3LjIyMDkyMi0yLjUzNDQ5NiA3LjIyMDkyMi0yLjU4MjMxNiA3LjIyMDkyMi0yLjY3Nzk1OEM3LjIyMDkyMi0zLjU1MDY4NSA2LjUxNTU2Ny0zLjkyMTI5NSA2LjA2MTI3LTQuMDY0NzU3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTgyJy8+Cjx1c2UgeD0nOS4wMDg1MTUnIHk9Jy00LjMzODQzNycgeGxpbms6aHJlZj0nI2cxLTUwJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9MCAtLT4=" alt="R^2" style="vertical-align: 0px"/> coefficients.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotR2Boxplots</span><span class="p">(</span><span class="n">r2Sample</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r2Sample</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;N=</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Degree&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;R2 (%)&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
<p>Each experiment is repeated several times.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">numberAttempts</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Number of repetitions</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># size of the train design</span>
<span class="n">r2Sample</span> <span class="o">=</span> <span class="n">computeSampleR2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n_valid</span><span class="p">,</span> <span class="n">numberAttempts</span><span class="p">,</span> <span class="n">maxDegree</span><span class="p">)</span>
<span class="n">plotR2Boxplots</span><span class="p">(</span><span class="n">r2Sample</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_002.png" srcset="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_002.png" alt="N=20" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Degree = 1
Degree = 2
Degree = 3
Degree = 4
</pre></div>
</div>
<p>We see that when the size of the design of experiments is as small as 20, it is more appropriate to use a very low degree polynomial. Here 1 performs best and 4 is risky.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># size of the train design</span>
<span class="n">r2Sample</span> <span class="o">=</span> <span class="n">computeSampleR2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n_valid</span><span class="p">,</span> <span class="n">numberAttempts</span><span class="p">,</span> <span class="n">maxDegree</span><span class="p">)</span>
<span class="n">plotR2Boxplots</span><span class="p">(</span><span class="n">r2Sample</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_003.png" srcset="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_003.png" alt="N=30" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Degree = 1
Degree = 2
Degree = 3
Degree = 4
</pre></div>
</div>
<p>With a 30-point design set, a polynomial degree of 2 is usually advisable.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># size of the train design</span>
<span class="n">r2Sample</span> <span class="o">=</span> <span class="n">computeSampleR2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n_valid</span><span class="p">,</span> <span class="n">numberAttempts</span><span class="p">,</span> <span class="n">maxDegree</span><span class="p">)</span>
<span class="n">plotR2Boxplots</span><span class="p">(</span><span class="n">r2Sample</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_004.png" srcset="../../_images/sphx_glr_plot_chaos_beam_sensitivity_degree_004.png" alt="N=50" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Degree = 1
Degree = 2
Degree = 3
Degree = 4
</pre></div>
</div>
<p>When the sample size increases, the <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC4yIC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEzLjI0MjY5OHB0JyBoZWlnaHQ9JzkuNDc0NzM5cHQnIHZpZXdCb3g9JzAgLTkuNDc0NzM5IDEzLjI0MjY5OCA5LjQ3NDczOSc+CjxkZWZzPgo8cGF0aCBpZD0nZzEtNTAnIGQ9J00yLjI0NzU3Mi0xLjYyNTkwM0MyLjM3NTA5My0xLjc0NTQ1NSAyLjcwOTgzOC0yLjAwODQ2OCAyLjgzNzM2LTIuMTIwMDVDMy4zMzE1MDctMi41NzQzNDYgMy44MDE3NDMtMy4wMTI3MDIgMy44MDE3NDMtMy43Mzc5ODNDMy44MDE3NDMtNC42ODY0MjYgMy4wMDQ3MzItNS4zMDAxMjUgMi4wMDg0NjgtNS4zMDAxMjVDMS4wNTIwNTUtNS4zMDAxMjUgLjQyMjQxNi00LjU3NDg0NCAuNDIyNDE2LTMuODY1NTA0Qy40MjI0MTYtMy40NzQ5NjkgLjczMzI1LTMuNDE5MTc4IC44NDQ4MzItMy40MTkxNzhDMS4wMTIyMDQtMy40MTkxNzggMS4yNTkyNzgtMy41Mzg3MyAxLjI1OTI3OC0zLjg0MTU5NEMxLjI1OTI3OC00LjI1NjA0IC44NjA3NzItNC4yNTYwNCAuNzY1MTMxLTQuMjU2MDRDLjk5NjI2NC00LjgzNzg1OCAxLjUzMDI2Mi01LjAzNzExMSAxLjkyMDc5Ny01LjAzNzExMUMyLjY2MjAxNy01LjAzNzExMSAzLjA0NDU4My00LjQwNzQ3MiAzLjA0NDU4My0zLjczNzk4M0MzLjA0NDU4My0yLjkwOTA5MSAyLjQ2Mjc2NS0yLjMwMzM2MiAxLjUyMjI5MS0xLjMzODk3OUwuNTE4MDU3LS4zMDI4NjRDLjQyMjQxNi0uMjE1MTkzIC40MjI0MTYtLjE5OTI1MyAuNDIyNDE2IDBIMy41NzA2MUwzLjgwMTc0My0xLjQyNjY1SDMuNTU0NjdDMy41MzA3Ni0xLjI2NzI0OCAzLjQ2Njk5OS0uODY4NzQyIDMuMzcxMzU3LS43MTczMUMzLjMyMzUzNy0uNjUzNTQ5IDIuNzE3ODA4LS42NTM1NDkgMi41OTAyODYtLjY1MzU0OUgxLjE3MTYwNkwyLjI0NzU3Mi0xLjYyNTkwM1onLz4KPHBhdGggaWQ9J2cwLTgyJyBkPSdNNC4zOTk1MDItNy4zNTI0MjhDNC41MDcwOTgtNy43OTQ3NyA0LjU1NDkxOS03LjgxODY4IDUuMDIxMTcxLTcuODE4NjhINS44ODE5NDNDNi45MTAwODctNy44MTg2OCA3LjY3NTIxOC03LjUwNzg0NiA3LjY3NTIxOC02LjU3NTM0MkM3LjY3NTIxOC01Ljk2NTYyOSA3LjM2NDM4NC00LjIwODIxOSA0Ljk2MTM5NS00LjIwODIxOUgzLjYxMDQ2MUw0LjM5OTUwMi03LjM1MjQyOFpNNi4wNjEyNy00LjA2NDc1N0M3LjU0MzcxMS00LjM4NzU0NyA4LjcwMzM2Mi01LjM0Mzk2IDguNzAzMzYyLTYuMzcyMTA1QzguNzAzMzYyLTcuMzA0NjA4IDcuNzU4OTA0LTguMTY1MzggNi4wOTcxMzYtOC4xNjUzOEgyLjg1NzI4NUMyLjYxODE4Mi04LjE2NTM4IDIuNTEwNTg1LTguMTY1MzggMi41MTA1ODUtNy45MzgyMzJDMi41MTA1ODUtNy44MTg2OCAyLjU5NDI3MS03LjgxODY4IDIuODIxNDItNy44MTg2OEMzLjUzODczLTcuODE4NjggMy41Mzg3My03LjcyMzAzOSAzLjUzODczLTcuNTkxNTMyQzMuNTM4NzMtNy41Njc2MjEgMy41Mzg3My03LjQ5NTg5IDMuNDkwOTA5LTcuMzE2NTYzTDEuODc2OTYxLS44ODQ2ODJDMS43NjkzNjUtLjQ2NjI1MiAxLjc0NTQ1NS0uMzQ2NyAuOTIwNTQ4LS4zNDY3Qy42NDU1NzktLjM0NjcgLjU2MTg5My0uMzQ2NyAuNTYxODkzLS4xMTk1NTJDLjU2MTg5MyAwIC42OTM0IDAgLjcyOTI2NSAwQy45NDQ0NTggMCAxLjE5NTUxNy0uMDIzOTEgMS40MjI2NjUtLjAyMzkxSDIuODMzMzc1QzMuMDQ4NTY4LS4wMjM5MSAzLjI5OTYyNiAwIDMuNTE0ODE5IDBDMy42MTA0NjEgMCAzLjc0MTk2OCAwIDMuNzQxOTY4LS4yMjcxNDhDMy43NDE5NjgtLjM0NjcgMy42MzQzNzEtLjM0NjcgMy40NTUwNDQtLjM0NjdDMi43MjU3NzgtLjM0NjcgMi43MjU3NzgtLjQ0MjM0MSAyLjcyNTc3OC0uNTYxODkzQzIuNzI1Nzc4LS41NzM4NDggMi43MjU3NzgtLjY1NzUzNCAyLjc0OTY4OS0uNzUzMTc2TDMuNTUwNjg1LTMuOTY5MTE2SDQuOTg1MzA1QzYuMTIxMDQ2LTMuOTY5MTE2IDYuMzM2MjM5LTMuMjUxODA2IDYuMzM2MjM5LTIuODU3Mjg1QzYuMzM2MjM5LTIuNjc3OTU4IDYuMjE2Njg3LTIuMjExNzA2IDYuMTMzMDAxLTEuOTAwODcyQzYuMDAxNDk0LTEuMzUwOTM0IDUuOTY1NjI5LTEuMjE5NDI3IDUuOTY1NjI5LS45OTIyNzlDNS45NjU2MjktLjE0MzQ2MiA2LjY1OTAyOSAuMjUxMDU5IDcuNDYwMDI1IC4yNTEwNTlDOC40MjgzOTQgLjI1MTA1OSA4Ljg0NjgyNC0uOTMyNTAzIDguODQ2ODI0LTEuMDk5ODc1QzguODQ2ODI0LTEuMTgzNTYyIDguNzg3MDQ5LTEuMjE5NDI3IDguNzE1MzE4LTEuMjE5NDI3QzguNjE5Njc2LTEuMjE5NDI3IDguNTk1NzY2LTEuMTQ3Njk2IDguNTcxODU2LTEuMDUyMDU1QzguMjg0OTMyLS4yMDMyMzggNy43OTQ3NyAuMDExOTU1IDcuNDk1ODkgLjAxMTk1NVM3LjAwNTcyOS0uMTE5NTUyIDcuMDA1NzI5LS42NTc1MzRDNy4wMDU3MjktLjk0NDQ1OCA3LjE0OTE5MS0yLjAzMjM3OSA3LjE2MTE0Ni0yLjA5MjE1NEM3LjIyMDkyMi0yLjUzNDQ5NiA3LjIyMDkyMi0yLjU4MjMxNiA3LjIyMDkyMi0yLjY3Nzk1OEM3LjIyMDkyMi0zLjU1MDY4NSA2LjUxNTU2Ny0zLjkyMTI5NSA2LjA2MTI3LTQuMDY0NzU3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTgyJy8+Cjx1c2UgeD0nOS4wMDg1MTUnIHk9Jy00LjMzODQzNycgeGxpbms6aHJlZj0nI2cxLTUwJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9MCAtLT4=" alt="R^2" style="vertical-align: 0px"/> computation becomes less sensitive to the polynomial degree.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>We observe that on the cantilever beam example, to use a polynomial total
degree equal to 4, we need a sample size at least equal to 50 to get a
satisfactory and reproducible <img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNC4yIC0tPgo8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEzLjI0MjY5OHB0JyBoZWlnaHQ9JzkuNDc0NzM5cHQnIHZpZXdCb3g9JzAgLTkuNDc0NzM5IDEzLjI0MjY5OCA5LjQ3NDczOSc+CjxkZWZzPgo8cGF0aCBpZD0nZzEtNTAnIGQ9J00yLjI0NzU3Mi0xLjYyNTkwM0MyLjM3NTA5My0xLjc0NTQ1NSAyLjcwOTgzOC0yLjAwODQ2OCAyLjgzNzM2LTIuMTIwMDVDMy4zMzE1MDctMi41NzQzNDYgMy44MDE3NDMtMy4wMTI3MDIgMy44MDE3NDMtMy43Mzc5ODNDMy44MDE3NDMtNC42ODY0MjYgMy4wMDQ3MzItNS4zMDAxMjUgMi4wMDg0NjgtNS4zMDAxMjVDMS4wNTIwNTUtNS4zMDAxMjUgLjQyMjQxNi00LjU3NDg0NCAuNDIyNDE2LTMuODY1NTA0Qy40MjI0MTYtMy40NzQ5NjkgLjczMzI1LTMuNDE5MTc4IC44NDQ4MzItMy40MTkxNzhDMS4wMTIyMDQtMy40MTkxNzggMS4yNTkyNzgtMy41Mzg3MyAxLjI1OTI3OC0zLjg0MTU5NEMxLjI1OTI3OC00LjI1NjA0IC44NjA3NzItNC4yNTYwNCAuNzY1MTMxLTQuMjU2MDRDLjk5NjI2NC00LjgzNzg1OCAxLjUzMDI2Mi01LjAzNzExMSAxLjkyMDc5Ny01LjAzNzExMUMyLjY2MjAxNy01LjAzNzExMSAzLjA0NDU4My00LjQwNzQ3MiAzLjA0NDU4My0zLjczNzk4M0MzLjA0NDU4My0yLjkwOTA5MSAyLjQ2Mjc2NS0yLjMwMzM2MiAxLjUyMjI5MS0xLjMzODk3OUwuNTE4MDU3LS4zMDI4NjRDLjQyMjQxNi0uMjE1MTkzIC40MjI0MTYtLjE5OTI1MyAuNDIyNDE2IDBIMy41NzA2MUwzLjgwMTc0My0xLjQyNjY1SDMuNTU0NjdDMy41MzA3Ni0xLjI2NzI0OCAzLjQ2Njk5OS0uODY4NzQyIDMuMzcxMzU3LS43MTczMUMzLjMyMzUzNy0uNjUzNTQ5IDIuNzE3ODA4LS42NTM1NDkgMi41OTAyODYtLjY1MzU0OUgxLjE3MTYwNkwyLjI0NzU3Mi0xLjYyNTkwM1onLz4KPHBhdGggaWQ9J2cwLTgyJyBkPSdNNC4zOTk1MDItNy4zNTI0MjhDNC41MDcwOTgtNy43OTQ3NyA0LjU1NDkxOS03LjgxODY4IDUuMDIxMTcxLTcuODE4NjhINS44ODE5NDNDNi45MTAwODctNy44MTg2OCA3LjY3NTIxOC03LjUwNzg0NiA3LjY3NTIxOC02LjU3NTM0MkM3LjY3NTIxOC01Ljk2NTYyOSA3LjM2NDM4NC00LjIwODIxOSA0Ljk2MTM5NS00LjIwODIxOUgzLjYxMDQ2MUw0LjM5OTUwMi03LjM1MjQyOFpNNi4wNjEyNy00LjA2NDc1N0M3LjU0MzcxMS00LjM4NzU0NyA4LjcwMzM2Mi01LjM0Mzk2IDguNzAzMzYyLTYuMzcyMTA1QzguNzAzMzYyLTcuMzA0NjA4IDcuNzU4OTA0LTguMTY1MzggNi4wOTcxMzYtOC4xNjUzOEgyLjg1NzI4NUMyLjYxODE4Mi04LjE2NTM4IDIuNTEwNTg1LTguMTY1MzggMi41MTA1ODUtNy45MzgyMzJDMi41MTA1ODUtNy44MTg2OCAyLjU5NDI3MS03LjgxODY4IDIuODIxNDItNy44MTg2OEMzLjUzODczLTcuODE4NjggMy41Mzg3My03LjcyMzAzOSAzLjUzODczLTcuNTkxNTMyQzMuNTM4NzMtNy41Njc2MjEgMy41Mzg3My03LjQ5NTg5IDMuNDkwOTA5LTcuMzE2NTYzTDEuODc2OTYxLS44ODQ2ODJDMS43NjkzNjUtLjQ2NjI1MiAxLjc0NTQ1NS0uMzQ2NyAuOTIwNTQ4LS4zNDY3Qy42NDU1NzktLjM0NjcgLjU2MTg5My0uMzQ2NyAuNTYxODkzLS4xMTk1NTJDLjU2MTg5MyAwIC42OTM0IDAgLjcyOTI2NSAwQy45NDQ0NTggMCAxLjE5NTUxNy0uMDIzOTEgMS40MjI2NjUtLjAyMzkxSDIuODMzMzc1QzMuMDQ4NTY4LS4wMjM5MSAzLjI5OTYyNiAwIDMuNTE0ODE5IDBDMy42MTA0NjEgMCAzLjc0MTk2OCAwIDMuNzQxOTY4LS4yMjcxNDhDMy43NDE5NjgtLjM0NjcgMy42MzQzNzEtLjM0NjcgMy40NTUwNDQtLjM0NjdDMi43MjU3NzgtLjM0NjcgMi43MjU3NzgtLjQ0MjM0MSAyLjcyNTc3OC0uNTYxODkzQzIuNzI1Nzc4LS41NzM4NDggMi43MjU3NzgtLjY1NzUzNCAyLjc0OTY4OS0uNzUzMTc2TDMuNTUwNjg1LTMuOTY5MTE2SDQuOTg1MzA1QzYuMTIxMDQ2LTMuOTY5MTE2IDYuMzM2MjM5LTMuMjUxODA2IDYuMzM2MjM5LTIuODU3Mjg1QzYuMzM2MjM5LTIuNjc3OTU4IDYuMjE2Njg3LTIuMjExNzA2IDYuMTMzMDAxLTEuOTAwODcyQzYuMDAxNDk0LTEuMzUwOTM0IDUuOTY1NjI5LTEuMjE5NDI3IDUuOTY1NjI5LS45OTIyNzlDNS45NjU2MjktLjE0MzQ2MiA2LjY1OTAyOSAuMjUxMDU5IDcuNDYwMDI1IC4yNTEwNTlDOC40MjgzOTQgLjI1MTA1OSA4Ljg0NjgyNC0uOTMyNTAzIDguODQ2ODI0LTEuMDk5ODc1QzguODQ2ODI0LTEuMTgzNTYyIDguNzg3MDQ5LTEuMjE5NDI3IDguNzE1MzE4LTEuMjE5NDI3QzguNjE5Njc2LTEuMjE5NDI3IDguNTk1NzY2LTEuMTQ3Njk2IDguNTcxODU2LTEuMDUyMDU1QzguMjg0OTMyLS4yMDMyMzggNy43OTQ3NyAuMDExOTU1IDcuNDk1ODkgLjAxMTk1NVM3LjAwNTcyOS0uMTE5NTUyIDcuMDA1NzI5LS42NTc1MzRDNy4wMDU3MjktLjk0NDQ1OCA3LjE0OTE5MS0yLjAzMjM3OSA3LjE2MTE0Ni0yLjA5MjE1NEM3LjIyMDkyMi0yLjUzNDQ5NiA3LjIyMDkyMi0yLjU4MjMxNiA3LjIyMDkyMi0yLjY3Nzk1OEM3LjIyMDkyMi0zLjU1MDY4NSA2LjUxNTU2Ny0zLjkyMTI5NSA2LjA2MTI3LTQuMDY0NzU3WicvPgo8L2RlZnM+CjxnIGlkPSdwYWdlMSc+Cjx1c2UgeD0nMCcgeT0nMCcgeGxpbms6aHJlZj0nI2cwLTgyJy8+Cjx1c2UgeD0nOS4wMDg1MTUnIHk9Jy00LjMzODQzNycgeGxpbms6aHJlZj0nI2cxLTUwJy8+CjwvZz4KPC9zdmc+CjwhLS0gREVQVEg9MCAtLT4=" alt="R^2" style="vertical-align: 0px"/> .
When the degree is equal to 4, if the sample size is small, then depending on the
particular sample, the predictivity coefficient can be very low (i.e., less than 0.5).
With a sample size as small as 20, a polynomial degree of 1 is safer.
However the limited sample size may have an impact on other statistics that
could be derived from a metamodel calculated on such a small training sample.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>“Metamodel-Based Sensitivity Analysis: Polynomial Chaos Expansions and Gaussian Processes”, Loïc Le Gratiet, Stefano Marelli, Bruno Sudret,
Handbook of Uncertainty Quantification, 2017, Springer International Publishing.</p></li>
</ul>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 3.638 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-meta-modeling-polynomial-chaos-metamodel-plot-chaos-beam-sensitivity-degree-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/bfea7e736d44ac4ec92f9c0611072539/plot_chaos_beam_sensitivity_degree.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_chaos_beam_sensitivity_degree.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a9caed05485a41904a724475a371c2f5/plot_chaos_beam_sensitivity_degree.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_chaos_beam_sensitivity_degree.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7b02572378003f7f5b8c26c7fe775e7f/plot_chaos_beam_sensitivity_degree.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_chaos_beam_sensitivity_degree.zip</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_chaos_cleaning_strategy.html" title="Create a sparse chaos by integration"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_enumeratefunction.html" title="Plot enumeration rules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.25dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Polynomial chaos metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Polynomial chaos is sensitive to the degree</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2005-2025 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>