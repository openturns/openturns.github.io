<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>EfficientGlobalOptimization examples &#8212; OpenTURNS 1.27dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css?v=105494d3" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=4652c2b6" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sphx_glr.css?v=2ae27345" />
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=c75cadd3"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script src="../../_static/js/mysearchtools.js?v=40848abd"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Iterative statistics" href="../iterative_statistics/index.html" />
    <link rel="prev" title="Optimization using dlib" href="plot_optimization_dlib.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../iterative_statistics/index.html" title="Iterative statistics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_optimization_dlib.html" title="Optimization using dlib"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.27dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Numerical methods</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Optimization</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">EfficientGlobalOptimization examples</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">EfficientGlobalOptimization examples</a><ul>
<li><a class="reference internal" href="#ackley-test-case">Ackley test-case</a><ul>
<li><a class="reference internal" href="#define-the-problem">Define the problem</a></li>
<li><a class="reference internal" href="#create-the-initial-gp">Create the initial GP</a></li>
<li><a class="reference internal" href="#create-the-optimization-problem">Create the optimization problem</a></li>
</ul>
</li>
<li><a class="reference internal" href="#branin-test-case">Branin test-case</a><ul>
<li><a class="reference internal" href="#id4">Define the problem</a></li>
<li><a class="reference internal" href="#id5">Create the initial GP</a></li>
<li><a class="reference internal" href="#create-and-solve-the-problem">Create and solve the problem</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_optimization_dlib.html"
                          title="previous chapter">Optimization using dlib</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../iterative_statistics/index.html"
                          title="next chapter">Iterative statistics</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_numerical_methods/optimization/plot_ego.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-numerical-methods-optimization-plot-ego-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="efficientglobaloptimization-examples">
<span id="sphx-glr-auto-numerical-methods-optimization-plot-ego-py"></span><h1>EfficientGlobalOptimization examples<a class="headerlink" href="#efficientglobaloptimization-examples" title="Link to this heading">¶</a></h1>
<p>The EGO algorithm <a class="reference internal" href="../../bibliography.html#jones1998" id="id1"><span>[jones1998]</span></a> is an adaptative optimization method based on
Gaussian Process metamodel.</p>
<p>An initial design of experiment is used to build a first metamodel.
At each iteration a new point that maximizes a criterion is chosen as
optimizer candidate.</p>
<p>The criterion uses a tradeoff between the metamodel value and the conditional
variance.</p>
<p>Then the new point is evaluated using the original model and the metamodel is
relearnt on the extended design of experiments.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">openturns.usecases</span><span class="w"> </span><span class="kn">import</span> <span class="n">branin_function</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openturns.usecases</span><span class="w"> </span><span class="kn">import</span> <span class="n">ackley_function</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns.experimental</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">otexp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns.viewer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">otv</span>
</pre></div>
</div>
<section id="ackley-test-case">
<h2>Ackley test-case<a class="headerlink" href="#ackley-test-case" title="Link to this heading">¶</a></h2>
<p>We first apply the EGO algorithm on the <a class="reference internal" href="../../usecases/use_case_ackley.html#use-case-ackley"><span class="std std-ref">Ackley function</span></a>.</p>
<section id="define-the-problem">
<h3>Define the problem<a class="headerlink" href="#define-the-problem" title="Link to this heading">¶</a></h3>
<p>The Ackley model is defined in the usecases module in a data class <cite>AckleyModel</cite> :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">am</span> <span class="o">=</span> <span class="n">ackley_function</span><span class="o">.</span><span class="n">AckleyModel</span><span class="p">()</span>
</pre></div>
</div>
<p>We get the Ackley function :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">model</span>
</pre></div>
</div>
<p>We specify the domain of the model :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dim</span>
<span class="n">lowerbound</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
<span class="n">upperbound</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</pre></div>
</div>
<p>We know that the global minimum is at the center of the domain. It is stored in the <cite>AckleyModel</cite> data class.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">xexact</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">x0</span>
</pre></div>
</div>
<p>The minimum value attained <cite>fexact</cite> is :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fexact</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xexact</span><span class="p">)</span>
<span class="n">fexact</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
class=Point name=Unnamed dimension=1 values=[4.44089e-16]
</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">lowerbound</span><span class="p">,</span> <span class="n">upperbound</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Ackley function&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_001.svg" srcset="../../_images/sphx_glr_plot_ego_001.svg" alt="Ackley function" class = "sphx-glr-single-img"/><p>We see that the Ackley function has many local minimas. The global minimum, however, is unique and located at the center of the domain.</p>
</section>
<section id="create-the-initial-gp">
<h3>Create the initial GP<a class="headerlink" href="#create-the-initial-gp" title="Link to this heading">¶</a></h3>
<p>Before using the EGO algorithm, we must create an initial GP metamodel.
In order to do this, we must create a design of experiment which fills the space.
In this situation, the <a class="reference internal" href="../../user_manual/_generated/openturns.LHSExperiment.html#openturns.LHSExperiment" title="openturns.LHSExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">LHSExperiment</span></code></a> is a good place to start (but other design of experiments may allow one to better fill the space).
We use a uniform distribution in order to create a LHS design.
The length of the first LHS is set to ten times the problem dimension as recommended in <a class="reference internal" href="../../bibliography.html#jones1998" id="id2"><span>[jones1998]</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">listUniformDistributions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">lowerbound</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">upperbound</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">(</span><span class="n">listUniformDistributions</span><span class="p">)</span>
<span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">dim</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LHSExperiment</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">sampleSize</span><span class="p">)</span>
<span class="n">inputSample</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">outputSample</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="s2">&quot;Initial LHS design of experiment - n=</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sampleSize</span><span class="p">),</span> <span class="s2">&quot;$x_0$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1$&quot;</span><span class="p">,</span> <span class="kc">True</span>
<span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_002.svg" srcset="../../_images/sphx_glr_plot_ego_002.svg" alt="Initial LHS design of experiment - n=20" class = "sphx-glr-single-img"/><p>We now create the GP metamodel.
We selected the <a class="reference internal" href="../../user_manual/_generated/openturns.MaternModel.html#openturns.MaternModel" title="openturns.MaternModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternModel</span></code></a> covariance model with a constant basis as recommended in <a class="reference internal" href="../../bibliography.html#leriche2021" id="id3"><span>[leriche2021]</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">covarianceModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MaternModel</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ConstantBasisFactory</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">fitter</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianProcessFitter</span><span class="p">(</span><span class="n">inputSample</span><span class="p">,</span> <span class="n">outputSample</span><span class="p">,</span> <span class="n">covarianceModel</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">fitter</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">gpr</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianProcessRegression</span><span class="p">(</span><span class="n">fitter</span><span class="o">.</span><span class="n">getResult</span><span class="p">())</span>
<span class="n">gpr</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="create-the-optimization-problem">
<h3>Create the optimization problem<a class="headerlink" href="#create-the-optimization-problem" title="Link to this heading">¶</a></h3>
<p>We finally create the <a class="reference internal" href="../../user_manual/_generated/openturns.OptimizationProblem.html#openturns.OptimizationProblem" title="openturns.OptimizationProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizationProblem</span></code></a> and solve it with class:<cite>~openturns.EfficientGlobalOptimization</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">OptimizationProblem</span><span class="p">()</span>
<span class="n">problem</span><span class="o">.</span><span class="n">setObjective</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">lowerbound</span><span class="p">,</span> <span class="n">upperbound</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to show the various options, we configure them all, even if most could be left to default settings in this case.</p>
<p>The most important method is <a class="reference internal" href="../../user_manual/_generated/openturns.experimental.EfficientGlobalOptimization.html#openturns.experimental.EfficientGlobalOptimization.setMaximumCallsNumber" title="openturns.experimental.EfficientGlobalOptimization.setMaximumCallsNumber"><code class="xref py py-class docutils literal notranslate"><span class="pre">setMaximumCallsNumber</span></code></a> which limits the number of iterations that the algorithm can perform.
In the Ackley example, we choose to perform 30 iterations of the algorithm.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">EfficientGlobalOptimization</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">gpr</span><span class="o">.</span><span class="n">getResult</span><span class="p">())</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumCallsNumber</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">getIterationNumber</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">getOptimalPoint</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
class=Point name=Unnamed dimension=2 values=[-0.00627535,-0.00519684]
</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">getOptimalValue</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
class=Point name=Unnamed dimension=1 values=[0.0248125]
</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fexact</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
class=Point name=Unnamed dimension=1 values=[4.44089e-16]
</div>
<br />
<br /><p>Compared to the minimum function value, we see that the EGO algorithm
provides solution which is accurate.
Indeed, the optimal point is in the neighbourhood of the exact solution,
and this is quite an impressive success given the limited amount of function
evaluations: only 20 evaluations for the initial DOE and 30 iterations of
the EGO algorithm, for a total equal to 50 function evaluations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">drawOptimalValueHistory</span><span class="p">()</span>
<span class="n">optimum_curve</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fexact</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="n">fexact</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">optimum_curve</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_003.svg" srcset="../../_images/sphx_glr_plot_ego_003.svg" alt="Optimal value history" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">inputHistory</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getInputSample</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">lowerbound</span><span class="p">,</span> <span class="n">upperbound</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Ackley function&quot;</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">inputSample</span><span class="p">,</span> <span class="s2">&quot;initial&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;bullet&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">inputHistory</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_004.svg" srcset="../../_images/sphx_glr_plot_ego_004.svg" alt="Ackley function" class = "sphx-glr-single-img"/><p>We see that the initial (black) points are dispersed in the whole domain,
while the solution points are much closer to the solution.</p>
</section>
</section>
<section id="branin-test-case">
<h2>Branin test-case<a class="headerlink" href="#branin-test-case" title="Link to this heading">¶</a></h2>
<p>We now take a look at the <a class="reference internal" href="../../usecases/use_case_branin.html#use-case-branin"><span class="std std-ref">Branin-Hoo</span></a> function.</p>
<section id="id4">
<h3>Define the problem<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>The Branin model is defined in the usecases module in a data class <cite>BraninModel</cite> :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">bm</span> <span class="o">=</span> <span class="n">branin_function</span><span class="o">.</span><span class="n">BraninModel</span><span class="p">()</span>
</pre></div>
</div>
<p>We load the dimension,</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">dim</span>
</pre></div>
</div>
<p>the domain boundaries,</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lowerbound</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">lowerbound</span>
<span class="n">upperbound</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">upperbound</span>
</pre></div>
</div>
<p>and we load the model function and its noise:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">objectiveFunction</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">model</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">trueNoiseFunction</span>
</pre></div>
</div>
<p>We build a sample out of the three minima :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">xexact</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([</span><span class="n">bm</span><span class="o">.</span><span class="n">xexact1</span><span class="p">,</span> <span class="n">bm</span><span class="o">.</span><span class="n">xexact2</span><span class="p">,</span> <span class="n">bm</span><span class="o">.</span><span class="n">xexact3</span><span class="p">])</span>
</pre></div>
</div>
<p>The minimum value attained <cite>fexact</cite> is :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fexact</span> <span class="o">=</span> <span class="n">objectiveFunction</span><span class="p">(</span><span class="n">xexact</span><span class="p">)</span>
<span class="n">fexact</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>y0</th></tr>
  <tr><th>0</th><td>-1.04741</td></tr>
  <tr><th>1</th><td>-1.04741</td></tr>
  <tr><th>2</th><td>-1.04741</td></tr>
</table>
</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">objectiveFunction</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">lowerbound</span><span class="p">,</span> <span class="n">upperbound</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Branin function&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_005.svg" srcset="../../_images/sphx_glr_plot_ego_005.svg" alt="Branin function" class = "sphx-glr-single-img"/><p>The Branin function has three local minimas.</p>
</section>
<section id="id5">
<h3>Create the initial GP<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">([</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
<span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">dim</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LHSExperiment</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">sampleSize</span><span class="p">)</span>
<span class="n">inputSample</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">outputSample</span> <span class="o">=</span> <span class="n">objectiveFunction</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="s2">&quot;Initial LHS design of experiment - n=</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sampleSize</span><span class="p">),</span> <span class="s2">&quot;$x_0$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1$&quot;</span><span class="p">,</span> <span class="kc">True</span>
<span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_006.svg" srcset="../../_images/sphx_glr_plot_ego_006.svg" alt="Initial LHS design of experiment - n=20" class = "sphx-glr-single-img"/><p>Configure the covariance model with the noise</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">covarianceModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MaternModel</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">covarianceModel</span><span class="o">.</span><span class="n">setNuggetFactor</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p>Build the initial GP</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ConstantBasisFactory</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">fitter</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianProcessFitter</span><span class="p">(</span><span class="n">inputSample</span><span class="p">,</span> <span class="n">outputSample</span><span class="p">,</span> <span class="n">covarianceModel</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">fitter</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">gpr</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianProcessRegression</span><span class="p">(</span><span class="n">fitter</span><span class="o">.</span><span class="n">getResult</span><span class="p">())</span>
<span class="n">gpr</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="create-and-solve-the-problem">
<h3>Create and solve the problem<a class="headerlink" href="#create-and-solve-the-problem" title="Link to this heading">¶</a></h3>
<p>We define the problem :</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">OptimizationProblem</span><span class="p">()</span>
<span class="n">problem</span><span class="o">.</span><span class="n">setObjective</span><span class="p">(</span><span class="n">objectiveFunction</span><span class="p">)</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">lowerbound</span><span class="p">,</span> <span class="n">upperbound</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
<p>We configure the algorithm
the nugget factor set in the covariance model with enable the AEI formulation</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">EfficientGlobalOptimization</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">gpr</span><span class="o">.</span><span class="n">getResult</span><span class="p">())</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumCallsNumber</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>We run the algorithm and get the result:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">getIterationNumber</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">getOptimalPoint</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
class=Point name=Unnamed dimension=2 values=[0.541996,0.152001]
</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">getOptimalValue</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
class=Point name=Unnamed dimension=1 values=[-1.0474]
</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fexact</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>y0</th></tr>
  <tr><th>0</th><td>-1.04741</td></tr>
  <tr><th>1</th><td>-1.04741</td></tr>
  <tr><th>2</th><td>-1.04741</td></tr>
</table>
</div>
<br />
<br /><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">inputHistory</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getInputSample</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">objectiveFunction</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">lowerbound</span><span class="p">,</span> <span class="n">upperbound</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Branin function&quot;</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">inputSample</span><span class="p">,</span> <span class="s2">&quot;initial&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;bullet&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">inputHistory</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="s2">&quot;diamond&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_007.svg" srcset="../../_images/sphx_glr_plot_ego_007.svg" alt="Branin function" class = "sphx-glr-single-img"/><p>We see that the EGO algorithm reached the different optima locations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">drawOptimalValueHistory</span><span class="p">()</span>
<span class="n">optimum_curve</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fexact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="n">fexact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]]))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">optimum_curve</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">axes_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;xticks&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">getIterationNumber</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ego_008.svg" srcset="../../_images/sphx_glr_plot_ego_008.svg" alt="Optimal value history" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-numerical-methods-optimization-plot-ego-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b663e1b1b3c4d94b9641214799794e94/plot_ego.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_ego.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4346f1b4e6973c226ebe5a1caa84d80e/plot_ego.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_ego.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e7cb924eb73aeb5b6383aceafde32e04/plot_ego.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_ego.zip</span></code></a></p>
</div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../iterative_statistics/index.html" title="Iterative statistics"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_optimization_dlib.html" title="Optimization using dlib"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.27dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Numerical methods</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Optimization</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">EfficientGlobalOptimization examples</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>