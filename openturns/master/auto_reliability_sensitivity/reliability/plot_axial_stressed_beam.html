
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Axial stressed beam : comparing different methods to estimate a probability &#8212; OpenTURNS 1.20dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Create unions or intersections of events" href="plot_event_system.html" />
    <link rel="prev" title="Test the design point with the Strong Maximum Test" href="plot_strong_maximum_test.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_event_system.html" title="Create unions or intersections of events"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_strong_maximum_test.html" title="Test the design point with the Strong Maximum Test"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Reliability</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Axial stressed beam : comparing different methods to estimate a probability</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Axial stressed beam : comparing different methods to estimate a probability</a><ul>
<li><a class="reference internal" href="#define-the-model">Define the model</a></li>
<li><a class="reference internal" href="#using-monte-carlo-simulations">Using Monte Carlo simulations</a></li>
<li><a class="reference internal" href="#using-form-analysis">Using FORM analysis</a></li>
<li><a class="reference internal" href="#using-directional-sampling">Using Directional sampling</a></li>
<li><a class="reference internal" href="#using-importance-sampling-with-form-design-point-form-is">Using importance sampling with FORM design point: FORM-IS</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_strong_maximum_test.html"
                          title="previous chapter">Test the design point with the Strong Maximum Test</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_event_system.html"
                          title="next chapter">Create unions or intersections of events</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/reliability/plot_axial_stressed_beam.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-reliability-plot-axial-stressed-beam-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="axial-stressed-beam-comparing-different-methods-to-estimate-a-probability">
<span id="sphx-glr-auto-reliability-sensitivity-reliability-plot-axial-stressed-beam-py"></span><h1>Axial stressed beam : comparing different methods to estimate a probability<a class="headerlink" href="#axial-stressed-beam-comparing-different-methods-to-estimate-a-probability" title="Permalink to this heading">¶</a></h1>
<p>In this example, we compare four methods to estimate the probability in the <a class="reference internal" href="../../usecases/use_case_beam.html#use-case-stressed-beam"><span class="std std-ref">axial stressed beam</span></a> example :</p>
<ul class="simple">
<li><p>Monte-Carlo simulation,</p></li>
<li><p>FORM,</p></li>
<li><p>directional sampling,</p></li>
<li><p>importance sampling with FORM design point: FORM-IS.</p></li>
</ul>
<section id="define-the-model">
<h2>Define the model<a class="headerlink" href="#define-the-model" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">stressed_beam</span>

<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>We load the model from the usecases module :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span> <span class="o">=</span> <span class="n">stressed_beam</span><span class="o">.</span><span class="n">AxialStressedBeam</span><span class="p">()</span>
</pre></div>
</div>
<p>The limit state function is defined in the <cite>model</cite> field of the data class :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">limitStateFunction</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">model</span>
</pre></div>
</div>
<p>The probabilistic model of the axial stressed beam is defined in the data class.
We get the first marginal and draw it :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R_dist</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">distribution_R</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">R_dist</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_axial_stressed_beam_001.png" srcset="../../_images/sphx_glr_plot_axial_stressed_beam_001.png" alt="plot axial stressed beam" class = "sphx-glr-single-img"/><p>We get the second marginal and draw it :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F_dist</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">distribution_F</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">F_dist</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_axial_stressed_beam_002.png" srcset="../../_images/sphx_glr_plot_axial_stressed_beam_002.png" alt="plot axial stressed beam" class = "sphx-glr-single-img"/><p>These independent marginals define the joint distribution of the input parameters :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDistribution</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">distribution</span>
</pre></div>
</div>
<p>We create a <cite>RandomVector</cite> from the <cite>Distribution</cite>, then a composite random vector. Finally, we create a <cite>ThresholdEvent</cite> from this <cite>RandomVector</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputRandomVector</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RandomVector</span><span class="p">(</span><span class="n">myDistribution</span><span class="p">)</span>
<span class="n">outputRandomVector</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CompositeRandomVector</span><span class="p">(</span>
    <span class="n">limitStateFunction</span><span class="p">,</span> <span class="n">inputRandomVector</span><span class="p">)</span>
<span class="n">myEvent</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ThresholdEvent</span><span class="p">(</span><span class="n">outputRandomVector</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Less</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-monte-carlo-simulations">
<h2>Using Monte Carlo simulations<a class="headerlink" href="#using-monte-carlo-simulations" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">NbSim</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MonteCarloExperiment</span><span class="p">()</span>
<span class="n">algoMC</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ProbabilitySimulationAlgorithm</span><span class="p">(</span><span class="n">myEvent</span><span class="p">,</span> <span class="n">experiment</span><span class="p">)</span>
<span class="n">algoMC</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="n">NbSim</span><span class="p">)</span>
<span class="n">algoMC</span><span class="o">.</span><span class="n">setBlockSize</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">algoMC</span><span class="o">.</span><span class="n">setMaximumCoefficientOfVariation</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>
</div>
<p>For statistics about the algorithm</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialNumberOfCall</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span>
</pre></div>
</div>
<p>Perform the analysis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algoMC</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">algoMC</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">probabilityMonteCarlo</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">()</span>
<span class="n">numberOfFunctionEvaluationsMonteCarlo</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span> <span class="o">-</span> \
    <span class="n">initialNumberOfCall</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of calls to the limit state =&#39;</span><span class="p">,</span>
      <span class="n">numberOfFunctionEvaluationsMonteCarlo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pf = &#39;</span><span class="p">,</span> <span class="n">probabilityMonteCarlo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CV =&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">getCoefficientOfVariation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of calls to the limit state = 13243
Pf =  0.02937400891036782
CV = 0.0499518017330141
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">algoMC</span><span class="o">.</span><span class="n">drawProbabilityConvergence</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLogScale</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">GraphImplementation</span><span class="o">.</span><span class="n">LOGX</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_axial_stressed_beam_003.png" srcset="../../_images/sphx_glr_plot_axial_stressed_beam_003.png" alt="ProbabilitySimulationAlgorithm convergence graph at level 0.95" class = "sphx-glr-single-img"/></section>
<section id="using-form-analysis">
<h2>Using FORM analysis<a class="headerlink" href="#using-form-analysis" title="Permalink to this heading">¶</a></h2>
<p>We create a NearestPoint algorithm</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myCobyla</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cobyla</span><span class="p">()</span>
<span class="c1"># Resolution options:</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">myCobyla</span><span class="o">.</span><span class="n">setMaximumEvaluationNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">myCobyla</span><span class="o">.</span><span class="n">setMaximumAbsoluteError</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
<span class="n">myCobyla</span><span class="o">.</span><span class="n">setMaximumRelativeError</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
<span class="n">myCobyla</span><span class="o">.</span><span class="n">setMaximumResidualError</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
<span class="n">myCobyla</span><span class="o">.</span><span class="n">setMaximumConstraintError</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
</pre></div>
</div>
<p>For statistics about the algorithm</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialNumberOfCall</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span>
</pre></div>
</div>
<p>We create a FORM algorithm. The first parameter is a NearestPointAlgorithm. The second parameter is an event. The third parameter is a starting point for the design point research.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algoFORM</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FORM</span><span class="p">(</span><span class="n">myCobyla</span><span class="p">,</span> <span class="n">myEvent</span><span class="p">,</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getMean</span><span class="p">())</span>
</pre></div>
</div>
<p>Perform the analysis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algoFORM</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resultFORM</span> <span class="o">=</span> <span class="n">algoFORM</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">numberOfFunctionEvaluationsFORM</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span> <span class="o">-</span> \
    <span class="n">initialNumberOfCall</span>
<span class="n">probabilityFORM</span> <span class="o">=</span> <span class="n">resultFORM</span><span class="o">.</span><span class="n">getEventProbability</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of calls to the limit state =&#39;</span><span class="p">,</span> <span class="n">numberOfFunctionEvaluationsFORM</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pf =&#39;</span><span class="p">,</span> <span class="n">probabilityFORM</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of calls to the limit state = 98
Pf = 0.02998278558231473
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">resultFORM</span><span class="o">.</span><span class="n">drawImportanceFactors</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_axial_stressed_beam_004.png" srcset="../../_images/sphx_glr_plot_axial_stressed_beam_004.png" alt="Importance Factors from Design Point - Unnamed" class = "sphx-glr-single-img"/></section>
<section id="using-directional-sampling">
<h2>Using Directional sampling<a class="headerlink" href="#using-directional-sampling" title="Permalink to this heading">¶</a></h2>
<p>Resolution options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">NbSim</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">algoDS</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">DirectionalSampling</span><span class="p">(</span><span class="n">myEvent</span><span class="p">)</span>
<span class="n">algoDS</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="n">NbSim</span><span class="p">)</span>
<span class="n">algoDS</span><span class="o">.</span><span class="n">setBlockSize</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">algoDS</span><span class="o">.</span><span class="n">setMaximumCoefficientOfVariation</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>
</div>
<p>For statistics about the algorithm</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialNumberOfCall</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span>
</pre></div>
</div>
<p>Perform the analysis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algoDS</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">algoDS</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">probabilityDirectionalSampling</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">()</span>
<span class="n">numberOfFunctionEvaluationsDirectionalSampling</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span> <span class="o">-</span> \
    <span class="n">initialNumberOfCall</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of calls to the limit state =&#39;</span><span class="p">,</span>
      <span class="n">numberOfFunctionEvaluationsDirectionalSampling</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pf = &#39;</span><span class="p">,</span> <span class="n">probabilityDirectionalSampling</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CV =&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">getCoefficientOfVariation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of calls to the limit state = 9578
Pf =  0.028181577058147052
CV = 0.04991396246073696
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">algoDS</span><span class="o">.</span><span class="n">drawProbabilityConvergence</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLogScale</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">GraphImplementation</span><span class="o">.</span><span class="n">LOGX</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_axial_stressed_beam_005.png" srcset="../../_images/sphx_glr_plot_axial_stressed_beam_005.png" alt="DirectionalSampling convergence graph at level 0.95" class = "sphx-glr-single-img"/></section>
<section id="using-importance-sampling-with-form-design-point-form-is">
<h2>Using importance sampling with FORM design point: FORM-IS<a class="headerlink" href="#using-importance-sampling-with-form-design-point-form-is" title="Permalink to this heading">¶</a></h2>
<p>The <cite>getStandardSpaceDesignPoint</cite> method returns the design point in the U-space.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">standardSpaceDesignPoint</span> <span class="o">=</span> <span class="n">resultFORM</span><span class="o">.</span><span class="n">getStandardSpaceDesignPoint</span><span class="p">()</span>
<span class="n">standardSpaceDesignPoint</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[-1.59355,0.999463]</p>
</div>
<br />
<br /><p>The key point is to define the importance distribution in the U-space. To define it, we use a multivariate standard Gaussian and configure it so that the center is equal to the design point in the U-space.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dimension</span> <span class="o">=</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
<span class="n">dimension</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myImportance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
<span class="n">myImportance</span><span class="o">.</span><span class="n">setMean</span><span class="p">(</span><span class="n">standardSpaceDesignPoint</span><span class="p">)</span>
<span class="n">myImportance</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>Normal(mu = [-1.59355,0.999463], sigma = [1,1], R = [[ 1 0 ]<br>
 [ 0 1 ]])</p>
</div>
<br />
<br /><p>Create the design of experiment corresponding to importance sampling. This generates a <cite>WeightedExperiment</cite> with weights corresponding to the importance distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ImportanceSamplingExperiment</span><span class="p">(</span><span class="n">myImportance</span><span class="p">)</span>
</pre></div>
</div>
<p>Create the standard event corresponding to the event. This transforms the original problem into the U-space, with Gaussian independent marginals.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">standardEvent</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">StandardEvent</span><span class="p">(</span><span class="n">myEvent</span><span class="p">)</span>
</pre></div>
</div>
<p>We then create the simulation algorithm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ProbabilitySimulationAlgorithm</span><span class="p">(</span><span class="n">standardEvent</span><span class="p">,</span> <span class="n">experiment</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumCoefficientOfVariation</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="mi">40000</span><span class="p">)</span>
</pre></div>
</div>
<p>For statistics about the algorithm</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialNumberOfCall</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>retrieve results</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">probabilityFORMIS</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">()</span>
<span class="n">numberOfFunctionEvaluationsFORMIS</span> <span class="o">=</span> <span class="n">limitStateFunction</span><span class="o">.</span><span class="n">getEvaluationCallsNumber</span><span class="p">()</span> <span class="o">-</span> \
    <span class="n">initialNumberOfCall</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of calls to the limit state =&#39;</span><span class="p">,</span>
      <span class="n">numberOfFunctionEvaluationsFORMIS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pf = &#39;</span><span class="p">,</span> <span class="n">probabilityFORMIS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CV =&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">getCoefficientOfVariation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of calls to the limit state = 952
Pf =  0.027582145808300113
CV = 0.049917758299132996
</pre></div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h2>
<p>We now compare the different methods in terms of accuracy and speed.</p>
<p>The following function computes the number of correct base-10 digits in the computed result compared to the exact result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeLogRelativeError</span><span class="p">(</span><span class="n">exact</span><span class="p">,</span> <span class="n">computed</span><span class="p">):</span>
    <span class="n">logRelativeError</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">exact</span> <span class="o">-</span> <span class="n">computed</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">exact</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">logRelativeError</span>
</pre></div>
</div>
<p>The following function prints the results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printMethodSummary</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">computedProbability</span><span class="p">,</span> <span class="n">numberOfFunctionEvaluations</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of calls to the limit state =&#39;</span><span class="p">,</span> <span class="n">numberOfFunctionEvaluations</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pf = &#39;</span><span class="p">,</span> <span class="n">computedProbability</span><span class="p">)</span>
    <span class="n">exactProbability</span> <span class="o">=</span> <span class="mf">0.02919819462483051</span>
    <span class="n">logRelativeError</span> <span class="o">=</span> <span class="n">computeLogRelativeError</span><span class="p">(</span>
        <span class="n">exactProbability</span><span class="p">,</span> <span class="n">computedProbability</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of correct digits=</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">logRelativeError</span><span class="p">))</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">logRelativeError</span><span class="o">/</span><span class="n">numberOfFunctionEvaluations</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Performance=</span><span class="si">%.2e</span><span class="s2"> (correct digits/evaluation)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">performance</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">printMethodSummary</span><span class="p">(</span><span class="s2">&quot;Monte-Carlo&quot;</span><span class="p">,</span> <span class="n">probabilityMonteCarlo</span><span class="p">,</span>
                   <span class="n">numberOfFunctionEvaluationsMonteCarlo</span><span class="p">)</span>
<span class="n">printMethodSummary</span><span class="p">(</span><span class="s2">&quot;FORM&quot;</span><span class="p">,</span> <span class="n">probabilityFORM</span><span class="p">,</span> <span class="n">numberOfFunctionEvaluationsFORM</span><span class="p">)</span>
<span class="n">printMethodSummary</span><span class="p">(</span><span class="s2">&quot;DirectionalSampling&quot;</span><span class="p">,</span> <span class="n">probabilityDirectionalSampling</span><span class="p">,</span>
                   <span class="n">numberOfFunctionEvaluationsDirectionalSampling</span><span class="p">)</span>
<span class="n">printMethodSummary</span><span class="p">(</span><span class="s2">&quot;FORM-IS&quot;</span><span class="p">,</span> <span class="n">probabilityFORMIS</span><span class="p">,</span>
                   <span class="n">numberOfFunctionEvaluationsFORMIS</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>---
Monte-Carlo :
Number of calls to the limit state = 13243
Pf =  0.02937400891036782
Number of correct digits=2.220
Performance=1.68e-04 (correct digits/evaluation)
---
FORM :
Number of calls to the limit state = 98
Pf =  0.02998278558231473
Number of correct digits=1.571
Performance=1.60e-02 (correct digits/evaluation)
---
DirectionalSampling :
Number of calls to the limit state = 9578
Pf =  0.028181577058147052
Number of correct digits=1.458
Performance=1.52e-04 (correct digits/evaluation)
---
FORM-IS :
Number of calls to the limit state = 952
Pf =  0.027582145808300113
Number of correct digits=1.257
Performance=1.32e-03 (correct digits/evaluation)
</pre></div>
</div>
<p>We see that all three methods produce the correct probability, but not with the same accuracy. In this case, we have found the correct order of magnitude of the probability, i.e. between one and two correct digits. There is, however, a significant difference in computational performance (measured here by the number of function evaluations).</p>
<ul class="simple">
<li><p>The fastest method is the FORM method, which produces more than 1 correct digit with less than 98 function evaluations with a performance equal to <img class="math" src="../../_images/math/220182a6bc20ff68dd03ae0584b60753df0d8219.svg" alt="1.60 \times 10^{-2}"/> (correct digits/evaluation). A practical limitation is that the FORM method does not produce a confidence interval: there is no guarantee that the computed probability is correct.</p></li>
<li><p>The slowest method is Monte-Carlo simulation, which produces more than 1 correct digit with 12806 function evaluations. This is associated with a very slow performance equal to <img class="math" src="../../_images/math/776446fe78c960947d178cfc9a5586a6efafd8ef.svg" alt="1.11 \times 10^{-4}"/> (correct digits/evaluation). The interesting point with the Monte-Carlo simulation is that the method produces a confidence interval.</p></li>
<li><p>The DirectionalSampling method is somewhat in-between the two previous methods.</p></li>
<li><p>The FORM-IS method produces 2 correct digits and has a small number of function evaluations. It has an intermediate performance equal to <img class="math" src="../../_images/math/96d14e51c180b5e2baaabeb455bee9528bb5456f.svg" alt="2.37\times 10^{-3}"/> (correct digits/evaluation). It combines the best of the both worlds: it has the small number of function evaluation of FORM computation and the confidence interval of Monte-Carlo simulation.</p></li>
</ul>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.633 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-reliability-plot-axial-stressed-beam-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/65bb7f045e1581a473c633e7f60f5ace/plot_axial_stressed_beam.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_axial_stressed_beam.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6707ac12c8b0aa1c79d9201ee14f6b7a/plot_axial_stressed_beam.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_axial_stressed_beam.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_event_system.html" title="Create unions or intersections of events"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_strong_maximum_test.html" title="Test the design point with the Strong Maximum Test"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Reliability</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Axial stressed beam : comparing different methods to estimate a probability</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.2.3.
    </div>
  </body>
</html>