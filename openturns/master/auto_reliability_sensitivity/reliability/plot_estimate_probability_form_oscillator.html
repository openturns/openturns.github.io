<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Using the FORM - SORM algorithms on a nonlinear function &#8212; OpenTURNS 1.24dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css?v=105494d3" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=4652c2b6" />
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=f016e9fd"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script src="../../_static/js/mysearchtools.js?v=a003391d"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reliability processes" href="../reliability_processes/index.html" />
    <link rel="prev" title="Cross Entropy Importance Sampling" href="plot_crossentropy.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../reliability_processes/index.html" title="Reliability processes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_crossentropy.html" title="Cross Entropy Importance Sampling"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.24dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Reliability</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using the FORM - SORM algorithms on a nonlinear function</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Using the FORM - SORM algorithms on a nonlinear function</a><ul>
<li><a class="reference internal" href="#model-definition">Model definition</a></li>
<li><a class="reference internal" href="#cross-cuts-in-the-physical-space">Cross cuts in the physical space</a></li>
<li><a class="reference internal" href="#computation-of-reference-probability-with-monte-carlo-simulation">Computation of reference probability with Monte-Carlo simulation</a></li>
<li><a class="reference internal" href="#form-analysis">FORM Analysis</a></li>
<li><a class="reference internal" href="#sorm-analysis">SORM Analysis</a></li>
<li><a class="reference internal" href="#estimation-with-post-analytical-importance-sampling">Estimation with post analytical Importance Sampling</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_crossentropy.html"
                          title="previous chapter">Cross Entropy Importance Sampling</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../reliability_processes/index.html"
                          title="next chapter">Reliability processes</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/reliability/plot_estimate_probability_form_oscillator.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-reliability-plot-estimate-probability-form-oscillator-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="using-the-form-sorm-algorithms-on-a-nonlinear-function">
<span id="sphx-glr-auto-reliability-sensitivity-reliability-plot-estimate-probability-form-oscillator-py"></span><h1>Using the FORM - SORM algorithms on a nonlinear function<a class="headerlink" href="#using-the-form-sorm-algorithms-on-a-nonlinear-function" title="Link to this heading">¶</a></h1>
<p>In this example, we estimate a failure probability with the <cite>FORM</cite> and <cite>SORM</cite> algorithms on the <a class="reference internal" href="../../usecases/use_case_oscillator.html#use-case-oscillator"><span class="std std-ref">oscillator</span></a> example.
This test-case is highly non linear with a significant curvature near the design point.</p>
<section id="model-definition">
<h2>Model definition<a class="headerlink" href="#model-definition" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">oscillator</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>We load the model from the usecases module:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">osc</span> <span class="o">=</span> <span class="n">oscillator</span><span class="o">.</span><span class="n">Oscillator</span><span class="p">()</span>
</pre></div>
</div>
<p>We use the input parameters distribution from the data class:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">osc</span><span class="o">.</span><span class="n">distribution</span>
</pre></div>
</div>
<p>We define the model:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">osc</span><span class="o">.</span><span class="n">model</span>
</pre></div>
</div>
<p>We create the event whose probability we want to estimate.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">vect</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RandomVector</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CompositeRandomVector</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">vect</span><span class="p">)</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ThresholdEvent</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Less</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">event</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s2">&quot;failure&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cross-cuts-in-the-physical-space">
<h2>Cross cuts in the physical space<a class="headerlink" href="#cross-cuts-in-the-physical-space" title="Link to this heading">¶</a></h2>
<p>Let’s have a look on 2D cross cuts of the limit state function. For each 2D cross cut, the other variables are fixed to the input distribution mean values.
This graph allows one to have a first idea of the variations of the function in pairs of dimensions. The colors of each contour plot are comparable.
The number of contour levels are related to the amount of variation of the function in the corresponding coordinates.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">lowerBound</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-5</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">upperBound</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getRange</span><span class="p">()</span><span class="o">.</span><span class="n">getUpperBound</span><span class="p">()</span>

<span class="c1"># Definition of number of meshes in x and y axes for the 2D cross cut plots</span>
<span class="n">nX</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">nY</span> <span class="o">=</span> <span class="mi">50</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">crossCutIndices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">crossCutReferencePoint</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">crossCutIndices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="c1"># Definition of the reference point</span>
                <span class="n">crossCutReferencePoint</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getMean</span><span class="p">()[</span><span class="n">k</span><span class="p">])</span>
        <span class="c1"># Definition of 2D cross cut function</span>
        <span class="n">crossCutFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">crossCutIndices</span><span class="p">,</span> <span class="n">crossCutReferencePoint</span>
        <span class="p">)</span>
        <span class="n">crossCutLowerBound</span> <span class="o">=</span> <span class="p">[</span><span class="n">lowerBound</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lowerBound</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">crossCutUpperBound</span> <span class="o">=</span> <span class="p">[</span><span class="n">upperBound</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">upperBound</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="c1"># Definition of the mesh</span>
        <span class="n">inputData</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">nX</span><span class="p">,</span> <span class="n">nY</span><span class="p">])</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
        <span class="n">inputData</span> <span class="o">*=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutUpperBound</span><span class="p">)</span> <span class="o">-</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutLowerBound</span><span class="p">)</span>
        <span class="n">inputData</span> <span class="o">+=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutLowerBound</span><span class="p">)</span>
        <span class="n">meshX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inputData</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">meshY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inputData</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">crossCutFunction</span><span class="p">(</span><span class="n">inputData</span><span class="p">)</span>
        <span class="n">meshZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">150</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">)]</span>

        <span class="c1"># Creation of the contour</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span> <span class="o">+</span> <span class="n">j</span>

        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.add_subplot.html#matplotlib.figure.Figure.add_subplot" title="matplotlib.figure.Figure.add_subplot" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span></a><span class="p">(</span>
            <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(),</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(),</span> <span class="n">index</span>
        <span class="p">)</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.pcolormesh.html#matplotlib.axes.Axes.pcolormesh" title="matplotlib.axes.Axes.pcolormesh" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">meshX</span><span class="p">,</span> <span class="n">meshY</span><span class="p">,</span> <span class="n">meshZ</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;hsv&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xticks.html#matplotlib.axes.Axes.set_xticks" title="matplotlib.axes.Axes.set_xticks" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span></a><span class="p">([])</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_yticks.html#matplotlib.axes.Axes.set_yticks" title="matplotlib.axes.Axes.set_yticks" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span></a><span class="p">([])</span>
        <span class="c1"># Creation of axes title</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_probability_form_oscillator_001.png" srcset="../../_images/sphx_glr_plot_estimate_probability_form_oscillator_001.png" alt="plot estimate probability form oscillator" class = "sphx-glr-single-img"/></section>
<section id="computation-of-reference-probability-with-monte-carlo-simulation">
<h2>Computation of reference probability with Monte-Carlo simulation<a class="headerlink" href="#computation-of-reference-probability-with-monte-carlo-simulation" title="Link to this heading">¶</a></h2>
<p>The target probability is supposed to be extremely low (<img class="math" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz4KPCEtLSBUaGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSBkdmlzdmdtIDMuNCAtLT4KPHN2ZyB2ZXJzaW9uPScxLjEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgeG1sbnM6eGxpbms9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnIHdpZHRoPSc1Ny45NDkxMjZwdCcgaGVpZ2h0PScxMC40NzEwMTFwdCcgdmlld0JveD0nMCAtOS40NzQ3MzkgNTcuOTQ5MTI2IDEwLjQ3MTAxMSc+CjxkZWZzPgo8cGF0aCBpZD0nZzMtNTUnIGQ9J000LjAzMjg3Ny00Ljg1Mzc5OEM0LjEwNDYwOC00Ljk0MTQ2OSA0LjEwNDYwOC00Ljk1NzQxIDQuMTA0NjA4LTUuMTMyNzUySDIuMDgwMTk5QzEuODgwOTQ2LTUuMTMyNzUyIDEuNjMzODczLTUuMTQwNzIyIDEuNDM0NjItNS4xNTY2NjNDMS4wMjAxNzQtNS4xODg1NDMgMS4wMTIyMDQtNS4yNjAyNzQgLjk4ODI5NC01LjM4Nzc5NkguNzQxMjJMLjQ3MDIzNy0zLjcwNjEwMkguNzE3MzFDLjczMzI1LTMuODI1NjU0IC44MjA5MjItNC4zNzU1OTIgLjkzMjUwMy00LjQzOTM1MkMxLjAyMDE3NC00LjQ3OTIwMyAxLjYxNzkzMy00LjQ3OTIwMyAxLjczNzQ4NC00LjQ3OTIwM0gzLjQyNzE0OEwyLjYwNjIyNy0zLjM3OTMyOEMxLjY5NzYzNC0yLjE2Nzg3IDEuNTA2MzUxLS45MDg1OTMgMS41MDYzNTEtLjI3ODk1NEMxLjUwNjM1MS0uMTk5MjUzIDEuNTA2MzUxIC4xNjczNzIgMS44ODA5NDYgLjE2NzM3MlMyLjI1NTU0Mi0uMTkxMjgzIDIuMjU1NTQyLS4yODY5MjRWLS42Njk0ODlDMi4yNTU1NDItMS44MTcxODYgMi40NDY4MjQtMi43NTc2NTkgMi44MzczNi0zLjI3NTcxNkw0LjAzMjg3Ny00Ljg1Mzc5OFonLz4KPHBhdGggaWQ9J2cwLTAnIGQ9J001LjU3MTEwOC0xLjgwOTIxNUM1LjY5ODYzLTEuODA5MjE1IDUuODczOTczLTEuODA5MjE1IDUuODczOTczLTEuOTkyNTI4UzUuNjk4NjMtMi4xNzU4NDEgNS41NzExMDgtMi4xNzU4NDFIMS4wMDQyMzRDLjg3NjcxMi0yLjE3NTg0MSAuNzAxMzctMi4xNzU4NDEgLjcwMTM3LTEuOTkyNTI4Uy44NzY3MTItMS44MDkyMTUgMS4wMDQyMzQtMS44MDkyMTVINS41NzExMDhaJy8+CjxwYXRoIGlkPSdnMS0yJyBkPSdNNC42NTA1Ni0zLjMyMzUzN0wyLjI1OTUyNy01LjcwMjYxNUMyLjExNjA2NS01Ljg0NjA3NyAyLjA5MjE1NC01Ljg2OTk4OCAxLjk5NjUxMy01Ljg2OTk4OEMxLjg3Njk2MS01Ljg2OTk4OCAxLjc1NzQxLTUuNzYyMzkxIDEuNzU3NDEtNS42MzA4ODRDMS43NTc0MS01LjU0NzE5OCAxLjc4MTMyLTUuNTIzMjg4IDEuOTEyODI3LTUuMzkxNzgxTDQuMzAzODYxLTIuOTg4NzkyTDEuOTEyODI3LS41ODU4MDNDMS43ODEzMi0uNDU0Mjk2IDEuNzU3NDEtLjQzMDM4NiAxLjc1NzQxLS4zNDY3QzEuNzU3NDEtLjIxNTE5MyAxLjg3Njk2MS0uMTA3NTk3IDEuOTk2NTEzLS4xMDc1OTdDMi4wOTIxNTQtLjEwNzU5NyAyLjExNjA2NS0uMTMxNTA3IDIuMjU5NTI3LS4yNzQ5NjlMNC42Mzg2MDUtMi42NTQwNDdMNy4xMTMzMjUtLjE3OTMyOEM3LjEzNzIzNS0uMTY3MzcyIDcuMjIwOTIyLS4xMDc1OTcgNy4yOTI2NTMtLjEwNzU5N0M3LjQzNjExNS0uMTA3NTk3IDcuNTMxNzU2LS4yMTUxOTMgNy41MzE3NTYtLjM0NjdDNy41MzE3NTYtLjM3MDYxIDcuNTMxNzU2LS40MTg0MzEgNy40OTU4OS0uNDc4MjA3QzcuNDgzOTM1LS41MDIxMTcgNS41ODMwNjQtMi4zNzkwNzggNC45ODUzMDUtMi45ODg3OTJMNy4xNzMxMDEtNS4xNzY1ODhDNy4yMzI4NzctNS4yNDgzMTkgNy40MTIyMDQtNS40MDM3MzYgNy40NzE5OC01LjQ3NTQ2N0M3LjQ4MzkzNS01LjQ5OTM3NyA3LjUzMTc1Ni01LjU0NzE5OCA3LjUzMTc1Ni01LjYzMDg4NEM3LjUzMTc1Ni01Ljc2MjM5MSA3LjQzNjExNS01Ljg2OTk4OCA3LjI5MjY1My01Ljg2OTk4OEM3LjE5NzAxMS01Ljg2OTk4OCA3LjE0OTE5MS01LjgyMjE2NyA3LjAxNzY4NC01LjY5MDY2TDQuNjUwNTYtMy4zMjM1MzdaJy8+CjxwYXRoIGlkPSdnMi01OCcgZD0nTTIuMTk5NzUxLS41NzM4NDhDMi4xOTk3NTEtLjkyMDU0OCAxLjkxMjgyNy0xLjE1OTY1MSAxLjYyNTkwMy0xLjE1OTY1MUMxLjI3OTIwMy0xLjE1OTY1MSAxLjA0MDEtLjg3MjcyNyAxLjA0MDEtLjU4NTgwM0MxLjA0MDEtLjIzOTEwMyAxLjMyNzAyNCAwIDEuNjEzOTQ4IDBDMS45NjA2NDggMCAyLjE5OTc1MS0uMjg2OTI0IDIuMTk5NzUxLS41NzM4NDhaJy8+CjxwYXRoIGlkPSdnNC00OCcgZD0nTTUuMzU1OTE1LTMuODI1NjU0QzUuMzU1OTE1LTQuODE3OTMzIDUuMjk2MTM5LTUuNzg2MzAxIDQuODY1NzUzLTYuNjk0ODk0QzQuMzc1NTkyLTcuNjg3MTczIDMuNTE0ODE5LTcuOTUwMTg3IDIuOTI5MDE2LTcuOTUwMTg3QzIuMjM1NjE2LTcuOTUwMTg3IDEuMzg2OC03LjYwMzQ4NyAuOTQ0NDU4LTYuNjExMjA4Qy42MDk3MTQtNS44NTgwMzIgLjQ5MDE2Mi01LjExNjgxMiAuNDkwMTYyLTMuODI1NjU0Qy40OTAxNjItMi42NjYwMDIgLjU3Mzg0OC0xLjc5MzI3NSAxLjAwNDIzNC0uOTQ0NDU4QzEuNDcwNDg2LS4wMzU4NjYgMi4yOTUzOTIgLjI1MTA1OSAyLjkxNzA2MSAuMjUxMDU5QzMuOTU3MTYxIC4yNTEwNTkgNC41NTQ5MTktLjM3MDYxIDQuOTAxNjE5LTEuMDY0MDFDNS4zMzIwMDUtMS45NjA2NDggNS4zNTU5MTUtMy4xMzIyNTQgNS4zNTU5MTUtMy44MjU2NTRaTTIuOTE3MDYxIC4wMTE5NTVDMi41MzQ0OTYgLjAxMTk1NSAxLjc1NzQxLS4yMDMyMzggMS41MzAyNjItMS41MDYzNTFDMS4zOTg3NTUtMi4yMjM2NjEgMS4zOTg3NTUtMy4xMzIyNTQgMS4zOTg3NTUtMy45NjkxMTZDMS4zOTg3NTUtNC45NDk0NCAxLjM5ODc1NS01LjgzNDEyMiAxLjU5MDAzNy02LjUzOTQ3N0MxLjc5MzI3NS03LjM0MDQ3MyAyLjQwMjk4OS03LjcxMTA4MyAyLjkxNzA2MS03LjcxMTA4M0MzLjM3MTM1Ny03LjcxMTA4MyA0LjA2NDc1Ny03LjQzNjExNSA0LjI5MTkwNS02LjQwNzk3QzQuNDQ3MzIzLTUuNzI2NTI2IDQuNDQ3MzIzLTQuNzgyMDY3IDQuNDQ3MzIzLTMuOTY5MTE2QzQuNDQ3MzIzLTMuMTY4MTIgNC40NDczMjMtMi4yNTk1MjcgNC4zMTU4MTYtMS41MzAyNjJDNC4wODg2NjctLjIxNTE5MyAzLjMzNTQ5MiAuMDExOTU1IDIuOTE3MDYxIC4wMTE5NTVaJy8+CjxwYXRoIGlkPSdnNC00OScgZD0nTTMuNDQzMDg4LTcuNjYzMjYzQzMuNDQzMDg4LTcuOTM4MjMyIDMuNDQzMDg4LTcuOTUwMTg3IDMuMjAzOTg1LTcuOTUwMTg3QzIuOTE3MDYxLTcuNjI3Mzk3IDIuMzE5MzAzLTcuMTg1MDU2IDEuMDg3OTItNy4xODUwNTZWLTYuODM4MzU2QzEuMzYyODg5LTYuODM4MzU2IDEuOTYwNjQ4LTYuODM4MzU2IDIuNjE4MTgyLTcuMTQ5MTkxVi0uOTIwNTQ4QzIuNjE4MTgyLS40OTAxNjIgMi41ODIzMTYtLjM0NjcgMS41MzAyNjItLjM0NjdIMS4xNTk2NTFWMEMxLjQ4MjQ0MS0uMDIzOTEgMi42NDIwOTItLjAyMzkxIDMuMDM2NjEzLS4wMjM5MVM0LjU3ODgyOS0uMDIzOTEgNC45MDE2MTkgMFYtLjM0NjdINC41MzEwMDlDMy40Nzg5NTQtLjM0NjcgMy40NDMwODgtLjQ5MDE2MiAzLjQ0MzA4OC0uOTIwNTQ4Vi03LjY2MzI2M1onLz4KPHBhdGggaWQ9J2c0LTUxJyBkPSdNMi4xOTk3NTEtNC4yOTE5MDVDMS45OTY1MTMtNC4yNzk5NSAxLjk0ODY5Mi00LjI2Nzk5NSAxLjk0ODY5Mi00LjE2MDM5OUMxLjk0ODY5Mi00LjA0MDg0NyAyLjAwODQ2OC00LjA0MDg0NyAyLjIyMzY2MS00LjA0MDg0N0gyLjc3MzU5OUMzLjc4OTc4OC00LjA0MDg0NyA0LjI0NDA4NS0zLjIwMzk4NSA0LjI0NDA4NS0yLjA1NjI4OUM0LjI0NDA4NS0uNDkwMTYyIDMuNDMxMTMzLS4wNzE3MzEgMi44NDUzMy0uMDcxNzMxQzIuMjcxNDgyLS4wNzE3MzEgMS4yOTExNTgtLjM0NjcgLjk0NDQ1OC0xLjEzNTc0MUMxLjMyNzAyNC0xLjA3NTk2NSAxLjY3MzcyNC0xLjI5MTE1OCAxLjY3MzcyNC0xLjcyMTU0NEMxLjY3MzcyNC0yLjA2ODI0NCAxLjQyMjY2NS0yLjMwNzM0NyAxLjA4NzkyLTIuMzA3MzQ3Qy44MDA5OTYtMi4zMDczNDcgLjQ5MDE2Mi0yLjEzOTk3NSAuNDkwMTYyLTEuNjg1Njc5Qy40OTAxNjItLjYyMTY2OSAxLjU1NDE3MiAuMjUxMDU5IDIuODgxMTk2IC4yNTEwNTlDNC4zMDM4NjEgLjI1MTA1OSA1LjM1NTkxNS0uODM2ODYyIDUuMzU1OTE1LTIuMDQ0MzM0QzUuMzU1OTE1LTMuMTQ0MjA5IDQuNDcxMjMzLTQuMDA0OTgxIDMuMzIzNTM3LTQuMjA4MjE5QzQuMzYzNjM2LTQuNTA3MDk4IDUuMDMzMTI2LTUuMzc5ODI2IDUuMDMzMTI2LTYuMzEyMzI5QzUuMDMzMTI2LTcuMjU2Nzg3IDQuMDUyODAyLTcuOTUwMTg3IDIuODkzMTUxLTcuOTUwMTg3QzEuNjk3NjM0LTcuOTUwMTg3IC44MTI5NTEtNy4yMjA5MjIgLjgxMjk1MS02LjM0ODE5NEMuODEyOTUxLTUuODY5OTg4IDEuMTgzNTYyLTUuNzc0MzQ2IDEuMzYyODg5LTUuNzc0MzQ2QzEuNjEzOTQ4LTUuNzc0MzQ2IDEuOTAwODcyLTUuOTUzNjc0IDEuOTAwODcyLTYuMzEyMzI5QzEuOTAwODcyLTYuNjk0ODk0IDEuNjEzOTQ4LTYuODYyMjY3IDEuMzUwOTM0LTYuODYyMjY3QzEuMjc5MjAzLTYuODYyMjY3IDEuMjU1MjkzLTYuODYyMjY3IDEuMjE5NDI3LTYuODUwMzExQzEuNjczNzI0LTcuNjYzMjYzIDIuNzk3NTA5LTcuNjYzMjYzIDIuODU3Mjg1LTcuNjYzMjYzQzMuMjUxODA2LTcuNjYzMjYzIDQuMDI4ODkyLTcuNDgzOTM1IDQuMDI4ODkyLTYuMzEyMzI5QzQuMDI4ODkyLTYuMDg1MTgxIDMuOTkzMDI2LTUuNDE1NjkxIDMuNjQ2MzI2LTQuOTAxNjE5QzMuMjg3NjcxLTQuMzc1NTkyIDIuODgxMTk2LTQuMzM5NzI2IDIuNTU4NDA2LTQuMzI3NzcxTDIuMTk5NzUxLTQuMjkxOTA1WicvPgo8cGF0aCBpZD0nZzQtNTUnIGQ9J001LjY3ODcwNS03LjQyNDE1OVYtNy42OTkxMjhIMi43OTc1MDlDMS4zNTA5MzQtNy42OTkxMjggMS4zMjcwMjQtNy44NTQ1NDUgMS4yNzkyMDMtOC4wODE2OTRIMS4wMTYxODlMLjY0NTU3OS01LjY5MDY2SC45MDg1OTNDLjk0NDQ1OC01LjkwNTg1MyAxLjA1MjA1NS02LjY0NzA3MyAxLjIwNzQ3Mi02Ljc3ODU4QzEuMzAzMTEzLTYuODUwMzExIDIuMTk5NzUxLTYuODUwMzExIDIuMzY3MTIzLTYuODUwMzExSDQuOTAxNjE5TDMuNjM0MzcxLTUuMDMzMTI2QzMuMzExNTgyLTQuNTY2ODc0IDIuMTA0MTEtMi42MDYyMjcgMi4xMDQxMS0uMzU4NjU1QzIuMTA0MTEtLjIyNzE0OCAyLjEwNDExIC4yNTEwNTkgMi41OTQyNzEgLjI1MTA1OUMzLjA5NjM4OSAuMjUxMDU5IDMuMDk2Mzg5LS4yMTUxOTMgMy4wOTYzODktLjM3MDYxVi0uOTY4MzY5QzMuMDk2Mzg5LTIuNzQ5Njg5IDMuMzgzMzEzLTQuMTM2NDg4IDMuOTQ1MjA1LTQuOTM3NDg0TDUuNjc4NzA1LTcuNDI0MTU5WicvPgo8cGF0aCBpZD0nZzQtNTYnIGQ9J00zLjU2MjY0LTQuMzE1ODE2QzQuMTYwMzk5LTQuNjM4NjA1IDUuMDMzMTI2LTUuMTg4NTQzIDUuMDMzMTI2LTYuMTkyNzc3QzUuMDMzMTI2LTcuMjMyODc3IDQuMDI4ODkyLTcuOTUwMTg3IDIuOTI5MDE2LTcuOTUwMTg3QzEuNzQ1NDU1LTcuOTUwMTg3IC44MTI5NTEtNy4wNzc0NiAuODEyOTUxLTUuOTg5NTM5Qy44MTI5NTEtNS41ODMwNjQgLjkzMjUwMy01LjE3NjU4OCAxLjI2NzI0OC00Ljc3MDExMkMxLjM5ODc1NS00LjYxNDY5NSAxLjQxMDcxLTQuNjAyNzQgMi4yNDc1NzItNC4wMTY5MzZDMS4wODc5Mi0zLjQ3ODk1NCAuNDkwMTYyLTIuNjc3OTU4IC40OTAxNjItMS44MDUyM0MuNDkwMTYyLS41Mzc5ODMgMS42OTc2MzQgLjI1MTA1OSAyLjkxNzA2MSAuMjUxMDU5QzQuMjQ0MDg1IC4yNTEwNTkgNS4zNTU5MTUtLjcyOTI2NSA1LjM1NTkxNS0xLjk4NDU1OEM1LjM1NTkxNS0zLjIwMzk4NSA0LjQ5NTE0My0zLjc0MTk2OCAzLjU2MjY0LTQuMzE1ODE2Wk0xLjkzNjczNy01LjM5MTc4MUMxLjc4MTMyLTUuNDk5Mzc3IDEuMzAzMTEzLTUuODEwMjEyIDEuMzAzMTEzLTYuMzk2MDE1QzEuMzAzMTEzLTcuMTczMTAxIDIuMTE2MDY1LTcuNjYzMjYzIDIuOTE3MDYxLTcuNjYzMjYzQzMuNzc3ODMzLTcuNjYzMjYzIDQuNTQyOTY0LTcuMDQxNTk0IDQuNTQyOTY0LTYuMTgwODIyQzQuNTQyOTY0LTUuNDUxNTU3IDQuMDE2OTM2LTQuODY1NzUzIDMuMzIzNTM3LTQuNDgzMTg4TDEuOTM2NzM3LTUuMzkxNzgxWk0yLjQ5ODYzLTMuODQ5NTY0TDMuOTQ1MjA1LTIuOTA1MTA2QzQuMjU2MDQtMi43MDE4NjggNC44MDU5NzgtMi4zMzEyNTggNC44MDU5NzgtMS42MDE5OTNDNC44MDU5NzgtLjY5MzQgMy44ODU0My0uMDcxNzMxIDIuOTI5MDE2LS4wNzE3MzFDMS45MTI4MjctLjA3MTczMSAxLjA0MDEtLjgxMjk1MSAxLjA0MDEtMS44MDUyM0MxLjA0MDEtMi43Mzc3MzMgMS43MjE1NDQtMy40OTA5MDkgMi40OTg2My0zLjg0OTU2NFonLz4KPC9kZWZzPgo8ZyBpZD0ncGFnZTEnPgo8dXNlIHg9JzAnIHk9JzAnIHhsaW5rOmhyZWY9JyNnNC01MScvPgo8dXNlIHg9JzUuODUyOTknIHk9JzAnIHhsaW5rOmhyZWY9JyNnMi01OCcvPgo8dXNlIHg9JzkuMTA0NjUyJyB5PScwJyB4bGluazpocmVmPScjZzQtNTUnLz4KPHVzZSB4PScxNC45NTc2NDInIHk9JzAnIHhsaW5rOmhyZWY9JyNnNC01NicvPgo8dXNlIHg9JzIzLjQ2NzI5NScgeT0nMCcgeGxpbms6aHJlZj0nI2cxLTInLz4KPHVzZSB4PSczNS40MjI0NTYnIHk9JzAnIHhsaW5rOmhyZWY9JyNnNC00OScvPgo8dXNlIHg9JzQxLjI3NTQ0NicgeT0nMCcgeGxpbms6aHJlZj0nI2c0LTQ4Jy8+Cjx1c2UgeD0nNDcuMTI4NDM3JyB5PSctNC4zMzg0MzcnIHhsaW5rOmhyZWY9JyNnMC0wJy8+Cjx1c2UgeD0nNTMuNzE0OTQzJyB5PSctNC4zMzg0MzcnIHhsaW5rOmhyZWY9JyNnMy01NScvPgo8L2c+Cjwvc3ZnPgo8IS0tIERFUFRIPTEgLS0+" alt="3.78\times 10^{-7}" style="vertical-align: -1px"/>).
Indeed, when performing Monte-Carlo simulation with a simulation budget of 100000 points, no sample are in the failure state, that induces a probability estimate of zero.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MonteCarloExperiment</span><span class="p">()</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ProbabilitySimulationAlgorithm</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">experiment</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">probability</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failure probability = &quot;</span><span class="p">,</span> <span class="n">probability</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Failure probability =  0.0
</pre></div>
</div>
<p>To get an accurate estimate of this probability, a billion of simulations are necessary.</p>
</section>
<section id="form-analysis">
<h2>FORM Analysis<a class="headerlink" href="#form-analysis" title="Link to this heading">¶</a></h2>
<p>To get a first idea of the failure probability with reduced simulation budget, one can use the First Order Reliability Method (FORM).</p>
<p>Define a solver:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">optimAlgo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cobyla</span><span class="p">()</span>
<span class="n">optimAlgo</span><span class="o">.</span><span class="n">setMaximumCallsNumber</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">optimAlgo</span><span class="o">.</span><span class="n">setMaximumAbsoluteError</span><span class="p">(</span><span class="mf">1.0e-3</span><span class="p">)</span>
<span class="n">optimAlgo</span><span class="o">.</span><span class="n">setMaximumRelativeError</span><span class="p">(</span><span class="mf">1.0e-3</span><span class="p">)</span>
<span class="n">optimAlgo</span><span class="o">.</span><span class="n">setMaximumResidualError</span><span class="p">(</span><span class="mf">1.0e-3</span><span class="p">)</span>
<span class="n">optimAlgo</span><span class="o">.</span><span class="n">setMaximumConstraintError</span><span class="p">(</span><span class="mf">1.0e-3</span><span class="p">)</span>
</pre></div>
</div>
<p>Run FORM initialized at the mean of the distribution:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FORM</span><span class="p">(</span><span class="n">optimAlgo</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getMean</span><span class="p">())</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
<p>Probability of failure:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FORM estimate of the probability of failure: &quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">getEventProbability</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>FORM estimate of the probability of failure:  3.891496415542106e-06
</pre></div>
</div>
<p>Design point in the standard space:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">designPointStandardSpace</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getStandardSpaceDesignPoint</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Design point in standard space : &quot;</span><span class="p">,</span> <span class="n">designPointStandardSpace</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Design point in standard space :  [0.292325,1.2089,1.28593,-0.286932,-2.85666,-1.8419,-2.03238,1.01191]
</pre></div>
</div>
<p>Design point in the physical space:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Design point in physical space : &quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">getPhysicalSpaceDesignPoint</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Design point in physical space :  [1.53672,0.0112256,1.26498,0.00926413,0.0154449,0.00749384,22.3422,110.072]
</pre></div>
</div>
<p>For this test case, in order to validate the results obtained by FORM, we can plot the cross cuts in the standard space near the design point found by FORM.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">distributionStandard</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">())</span>
<span class="n">inverseIsoProbabilistic</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getInverseIsoProbabilisticTransformation</span><span class="p">()</span>
<span class="n">standardSpaceLimitState</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedFunction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">inverseIsoProbabilistic</span><span class="p">)</span>
<span class="n">standardSpaceLimitStateFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">standardSpaceLimitState</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">lowerBound</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">upperBound</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>

<span class="c1"># Definition of number of meshes in x and y axes for the 2D cross cut plots</span>
<span class="n">nX</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">nY</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">my_labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;MPP&quot;</span><span class="p">:</span> <span class="s2">&quot;Design Point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="s2">&quot;Origin in Standard Space&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TLSF&quot;</span><span class="p">:</span> <span class="s2">&quot;True Limit State Function&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ALSF&quot;</span><span class="p">:</span> <span class="s2">&quot;Approximated Limit State Function&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">crossCutIndices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">crossCutReferencePoint</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">crossCutIndices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="c1"># Definition of the reference point</span>
                <span class="n">crossCutReferencePoint</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="c1"># Definition of 2D cross cut function</span>
        <span class="n">crossCutFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span>
            <span class="n">standardSpaceLimitStateFunction</span><span class="p">,</span> <span class="n">crossCutIndices</span><span class="p">,</span> <span class="n">crossCutReferencePoint</span>
        <span class="p">)</span>

        <span class="n">crossCutLowerBound</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">lowerBound</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
            <span class="n">lowerBound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">crossCutUpperBound</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">upperBound</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
            <span class="n">upperBound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="c1"># Definition of the mesh</span>
        <span class="n">inputData</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">nX</span><span class="p">,</span> <span class="n">nY</span><span class="p">])</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
        <span class="n">inputData</span> <span class="o">*=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutUpperBound</span><span class="p">)</span> <span class="o">-</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutLowerBound</span><span class="p">)</span>
        <span class="n">inputData</span> <span class="o">+=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutLowerBound</span><span class="p">)</span>
        <span class="n">meshX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inputData</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">meshY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inputData</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">crossCutFunction</span><span class="p">(</span><span class="n">inputData</span><span class="p">)</span>
        <span class="n">meshZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">150</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">)]</span>

        <span class="c1"># Creation of the contour</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span> <span class="o">+</span> <span class="n">j</span>

        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.add_subplot.html#matplotlib.figure.Figure.add_subplot" title="matplotlib.figure.Figure.add_subplot" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span></a><span class="p">(</span>
            <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(),</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(),</span> <span class="n">index</span>
        <span class="p">)</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.pcolormesh.html#matplotlib.axes.Axes.pcolormesh" title="matplotlib.axes.Axes.pcolormesh" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">meshX</span><span class="p">,</span> <span class="n">meshY</span><span class="p">,</span> <span class="n">meshZ</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;hsv&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

        <span class="n">cs0</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span>
            <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
            <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;MPP&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">cs1</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;rs&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">])</span>
        <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.QuadContourSet" title="matplotlib.contour.QuadContourSet" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cs2</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.contour.html#matplotlib.axes.Axes.contour" title="matplotlib.axes.Axes.contour" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">contour</span></a><span class="p">(</span><span class="n">meshX</span><span class="p">,</span> <span class="n">meshY</span><span class="p">,</span> <span class="n">meshZ</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">])</span>

        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xticks.html#matplotlib.axes.Axes.set_xticks" title="matplotlib.axes.Axes.set_xticks" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span></a><span class="p">([])</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_yticks.html#matplotlib.axes.Axes.set_yticks" title="matplotlib.axes.Axes.set_yticks" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span></a><span class="p">([])</span>

        <span class="n">u0</span> <span class="o">=</span> <span class="p">[</span><span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearTaylor</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">crossCutFunction</span><span class="p">)</span>
        <span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">responseSurface</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">responseSurface</span><span class="p">(</span><span class="n">inputData</span><span class="p">)</span>
        <span class="n">meshZ2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

        <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.QuadContourSet" title="matplotlib.contour.QuadContourSet" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cs3</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.contour.html#matplotlib.axes.Axes.contour" title="matplotlib.axes.Axes.contour" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">contour</span></a><span class="p">(</span><span class="n">meshX</span><span class="p">,</span> <span class="n">meshY</span><span class="p">,</span> <span class="n">meshZ2</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">)</span>

        <span class="c1"># Creation of axes title</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.collections" title="matplotlib.contour.ContourSet.collections" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-property"><span class="n">cs2</span><span class="o">.</span><span class="n">collections</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;TLSF&quot;</span><span class="p">])</span>
            <span class="n">h2</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.legend_elements" title="matplotlib.contour.ContourSet.legend_elements" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-method"><span class="n">cs2</span><span class="o">.</span><span class="n">legend_elements</span></a><span class="p">()</span>
            <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.collections" title="matplotlib.contour.ContourSet.collections" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-property"><span class="n">cs3</span><span class="o">.</span><span class="n">collections</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;ALSF&quot;</span><span class="p">])</span>
            <span class="n">h3</span><span class="p">,</span> <span class="n">l3</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.legend_elements" title="matplotlib.contour.ContourSet.legend_elements" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-method"><span class="n">cs3</span><span class="o">.</span><span class="n">legend_elements</span></a><span class="p">()</span>
            <a href="https://matplotlib.org/stable/api/legend_api.html#matplotlib.legend.Legend" title="matplotlib.legend.Legend" class="sphx-glr-backref-module-matplotlib-legend sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lg</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html#matplotlib.axes.Axes.legend" title="matplotlib.axes.Axes.legend" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">legend</span></a><span class="p">(</span>
                <span class="p">[</span><span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h3</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;TLSF&quot;</span><span class="p">],</span> <span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;ALSF&quot;</span><span class="p">]],</span>
                <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/legend_api.html#matplotlib.legend.Legend" title="matplotlib.legend.Legend" class="sphx-glr-backref-module-matplotlib-legend sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lg1</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html#matplotlib.axes.Axes.legend" title="matplotlib.axes.Axes.legend" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">legend</span></a><span class="p">(</span>
                <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">7.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_probability_form_oscillator_002.png" srcset="../../_images/sphx_glr_plot_estimate_probability_form_oscillator_002.png" alt="plot estimate probability form oscillator" class = "sphx-glr-single-img"/><p>As it can be seen, the curvature of the limit state function near the design point is significant.
In that way, FORM provides poor estimate since it linearly approximates the limit state function.
Thus, SORM can be used in order to refine this probability estimation by approximating the limit state function with a quadratic model.</p>
</section>
<section id="sorm-analysis">
<h2>SORM Analysis<a class="headerlink" href="#sorm-analysis" title="Link to this heading">¶</a></h2>
<p>Run SORM initialized at the mean of the distribution:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">algoSORM</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SORM</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Cobyla</span><span class="p">(),</span> <span class="n">event</span><span class="p">,</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getMean</span><span class="p">())</span>
<span class="n">algoSORM</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Analysis of SORM results:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">resultSORM</span> <span class="o">=</span> <span class="n">algoSORM</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Probability estimate with SORM (Breitung correction) =&quot;</span><span class="p">,</span>
    <span class="n">resultSORM</span><span class="o">.</span><span class="n">getEventProbabilityBreitung</span><span class="p">(),</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Probability estimate with SORM (Hohenbichler correction) =&quot;</span><span class="p">,</span>
    <span class="n">resultSORM</span><span class="o">.</span><span class="n">getEventProbabilityHohenbichler</span><span class="p">(),</span>
<span class="p">)</span>

<span class="n">optim_res</span> <span class="o">=</span> <span class="n">resultSORM</span><span class="o">.</span><span class="n">getOptimizationResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation budget:&quot;</span><span class="p">,</span> <span class="n">optim_res</span><span class="o">.</span><span class="n">getCallsNumber</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Probability estimate with SORM (Breitung correction) = 3.8119422417743107e-07
Probability estimate with SORM (Hohenbichler correction) = 3.6841954700676055e-07
Simulation budget: 783
</pre></div>
</div>
<p>One can see that the probability estimate has been decreased by a factor 10 compared to the FORM estimate.
This probability is quite close to the reference probability and obtained with less than 1000 evaluations of the model.</p>
<p>In order to visualize the SORM limit state approximation, we can draw cross cuts of SORM oscultating parabola using second order Taylor approximation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">lowerBound</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">upperBound</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>

<span class="c1"># Definition of number of meshes in x and y axes for the 2D cross cut plots</span>
<span class="n">nX</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">nY</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">my_labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;MPP&quot;</span><span class="p">:</span> <span class="s2">&quot;Design Point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="s2">&quot;Origin in Standard Space&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TLSF&quot;</span><span class="p">:</span> <span class="s2">&quot;True Limit State Function&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ALSF&quot;</span><span class="p">:</span> <span class="s2">&quot;Approximated Limit State Function&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">crossCutIndices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">crossCutReferencePoint</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">crossCutIndices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="c1"># Definition of the reference point</span>
                <span class="n">crossCutReferencePoint</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="c1"># Definition of 2D cross cut function</span>
        <span class="n">crossCutFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span>
            <span class="n">standardSpaceLimitStateFunction</span><span class="p">,</span> <span class="n">crossCutIndices</span><span class="p">,</span> <span class="n">crossCutReferencePoint</span>
        <span class="p">)</span>

        <span class="n">crossCutLowerBound</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">lowerBound</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
            <span class="n">lowerBound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="n">crossCutUpperBound</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">upperBound</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
            <span class="n">upperBound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="c1"># Definition of the mesh</span>
        <span class="n">inputData</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">nX</span><span class="p">,</span> <span class="n">nY</span><span class="p">])</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
        <span class="n">inputData</span> <span class="o">*=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutUpperBound</span><span class="p">)</span> <span class="o">-</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutLowerBound</span><span class="p">)</span>
        <span class="n">inputData</span> <span class="o">+=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">crossCutLowerBound</span><span class="p">)</span>
        <span class="n">meshX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inputData</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">meshY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inputData</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">crossCutFunction</span><span class="p">(</span><span class="n">inputData</span><span class="p">)</span>
        <span class="n">meshZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">150</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">)]</span>

        <span class="c1"># Creation of the contour</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span> <span class="o">+</span> <span class="n">j</span>

        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.add_subplot.html#matplotlib.figure.Figure.add_subplot" title="matplotlib.figure.Figure.add_subplot" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span></a><span class="p">(</span>
            <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(),</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(),</span> <span class="n">index</span>
        <span class="p">)</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.pcolormesh.html#matplotlib.axes.Axes.pcolormesh" title="matplotlib.axes.Axes.pcolormesh" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">meshX</span><span class="p">,</span> <span class="n">meshY</span><span class="p">,</span> <span class="n">meshZ</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;hsv&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
        <span class="n">cs0</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span>
            <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
            <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;MPP&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">cs1</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;rs&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">])</span>
        <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.QuadContourSet" title="matplotlib.contour.QuadContourSet" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cs2</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.contour.html#matplotlib.axes.Axes.contour" title="matplotlib.axes.Axes.contour" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">contour</span></a><span class="p">(</span><span class="n">meshX</span><span class="p">,</span> <span class="n">meshY</span><span class="p">,</span> <span class="n">meshZ</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">])</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xticks.html#matplotlib.axes.Axes.set_xticks" title="matplotlib.axes.Axes.set_xticks" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span></a><span class="p">([])</span>
        <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_yticks.html#matplotlib.axes.Axes.set_yticks" title="matplotlib.axes.Axes.set_yticks" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span></a><span class="p">([])</span>

        <span class="n">u0</span> <span class="o">=</span> <span class="p">[</span><span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">designPointStandardSpace</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">QuadraticTaylor</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">crossCutFunction</span><span class="p">)</span>
        <span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">responseSurface</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">responseSurface</span><span class="p">(</span><span class="n">inputData</span><span class="p">)</span>
        <span class="n">meshZ2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nX</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.QuadContourSet" title="matplotlib.contour.QuadContourSet" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cs3</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.contour.html#matplotlib.axes.Axes.contour" title="matplotlib.axes.Axes.contour" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">contour</span></a><span class="p">(</span><span class="n">meshX</span><span class="p">,</span> <span class="n">meshY</span><span class="p">,</span> <span class="n">meshZ2</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">)</span>

        <span class="c1"># Creation of axes title</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()[</span><span class="n">j</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.collections" title="matplotlib.contour.ContourSet.collections" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-property"><span class="n">cs2</span><span class="o">.</span><span class="n">collections</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;TLSF&quot;</span><span class="p">])</span>
            <span class="n">h2</span><span class="p">,</span> <span class="n">l2</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.legend_elements" title="matplotlib.contour.ContourSet.legend_elements" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-method"><span class="n">cs2</span><span class="o">.</span><span class="n">legend_elements</span></a><span class="p">()</span>
            <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.collections" title="matplotlib.contour.ContourSet.collections" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-property"><span class="n">cs3</span><span class="o">.</span><span class="n">collections</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;ALSF&quot;</span><span class="p">])</span>
            <span class="n">h3</span><span class="p">,</span> <span class="n">l3</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourSet.legend_elements" title="matplotlib.contour.ContourSet.legend_elements" class="sphx-glr-backref-module-matplotlib-contour sphx-glr-backref-type-py-method"><span class="n">cs3</span><span class="o">.</span><span class="n">legend_elements</span></a><span class="p">()</span>
            <a href="https://matplotlib.org/stable/api/legend_api.html#matplotlib.legend.Legend" title="matplotlib.legend.Legend" class="sphx-glr-backref-module-matplotlib-legend sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lg</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html#matplotlib.axes.Axes.legend" title="matplotlib.axes.Axes.legend" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">legend</span></a><span class="p">(</span>
                <span class="p">[</span><span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h3</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;TLSF&quot;</span><span class="p">],</span> <span class="n">my_labels</span><span class="p">[</span><span class="s2">&quot;ALSF&quot;</span><span class="p">]],</span>
                <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span>
                <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <a href="https://matplotlib.org/stable/api/legend_api.html#matplotlib.legend.Legend" title="matplotlib.legend.Legend" class="sphx-glr-backref-module-matplotlib-legend sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lg1</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html#matplotlib.axes.Axes.legend" title="matplotlib.axes.Axes.legend" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">legend</span></a><span class="p">(</span>
                <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">7.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_probability_form_oscillator_003.png" srcset="../../_images/sphx_glr_plot_estimate_probability_form_oscillator_003.png" alt="plot estimate probability form oscillator" class = "sphx-glr-single-img"/><p>We can see that this approximation is very appropriate, explaining the accuracy of the obtained results.</p>
</section>
<section id="estimation-with-post-analytical-importance-sampling">
<h2>Estimation with post analytical Importance Sampling<a class="headerlink" href="#estimation-with-post-analytical-importance-sampling" title="Link to this heading">¶</a></h2>
<p>Different algorithms exist for the reliability analysis by Importance Sampling.
One way is to perform post analytical Importance Sampling by defining the auxiliary density centered at the design point found by FORM.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">postAnalyticalIS</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PostAnalyticalImportanceSampling</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">postAnalyticalIS</span><span class="o">.</span><span class="n">setMaximumCoefficientOfVariation</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">postAnalyticalIS</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">resultPostAnalyticalIS</span> <span class="o">=</span> <span class="n">postAnalyticalIS</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Probability of failure with post analytical IS = &quot;</span><span class="p">,</span>
    <span class="n">resultPostAnalyticalIS</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Probability of failure with post analytical IS =  3.948977006146584e-07
</pre></div>
</div>
<p>We can see that this post-treatment of FORM result allows one to greatly improve the quality of the probability estimation.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 5.544 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-reliability-plot-estimate-probability-form-oscillator-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/452487099120eaf54f231b05b7fd7fc2/plot_estimate_probability_form_oscillator.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_estimate_probability_form_oscillator.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a29756e634760593fbff282c6089464c/plot_estimate_probability_form_oscillator.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_estimate_probability_form_oscillator.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9b9d9194dc6d401cdd0b305ce7665892/plot_estimate_probability_form_oscillator.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_estimate_probability_form_oscillator.zip</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../reliability_processes/index.html" title="Reliability processes"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_crossentropy.html" title="Cross Entropy Importance Sampling"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.24dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Reliability</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using the FORM - SORM algorithms on a nonlinear function</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    </div>
  </body>
</html>