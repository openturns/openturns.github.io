
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Use the Smolyak quadrature &#8212; OpenTURNS 1.22dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Functional modeling" href="../../auto_functional_modeling/index.html" />
    <link rel="prev" title="Merge nodes in Smolyak quadrature" href="plot_smolyak_merge.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../auto_functional_modeling/index.html" title="Functional modeling"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_smolyak_merge.html" title="Merge nodes in Smolyak quadrature"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Design of experiments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Use the Smolyak quadrature</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_smolyak_merge.html"
                          title="previous chapter">Merge nodes in Smolyak quadrature</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../../auto_functional_modeling/index.html"
                          title="next chapter">Functional modeling</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/design_of_experiments/plot_smolyak_quadrature.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-design-of-experiments-plot-smolyak-quadrature-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="use-the-smolyak-quadrature">
<span id="sphx-glr-auto-reliability-sensitivity-design-of-experiments-plot-smolyak-quadrature-py"></span><h1>Use the Smolyak quadrature<a class="headerlink" href="#use-the-smolyak-quadrature" title="Permalink to this heading">¶</a></h1>
<p>The goal of this example is to use Smolyak’s quadrature.
We create a Smolyak quadrature using a Gauss-Legendre marginal
quadrature and use it on a benchmark problem.
In the second part, we compute the absolute error of Smolyak’s quadrature
method and compare it with the tensorized Gauss-Legendre quadrature.
In the third part, we plot the absolute error depending on the sample
sample and analyze the speed of convergence.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.experimental</span> <span class="k">as</span> <span class="nn">otexp</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
<p>In the first example, we print the nodes and weights
Smolyak-Legendre quadrature of level 3.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uniform</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussProductExperiment</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">level</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;level = &quot;</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">SmolyakExperiment</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="n">nodes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generateWithWeights</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>level =  3
 0 : [ 0.112702 0.5      ]
 1 : [ 0.211325 0.211325 ]
 2 : [ 0.211325 0.5      ]
 3 : [ 0.211325 0.788675 ]
 4 : [ 0.5      0.112702 ]
 5 : [ 0.5      0.211325 ]
 6 : [ 0.5      0.5      ]
 7 : [ 0.5      0.788675 ]
 8 : [ 0.5      0.887298 ]
 9 : [ 0.788675 0.211325 ]
10 : [ 0.788675 0.5      ]
11 : [ 0.788675 0.788675 ]
12 : [ 0.887298 0.5      ]
[0.277778,0.25,-0.5,0.25,0.277778,-0.5,0.888889,-0.5,0.277778,0.25,-0.5,0.25,0.277778]#13
</pre></div>
</div>
<p>We see that some of the weights are nonpositive. This is a significant
difference with tensorized Gauss quadrature.</p>
<p>We now create an exponential product problem from
<a class="reference internal" href="../../bibliography.html#morokoff1995" id="id1"><span>[morokoff1995]</span></a>, table 1, page 221.
This example is also used in <a class="reference internal" href="../../bibliography.html#gerstner1998" id="id2"><span>[gerstner1998]</span></a> page 221 to demonstrate
the properties of Smolyak’s quadrature.
It is defined by the equation :</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAAA1BAMAAADos4nZAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK+LMun7dGCdz7/z3UgvPFBbAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADPklEQVRYw+2YTWgTQRSAX9ytzXaT7VbRUkSMBgn0oCl6KK3KghRqVZr6g/WiBe9SLBpqQVJBC56KWHorQS92RRuoUPFicvEcaS9eJDcRLa20RaVqfLOZ3czsz22nXvoO2Tfz3s43O/PmzSMAYUrkI4iX51vAGBJO2DGaEc74pCREI7SimhPNkAoxXTSjMXGuVfh+LNydhG3ZFrHSWsafRFi5eP8kNFcdsc96FpOXZISVi5tw2OWqlQ+P/h63e2XsUEPLxTvJ9UQZa8AyTrO5uI0+PQe1LWjgguOfmiIaZfzkGAfZXJynz33uofIBCJm8uryO/vHK40BGgcnFiq00pvmhiOFBheuKXrPuI4OoQ+j/Dd4EMaI5Jhc3OBbXTYaGMyuUUXOWZ/6SR9yaQR79u6HkzyjiljO5eMSxpHgGMTRTRiftsxhfLFAa/W/JpWE/xv0bRhubi5ccyyOesRTEeE1+mg30V7Ozvt+B8sSuiZIdOonhxpeDJ5/V4tBVaPgy8BAr03cYf5YRHevt1p3YA+jR96ahCLisc+X3OCDpe2uiPCVaMYARxdhYBJP6uxmftcUYBos8TG1X8ItJmGXg+vhVnBd3JRODL6NJB6kMs4w/y5jUvktsJK7CQ9Ay1kklbf7a1xyGapqXTTPhMHD0NNxk/Ln9ULhjpWSgHSJkSaJ/7LzAFLBBa5UF6De01YD9gIZh9qipBbhobe0L9Rd8pe/U9yNoz3GeK6CUc/6MXL+usAVLXloHGABt88Ba5BLAeT6uBggjxzNwmEiezGZPIl33ZxhS8YR+nB0lOYpznca5vzpsYn44xjPQsGvuQoVhRNo3joCE2OjCvXm97s8w5FRvqgJdbCWMc+pzWh94Rh+jd9bVuNfffQYlNnpiuD9xuy278myccWypq2fB4+855z2ONgW3iat9IlVXxeoYeJkBj7+HkXS0sREr5ido85R7tAlfRhk8/h5GKe2+cujTgAADL4ZH8TLmjdBLHb+8G7JEqlb98e6HQMZydRPXZne1XvuELqSG2wCFreG25X8KvS1ay+JRWfH/NNQKAFHSJZ4hxVoOoehCv6NnC9YquQWMUkdtrYoCGfS2wGLdY/oH9pf9H0+nR9EAAAAKdEVYdERlcHRoAP////6On/F5AAAAAElFTkSuQmCC" alt="g(\boldsymbol{x}) = (1 + 1 / d)^d \prod_{i = 1}^d x_i^{1 / d}"/></p>
</div><p>for any <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE0AAAAVBAMAAADx+n4ZAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdM/d6WCLv/P7GJ1IMq+qQHN+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFElEQVQoz2NgIAYs3kCUMgamACyCRQnIPDY9IMGJTbMCmlkMDA+3YFfHuu0phMnqA1LHfGAfdnVHGFgugFi8e/6A1J1gKEWW50o3NoSoM2TgLoCIgdWlM3Qhq0uOgpn3h4F1ApI6Od4uAQYGIZMwI5AP2R7A7OX5y8DzC0kdu6A2ULqA6TMHSPdiuPtYger+IqkDAxYGlq9LQMEdxoBkHiuGOgaG9R/A1BZjY6g/eP8wMP7CVBdvAKaiEeHylYFxAro6poL6DTygUGBGqDNj4FZAV3e+6n/CElCoMhbA1QUDw5lXC8T+ClfHrnTOSRct/Bg3PmXgmQYM+Udf3iDchxkfYMCISAfYAYnqBKilDi09q4MpAMpEQ9YkzLFsAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\boldsymbol{x} \in [0, 1]^d" style="vertical-align: -5px"/> where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMASN0yYPudz4t0GOmvv40dxUsAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABMSURBVAjXY2BgYBB6DCQYWAJAJFsBiGRqAJF8BkB+5lQgS4OhnIGBQ4GhjIGBtYEhkIHBzoDxAQODHAObggMDK8PqAw0MLDcn3lgAAEoSDEBZQZ8MAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="d" style="vertical-align: 0px"/> is the
dimension of the problem.</p>
<p>We are interested in the integral:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKsAAAAsBAMAAADoc1VKAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/zv3TdnUj7MovP6WCm0j6sAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADMElEQVRIx71WS2gTQRj+N6/dbJLtUsXHIST4OEjV1qMHMT2I0grNQXy1xXjQg1qagwGh+KBIQUFSvejNgCIIlkQQKYZCEF9owCiIoKKpoFAsGDHUkmLqP5OdjelMDeiuP+zO/+/M/838z1mARWh7BmwgV/abHbChFTk7YE+CLfTSFlSpagusz5aAgb/DFlivLXkA6bgtsAeK4kgau8n1T8uNceE5pNXlKKffo4tdznQidBhCReatpfQ9UjHXemK8/laxEacY00vTJdEBMjPLTXuINmqubeH9KP0UwxYYEyAv5/lijanPyfVQJ89w6lpZiOo2u5qD+C3Njk1pLbW83vdO8/qOOSGsJ2XuS07Vj88Rc3KaWm6ugMMC/VneL223dS+OfQNfjuGR0IetWzbS0f3o/d1nmOrogsQ+JgFcpmo780j3WTWUONgxfWXGiWGK+GeciEUWHMUHq/EOPI9txoOSD3kmgTorqAa+dl+hgWMkVoFqEGN8ET9dQeUCidWHydd4FN0Xg8dMAl9JUA1c7WolmIILtMHT9ZvQLcgoJP7SPM0L3ZshO9Uk8Bd42HYu5+QCrIclhPtK0xz9oKFJEjFLm6GOg3RKKTEJvGHet4Nc7boi8JZExR/piSsRCktzFMcHrh9wlsAmQY4VDQnSgvK/ytWuO+erQECHZOd8JpgCFY/sJya9AKUcmpPeANxA4GB43JBaBx/yyfSd36ltzyjIUXDlh989xYBgjnlJGSXQzicb8piuWdC27e3WDUlEwiJz5EA1I+lBc0KEuWXOH2zaFmVRkTmjv6ki2mQfw6ekNm/8/orggielep2JnQDVHRQtwmKqN4V18qm8q5ckjGZ0Zh+6NVvrKp+MBePN74aW2GIzRjDU+he1ceaPN1n4v9xk3dbAti+QT1gDOwByl5LAIpJ2wwTUr8F/pEt4Y3uwbMDdj5w2FLMEVa0i2DSMkOaN3DLVmgi6Swh2HM4ZsMO+/db84OcQbA3cNGAdH60JmTfacFprKBCeAurbz5bCOjOHCGwAsliX1yyDVVZlCKySCHvi2rp7spXlWwOLNv5zWgQrFS2H7SL5S7iJv9L/BabczQWK2zTgAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="I = \int_{[0, 1]^d} g(\boldsymbol{x}) f(\boldsymbol{x}) d \boldsymbol{x}"/></p>
</div><p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEUAAAATBAMAAAA0dN3wAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABCklEQVQoz2NggABOAQjNyIAdMCozMPDC1D7ArkbRhIFBHMYxQpOsCABTrukMDA0wMQ5UJYnxYDVsHxgYmBVgglwGqIr4wWqYgWZwJ8DE2C9gUcO5pKuAgQfIsN1RtBdo3AFs5nADJVgYGJge8P5mASoA2szAdxcEFiDU8ADJDJBjOb7PAIbSSWzmzAfiCDADZASDJzY1JUA8BcSo3wAisbpHFmQfMKQfvBdgfQBRg+Gei6CQm8AQ//K/wowEBrYNaOYUgMijoCgzAOqN6r0G9J4CipJZ97uABnGCXMoGDznuCZgRyj4ZLL0Txs/FEun8dWBH5cH4L7GoYVKCGAeNSqYABtwAGqlsWKQACtI+ftIwbfsAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="f(\boldsymbol{x}) = 1" style="vertical-align: -5px"/> is the uniform density probability
function in the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAVBAMAAAAp9toTAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv8+LYJ2vSOky3XT7GPOCPBn4AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAtElEQVQY02NgwAS3ArAIMjA5MAgZIAswqwEJHgYGBTR1DAzZESBRluAUiAhLO0iUqyAMJFrBwDEBJMgZ/h0kWscgAhJdzcAqAFEMFjVkeAsS/c7AcgBJdBvn2w0MCuw/Gdj/Ioky7lYFqmUBiv5EEgUDkFoWTFHO7wzcfzFEGb4wcB/AFF3MwKqAKeoF9AWnLoj9BUmUOzqFgf0wAwNv0o90hCgYcCNCh6DoBmJE0eJCEUwBAAe+Kl2vZlFFAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="[0, 1]^d" style="vertical-align: -5px"/> interval.</p>
<p>When the dimension increases, the variance goes to zero,
but the variation in the sense of Hardy and Krause goes to infinity.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dimension</span> <span class="o">=</span> <span class="mi">5</span>


<span class="k">def</span> <span class="nf">g_function_py</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates the exponential integrand function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : ot.Point</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y : ot.Point</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dimension</span><span class="p">)</span> <span class="o">**</span> <span class="n">dimension</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">*=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">dimension</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>


<span class="n">g_function</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">g_function_py</span><span class="p">)</span>
<span class="n">interval</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dimension</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dimension</span><span class="p">)</span>
<span class="n">integral</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exact integral = &quot;</span><span class="p">,</span> <span class="n">integral</span><span class="p">)</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ExponentialProduct&quot;</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Exact integral =  1.0
</pre></div>
</div>
<p>In the next cell, we evaluate the Smolyak quadrature.
We first create a Smolyak experiment using a Gauss-Legendre
marginal experiment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uniform</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussProductExperiment</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">]</span> <span class="o">*</span> <span class="n">dimension</span>
<span class="n">level</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;level = &quot;</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">SmolyakExperiment</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="n">nodes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generateWithWeights</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;size = &quot;</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>level =  5
size =  781
</pre></div>
</div>
<p>Then we evaluate the function values at the nodes, and
use the <cite>dot</cite> product in order to compute the weighted
sum of function values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g_values</span> <span class="o">=</span> <span class="n">g_function</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<span class="n">g_values_point</span> <span class="o">=</span> <span class="n">g_values</span><span class="o">.</span><span class="n">asPoint</span><span class="p">()</span>
<span class="n">approximate_integral</span> <span class="o">=</span> <span class="n">g_values_point</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">lre10</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">approximate_integral</span> <span class="o">-</span> <span class="n">integral</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">integral</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Approx. integral = &quot;</span><span class="p">,</span> <span class="n">approximate_integral</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Log-relative error in base 10= </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lre10</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Approx. integral =  1.007384006870824
Log-relative error in base 10= 2.13
</pre></div>
</div>
<p>We see that Smolyak’s quadrature has produced a quite accurate
approximation of the integral.
With only 781 nodes in dimension 4, the approximation has more than 2 correct
digits.</p>
<p>In the next cell, we use a tensorized Gauss quadrature rule and
compute the accuracy of the quadrature.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numberOfMarginalNodes</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">collectionOfMarginalNumberOfNodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">numberOfMarginalNodes</span><span class="p">]</span> <span class="o">*</span> <span class="n">dimension</span>
<span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">dimension</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussProductExperiment</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">collectionOfMarginalNumberOfNodes</span><span class="p">)</span>
<span class="n">nodes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generateWithWeights</span><span class="p">()</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;size = &quot;</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span>
<span class="n">g_values</span> <span class="o">=</span> <span class="n">g_function</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<span class="n">g_values_point</span> <span class="o">=</span> <span class="n">g_values</span><span class="o">.</span><span class="n">asPoint</span><span class="p">()</span>
<span class="n">approximate_integral</span> <span class="o">=</span> <span class="n">g_values_point</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">lre10</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">approximate_integral</span> <span class="o">-</span> <span class="n">integral</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">integral</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Approx. integral = &quot;</span><span class="p">,</span> <span class="n">approximate_integral</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Log-relative error in base 10= </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lre10</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>size =  3125
Approx. integral =  1.0086187030911973
Log-relative error in base 10= 2.06
</pre></div>
</div>
<p>Using 5 nodes in each dimension leads to a total number of nodes
equal to 3125.
This relatively large number of nodes leads to an approximate integral
which has more than 2 correct digits.</p>
<p>We want to see how the quadrature converges to the true integral
when the number of nodes increases and the speed of convergence.
To do this, we create a set of helper functions which evaluate the
quadrature rule, compute the table of the absolute error versus the number of
nodes and plot it.</p>
<p>The next function performs Smolyak quadrature on a function on the
unit cube using Gauss-Legendre quadrature rule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">smolyakQuadrature</span><span class="p">(</span><span class="n">g_function</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrate a function g on the unit cube [0, 1]^d using Smolyak quadrature.</span>

<span class="sd">    Uses a Gauss-Legendre quadrature rule as the marginal quadrature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    g_function : ot.Function</span>
<span class="sd">        The integrand, with d inputs and dimension 1 output.</span>
<span class="sd">    level : int</span>
<span class="sd">        The level of Smolyak quadrature.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    size : int</span>
<span class="sd">        The number of nodes in the quadrature.</span>
<span class="sd">    abserr : float</span>
<span class="sd">        The absolute error.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">g_function</span><span class="o">.</span><span class="n">getInputDimension</span><span class="p">()</span>
    <span class="n">uniform</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussProductExperiment</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">]</span> <span class="o">*</span> <span class="n">dimension</span>
    <span class="n">experiment</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">SmolyakExperiment</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
    <span class="n">nodes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generateWithWeights</span><span class="p">()</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
    <span class="n">g_values</span> <span class="o">=</span> <span class="n">g_function</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">g_values_point</span> <span class="o">=</span> <span class="n">g_values</span><span class="o">.</span><span class="n">asPoint</span><span class="p">()</span>
    <span class="n">approximate_integral</span> <span class="o">=</span> <span class="n">g_values_point</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">abserr</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">approximate_integral</span> <span class="o">-</span> <span class="n">integral</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">size</span><span class="p">,</span> <span class="n">abserr</span><span class="p">]</span>
</pre></div>
</div>
<p>Similarly, the next function uses the Gauss-Legendre quadrature rule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tensorizedGaussQuadrature</span><span class="p">(</span><span class="n">g_function</span><span class="p">,</span> <span class="n">numberOfMarginalNodes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrate a function g on the unit cube [0, 1]^d.</span>

<span class="sd">    Uses a tensorized Gauss-Legendre quadrature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    g_function : ot.Function</span>
<span class="sd">        The integrand, with d inputs and dimension 1 output.</span>
<span class="sd">    level : int</span>
<span class="sd">        The level of Smolyak quadrature.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    size : int</span>
<span class="sd">        The number of nodes in the quadrature.</span>
<span class="sd">    abserr : float</span>
<span class="sd">        The absolute error.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">g_function</span><span class="o">.</span><span class="n">getInputDimension</span><span class="p">()</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="p">[</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">dimension</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
    <span class="n">collectionOfMarginalNumberOfNodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">numberOfMarginalNodes</span><span class="p">]</span> <span class="o">*</span> <span class="n">dimension</span>
    <span class="n">experiment</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussProductExperiment</span><span class="p">(</span>
        <span class="n">distribution</span><span class="p">,</span> <span class="n">collectionOfMarginalNumberOfNodes</span>
    <span class="p">)</span>
    <span class="n">nodes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">generateWithWeights</span><span class="p">()</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
    <span class="n">g_values</span> <span class="o">=</span> <span class="n">g_function</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">g_values_point</span> <span class="o">=</span> <span class="n">g_values</span><span class="o">.</span><span class="n">asPoint</span><span class="p">()</span>
    <span class="n">approximate_integral</span> <span class="o">=</span> <span class="n">g_values_point</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">abserr</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">approximate_integral</span> <span class="o">-</span> <span class="n">integral</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">size</span><span class="p">,</span> <span class="n">abserr</span><span class="p">]</span>
</pre></div>
</div>
<p>The following function plots the absolute error versus the
number of nodes and returns the graph.
Moreover, it fits a linear least squares model against the data.
The model is (<a class="reference internal" href="../../bibliography.html#gerstner1998" id="id3"><span>[gerstner1998]</span></a> page 222)</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAAAQBAMAAAABqIdEAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIudz2DzrzLdGEi/++kh5/yJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABPUlEQVQoz2NgIBYYlnIxkA5YAtiYSNPBXF5ebrCNgU2LDNt0GPgMyNAmw7BsAzKfURGXKUKCDcJaSt4QDruiYCkDg3kpTNKZIRRZLY8LCBSAAkGBpSL6EoMkkiSfAIzFlMBQAaLVMCyzY2BcCJQ1QRI6AmexTVQOANFbMLR9AtldAHQNAnwpV4Cy1jdAaCN0XRy/gARvAMMPhBAXgr0eRBQaMUzXYWASQvYb9wcGhgX9DIwPAhD6gNoWl8o0iQMduYFBmnODOcMtlg3bmVCCOIOBqUEP6EwFhNAhBgaF38wT2IBuKRRasI3hKPcEzoD93iiubBfUAjqdu3ABQohdUYt7AkvAMlgKyGIq4F3AXUtMSjNgWyADYYpzZIkaiHM7sBCTpDcsY3CFuJtH0JnhkAGXqjYR2jgZtjMYbwAAjkU+xHifAWEAAAAKdEVYdERlcHRoAP////xgkZBVAAAAAElFTkSuQmCC" alt="e_{abs} = c n^{-\alpha} \epsilon_m"/></p>
</div><p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAALBAMAAAB8LOv9AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIudz2DzrzLdGEi/+1xiTPsAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAB2SURBVAjXY2BgVDRgQALODKFIPKYEhgoQrQbhsk1UDgDRWyDcdQ0Q2gjKBRGFRgzTdRiYhICKNzBIc24wZ7jFsmE70wYGjkKhBdsYjnJP4AzY5w3RoMOQxVTAu4C7FsIV58gSNRDndmCBcHkEnRkOGXCpajMAALdTFanRxH52AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="e_{abs}" style="vertical-align: -3px"/> is the absolute error, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAdIsyz6+d6RhI8xONfKYAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAuSURBVAjXY2BgVBRmYHBicGVgK2CQYOBWYGBgsG4AErMZGDgYuAwYlBmYA4UaAEZkBBeN279pAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="c" style="vertical-align: 0px"/> is a constant
parameter representing the absolute error when the number of nodes
is equal to 1, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LGM9IMmD73fO/r+mGTbZDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgVHY2TWBgqMg0YFzAwCBgzcAUwMDAcJaBVQFIzWDgL2BgYP/AIMfBwMD8gOEsMwMDkwFDrggDAP0FCNj5FTHGAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="n" style="vertical-align: 0px"/> is the number of nodes, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgYFR2ZQACN4YKBgMG5gkMXNIbGDgMGDiVGBjiCxh4jjIw7Gdg4ElgYOAKYLiTUMDAmnix9FEBANuoCvKuJg1RAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\alpha" style="vertical-align: 0px"/> is a constant
parameter representing the order of convergence and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAALBAMAAABv+6sJAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAna9g6XS/z4sYMkjd8+BKY0AAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABSSURBVAjXY2BgVDJggAJXGIOBrQDO5CvSgDHnLUCILmDgFDLNalUAqm1g4ODbIMNwASisETFhD0Mx5wWIIkGGm6wJEGY15wV2CwjzALcCozQDAKRBDjtBK4SzAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\epsilon_m" style="vertical-align: -3px"/>
is the multiplicative residual.
The logarithm of the previous equation is</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAATBAMAAABCYq0+AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0yv89gdJ2Lrxjz6fv9xBs/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADD0lEQVRIx42WTWgTQRiG381uspvNT0PRSy9VC714cFGKIEoLHurPwfSgFE+rIFXwEAVt4kFzsW0Khe1Fm1ZhRSRNT6sVrAg22oMHLwEPHopQ9CReCkVBCtaZ3Z11Z39SB5Ls7Pfs++7M981MAK6t8F0FHZrDVrFrW+kk1r3l7xX5YGaI6wqHtBD7Mko0CgyKseb3V/RAsMJ3u7QQKxtRohFgSCzCPxcM5uJlWai9m38ucGHF+4feUC3FyjK2sZt/JSD2IMY/A/QFdVLFGFnLY6909v8HMrGQv1ybABanJ01s0Nct+6MbQdnynA51avGOw45ryHOEXDsZAZYX6iOemOuvLOmu/zQkQzWTZCW1gGQ15S/CTfKRztNm2rKKidNYwqjDGkkTXZz/GbyFEQTFS99x0xXz/D+z8We2IW5mS0obIqmlR1Dp3KVbTvRHYPyrFgbxATM2OwPZQt5fT+k2sjcKQVAmavc9McdfYpndkslr/UpW1SIEovm+MmGvYDf8MeB/j3zpo3hms7/pvSzxTx2gjYw7byA3FQYlk04EFSNz+cWey66LTb9/au2EhUwLGbccFSM6/7bs9SPrlBW36T0u/4MWEn0hEHndLnN//ldZhW4RGWFbkXUbyNAcqWUj0RzCQ8N5xJ9/YtBrVW/brLBJy5vz7wUSYZBkQm7rvD9dIcSH1t8SpKpaoDfXgXeQC/sVM2+NCOYsxH2B8asmTuGJy64hreGwH8hquGxaIfAxyYDBxNz8E2vigz0/9XStAXHnTz8wCRwbXxBakt6NfuFnAWludxXOXcDcfAmDO191lwXqfkJsjC2PWiGwBqFhMTG3/puV58SHPfhCW76rYcAp4qGsNU+KtWcDCStic8n0ZY5+c1ngYPzBx4NMzNt/qA+7rpEZKbmEbB5/dVU295KDayBKltbmMFMTi/H+HAgm9sbbq4iPdwyT40GD6ByRw7eq0hxeXyvgbOTpSvL4ibGSFe/PgQiLER8Pbdafkp8xHkgXInV76vMaY2c7/fPwg3FiXBM7dqOC2n+LRor9BXWK+HzI4uS6AAAACnRFWHREZXB0aAD////+jp/xeQAAAABJRU5ErkJggg==" alt="\log(e_{abs}) = \log(c) - \alpha \log(n) + \epsilon_a"/></p>
</div><p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF4AAAATBAMAAADrOqfvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAna9g6XS/z4sYMt1I8/v/F6RnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABZUlEQVQoz4WTsU/CUBDGv1extKUNYHSvMMjg0MXRxMUBJ8AE2cSBqJMgg2shMdGtDG4QWIzGxMBMTGz4B+zi4MaqLm4mxkSPAmkhT3tDc9fv965313tAkDU8l/EJ9bHji8qeKxf5B6I+nhk+oRDMh/xCKJifSSlkAngLfb+wQM2whMHhszUDQnw1hyHFS8mpQtH21BfPRqa7PNNxhAQqgENVe1V8QCzz6mlb6OIZy1C2gENPeUX0NMXh9+lhVLAGlfjPhDlVXtDu4C9+8y4N2YH85SlDdxZC1pyrv2vhyYrtjjskvpHM3+bcSCT0gelz+QUdB1gf+WlQ5zC/WU8DlB6QKjQdcWak6kkVtXoG3Z93Ayv0+fNLtRc2WoDkNiIVNYvz1+S+fP2Gm/EWxTQrD0RcblG/v+LwjJKVJkjYbqFqTg6jtBfjrTUVuwPF3eEIBojbOP73pgwu6jS8De+FZCPYlBn3F6LgVXW0LFX+AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\epsilon_a = \log(\epsilon_m)" style="vertical-align: -5px"/> is the additive residual
in logarithmic scale.
This model states that the curve presenting the error depending on the
number of nodes is a line with slope <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgYFR2ZQACN4YKBgMG5gkMXNIbGDgMGDiVGBjiCxh4jjIw7Gdg4ElgYOAKYLiTUMDAmnix9FEBANuoCvKuJg1RAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\alpha" style="vertical-align: 0px"/> in a log-log plot.
A method with a more negative slope is favored, since it means that the
speed of convergence is faster.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drawQuadrature</span><span class="p">(</span>
    <span class="n">size_list</span><span class="p">,</span> <span class="n">abserr_list</span><span class="p">,</span> <span class="n">quadratureName</span><span class="o">=</span><span class="s2">&quot;Quadrature&quot;</span><span class="p">,</span> <span class="n">pointStyle</span><span class="o">=</span><span class="s2">&quot;bullet&quot;</span>
<span class="p">):</span>
    <span class="c1"># Plot the quadrature given the list of size and absolute errors.</span>

    <span class="c1"># Compute least squares fit</span>
    <span class="n">data_logn</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">BuildFromPoint</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">size_list</span><span class="p">))</span>
    <span class="n">data_loge</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">BuildFromPoint</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">abserr_list</span><span class="p">))</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;log_n&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="s2">&quot;log_n&quot;</span><span class="p">])</span>
    <span class="n">designMatrix</span> <span class="o">=</span> <span class="n">basis</span><span class="p">(</span><span class="n">data_logn</span><span class="p">)</span>
    <span class="n">myLeastSquares</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearLeastSquares</span><span class="p">(</span><span class="n">designMatrix</span><span class="p">,</span> <span class="n">data_loge</span><span class="p">)</span>
    <span class="n">myLeastSquares</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">ls_fit</span> <span class="o">=</span> <span class="n">myLeastSquares</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
    <span class="n">logerror_fit</span> <span class="o">=</span> <span class="n">ls_fit</span><span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="n">data_logn</span><span class="p">))</span>
    <span class="n">error_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logerror_fit</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">myLeastSquares</span><span class="o">.</span><span class="n">getLinear</span><span class="p">()[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="c1">#</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">size_list</span><span class="p">,</span> <span class="n">abserr_list</span><span class="p">)</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="n">quadratureName</span><span class="p">)</span>
    <span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="n">pointStyle</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">size_list</span><span class="p">,</span> <span class="n">error_fit</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\alpha$ = </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>
</pre></div>
</div>
<p>The next two functions plots the Smolyak and tensorized Gauss quadrature.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drawSmolyakQuadrature</span><span class="p">(</span><span class="n">level_max</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Smolyak-Gauss Quadrature&quot;</span><span class="p">)</span>
    <span class="n">size_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">abserr_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">level_max</span><span class="p">):</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">abserr</span> <span class="o">=</span> <span class="n">smolyakQuadrature</span><span class="p">(</span><span class="n">g_function</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;size = </span><span class="si">%d</span><span class="s2">, level = </span><span class="si">%d</span><span class="s2">, ea = </span><span class="si">%.3e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">abserr</span><span class="p">))</span>
        <span class="n">size_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">abserr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abserr</span><span class="p">)</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">drawQuadrature</span><span class="p">(</span><span class="n">size_list</span><span class="p">,</span> <span class="n">abserr_list</span><span class="p">,</span> <span class="s2">&quot;Smolyak-Gauss&quot;</span><span class="p">,</span> <span class="s2">&quot;bullet&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>


<span class="k">def</span> <span class="nf">drawTensorizedGaussQuadrature</span><span class="p">(</span><span class="n">n_max</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tensorized Gauss Quadrature&quot;</span><span class="p">)</span>
    <span class="n">size_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">abserr_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_max</span><span class="p">):</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">abserr</span> <span class="o">=</span> <span class="n">tensorizedGaussQuadrature</span><span class="p">(</span><span class="n">g_function</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;size = </span><span class="si">%d</span><span class="s2">, n = </span><span class="si">%d</span><span class="s2">, ea = </span><span class="si">%.3e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">abserr</span><span class="p">))</span>
        <span class="n">size_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">abserr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abserr</span><span class="p">)</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">drawQuadrature</span><span class="p">(</span><span class="n">size_list</span><span class="p">,</span> <span class="n">abserr_list</span><span class="p">,</span> <span class="s2">&quot;Gauss-Legendre&quot;</span><span class="p">,</span> <span class="s2">&quot;plus&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>
</pre></div>
</div>
<p>We can finally create the graph.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">level_max</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Exponential problem&quot;</span><span class="p">,</span> <span class="s2">&quot;$n$&quot;</span><span class="p">,</span> <span class="s2">&quot;$e_</span><span class="si">{abs}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">drawSmolyakQuadrature</span><span class="p">(</span><span class="n">level_max</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="n">n_max</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">drawTensorizedGaussQuadrature</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLogScale</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">GraphImplementation</span><span class="o">.</span><span class="n">LOGXY</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_smolyak_quadrature_001.png" srcset="../../_images/sphx_glr_plot_smolyak_quadrature_001.png" alt="Exponential problem" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Smolyak-Gauss Quadrature
size = 1, level = 1, ea = 2.442e-01
size = 11, level = 2, ea = 4.885e-02
size = 61, level = 3, ea = 2.120e-02
size = 241, level = 4, ea = 1.174e-02
size = 781, level = 5, ea = 7.384e-03
size = 2203, level = 6, ea = 5.026e-03
size = 5593, level = 7, ea = 3.614e-03
size = 13073, level = 8, ea = 2.708e-03
size = 28553, level = 9, ea = 2.094e-03
size = 58923, level = 10, ea = 1.660e-03
size = 115813, level = 11, ea = 1.344e-03
size = 218193, level = 12, ea = 1.107e-03
size = 395973, level = 13, ea = 9.250e-04
Tensorized Gauss Quadrature
size = 1, n = 1, ea = 2.442e-01
size = 32, n = 2, ea = 6.074e-02
size = 243, n = 3, ea = 2.606e-02
size = 1024, n = 4, ea = 1.405e-02
size = 3125, n = 5, ea = 8.619e-03
size = 7776, n = 6, ea = 5.749e-03
size = 16807, n = 7, ea = 4.068e-03
size = 32768, n = 8, ea = 3.008e-03
size = 59049, n = 9, ea = 2.300e-03
size = 100000, n = 10, ea = 1.808e-03
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  7.741 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-design-of-experiments-plot-smolyak-quadrature-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4efee4bafbdfe43da21f1d7dcb1c1886/plot_smolyak_quadrature.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_smolyak_quadrature.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d7bc48e3cbd80d73f4f598ad607bb85c/plot_smolyak_quadrature.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_smolyak_quadrature.ipynb</span></code></a></p>
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../auto_functional_modeling/index.html" title="Functional modeling"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_smolyak_merge.html" title="Merge nodes in Smolyak quadrature"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Design of experiments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Use the Smolyak quadrature</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>