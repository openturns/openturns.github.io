
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The HSIC sensitivity indices: the Ishigami model &#8212; OpenTURNS 1.20dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Create a composite design of experiments" href="../design_of_experiments/plot_composite_experiment.html" />
    <link rel="prev" title="Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis" href="plot_sensitivity_sobol.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../design_of_experiments/plot_composite_experiment.html" title="Create a composite design of experiments"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_sobol.html" title="Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" accesskey="U">Reliability &amp; Sensitivity</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The HSIC sensitivity indices: the Ishigami model</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">The HSIC sensitivity indices: the Ishigami model</a><ul>
<li><a class="reference internal" href="#definition-of-the-model">Definition of the model</a></li>
<li><a class="reference internal" href="#setting-the-covariance-models">Setting the covariance models</a></li>
<li><a class="reference internal" href="#the-global-hsic-estimator">The Global HSIC estimator</a><ul>
<li><a class="reference internal" href="#choosing-an-estimator">Choosing an estimator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-target-hsic-estimator">The Target HSIC estimator</a><ul>
<li><a class="reference internal" href="#defining-a-filter-function">Defining a filter function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-conditional-hsic-estimator">The Conditional HSIC estimator</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_sensitivity_sobol.html"
                          title="previous chapter">Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../design_of_experiments/plot_composite_experiment.html"
                          title="next chapter">Create a composite design of experiments</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/sensitivity_analysis/plot_hsic_estimators_ishigami.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-hsic-estimators-ishigami-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="the-hsic-sensitivity-indices-the-ishigami-model">
<span id="sphx-glr-auto-reliability-sensitivity-sensitivity-analysis-plot-hsic-estimators-ishigami-py"></span><h1>The HSIC sensitivity indices: the Ishigami model<a class="headerlink" href="#the-hsic-sensitivity-indices-the-ishigami-model" title="Permalink to this heading">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">ishigami_function</span>
</pre></div>
</div>
<p>This example is a brief overview of the HSIC sensitivity indices classes and how to call them.
HSIC estimators rely on a reproducing kernel of a Hilbert space. We can use them to compute sensitivity
indices. We present the methods on the <a class="reference internal" href="../../usecases/use_case_ishigami.html#use-case-ishigami"><span class="std std-ref">Ishigami function</span></a>.</p>
<section id="definition-of-the-model">
<h2>Definition of the model<a class="headerlink" href="#definition-of-the-model" title="Permalink to this heading">¶</a></h2>
<p>We load the model from the usecases module.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">ishigami_function</span><span class="o">.</span><span class="n">IshigamiModel</span><span class="p">()</span>
</pre></div>
</div>
<p>We generate an input sample of size 100 (and dimension 3).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>We compute the output by applying the Ishigami model to the input sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="setting-the-covariance-models">
<h2>Setting the covariance models<a class="headerlink" href="#setting-the-covariance-models" title="Permalink to this heading">¶</a></h2>
<p>The HSIC algorithms use reproducing kernels defined on Hilbert spaces to estimate independence.
For each input variable we choose a covariance kernel.
Here we choose a <a class="reference internal" href="../../user_manual/_generated/openturns.SquaredExponential.html#openturns.SquaredExponential" title="openturns.SquaredExponential"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquaredExponential</span></code></a>
kernel for all input variables.</p>
<p>They are all stored in a list of <img class="math" src="../../_images/math/5a0ccea1195896363fea2eff146089eeec84e27e.svg" alt="d+1"/> covariance kernels where <img class="math" src="../../_images/math/5da6e6d65e4ae3032c58fe8c94955247fc4ebe22.svg" alt="d"/> is the number of
input variables. The remaining one is for the output variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">covarianceModelCollection</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">Xi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">inputCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SquaredExponential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">inputCovariance</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">Xi</span><span class="o">.</span><span class="n">computeStandardDeviation</span><span class="p">())</span>
    <span class="n">covarianceModelCollection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inputCovariance</span><span class="p">)</span>
</pre></div>
</div>
<p>Likewise we define a covariance kernel associated to the output variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">outputCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SquaredExponential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">outputCovariance</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">computeStandardDeviation</span><span class="p">())</span>
<span class="n">covarianceModelCollection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outputCovariance</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="the-global-hsic-estimator">
<h2>The Global HSIC estimator<a class="headerlink" href="#the-global-hsic-estimator" title="Permalink to this heading">¶</a></h2>
<p>In this paragraph, we perform the analysis on the raw data: that is
the global HSIC estimator.</p>
<section id="choosing-an-estimator">
<h3>Choosing an estimator<a class="headerlink" href="#choosing-an-estimator" title="Permalink to this heading">¶</a></h3>
<p>After having defined the covariance kernels one has to select an
appropriate estimator for the computations.</p>
<p>Two estimators are proposed:</p>
<ul class="simple">
<li><p>an unbiased estimator through the <a class="reference internal" href="../../user_manual/_generated/openturns.HSICUStat.html#openturns.HSICUStat" title="openturns.HSICUStat"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSICUStat</span></code></a> class</p></li>
<li><p>a biased, but asymptotically unbiased, estimator through the <a class="reference internal" href="../../user_manual/_generated/openturns.HSICVStat.html#openturns.HSICVStat" title="openturns.HSICVStat"><code class="xref py py-class docutils literal notranslate"><span class="pre">HSICVStat</span></code></a> class</p></li>
</ul>
<p>Beware that the conditional analysis used later cannot be performed with the unbiased estimator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimatorType</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HSICUStat</span><span class="p">()</span>
</pre></div>
</div>
<p>We now build the HSIC estimator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">globHSIC</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HSICEstimatorGlobalSensitivity</span><span class="p">(</span>
    <span class="n">covarianceModelCollection</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">estimatorType</span><span class="p">)</span>
</pre></div>
</div>
<p>We get the R2-HSIC indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R2HSICIndices</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">getR2HSICIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Global HSIC analysis&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R2-HSIC Indices: &quot;</span><span class="p">,</span> <span class="n">R2HSICIndices</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> Global HSIC analysis
R2-HSIC Indices:  [0.0639736,-0.000188039,0.0140331]
</pre></div>
</div>
<p>and the HSIC indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HSICIndices</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">getHSICIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HSIC Indices: &quot;</span><span class="p">,</span> <span class="n">HSICIndices</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>HSIC Indices:  [0.0051169,-1.57797e-05,0.00108955]
</pre></div>
</div>
<p>The p-value by permutation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pvperm</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">getPValuesPermutation</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value (permutation): &quot;</span><span class="p">,</span> <span class="n">pvperm</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>p-value (permutation):  [0,0.356436,0.148515]
</pre></div>
</div>
<p>We have an asymptotic estimate of the value for this estimator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pvas</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">getPValuesAsymptotic</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value (asymptotic): &quot;</span><span class="p">,</span> <span class="n">pvas</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>p-value (asymptotic):  [0.00207356,0.420886,0.156227]
</pre></div>
</div>
<p>We vizualise the results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph1</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">drawHSICIndices</span><span class="p">()</span>
<span class="n">view1</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph1</span><span class="p">)</span>

<span class="n">graph2</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">drawPValuesAsymptotic</span><span class="p">()</span>
<span class="n">view2</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph2</span><span class="p">)</span>

<span class="n">graph3</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">drawR2HSICIndices</span><span class="p">()</span>
<span class="n">view3</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph3</span><span class="p">)</span>

<span class="n">graph4</span> <span class="o">=</span> <span class="n">globHSIC</span><span class="o">.</span><span class="n">drawPValuesPermutation</span><span class="p">()</span>
<span class="n">view4</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph4</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_001.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_001.png" alt="HSIC indices" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_002.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_002.png" alt="Asymptotic p-values" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_003.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_003.png" alt="R2-HSIC indices" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_004.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_004.png" alt="p-values by permutation" class = "sphx-glr-multi-img"/></li>
</ul>
</section>
</section>
<section id="the-target-hsic-estimator">
<h2>The Target HSIC estimator<a class="headerlink" href="#the-target-hsic-estimator" title="Permalink to this heading">¶</a></h2>
<p>We now perform the target analysis which consists in using a filter function over the
output.</p>
<section id="defining-a-filter-function">
<h3>Defining a filter function<a class="headerlink" href="#defining-a-filter-function" title="Permalink to this heading">¶</a></h3>
<p>We define a filter function on the output variable for the target
analysis. In this example we use the function <img class="math" src="../../_images/math/6f5e230db60cd0717aa84bfe768f1f1b84db9e2d.svg" alt="\exp{(-d/s)}"/> where <img class="math" src="../../_images/math/5da6e6d65e4ae3032c58fe8c94955247fc4ebe22.svg" alt="d"/> is the distance
to a well-chosen interval.</p>
<p>We first define a critical domain: in our case that is the <img class="math" src="../../_images/math/f20c8ce08e729a8565410f121a3145401f24698b.svg" alt="[5,+\infty["/> interval.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">criticalDomain</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We have access to the distance to this  domain thanks to the
<a class="reference internal" href="../../user_manual/_generated/openturns.DistanceToDomainFunction.html#openturns.DistanceToDomainFunction" title="openturns.DistanceToDomainFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceToDomainFunction</span></code></a> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dist2criticalDomain</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">DistanceToDomainFunction</span><span class="p">(</span><span class="n">criticalDomain</span><span class="p">)</span>
</pre></div>
</div>
<p>We define the parameters in our function from the output sample</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Y</span><span class="o">.</span><span class="n">computeStandardDeviation</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>We now define our filter function by composition of the parametrized function and
the distance function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;exp(-x/s)&quot;</span><span class="p">])</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">s</span><span class="p">])</span>
<span class="n">filterFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedFunction</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">dist2criticalDomain</span><span class="p">)</span>
</pre></div>
</div>
<p>We choose an unbiased estimator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimatorType</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HSICUStat</span><span class="p">()</span>
</pre></div>
</div>
<p>and build the HSIC estimator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">targetHSIC</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HSICEstimatorTargetSensitivity</span><span class="p">(</span>
    <span class="n">covarianceModelCollection</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">estimatorType</span><span class="p">,</span> <span class="n">filterFunction</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We get the R2-HSIC indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R2HSICIndices</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">getR2HSICIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Target HSIC analysis&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R2-HSIC Indices: &quot;</span><span class="p">,</span> <span class="n">R2HSICIndices</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> Target HSIC analysis
R2-HSIC Indices:  [0.0321494,0.00293329,-0.00627235]
</pre></div>
</div>
<p>and the HSIC indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HSICIndices</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">getHSICIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HSIC Indices: &quot;</span><span class="p">,</span> <span class="n">HSICIndices</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>HSIC Indices:  [0.000192388,1.84164e-05,-3.64356e-05]
</pre></div>
</div>
<p>The p-value by permutation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pvperm</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">getPValuesPermutation</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value (permutation): &quot;</span><span class="p">,</span> <span class="n">pvperm</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>p-value (permutation):  [0,0.257426,0.584158]
</pre></div>
</div>
<p>We have an asymptotic estimate of the value for this estimator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pvas</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">getPValuesAsymptotic</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value (asymptotic): &quot;</span><span class="p">,</span> <span class="n">pvas</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>p-value (asymptotic):  [0.0339153,0.297131,0.589994]
</pre></div>
</div>
<p>We vizualise the results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph5</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">drawHSICIndices</span><span class="p">()</span>
<span class="n">view5</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph5</span><span class="p">)</span>

<span class="n">graph6</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">drawPValuesAsymptotic</span><span class="p">()</span>
<span class="n">view6</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph6</span><span class="p">)</span>

<span class="n">graph7</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">drawR2HSICIndices</span><span class="p">()</span>
<span class="n">view7</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph7</span><span class="p">)</span>

<span class="n">graph8</span> <span class="o">=</span> <span class="n">targetHSIC</span><span class="o">.</span><span class="n">drawPValuesPermutation</span><span class="p">()</span>
<span class="n">view8</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph8</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_005.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_005.png" alt="HSIC indices" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_006.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_006.png" alt="Asymptotic p-values" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_007.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_007.png" alt="R2-HSIC indices" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_008.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_008.png" alt="p-values by permutation" class = "sphx-glr-multi-img"/></li>
</ul>
</section>
</section>
<section id="the-conditional-hsic-estimator">
<h2>The Conditional HSIC estimator<a class="headerlink" href="#the-conditional-hsic-estimator" title="Permalink to this heading">¶</a></h2>
<p>In this last section we preprocess the input variables: that is the conditional
analysis. To do so, one has to work with a weight function.
Here the weight function is the filter function we used previously.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">weightFunction</span> <span class="o">=</span> <span class="n">filterFunction</span>
</pre></div>
</div>
<p>We have to select a biased -but asymptotically unbiased- estimator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimatorType</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HSICVStat</span><span class="p">()</span>
</pre></div>
</div>
<p>We build the conditional HSIC estimator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">condHSIC</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HSICEstimatorConditionalSensitivity</span><span class="p">(</span>
    <span class="n">covarianceModelCollection</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">estimatorType</span><span class="p">,</span> <span class="n">weightFunction</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We get the R2-HSIC indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R2HSICIndices</span> <span class="o">=</span> <span class="n">condHSIC</span><span class="o">.</span><span class="n">getR2HSICIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Conditional HSIC analysis&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R2-HSIC Indices: &quot;</span><span class="p">,</span> <span class="n">R2HSICIndices</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span> Conditional HSIC analysis
R2-HSIC Indices:  [0.250897,0.00916689,0.229481]
</pre></div>
</div>
<p>and the HSIC indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HSICIndices</span> <span class="o">=</span> <span class="n">condHSIC</span><span class="o">.</span><span class="n">getHSICIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HSIC Indices: &quot;</span><span class="p">,</span> <span class="n">HSICIndices</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>HSIC Indices:  [0.0121911,0.000544078,0.0117331]
</pre></div>
</div>
<p>For the conditional estimator we only have access to the p-value by permutation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pvperm</span> <span class="o">=</span> <span class="n">condHSIC</span><span class="o">.</span><span class="n">getPValuesPermutation</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value (permutation): &quot;</span><span class="p">,</span> <span class="n">pvperm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>p-value (permutation):  [0,0.930693,0]
</pre></div>
</div>
<p>We can vizualise the results thanks to the various drawing methods.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph9</span> <span class="o">=</span> <span class="n">condHSIC</span><span class="o">.</span><span class="n">drawHSICIndices</span><span class="p">()</span>
<span class="n">view9</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph9</span><span class="p">)</span>

<span class="n">graph10</span> <span class="o">=</span> <span class="n">condHSIC</span><span class="o">.</span><span class="n">drawR2HSICIndices</span><span class="p">()</span>
<span class="n">view10</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph10</span><span class="p">)</span>

<span class="n">graph11</span> <span class="o">=</span> <span class="n">condHSIC</span><span class="o">.</span><span class="n">drawPValuesPermutation</span><span class="p">()</span>
<span class="n">view11</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph11</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_009.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_009.png" alt="HSIC indices" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_010.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_010.png" alt="R2-HSIC indices" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_hsic_estimators_ishigami_011.png" srcset="../../_images/sphx_glr_plot_hsic_estimators_ishigami_011.png" alt="p-values by permutation" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  3.005 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-hsic-estimators-ishigami-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/db227e2d269c18c21e6f81f19e8b6f32/plot_hsic_estimators_ishigami.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_hsic_estimators_ishigami.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f4228a290d3fe75a60b0f4b230184c7c/plot_hsic_estimators_ishigami.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_hsic_estimators_ishigami.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../design_of_experiments/plot_composite_experiment.html" title="Create a composite design of experiments"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_sobol.html" title="Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The HSIC sensitivity indices: the Ishigami model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
  </body>
</html>