<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estimate Sobol’ indices for a function with multivariate output &#8212; OpenTURNS 1.25dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css?v=105494d3" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=4652c2b6" />
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=e2d0d5e7"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script src="../../_static/js/mysearchtools.js?v=a003391d"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis" href="plot_sensitivity_sobol.html" />
    <link rel="prev" title="Parallel coordinates graph as sensitivity tool" href="plot_sensitivity_par_coo.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_sensitivity_sobol.html" title="Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_par_coo.html" title="Parallel coordinates graph as sensitivity tool"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.25dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate Sobol’ indices for a function with multivariate output</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Estimate Sobol’ indices for a function with multivariate output</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#define-the-model">Define the model</a></li>
<li><a class="reference internal" href="#estimate-the-sobol-indices">Estimate the Sobol’ indices</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_sensitivity_par_coo.html"
                          title="previous chapter">Parallel coordinates graph as sensitivity tool</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_sensitivity_sobol.html"
                          title="next chapter">Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/sensitivity_analysis/plot_sensitivity_sobol_multivariate.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-multivariate-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="estimate-sobol-indices-for-a-function-with-multivariate-output">
<span id="sphx-glr-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-multivariate-py"></span><h1>Estimate Sobol’ indices for a function with multivariate output<a class="headerlink" href="#estimate-sobol-indices-for-a-function-with-multivariate-output" title="Link to this heading">¶</a></h1>
<p>In this example, we estimate the Sobol’ indices of a function by sampling methods.
This function has several outputs, which leads to the need of aggregated Sobol’ indices.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>In this example we quantify the sensitivity of a function’s outputs to its inputs with Sobol’ indices.</p>
<p>The function we consider has 5 outputs. In this case, it may be convenient to consider each output separately.
It may also be interesting to aggregate the sensitivity indices to get a global understanding of the sensitivity of the inputs to the average output.</p>
</section>
<section id="define-the-model">
<h2>Define the model<a class="headerlink" href="#define-the-model" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">openturns</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns.viewer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openturns.viewer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">viewer</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>We define a linear model with 5 independent Gaussian inputs and 2 outputs.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">inputDistribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">function</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;x0&quot;</span><span class="p">,</span> <span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;x3&quot;</span><span class="p">,</span> <span class="s2">&quot;x4&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;x0 + 4.0 * x1 ^ 2 + 3.0 * x2&quot;</span><span class="p">,</span> <span class="s2">&quot;-7.0 * x2 - 4.0 * x3 + x4&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="estimate-the-sobol-indices">
<h2>Estimate the Sobol’ indices<a class="headerlink" href="#estimate-the-sobol-indices" title="Link to this heading">¶</a></h2>
<p>We first create a design of experiments with <cite>SobolIndicesExperiment</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sie</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SobolIndicesExperiment</span><span class="p">(</span><span class="n">inputDistribution</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="n">inputDesign</span> <span class="o">=</span> <span class="n">sie</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">input_names</span> <span class="o">=</span> <span class="n">inputDistribution</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
<span class="n">inputDesign</span><span class="o">.</span><span class="n">setDescription</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample size: &quot;</span><span class="p">,</span> <span class="n">inputDesign</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Sample size:  7000
</pre></div>
</div>
<p>We see that 7000 function evaluations are required to estimate the first order and total Sobol’ indices.
Then we evaluate the outputs corresponding to this design of experiments.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">outputDesign</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we estimate the Sobol’ indices with the <cite>SaltelliSensitivityAlgorithm</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SaltelliSensitivityAlgorithm</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">,</span> <span class="n">outputDesign</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>getFirstOrderIndices</cite> and <cite>getTotalOrderIndices</cite> method respectively return estimates of first order and total Sobol’ indices with a given output.
Since these depend on the output marginal, the index of the output must
be specified (the default is to return the index for the first output).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">output_dimension</span> <span class="o">=</span> <span class="n">function</span><span class="o">.</span><span class="n">getOutputDimension</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">output_dimension</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output #&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">first_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getFirstOrderIndices</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">total_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getTotalOrderIndices</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    First order indices: &quot;</span><span class="p">,</span> <span class="n">first_order</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Total order indices: &quot;</span><span class="p">,</span> <span class="n">total_order</span><span class="p">)</span>

<span class="n">agg_first_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getAggregatedFirstOrderIndices</span><span class="p">()</span>
<span class="n">agg_total_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getAggregatedTotalOrderIndices</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agg. first order indices: &quot;</span><span class="p">,</span> <span class="n">agg_first_order</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agg. total order indices: &quot;</span><span class="p">,</span> <span class="n">agg_total_order</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Output # 0
    First order indices:  [0.00761431,0.621962,0.160892,-0.011267,-0.011267]
    Total order indices:  [0.0089416,0.830274,0.172443,-1.12266e-07,-1.12266e-07]
Output # 1
    First order indices:  [0.0284216,0.0284216,0.73632,0.292301,0.0467992]
    Total order indices:  [-4.32912e-08,-4.32912e-08,0.737774,0.223835,0.0101204]
Agg. first order indices:  [0.019673,0.277982,0.494376,0.164663,0.0223847]
Agg. total order indices:  [0.00375955,0.349097,0.500075,0.129722,0.00586515]
</pre></div>
</div>
<p>We see that:</p>
<ul class="simple">
<li><p><cite>x1</cite> has a rather large first order index on the first output, but a small index on the second output,</p></li>
<li><p><cite>x2</cite> has a rather large first order index on the first output on both outputs,</p></li>
<li><p>the largest aggregated Sobol’ index is <cite>x2</cite>,</p></li>
<li><p><cite>x0</cite> and <cite>x5</cite> have Sobol’ indices which are close to zero regardless of whether the indices are aggregated or not.</p></li>
</ul>
<p>The <cite>draw</cite> method produces the following graph. The vertical bars represent the 95% confidence intervals of the estimates.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sensitivity_sobol_multivariate_001.png" srcset="../../_images/sphx_glr_plot_sensitivity_sobol_multivariate_001.png" alt="Aggregated Sobol' indices - SaltelliSensitivityAlgorithm" class = "sphx-glr-single-img"/><p>Since there are several outputs, the graph presents the aggregated Sobol’ indices.
The aggregated Sobol’ indices indicate that the input variable which has the largest impact on the variability of the several outputs is <cite>x2</cite>.</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-multivariate-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8b9b454e1deedf95dba642ced538dd3e/plot_sensitivity_sobol_multivariate.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sensitivity_sobol_multivariate.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f25408f623236a16fc3c6fe5be1acf3b/plot_sensitivity_sobol_multivariate.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sensitivity_sobol_multivariate.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/37021e17efa0109060d56870a1de49bc/plot_sensitivity_sobol_multivariate.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_sensitivity_sobol_multivariate.zip</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_sensitivity_sobol.html" title="Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_par_coo.html" title="Parallel coordinates graph as sensitivity tool"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.25dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate Sobol’ indices for a function with multivariate output</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>