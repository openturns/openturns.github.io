
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Plot the log-likelihood contours of a distribution &#8212; OpenTURNS 1.20dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A quick start guide to graphs" href="plot_graphs_basics.html" />
    <link rel="prev" title="How to fill an area" href="plot_graphs_fill_area.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../install.html">Get it</a></li>
    <li><a href="../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../index.html">
    <h1>
      <img src="../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_graphs_basics.html" title="A quick start guide to graphs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_graphs_fill_area.html" title="How to fill an area"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Graphs</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Plot the log-likelihood contours of a distribution</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Plot the log-likelihood contours of a distribution</a><ul>
<li><a class="reference internal" href="#generate-a-sample">Generate a sample</a></li>
<li><a class="reference internal" href="#define-the-log-likelihood-function">Define the log-likelihood function</a></li>
<li><a class="reference internal" href="#with-the-draw-method">With the draw method</a></li>
<li><a class="reference internal" href="#customizing-the-number-of-levels">Customizing the number of levels</a></li>
<li><a class="reference internal" href="#getting-the-level-values">Getting the level values</a></li>
<li><a class="reference internal" href="#monochrome-contour-plot">Monochrome contour plot</a></li>
<li><a class="reference internal" href="#multicolor-contour-plot">Multicolor contour plot</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_graphs_fill_area.html"
                          title="previous chapter">How to fill an area</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_graphs_basics.html"
                          title="next chapter">A quick start guide to graphs</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/auto_graphs/plot_graphs_loglikelihood_contour.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-graphs-plot-graphs-loglikelihood-contour-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="plot-the-log-likelihood-contours-of-a-distribution">
<span id="sphx-glr-auto-graphs-plot-graphs-loglikelihood-contour-py"></span><h1>Plot the log-likelihood contours of a distribution<a class="headerlink" href="#plot-the-log-likelihood-contours-of-a-distribution" title="Permalink to this heading">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 5</span>
</pre></div>
</div>
<p>In this example, we show how to plot the bidimensionnal log-likelihood contours of function given a sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<section id="generate-a-sample">
<h2>Generate a sample<a class="headerlink" href="#generate-a-sample" title="Permalink to this heading">¶</a></h2>
<p>We create a <cite>TruncatedNormal</cite> and generate a small sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">TruncatedNormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to see the distribution and the sample, we draw the PDF of the distribution and generate a clouds which X coordinates are the sample values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;TruncatedNormal&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="s2">&quot;red&quot;</span><span class="p">])</span>
<span class="n">zeros</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">getSize</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Sample&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_graphs_loglikelihood_contour_001.png" srcset="../_images/sphx_glr_plot_graphs_loglikelihood_contour_001.png" alt="plot graphs loglikelihood contour" class = "sphx-glr-single-img"/><p>The following function computes the log-likelihood of a <cite>TruncatedNormal</cite> which mean and standard deviations are given as input arguments. The lower and upper bounds of the distribution are computed as minimum and maximum of the sample.</p>
</section>
<section id="define-the-log-likelihood-function">
<h2>Define the log-likelihood function<a class="headerlink" href="#define-the-log-likelihood-function" title="Permalink to this heading">¶</a></h2>
<p>The following function evaluates the log-likelihood function given a point <img class="math" src="../_images/math/90ca82ffb82ec4c678a6a44c0555fc33a4d3e9c8.svg" alt="X=(\mu,\sigma"/>). In order to evaluate the likelihood on the sample, we use a trick: we evaluate the <cite>computeMean</cite> method on the log-PDF sample, then multiply by the sample size. This is much faster than using a <cite>for</cite> loop.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logLikelihood</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Evaluate the log-likelihood of a TruncatedNormal on a sample.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">samplesize</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getMin</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getMax</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">samplesize</span>
    <span class="n">a</span> <span class="o">-=</span> <span class="n">delta</span>
    <span class="n">b</span> <span class="o">+=</span> <span class="n">delta</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">TruncatedNormal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">samplelogpdf</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">computeLogPDF</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">loglikelihood</span> <span class="o">=</span> <span class="n">samplelogpdf</span><span class="o">.</span><span class="n">computeMean</span><span class="p">()</span> <span class="o">*</span> <span class="n">samplesize</span>
    <span class="k">return</span> <span class="n">loglikelihood</span>
</pre></div>
</div>
</section>
<section id="with-the-draw-method">
<h2>With the draw method<a class="headerlink" href="#with-the-draw-method" title="Permalink to this heading">¶</a></h2>
<p>In this section, we use the <cite>draw</cite> method which is available for any <cite>Function</cite> which has 1 or 2 input arguments. In our case, the log-likelihood function has two inputs: <img class="math" src="../_images/math/bc6c9322be0277e80e1d8fdf7e8c1efbbad9ab29.svg" alt="x_0=\mu"/> and <img class="math" src="../_images/math/37f47254773354ca0259046df12acd6580e02be4.svg" alt="x_1=\sigma"/>.</p>
<p>Draw the log-likelihood function with the <cite>draw</cite> method: this is much faster than using a <cite>for</cite> loop.  In order to print LaTeX X and Y labels, we use the <cite>“r”</cite> character in front of the string containing the LaTeX command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logLikelihoodFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">logLikelihood</span><span class="p">)</span>
<span class="n">graphBasic</span> <span class="o">=</span> <span class="n">logLikelihoodFunction</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">graphBasic</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">)</span>
<span class="n">graphBasic</span><span class="o">.</span><span class="n">setYTitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphBasic</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_graphs_loglikelihood_contour_002.png" srcset="../_images/sphx_glr_plot_graphs_loglikelihood_contour_002.png" alt="y0 as a function of (x0,x1)" class = "sphx-glr-single-img"/></section>
<section id="customizing-the-number-of-levels">
<h2>Customizing the number of levels<a class="headerlink" href="#customizing-the-number-of-levels" title="Permalink to this heading">¶</a></h2>
<p>The level values are computed from the quantiles of the data, so that the contours are equally spaced. We can configure the number of levels by setting the <cite>Contour-DefaultLevelsNumber</cite> key in the <cite>ResourceMap</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Contour-DefaultLevelsNumber&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">logLikelihoodFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">logLikelihood</span><span class="p">)</span>
<span class="n">graphBasic</span> <span class="o">=</span> <span class="n">logLikelihoodFunction</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">graphBasic</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">)</span>
<span class="n">graphBasic</span><span class="o">.</span><span class="n">setYTitle</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphBasic</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_graphs_loglikelihood_contour_003.png" srcset="../_images/sphx_glr_plot_graphs_loglikelihood_contour_003.png" alt="y0 as a function of (x0,x1)" class = "sphx-glr-single-img"/><p>A part of the graphics is hidden by the legends. This is why we fine tune the graphics in the next examples.</p>
</section>
<section id="getting-the-level-values">
<h2>Getting the level values<a class="headerlink" href="#getting-the-level-values" title="Permalink to this heading">¶</a></h2>
<p>The level values can be retrieved with the <cite>getLevels</cite> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">drawables</span> <span class="o">=</span> <span class="n">graphBasic</span><span class="o">.</span><span class="n">getDrawables</span><span class="p">()</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drawables</span><span class="p">)):</span>
    <span class="n">contours</span> <span class="o">=</span> <span class="n">drawables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contours</span><span class="o">.</span><span class="n">getLevels</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">levels</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-40.84428512570853, -13.765651599444114, -13.159190501082549, -13.080032173821092, -13.055840526560251]
</pre></div>
</div>
</section>
<section id="monochrome-contour-plot">
<h2>Monochrome contour plot<a class="headerlink" href="#monochrome-contour-plot" title="Permalink to this heading">¶</a></h2>
<p>We first configure the contour plot. By default each level is a dedicated contour in order to have one color per contour, but they all share the same grid and data. We use the <cite>getDrawable</cite> method to take the first contour as the only one with multiple levels. Then we use the <cite>setLevels</cite> method: we ask for many iso-values in the same data so the color will be the same for all curves. In order to inline the level values labels, we use the <cite>setDrawLabels</cite> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">contours</span> <span class="o">=</span> <span class="n">graphBasic</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">contours</span><span class="o">.</span><span class="n">setLevels</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
<span class="n">contours</span><span class="o">.</span><span class="n">setDrawLabels</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we create a new graph. Finally, we use the <cite>setDrawables</cite> to substitute the collection of drawables by a collection reduced to this unique contour.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graphFineTune</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Log-Likelihood&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setDrawables</span><span class="p">([</span><span class="n">contours</span><span class="p">])</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Remove the legend</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphFineTune</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_graphs_loglikelihood_contour_004.png" srcset="../_images/sphx_glr_plot_graphs_loglikelihood_contour_004.png" alt="Log-Likelihood" class = "sphx-glr-single-img"/></section>
<section id="multicolor-contour-plot">
<h2>Multicolor contour plot<a class="headerlink" href="#multicolor-contour-plot" title="Permalink to this heading">¶</a></h2>
<p>The previous contour plot is fine, but lacks of colors. It is not obvious that the colors make the plot clearer given that the values in the contour plot are so different: some adjacent contours have close levels, while others are very different. Anyway, it is obviously nicer to get a colored graphics.</p>
<p>The following script first creates a palette of colors with the <cite>BuildDefaultPalette</cite> class. Before doing so, we configure the <cite>Drawable-DefaultPalettePhase</cite> <cite>ResourceMap</cite> key so that the number of generated colors corresponds to the number of levels. Then we create the <cite>drawables</cite> list, where each item is a single contour with its own level and color.</p>
<p>Take the first contour as the only one with multiple levels</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">contour</span> <span class="o">=</span> <span class="n">graphBasic</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Build a range of colors</span>
<span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span>
    <span class="s1">&#39;Drawable-DefaultPalettePhase&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
<span class="c1"># Create the drawables list, appending each contour with its own color</span>
<span class="n">drawables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)):</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setLevels</span><span class="p">([</span><span class="n">levels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="c1"># Inline the level values</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">setDrawLabels</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># We have to copy the drawable because a Python list stores only pointers</span>
    <span class="n">drawables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="p">(</span><span class="n">contour</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graphFineTune</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Log-Likelihood&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setDrawables</span><span class="p">(</span><span class="n">drawables</span><span class="p">)</span>  <span class="c1"># Replace the drawables</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Remove the legend</span>
<span class="n">graphFineTune</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>  <span class="c1"># Add colors</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphFineTune</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_graphs_loglikelihood_contour_005.png" srcset="../_images/sphx_glr_plot_graphs_loglikelihood_contour_005.png" alt="Log-Likelihood" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.594 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-graphs-plot-graphs-loglikelihood-contour-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ab84722904aa1aa14f1eec0a8404cad9/plot_graphs_loglikelihood_contour.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_graphs_loglikelihood_contour.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/dcd6fb681942f7b4caa40db4a36e19f8/plot_graphs_loglikelihood_contour.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_graphs_loglikelihood_contour.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_graphs_basics.html" title="A quick start guide to graphs"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_graphs_fill_area.html" title="How to fill an area"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Graphs</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Plot the log-likelihood contours of a distribution</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
  </body>
</html>