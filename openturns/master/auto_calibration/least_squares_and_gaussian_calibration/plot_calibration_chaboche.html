
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Calibration of the Chaboche mechanical model &#8212; OpenTURNS 1.22dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bayesian calibration" href="../bayesian_calibration/index.html" />
    <link rel="prev" title="Calibration of the flooding model" href="plot_calibration_flooding.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../bayesian_calibration/index.html" title="Bayesian calibration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_flooding.html" title="Calibration of the flooding model"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the Chaboche mechanical model</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Calibration of the Chaboche mechanical model</a><ul>
<li><a class="reference internal" href="#parameters-to-calibrate-and-observations">Parameters to calibrate and observations</a></li>
<li><a class="reference internal" href="#define-the-observations">Define the observations</a></li>
<li><a class="reference internal" href="#set-the-calibration-parameters">Set the calibration parameters</a></li>
<li><a class="reference internal" href="#calibration-with-linear-least-squares">Calibration with linear least squares</a></li>
<li><a class="reference internal" href="#analysis-of-the-results">Analysis of the results</a></li>
<li><a class="reference internal" href="#calibration-with-nonlinear-least-squares">Calibration with nonlinear least squares</a></li>
<li><a class="reference internal" href="#id1">Analysis of the results</a></li>
<li><a class="reference internal" href="#gaussian-calibration-parameters">Gaussian calibration parameters</a></li>
<li><a class="reference internal" href="#gaussian-linear-calibration">Gaussian linear calibration</a></li>
<li><a class="reference internal" href="#id2">Analysis of the results</a></li>
<li><a class="reference internal" href="#gaussian-nonlinear-calibration">Gaussian nonlinear calibration</a></li>
<li><a class="reference internal" href="#id3">Analysis of the results</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_calibration_flooding.html"
                          title="previous chapter">Calibration of the flooding model</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../bayesian_calibration/index.html"
                          title="next chapter">Bayesian calibration</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/least_squares_and_gaussian_calibration/plot_calibration_chaboche.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-chaboche-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="calibration-of-the-chaboche-mechanical-model">
<span id="sphx-glr-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-chaboche-py"></span><h1>Calibration of the Chaboche mechanical model<a class="headerlink" href="#calibration-of-the-chaboche-mechanical-model" title="Permalink to this heading">¶</a></h1>
<p>In this example we present calibration methods on the Chaboche model.
A detailed explanation of this mechanical law is presented <a class="reference internal" href="../../usecases/use_case_chaboche.html#use-case-chaboche"><span class="std std-ref">here</span></a>.
As we are going to see, this model is relatively simple to calibrate:
its parameters are identifiable and the output is relatively sensitive
to the variation of the parameters.
Hence, all methods perform correctly in this case.</p>
<p>In this example, we use both least squares methods and Bayesian Gaussian
methods.
Please read <a class="reference internal" href="../../theory/data_analysis/code_calibration.html#code-calibration"><span class="std std-ref">Code calibration</span></a> for more details on code calibration
and least squares and read <a class="reference internal" href="../../theory/data_analysis/gaussian_calibration.html#gaussian-calibration"><span class="std std-ref">Gaussian calibration</span></a> for more details
on Gaussian calibration.</p>
<section id="parameters-to-calibrate-and-observations">
<h2>Parameters to calibrate and observations<a class="headerlink" href="#parameters-to-calibrate-and-observations" title="Permalink to this heading">¶</a></h2>
<p>The vector of parameters to calibrate is:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAAATBAMAAACO11WQAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIuvMt3znRjpz2D7v0jPYBFiAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABoklEQVQoz2NgwAAcBQy4AUxOyARVnAuIzf7aBjdAzagyL3CHS/ZCKCYDV1RN1UDMuoCBdwKEq7aBgTkbLsmoAKbcGPhRNYEU8yswMP4D85gzGBi4P6DKMjCEM/Sj6AGb9d6Bgf0HmKvvAFcJBoZgJ/9g8EfRxApSVcPA0AN2CMd3EGmAkN4FItgnMKihaOIBEVEMjdEQ1/2ASzAfe8AgAJFmSzaeBaR4V4EAyEQ2kOhfoauQwGMLgGtavnkCYwMkAPg3MCSh2OQJxHxfQC4AS8NdxviAYTcT0CEgw/wbWD6gaHoJcvMBBiaIKD/IZ4wgFgswdt4BrQZp2sPAfAFFUxs0mg5AnAeySQUqxaQA9bIbQ08Dip94IOazTeCAhhMDiwBMkwBUExvDatS45QSasf8BA2eAN8sKIHcyA8MmBgYvcLAwA0lXBqAwt/oGVE3sAgzMdy8y8C1S4DsE4l4uB0bcG3CksQOxEgPfEcx0zLIAkTgQomAX8gJxBPbUH4FT0yMUI1GAL6pKJO0lQMsasGviFsClCZgD9XDlTgc8ORcsBwBPhlAwbWRbKAAAAAp0RVh0RGVwdGgA/////o6f8XkAAAAASUVORK5CYII=" alt="\theta = (R,C,\gamma)."/></p>
</div><p>We consider a data set where the number of observations is equal to:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAAMBAMAAAAqgQioAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LGM9IMmD73fO/r+mGTbZDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAo0lEQVQY02NgwAR9CQwMTbYNDFhBUX4CA9sDhufYZRn4Exi4BBh0cMsCUSeIyajsbJqAIZtfwJDvAGRWZBowLgDSPKEgcAEq218AUsDAIGDNwBSATW8/SJbhLAOrAoZsfQKDPMhkhhkM/AWYrmpgkAQx2T8wyHFg2MtlwKAKYjI/YDjLjKa3gYFjATA0Sh0YmAwYckVQJH3j3yYwCMk2MGQWAACamyW2Qg8fJAAAAAp0RVh0RGVwdGgA////+RD7ZNoAAAAASUVORK5CYII=" alt="n = 10."/></p>
</div><p>The observations are the pairs <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAAAUBAMAAABMnB83AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL9g6Z0ySHTd88+L+6+Dk2LmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABqklEQVQ4y2NgYFQyYGAQZcAEAQwM7AYM+AALUAnDBiwSQkBscgCfVv4EBgZWbKZzALWxfySklQWrjAMDA+M3Qlp7sMq8AGKCWqdhlbEmpFUeqPUCkI57DBM59f8/SICBl5DWeiBeAPRuA0yAWzEzAOIeIP6MRye7BwMDGzBAtBlgXj7JwOwADl5eAWDsNICZQCAxAV2rpSJQO1Dr73ewKLzOwAFRxQXUKrQZprDDAcPaKGAULECKBbYLDEwPGGB+9YOrY8PUKi8ADiagVh5wmgK6FujS01Ct3xnATDStjHEWitDIcWRg0GFgOLCQIRtszg4GHpBjM8EhzMMl+A4IBJC18vAXvIBqjWBg4DtxEChZC/RwaWsBA0MKUOYMJHJSsDi4kmE7VGs2mM8H1AeLojdAPBGi9Q0WraHgpADSyikADlEZhNaFBxjYNkDS8MKDEAcvYEiAw+3M24A5hh+omk0BpJzpGAMHzFidBAYmoHnsH8BMELC7kzCVYQYYTmWYwLgHlLdWAAkLWEZDctRxBnCKQM6G6KqYgaHChiWdJWCUEsJoNAmgAYUGAEMyZMccxIIZAAAACnRFWHREZXB0aAAAAAAGzkBEOQAAAABJRU5ErkJggg==" alt="\{(\epsilon_i,\sigma_i)\}_{i=1,...,n}" style="vertical-align: -6px"/>,
i.e. each observation is a couple made of the strain and the corresponding stress.</p>
<p>In the particular situation where we want to calibrate this model, the following
list presents which variables are observed input variables, input calibrated
variables and observed output variables.</p>
<ul class="simple">
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAIBAMAAADHKvg1AAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAna9g6XS/z4sYMlMluB4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAApSURBVAjXY2BgVDJgYHBlYGBgKwAS3EUaDAyzF4BYIIKtAUgwaERMAABV6gUwUkjxMQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\epsilon" style="vertical-align: 0px"/>: Input. Observed.</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3RjP6Yt0SDKd+2DyayUzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgYBD6LOwYwMDAwJLAwFwApPkbGDh/Aen1Gxh4vgLpswwMsQ1A2o0h0g9IMXyeYQJSzvWbgQeknOcCA8cHqPYLEO1MBawMDO8XMLA77GNgNLZk4MpoAAAQlxSe7fj0VwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="R" style="vertical-align: 0px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAGJ3PrzKL82Dp3XS/PhALxAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFhJREFUCNdjYGBgVHZSCGJgYEhvYGCpYGBgKWRg4LjAwJAbABSbwMB4CUgxODCwXGQAA/YFEJrXAUonAAluoDiIn8rAwDSBgYF1A5A9hYGhDaSA6YgS0CQAnwkMb0a3XhsAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="C" style="vertical-align: 0px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> : Inputs. Calibrated.</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAANUlEQVQI12NgYNT//5mBgcE1vRNIMjYwrAZSzAcYbgCpYgaGOCAFFDEDCTKwXABSPHPnAEkAOqcJ7ewSY/oAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\sigma" style="vertical-align: 0px"/>: Output. Observed.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">chaboche_model</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-the-observations">
<h2>Define the observations<a class="headerlink" href="#define-the-observations" title="Permalink to this heading">¶</a></h2>
<p>In practice, we generally use a data set which has been obtained from
measurements.
This data set can be loaded using e.g. <a class="reference internal" href="../../user_manual/_generated/openturns.Sample.html#openturns.Sample.ImportFromCSVFile" title="openturns.Sample.ImportFromCSVFile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImportFromCSVFile()</span></code></a>.
Here we import the data from the
<a class="reference internal" href="../../user_manual/_generated/openturns.usecases.chaboche_model.ChabocheModel.html#openturns.usecases.chaboche_model.ChabocheModel" title="openturns.usecases.chaboche_model.ChabocheModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChabocheModel</span></code></a>
class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">chaboche_model</span><span class="o">.</span><span class="n">ChabocheModel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">observedStrain</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">observedStress</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">nbobs</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    [ Strain      Stress (Pa) ]
0 : [ 0           7.56e+08    ]
1 : [ 0.0077      7.57e+08    ]
2 : [ 0.0155      7.85e+08    ]
3 : [ 0.0233      8.19e+08    ]
4 : [ 0.0311      8.01e+08    ]
5 : [ 0.0388      8.42e+08    ]
6 : [ 0.0466      8.49e+08    ]
7 : [ 0.0544      8.79e+08    ]
8 : [ 0.0622      8.85e+08    ]
9 : [ 0.07        8.96e+08    ]
</pre></div>
</div>
<p>Print the Chaboche model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inputs:&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outputs:&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getOutputDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Inputs: [Strain,R,C,Gamma]
Outputs: [Sigma]
</pre></div>
</div>
<p>We see that there are four inputs: <cite>Strain</cite>, <cite>R</cite>, <cite>C</cite> and <cite>Gamma</cite> and one
output: <cite>Sigma</cite>.
The <cite>Strain</cite> is observed on input and the stress <cite>Sigma</cite> is observed on
output.
Using these observations, we want to estimate the parameters <cite>R</cite>, <cite>C</cite>
and <cite>Gamma</cite>.</p>
</section>
<section id="set-the-calibration-parameters">
<h2>Set the calibration parameters<a class="headerlink" href="#set-the-calibration-parameters" title="Permalink to this heading">¶</a></h2>
<p>In this part, we begin the calibration study.
Define the value of the reference values of the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/> parameter.
In the Bayesian framework, this is called the mean of the <em>prior</em> Gaussian
distribution. In the data assimilation framework, this is called the <em>background</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="mf">700e6</span>  <span class="c1"># Exact : 750e6</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">2500e6</span>  <span class="c1"># Exact : 2750e6</span>
<span class="n">Gamma</span> <span class="o">=</span> <span class="mf">8.0</span>  <span class="c1"># Exact : 10</span>
<span class="n">thetaPrior</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">]</span>
</pre></div>
</div>
<p>In the physical model, the inputs and parameters are ordered as
presented in the next table.
Notice that there are no parameters in the physical model.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Strain</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>R</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>C</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Gamma</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>∅</p></td>
<td><p>∅</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 1.</strong> Indices and names of the inputs and parameters of the physical model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Inputs:&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Parameters:&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Physical Model Inputs: [Strain,R,C,Gamma]
Physical Model Parameters: []
</pre></div>
</div>
<p>In order to perform calibration, we have to define a parametric model,
with observed inputs and parameters to calibrate.
In order to do this, we create a <a class="reference internal" href="../../user_manual/_generated/openturns.ParametricFunction.html#openturns.ParametricFunction" title="openturns.ParametricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParametricFunction</span></code></a> where the parameters
are <cite>R</cite>, <cite>C</cite> and <cite>Gamma</cite> which have the indices 1, 2 and 3 in the physical model.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Strain</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>R</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>C</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Gamma</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 2.</strong> Indices and names of the inputs and parameters of the parametric model.</p>
<p>The following statement create the calibrated function from the model.
The calibrated parameters <cite>R</cite>, <cite>C</cite>, <cite>Gamma</cite> are at indices 1, 2, 3 in
the inputs arguments of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibratedIndices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">mycf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">calibratedIndices</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we plot the model and compare it to the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Model before calibration&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain&quot;</span><span class="p">,</span> <span class="s2">&quot;Stress (MPa)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># Plot the model</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">mycf</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">strainMin</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">strainMax</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Model before calibration&quot;</span><span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="s2">&quot;CalibrationResult-ObservationLineStyle&quot;</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="c1"># Plot the noisy observations</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Observations&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="s2">&quot;CalibrationResult-ObservationPointStyle&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_001.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_001.png" alt="Model before calibration" class = "sphx-glr-single-img"/><p>We see that the observations are relatively noisy, but that the
trend is clear: this shows that it may be possible to fit the model.
At this point, we have a data set that we can use for calibration
and a model to calibrate.</p>
</section>
<section id="calibration-with-linear-least-squares">
<h2>Calibration with linear least squares<a class="headerlink" href="#calibration-with-linear-least-squares" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.LinearLeastSquaresCalibration.html#openturns.LinearLeastSquaresCalibration" title="openturns.LinearLeastSquaresCalibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearLeastSquaresCalibration</span></code></a> class performs the
linear least squares
calibration by linearizing the model in the neighbourhood of the reference point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearLeastSquaresCalibration</span><span class="p">(</span>
    <span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">,</span> <span class="s2">&quot;SVD&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.LinearLeastSquaresCalibration.html#openturns.LinearLeastSquaresCalibration.run" title="openturns.LinearLeastSquaresCalibration.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method computes
the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="analysis-of-the-results">
<h2>Analysis of the results<a class="headerlink" href="#analysis-of-the-results" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.getParameterMAP" title="openturns.CalibrationResult.getParameterMAP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getParameterMAP()</span></code></a> method
returns the maximum of the posterior density of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printRCGamma</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">indentation</span><span class="o">=</span><span class="s2">&quot;   &quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print the [R, C, Gamma] vector with readable units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">indentation</span><span class="p">,</span> <span class="s2">&quot;R = </span><span class="si">%.1f</span><span class="s2"> (MPa)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">indentation</span><span class="p">,</span> <span class="s2">&quot;C = </span><span class="si">%.1f</span><span class="s2"> (MPa)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">indentation</span><span class="p">,</span> <span class="s2">&quot;Gamma = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta After = &quot;</span><span class="p">)</span>
<span class="n">printRCGamma</span><span class="p">(</span><span class="n">thetaMAP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta Before = &quot;</span><span class="p">)</span>
<span class="n">printRCGamma</span><span class="p">(</span><span class="n">thetaPrior</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta True = &quot;</span><span class="p">)</span>
<span class="n">thetaTrue</span> <span class="o">=</span> <span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">trueR</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">trueC</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">trueGamma</span><span class="p">]</span>
<span class="n">printRCGamma</span><span class="p">(</span><span class="n">thetaTrue</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>theta After =
    R = 751.2 (MPa)
    C = 2209.6 (MPa)
    Gamma = 0.7726
theta Before =
    R = 700.0 (MPa)
    C = 2500.0 (MPa)
    Gamma = 8.0000
theta True =
    R = 750.0 (MPa)
    C = 2750.0 (MPa)
    Gamma = 10.0000
</pre></div>
</div>
<p>We can compute a 95% confidence interval of the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANBAMAAABSlfMXAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABlSURBVAjXY2BgEDJhYBBgYGBgMnBl4DAAMtwY+BgvTwaywhn6GDofMjBwvGDwY+gsZ2Bgn8CgxqDBzsDAlmw8iwEE+DYwJIEZfg0sD8CMPQzMF8AMN4aeBjCDjWE1mGbgVt8ApgH8XxDmKHijlwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta^\star" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printRCGammaInterval</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">indentation</span><span class="o">=</span><span class="s2">&quot;   &quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print the [R, C, Gamma] C.I. with readable units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lowerBound</span> <span class="o">=</span> <span class="n">interval</span><span class="o">.</span><span class="n">getLowerBound</span><span class="p">()</span>
    <span class="n">upperBound</span> <span class="o">=</span> <span class="n">interval</span><span class="o">.</span><span class="n">getUpperBound</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="n">indentation</span><span class="p">,</span>
        <span class="s2">&quot;R in [</span><span class="si">%.1f</span><span class="s2">, </span><span class="si">%.1f</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="n">indentation</span><span class="p">,</span>
        <span class="s2">&quot;C in [</span><span class="si">%.1f</span><span class="s2">, </span><span class="si">%.1f</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">indentation</span><span class="p">,</span> <span class="s2">&quot;Gamma in [</span><span class="si">%.4f</span><span class="s2">, </span><span class="si">%.4f</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">interval</span> <span class="o">=</span> <span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span>
    <span class="mf">0.95</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;95% C.I.:&quot;</span><span class="p">)</span>
<span class="n">printRCGammaInterval</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>95% C.I.:
    R in [730.3, 772.1]
    C in [758.2, 3661.0]
    Gamma in [-1450.7629, 1452.3081]
</pre></div>
</div>
<p>We can see that the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> parameter has a large confidence interval
relative to the true value of the parameter:
even the sign of the parameter is unknown.
The parameter which is calibrated with the smallest (relative) confidence
interval is <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3RjP6Yt0SDKd+2DyayUzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgYBD6LOwYwMDAwJLAwFwApPkbGDh/Aen1Gxh4vgLpswwMsQ1A2o0h0g9IMXyeYQJSzvWbgQeknOcCA8cHqPYLEO1MBawMDO8XMLA77GNgNLZk4MpoAAAQlxSe7fj0VwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="R" style="vertical-align: 0px"/>.
This is why this parameter seems to be the most important in this case.</p>
<p>Increase the default number of points in the plots.
This produces smoother spiky distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Distribution-DefaultPointNumber&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>We now plot the predicted output stress depending on the input
strain before and after calibration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 3</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_002.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_002.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a good fit after calibration, since the predictions
after calibration are close to the observations.</p>
<p>We can also plot the predicted stress depending on the observed stress.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_003.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_003.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a much better fit after calibration, since the
predictions are close to the diagonal of the graphics.</p>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.getObservationsError" title="openturns.CalibrationResult.getObservationsError"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getObservationsError()</span></code></a> method
returns the estimated distribution of the observation error.
This is necessarily a Gaussian distribution, because this is the distribution
that we assume when we use least squares.
By hypothesis, the distribution has a zero mean (this is a property
of linear least squares).
The standard deviation is estimated from the residuals after calibration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">observationError</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Normal(mu = 0, sigma = 1.14338e+07)
</pre></div>
</div>
<p>In order to validate that the distribution of the residuals is
Gaussian after calibration, we use the
<a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.drawResiduals" title="openturns.CalibrationResult.drawResiduals"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drawResiduals()</span></code></a> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_004.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_004.png" alt="Residual analysis" class = "sphx-glr-single-img"/><p>The analysis of the distribution of the residuals after calibration
shows that the distribution is centered on zero and is symmetric.
This indicates that the calibration performed well.
With the least squares method, the standard deviation of the observation
noise is estimated from the data.
On the plot, we see that the Gaussian with zero mean and estimated
standard deviation is close to the distribution of the residuals
after calibration.
This shows that the distribution of the residuals is close to being Gaussian.</p>
<p>This can also be seen on a Normal-plot.
This is a QQ-plot applied to the normal distribution.
We could use the <a class="reference internal" href="../../user_manual/_generated/openturns.VisualTest.DrawHenryLine.html#openturns.VisualTest.DrawHenryLine" title="openturns.VisualTest.DrawHenryLine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DrawHenryLine()</span></code></a>
method to plot it, but <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.drawResidualsNormalPlot" title="openturns.CalibrationResult.drawResidualsNormalPlot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drawResidualsNormalPlot()</span></code></a>
does it directly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResidualsNormalPlot</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_005.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_005.png" alt="Residuals after calibration vs Gaussian hypothesis" class = "sphx-glr-single-img"/><p>We see that the residuals fit to the Normal distribution,
according to the normal plot.</p>
<p>The parameters which best fit to the data may be sensitive to the random
noise in the observed outputs.
In order to see how this source of randomness changes the optimum
parameter, we use
<a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.drawParameterDistributions" title="openturns.CalibrationResult.drawParameterDistributions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drawParameterDistributions()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_006.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_006.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3RjP6Yt0SDKd+2DyayUzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgYBD6LOwYwMDAwJLAwFwApPkbGDh/Aen1Gxh4vgLpswwMsQ1A2o0h0g9IMXyeYQJSzvWbgQeknOcCA8cHqPYLEO1MBawMDO8XMLA77GNgNLZk4MpoAAAQlxSe7fj0VwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="R" style="vertical-align: 0px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAGJ3PrzKL82Dp3XS/PhALxAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFhJREFUCNdjYGBgVHZSCGJgYEhvYGCpYGBgKWRg4LjAwJAbABSbwMB4CUgxODCwXGQAA/YFEJrXAUonAAluoDiIn8rAwDSBgYF1A5A9hYGhDaSA6YgS0CQAnwkMb0a3XhsAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="C" style="vertical-align: 0px"/> parameters are relatively accurately
estimated.
The parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> is not estimated accurately, as can be
be seen from the very large spread of the distribution of this parameter.
This may reveal that there are identifiability issues with this parameter
when we use a linearization of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotDistributionGridPDF</span><span class="p">(</span><span class="n">distribution</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the marginal and bi-dimensional iso-PDF on a grid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    distribution : ot.Distribution</span>
<span class="sd">        The distribution.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    grid : ot.GridLayout(dimension, dimension)</span>
<span class="sd">        The grid of plots.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">dimension</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">distributionI</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">([</span><span class="n">i</span><span class="p">])</span>
                <span class="n">graph</span> <span class="o">=</span> <span class="n">distributionI</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">distributionJI</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">graph</span> <span class="o">=</span> <span class="n">distributionJI</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dimension</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">setYTitle</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Iso-PDF values&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grid</span>
</pre></div>
</div>
<p>Plot the PDF values of the distribution of the optimum parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">plotDistributionGridPDF</span><span class="p">(</span><span class="n">thetaPosterior</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">grid</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plot_space</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_007.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_007.png" alt="Iso-PDF values" class = "sphx-glr-single-img"/><p>Since linear least squares calibration perform well, the study
could stop here.
In the next cell, we use other methods to see how this can change
the results.
We are going to see that the lack of identifiability of the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/>
parameter can be regularized using Gausssian calibration methods.</p>
</section>
<section id="calibration-with-nonlinear-least-squares">
<h2>Calibration with nonlinear least squares<a class="headerlink" href="#calibration-with-nonlinear-least-squares" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.NonLinearLeastSquaresCalibration.html#openturns.NonLinearLeastSquaresCalibration" title="openturns.NonLinearLeastSquaresCalibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">NonLinearLeastSquaresCalibration</span></code></a> class performs
the non linear least squares calibration by minimizing the squared
Euclidian norm between the predictions and the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NonLinearLeastSquaresCalibration</span><span class="p">(</span>
    <span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The optimization algorithm is automatically selected using
the default solver which can build a <a class="reference internal" href="../../user_manual/_generated/openturns.LeastSquaresProblem.html#openturns.LeastSquaresProblem" title="openturns.LeastSquaresProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">LeastSquaresProblem</span></code></a>.
We can see which solved is used using
<a class="reference internal" href="../../user_manual/_generated/openturns.NonLinearLeastSquaresCalibration.html#openturns.NonLinearLeastSquaresCalibration.getOptimizationAlgorithm" title="openturns.NonLinearLeastSquaresCalibration.getOptimizationAlgorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getOptimizationAlgorithm()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">algo</span><span class="o">.</span><span class="n">getOptimizationAlgorithm</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>class=OptimizationAlgorithm implementation=class=Ceres class=OptimizationAlgorithmImplementation problem=class=OptimizationProblem implementation=class=LeastSquaresProblem residual function=class=Function name=Unnamed implementation=class=FunctionImplementation name=Unnamed description=[] evaluationImplementation=class=NoEvaluation name=Unnamed gradientImplementation=class=NoGradient name=Unnamed hessianImplementation=class=NoHessian name=Unnamed dimension=0 startingPoint=class=Point name=Unnamed dimension=0 values=[] maximumIterationNumber=100 maximumEvaluationNumber=1000 maximumAbsoluteError=1e-05 maximumRelativeError=1e-05 maximumResidualError=1e-05 maximumConstraintError=1e-05 verbose=false
</pre></div>
</div>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.NonLinearLeastSquaresCalibration.html#openturns.NonLinearLeastSquaresCalibration.run" title="openturns.NonLinearLeastSquaresCalibration.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method computes
the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>Analysis of the results<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.getParameterMAP" title="openturns.CalibrationResult.getParameterMAP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getParameterMAP()</span></code></a> method
returns the maximum of the posterior distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thetaMAP</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[7.49701e+08,2.3567e+09,2.68804]
</pre></div>
</div>
<p>We can compute a 95% confidence interval of the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANBAMAAABSlfMXAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABlSURBVAjXY2BgEDJhYBBgYGBgMnBl4DAAMtwY+BgvTwaywhn6GDofMjBwvGDwY+gsZ2Bgn8CgxqDBzsDAlmw8iwEE+DYwJIEZfg0sD8CMPQzMF8AMN4aeBjCDjWE1mGbgVt8ApgH8XxDmKHijlwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta^\star" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">interval</span> <span class="o">=</span> <span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span>
    <span class="mf">0.95</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;95% C.I.:&quot;</span><span class="p">)</span>
<span class="n">printRCGammaInterval</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>95% C.I.:
    R in [717.0, 766.6]
    C in [986.3, 5795.6]
    Gamma in [-20.1227, 50.4506]
</pre></div>
</div>
<p>We can see that <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3RjP6Yt0SDKd+2DyayUzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgYBD6LOwYwMDAwJLAwFwApPkbGDh/Aen1Gxh4vgLpswwMsQ1A2o0h0g9IMXyeYQJSzvWbgQeknOcCA8cHqPYLEO1MBawMDO8XMLA77GNgNLZk4MpoAAAQlxSe7fj0VwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="R" style="vertical-align: 0px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAGJ3PrzKL82Dp3XS/PhALxAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFhJREFUCNdjYGBgVHZSCGJgYEhvYGCpYGBgKWRg4LjAwJAbABSbwMB4CUgxODCwXGQAA/YFEJrXAUonAAluoDiIn8rAwDSBgYF1A5A9hYGhDaSA6YgS0CQAnwkMb0a3XhsAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="C" style="vertical-align: 0px"/> are accurately estimated
and that <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> is estimated with a relatively large confidence
interval.
Notice, however, that the interval is much more narrow than the
one with obtained using linear least squares.
This is because the optimization algorithm that we used implicitly
introduced some regularization that was absent from
linear least squares.</p>
<p>We now check the observations depending on the inputs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_008.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_008.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a good fit after calibration, since the predictions
after calibration are close to the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_009.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_009.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a much better fit after calibration, since the
predictions are close to the diagonal of the graphics.</p>
<p>We now focus on the distribution of the errors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">observationError</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Normal(mu = -2002.54, sigma = 1.01979e+07)
</pre></div>
</div>
<p>We see that the distribution is Gaussian (this is by hypothesis)
with a mean relatively close to zero.
Indeed, please consider that the stress has an order of magnitude close to
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAQBAMAAAAPAfkrAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYOlIMp0Yr8+L3XS/+7yxHmYAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACGSURBVAjXY2CAAcvpDAhQwDIBwVFj3IDgnA0HEkIGDAyi0wUYvF4wMLjaGTAwKzCosDVkHWBg4DNg4NrAEMO5gUEBzAEiWcYAhgIwx86BwS5h5tQEMEfOAcQHAYiMHJzjZ8CwLwHG4RNg2MsA43BNYIiAcgQYGBcwqIDZ6X3qBgxbtwuA2ACWyhkbhyn20wAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="10^8" style="vertical-align: 0px"/>.</p>
<p>As with any other distribution, we can draw its PDF.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">observationError</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_010.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_010.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_011.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_011.png" alt="Residual analysis" class = "sphx-glr-single-img"/><p>The analysis of the residuals shows that the distribution is centered
on zero and symmetric.
This indicates that the calibration performed well.
Moreover, the distribution of the residuals is close to being Gaussian.
This indicates that the observation error might be Gaussian.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_012.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_012.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResidualsNormalPlot</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_013.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_013.png" alt="Residuals after calibration vs Gaussian hypothesis" class = "sphx-glr-single-img"/><p>Plot the PDF values of the distribution of the optimum parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">plotDistributionGridPDF</span><span class="p">(</span><span class="n">thetaPosterior</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">grid</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plot_space</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_014.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_014.png" alt="Iso-PDF values" class = "sphx-glr-single-img"/><p>We see that the parameters are relatively well estimated,
although the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> still has a significant
dispersion (but this is significantly reduced compared to linear
least squares).
Since this parameter cannot be identified easily, it may be appropriate
to consider Gaussian calibration, which adds some regularity
to the problem that may solve identificability issues.</p>
</section>
<section id="gaussian-calibration-parameters">
<h2>Gaussian calibration parameters<a class="headerlink" href="#gaussian-calibration-parameters" title="Permalink to this heading">¶</a></h2>
<p>In this part, we set the parameters of the Gaussian calibration.
We first set the standard deviation of the observations errors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaStress</span> <span class="o">=</span> <span class="mf">1.0e7</span>  <span class="c1"># (Pa)</span>
</pre></div>
</div>
<p>Define the covariance matrix of the output Y of the model.
Since the dimension of the output is equal to 1, this must be
a 1-by-1 covariance matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">errorCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">errorCovariance</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaStress</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Define the covariance matrix of the parameters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/> to calibrate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaR</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">R</span>
<span class="n">sigmaC</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">C</span>
<span class="n">sigmaGamma</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Gamma</span>
</pre></div>
</div>
<p>Since there are 3 parameters, the prior covariance matrix is a
3-by-3 covariance matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaR</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sigma</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaC</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sigma</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaGamma</span> <span class="o">**</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 4.9e+15  0        0        ]
 [ 0        6.25e+16 0        ]
 [ 0        0        0.64     ]]
</pre></div>
</div>
</section>
<section id="gaussian-linear-calibration">
<h2>Gaussian linear calibration<a class="headerlink" href="#gaussian-linear-calibration" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.GaussianLinearCalibration.html#openturns.GaussianLinearCalibration" title="openturns.GaussianLinearCalibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianLinearCalibration</span></code></a> class performs the Gaussian
linear calibration by linearizing the model in the neighbourhood of the prior.
This is also known as the Kalman filter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianLinearCalibration</span><span class="p">(</span>
    <span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">errorCovariance</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.GaussianLinearCalibration.html#openturns.GaussianLinearCalibration.run" title="openturns.GaussianLinearCalibration.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method computes
the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id2">
<h2>Analysis of the results<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.getParameterMAP" title="openturns.CalibrationResult.getParameterMAP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getParameterMAP()</span></code></a> method returns the
maximum of the posterior distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thetaMAP</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[7.48807e+08,2.67622e+09,7.75012]
</pre></div>
</div>
<p>We can compute a 95% credibility interval of the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANBAMAAABSlfMXAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABlSURBVAjXY2BgEDJhYBBgYGBgMnBl4DAAMtwY+BgvTwaywhn6GDofMjBwvGDwY+gsZ2Bgn8CgxqDBzsDAlmw8iwEE+DYwJIEZfg0sD8CMPQzMF8AMN4aeBjCDjWE1mGbgVt8ApgH8XxDmKHijlwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta^\star" style="vertical-align: 0px"/>
(when we consider Bayesian methods, confidence intervals are called
credibility intervals).
This interval reflects the interval that contains 95%
of the posterior distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">interval</span> <span class="o">=</span> <span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span>
    <span class="mf">0.95</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;95% C.I.:&quot;</span><span class="p">)</span>
<span class="n">printRCGammaInterval</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>95% C.I.:
    R in [736.2, 761.5]
    C in [2312.0, 3040.5]
    Gamma in [5.9294, 9.5708]
</pre></div>
</div>
<p>We can see that all three parameters are estimated with a relatively
small confidence interval (including <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/>).</p>
<p>Let us analyze the validation graphics.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_015.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_015.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a good fit after calibration, since the predictions
after calibration are close to the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_016.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_016.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a much better fit after calibration, since the
predictions are close to the diagonal of the graphics.</p>
<p>The observation error is an hypothesis of the Gaussian calibration.
This is the Gaussian distribution that we introduced in the
model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">observationError</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Normal(mu = 0, sigma = 1e+07)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_017.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_017.png" alt="Residual analysis" class = "sphx-glr-single-img"/><p>The analysis of the Gaussian distribution of the observation
errors is close to the posterior distribution of the residuals.
Moreover, the posterior distribution is centered.
These information indicate that the calibration performed well.</p>
<p>The posterior distribution of the parameters allows one to see if
the observations bring significant information compared to the prior
Gaussian distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_018.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_018.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that the posterior distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3RjP6Yt0SDKd+2DyayUzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgYBD6LOwYwMDAwJLAwFwApPkbGDh/Aen1Gxh4vgLpswwMsQ1A2o0h0g9IMXyeYQJSzvWbgQeknOcCA8cHqPYLEO1MBawMDO8XMLA77GNgNLZk4MpoAAAQlxSe7fj0VwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="R" style="vertical-align: 0px"/> is spiky.
For the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3RjP6Yt0SDKd+2DyayUzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgYBD6LOwYwMDAwJLAwFwApPkbGDh/Aen1Gxh4vgLpswwMsQ1A2o0h0g9IMXyeYQJSzvWbgQeknOcCA8cHqPYLEO1MBawMDO8XMLA77GNgNLZk4MpoAAAQlxSe7fj0VwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="R" style="vertical-align: 0px"/> variable, the observations are much more important than
the prior: this is shown by the fact that the posterior and prior
distribution of the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANBAMAAABr8kJMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3RjP6Yt0SDKd+2DyayUzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgYBD6LOwYwMDAwJLAwFwApPkbGDh/Aen1Gxh4vgLpswwMsQ1A2o0h0g9IMXyeYQJSzvWbgQeknOcCA8cHqPYLEO1MBawMDO8XMLA77GNgNLZk4MpoAAAQlxSe7fj0VwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="R" style="vertical-align: 0px"/> variable are very different.
We see that the prior and posterior distribution are close to each other
for the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> variable: the observations did not convey much information for this variable.
This shows that this parameters is difficult to identify.
One potential solution to estimate this parameter is, if it can be
identified, to use a larger sample size (but this is not always easy
in practice).</p>
<p>We can check that if the residuals after calibration are normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResidualsNormalPlot</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_019.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_019.png" alt="Residuals after calibration vs Gaussian hypothesis" class = "sphx-glr-single-img"/><p>Plot the PDF values of the distribution of the optimum parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">plotDistributionGridPDF</span><span class="p">(</span><span class="n">thetaPosterior</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">grid</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plot_space</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_020.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_020.png" alt="Iso-PDF values" class = "sphx-glr-single-img"/></section>
<section id="gaussian-nonlinear-calibration">
<h2>Gaussian nonlinear calibration<a class="headerlink" href="#gaussian-nonlinear-calibration" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.GaussianNonLinearCalibration.html#openturns.GaussianNonLinearCalibration" title="openturns.GaussianNonLinearCalibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianNonLinearCalibration</span></code></a> class
performs the Gaussian nonlinear calibration.
This algorithm is also known as 3DVar.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianNonLinearCalibration</span><span class="p">(</span>
    <span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">errorCovariance</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.GaussianNonLinearCalibration.html#openturns.GaussianNonLinearCalibration.run" title="openturns.GaussianNonLinearCalibration.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method computes
the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2>Analysis of the results<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.getParameterMAP" title="openturns.CalibrationResult.getParameterMAP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getParameterMAP()</span></code></a> method
returns the maximum of the posterior distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thetaMAP</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[7.4895e+08,2.67065e+09,7.73735]
</pre></div>
</div>
<p>We can compute a 95% credibility interval of the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANBAMAAABSlfMXAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABlSURBVAjXY2BgEDJhYBBgYGBgMnBl4DAAMtwY+BgvTwaywhn6GDofMjBwvGDwY+gsZ2Bgn8CgxqDBzsDAlmw8iwEE+DYwJIEZfg0sD8CMPQzMF8AMN4aeBjCDjWE1mGbgVt8ApgH8XxDmKHijlwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta^\star" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">interval</span> <span class="o">=</span> <span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span>
    <span class="mf">0.95</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;95% C.I.:&quot;</span><span class="p">)</span>
<span class="n">printRCGammaInterval</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>95% C.I.:
    R in [732.2, 759.4]
    C in [2466.8, 2994.8]
    Gamma in [7.3087, 7.8756]
</pre></div>
</div>
<p>The previous credibility interval can be compared to the one that we previously
obtains with the linear Gaussian calibration method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_021.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_021.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a good fit after calibration, since the predictions
after calibration are close to the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_022.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_022.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><p>We see that there is a much better fit after calibration, since the
predictions are close to the diagonal of the graphics.</p>
<p>The method to compute the distribution of the error and the posterior
distribution of the parameter depends on the default
value of the bootstrap size.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bootstrap size : &quot;</span><span class="p">,</span> <span class="n">algo</span><span class="o">.</span><span class="n">getBootstrapSize</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Bootstrap size :  100
</pre></div>
</div>
<p>The default value of the parameter uses bootstrap to estimate the distribution.</p>
<p>By default, the observation error is predicted by bootstraping the
problem at the posterior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">observationError</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Normal(mu = -99660.4, sigma = 1e+07)
</pre></div>
</div>
<p>This can be compared to the residuals distribution, which is computed at the posterior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_023.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_023.png" alt="Residual analysis" class = "sphx-glr-single-img"/><p>The analysis is very similar to the linear Gaussian calibration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_024.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_024.png" alt="plot calibration chaboche" class = "sphx-glr-single-img"/><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResidualsNormalPlot</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_025.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_025.png" alt="Residuals after calibration vs Gaussian hypothesis" class = "sphx-glr-single-img"/><p>Plot the PDF values of the distribution of the optimum parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">plotDistributionGridPDF</span><span class="p">(</span><span class="n">thetaPosterior</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">grid</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plot_space</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="n">plot_space</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_chaboche_026.png" srcset="../../_images/sphx_glr_plot_calibration_chaboche_026.png" alt="Iso-PDF values" class = "sphx-glr-single-img"/><p>We see that the prior and posterior distribution for the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/>
parameter are close to each other, but not superimposed: the observations
significantly brought information to the variable <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> during
the calibration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<p>Reset default settings</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">Reload</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  6.694 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-chaboche-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/df6875357182d9cc3a184cf8a65a89a4/plot_calibration_chaboche.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_calibration_chaboche.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/eace64ef90ce50019c2cac3df8f0b461/plot_calibration_chaboche.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_calibration_chaboche.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../bayesian_calibration/index.html" title="Bayesian calibration"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_flooding.html" title="Calibration of the flooding model"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the Chaboche mechanical model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>