
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Calibration of the deflection of a tube &#8212; OpenTURNS 1.22dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Calibration of the flooding model" href="plot_calibration_flooding.html" />
    <link rel="prev" title="Calibration of the logistic model" href="plot_calibration_logistic.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_calibration_flooding.html" title="Calibration of the flooding model"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_logistic.html" title="Calibration of the logistic model"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the deflection of a tube</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Calibration of the deflection of a tube</a><ul>
<li><a class="reference internal" href="#variables">Variables</a></li>
<li><a class="reference internal" href="#create-a-calibration-problem">Create a calibration problem</a></li>
<li><a class="reference internal" href="#setting-up-the-calibration">Setting up the calibration</a></li>
<li><a class="reference internal" href="#calibration-with-gaussian-non-linear-calibration">Calibration with Gaussian non linear calibration</a></li>
<li><a class="reference internal" href="#analysis-of-the-results">Analysis of the results</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_calibration_logistic.html"
                          title="previous chapter">Calibration of the logistic model</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_calibration_flooding.html"
                          title="next chapter">Calibration of the flooding model</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/least_squares_and_gaussian_calibration/plot_calibration_deflection_tube.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-deflection-tube-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="calibration-of-the-deflection-of-a-tube">
<span id="sphx-glr-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-deflection-tube-py"></span><h1>Calibration of the deflection of a tube<a class="headerlink" href="#calibration-of-the-deflection-of-a-tube" title="Permalink to this heading">¶</a></h1>
<p>In this example, we calibrate the deflection of a tube as described in the <a class="reference internal" href="../../usecases/use_case_deflection_tube.html#use-case-deflection-tube"><span class="std std-ref">use cases</span></a> section.
More precisely, we calibrate the mechanical parameters of a physical model which
computes the vertical deflection of a tube and two deflection angles.
This example shows how to calibrate a computer code which has several outputs.</p>
<p>In this example, we use Gaussian calibration method to calibrate the parametric
model.
Please read <a class="reference internal" href="../../theory/data_analysis/gaussian_calibration.html#gaussian-calibration"><span class="std std-ref">Gaussian calibration</span></a> for more details on Bayesian Gaussian
calibration.
This study is relatively complicated: please read the <a class="reference internal" href="plot_calibration_chaboche.html"><span class="doc">calibration of the Chaboche mechanical model</span></a> first if this is not already done.</p>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Permalink to this heading">¶</a></h2>
<p>In this this model, the following list presents which variables
are observed input variables, input calibrated parameters
and observed output variables.</p>
<ul class="simple">
<li><p>F, E: Input. Observed.</p></li>
<li><p>L, a, D, d: Input. Calibrated.</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAMBAMAAABPbPrXAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAGK+LMun7dGCdz7/z3VxGrFIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABbSURBVAjXY2BgVDYUYAABVwExAzAjnIHPQfwCAwPHA4Y2hvIABgbOAAYtBhYgg3sDQzCYwb6A+QmYwaBcmQBhMDAtgDJ4ChhYDjAwTGUoZWBoSnZgqC5WAJsLAA0lD6DfVeE6AAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="g_1" style="vertical-align: -4px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAMBAMAAABPbPrXAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK+LMun7dGCdz7/zSN2jb0nPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAaElEQVQI12NgYFQ2FGAAAVcBMQMwI5yB36FYm4GB4wNDG8sELgUGzgAGLd4A5gcM3BsYghkYmBQY2Bcwf2FgkAFqVK5MYGBYC9LGtICB84IDkMFTwNDBMIFhKkMpA8v//woM1cUKYHMBWeUScEsbSX8AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="g_2" style="vertical-align: -4px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAMBAMAAABPbPrXAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK+LMun7dGCdz7/zSN2jb0nPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAaUlEQVQI12NgYFQ2FGAAAVcBMQMwI5yB36GiWoCB4wNDG0MC1wQGzgAGLQYH1gsM3BsYghlYZjIwsC9g/sLA2A3UqFyZwMDA/QCojWkB+wPmA0AGTwHHBG4FhqkMpQwMxkYMDNXFCmBzAa8YEo7L3/QEAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="g_3" style="vertical-align: -4px"/>: Output. Observed.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">deflection_tube</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-a-calibration-problem">
<h2>Create a calibration problem<a class="headerlink" href="#create-a-calibration-problem" title="Permalink to this heading">¶</a></h2>
<p>We load the model from the use case module :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">deflection_tube</span><span class="o">.</span><span class="n">DeflectionTube</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inputs:&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outputs:&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getOutputDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Inputs: [F,L,a,De,di,E]
Outputs: [Deflection,Left angle,Right angle]
</pre></div>
</div>
<p>We see that there are 6 inputs: F, L, a, De, di, E and
3 outputs: Deflection, Left angle, Right angle.
In this calibration example, the variables F and E are observed inputs
and the input parameters L, a, De, di are calibrated.</p>
<p>We create a sample out of our input distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inputSample</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">inputDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">inputSample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Force</th><th>Length</th><th>Location</th><th>External diameter</th><th>Internal diameter</th><th>Young Modulus</th></tr>
  <tr><th>0</th><td>0.9905769</td><td>1.5</td><td>1</td><td>0.8</td><td>0.1</td><td>195443.3</td></tr>
  <tr><th>1</th><td>1.05256</td><td>1.5</td><td>1</td><td>0.8</td><td>0.1</td><td>198526</td></tr>
  <tr><th>2</th><td>0.8960331</td><td>1.5</td><td>1</td><td>0.8</td><td>0.1</td><td>197851.2</td></tr>
  <tr><th>3</th><td>1.057398</td><td>1.5</td><td>1</td><td>0.8</td><td>0.1</td><td>200036.7</td></tr>
  <tr><th>4</th><td>1.008869</td><td>1.5</td><td>1</td><td>0.8</td><td>0.1</td><td>197215.1</td></tr>
</table>
</div>
<br />
<br /><p>We take the image of our input sample by the model :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">outputDeflection</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
<span class="n">outputDeflection</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Deflection</th><th>Left angle</th><th>Right angle</th></tr>
  <tr><th>0</th><td>-7.003919e-06</td><td>-1.400784e-05</td><td>1.75098e-05</td></tr>
  <tr><th>1</th><td>-7.326614e-06</td><td>-1.465323e-05</td><td>1.831653e-05</td></tr>
  <tr><th>2</th><td>-6.258339e-06</td><td>-1.251668e-05</td><td>1.564585e-05</td></tr>
  <tr><th>3</th><td>-7.304704e-06</td><td>-1.460941e-05</td><td>1.826176e-05</td></tr>
  <tr><th>4</th><td>-7.069166e-06</td><td>-1.413833e-05</td><td>1.767292e-05</td></tr>
</table>
</div>
<br />
<br /><p>We now define the observed noise of the output.
Since there are three observed outputs, there are
three different standard deviations to define.
Then we define a 3x3 covariance matrix of the observed outputs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationNoiseSigma</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1e-6</span><span class="p">,</span> <span class="mf">0.5e-6</span><span class="p">,</span> <span class="mf">0.5e-6</span><span class="p">]</span>
<span class="n">observationNoiseCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">observationNoiseCovariance</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">observationNoiseSigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Finally, we define a dimension 3 normal distribution of the
observed output and get a sample from it.
We add this noise to the output of the model, which
defines the observed output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">noiseSigma</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">observationNoiseCovariance</span><span class="p">)</span>
<span class="n">sampleObservationNoise</span> <span class="o">=</span> <span class="n">noiseSigma</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">observedOutput</span> <span class="o">=</span> <span class="n">outputDeflection</span> <span class="o">+</span> <span class="n">sampleObservationNoise</span>
<span class="n">observedOutput</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Deflection</th><th>Left angle</th><th>Right angle</th></tr>
  <tr><th>0</th><td>-7.163228e-06</td><td>-1.410771e-05</td><td>1.753855e-05</td></tr>
  <tr><th>1</th><td>-7.452763e-06</td><td>-1.449212e-05</td><td>1.838678e-05</td></tr>
  <tr><th>2</th><td>-6.33502e-06</td><td>-1.256392e-05</td><td>1.626712e-05</td></tr>
  <tr><th>3</th><td>-7.265429e-06</td><td>-1.522145e-05</td><td>1.823709e-05</td></tr>
  <tr><th>4</th><td>-7.065494e-06</td><td>-1.457829e-05</td><td>1.76351e-05</td></tr>
</table>
</div>
<br />
<br /><p>We now extract the observed inputs from the input sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observedInput</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">observedInput</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputSample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># F</span>
<span class="n">observedInput</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputSample</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span>  <span class="c1"># E</span>
<span class="n">observedInput</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Force&quot;</span><span class="p">,</span> <span class="s2">&quot;Young Modulus&quot;</span><span class="p">])</span>
<span class="n">observedInput</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Force</th><th>Young Modulus</th></tr>
  <tr><th>0</th><td>0.9905769</td><td>195443.3</td></tr>
  <tr><th>1</th><td>1.05256</td><td>198526</td></tr>
  <tr><th>2</th><td>0.8960331</td><td>197851.2</td></tr>
  <tr><th>3</th><td>1.057398</td><td>200036.7</td></tr>
  <tr><th>4</th><td>1.008869</td><td>197215.1</td></tr>
</table>
</div>
<br />
<br /><p>We would like to see how the observed output depend on the
observed inputs.
To do this, we use the <a class="reference internal" href="../../user_manual/_generated/openturns.VisualTest.DrawPairs.html#openturns.VisualTest.DrawPairs" title="openturns.VisualTest.DrawPairs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DrawPairs()</span></code></a> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fullSample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">fullSample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">observedInput</span>
<span class="n">fullSample</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">observedOutput</span>
<span class="n">fullSample</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Force&quot;</span><span class="p">,</span> <span class="s2">&quot;Young&quot;</span><span class="p">,</span> <span class="s2">&quot;Deflection&quot;</span><span class="p">,</span> <span class="s2">&quot;Left Angle&quot;</span><span class="p">,</span> <span class="s2">&quot;Right Angle&quot;</span><span class="p">])</span>
<span class="n">fullSample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Force</th><th>Young</th><th>Deflection</th><th>Left Angle</th><th>Right Angle</th></tr>
  <tr><th>0</th><td>0.9905769</td><td>195443.3</td><td>-7.163228e-06</td><td>-1.410771e-05</td><td>1.753855e-05</td></tr>
  <tr><th>1</th><td>1.05256</td><td>198526</td><td>-7.452763e-06</td><td>-1.449212e-05</td><td>1.838678e-05</td></tr>
  <tr><th>2</th><td>0.8960331</td><td>197851.2</td><td>-6.33502e-06</td><td>-1.256392e-05</td><td>1.626712e-05</td></tr>
  <tr><th>3</th><td>1.057398</td><td>200036.7</td><td>-7.265429e-06</td><td>-1.522145e-05</td><td>1.823709e-05</td></tr>
  <tr><th>4</th><td>1.008869</td><td>197215.1</td><td>-7.065494e-06</td><td>-1.457829e-05</td><td>1.76351e-05</td></tr>
</table>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">VisualTest</span><span class="o">.</span><span class="n">DrawPairs</span><span class="p">(</span><span class="n">fullSample</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_deflection_tube_001.png" srcset="../../_images/sphx_glr_plot_calibration_deflection_tube_001.png" alt="plot calibration deflection tube" class = "sphx-glr-single-img"/></section>
<section id="setting-up-the-calibration">
<h2>Setting up the calibration<a class="headerlink" href="#setting-up-the-calibration" title="Permalink to this heading">¶</a></h2>
<p>Please consider that the input parameters L, a, De, di are calibrated.
We define the initial point of the calibrated parameters:
these values will be used as the mean of the prior normal distribution
of the parameters.
We set it with a slight difference with the true values, because,
in general, we do not know the exact value (otherwise we would
not use a calibration method).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">XL</span> <span class="o">=</span> <span class="mf">1.4</span>  <span class="c1"># Exact : 1.5</span>
<span class="n">Xa</span> <span class="o">=</span> <span class="mf">1.2</span>  <span class="c1"># Exact : 1.0</span>
<span class="n">XD</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># Exact : 0.8</span>
<span class="n">Xd</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Exact : 0.1</span>
<span class="n">thetaPrior</span> <span class="o">=</span> <span class="p">[</span><span class="n">XL</span><span class="p">,</span> <span class="n">Xa</span><span class="p">,</span> <span class="n">XD</span><span class="p">,</span> <span class="n">Xd</span><span class="p">]</span>
</pre></div>
</div>
<p>We now define the standard deviation of the prior distribution
of the parameters.
We compute the standard deviation as 10% of the value of the parameter.
This ensures that the prior normal distribution has a spread
which scales correctly with the mean of the Gaussian distribution.
In other words, this setting corresponds to a 10% coefficient of
variation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaXL</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">XL</span>
<span class="n">sigmaXa</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Xa</span>
<span class="n">sigmaXD</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">XD</span>
<span class="n">sigmaXd</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Xd</span>
<span class="n">parameterCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">parameterCovariance</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaXL</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">parameterCovariance</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaXa</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">parameterCovariance</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaXD</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">parameterCovariance</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaXd</span> <span class="o">**</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parameterCovariance</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.0196 0      0      0      ]
 [ 0      0.0144 0      0      ]
 [ 0      0      0.0049 0      ]
 [ 0      0      0      0.0004 ]]
</pre></div>
</div>
<p>In the physical model, the inputs and parameters are ordered as
presented in the next table.
Notice that there are no parameters in the physical model.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>F</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>L</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>a</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>De</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>di</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>E</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>∅</p></td>
<td><p>∅</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 1.</strong> Indices and names of the inputs and parameters of the physical model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Inputs:&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Parameters:&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Physical Model Inputs: [F,L,a,De,di,E]
Physical Model Parameters: []
</pre></div>
</div>
<p>In order to perform calibration, we have to define a parametric model,
with observed inputs and parameters to calibrate.
In order to do this, we create a <a class="reference internal" href="../../user_manual/_generated/openturns.ParametricFunction.html#openturns.ParametricFunction" title="openturns.ParametricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParametricFunction</span></code></a> where the parameters
are <cite>L</cite>, <cite>a</cite>, <cite>de</cite>, <cite>di</cite>, which have the indices 1, 2, 3 and 4
in the physical model.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>F</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>E</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>L</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>a</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>De</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>di</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 2.</strong> Indices and names of the inputs and parameters of the parametric model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibratedIndices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  <span class="c1"># [L, a, De, di]</span>
<span class="n">calibrationFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">calibratedIndices</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parametric Model Inputs:&quot;</span><span class="p">,</span> <span class="n">calibrationFunction</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parametric Model Parameters:&quot;</span><span class="p">,</span> <span class="n">calibrationFunction</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Parametric Model Inputs: [F,E]
Parametric Model Parameters: [L,a,De,di]
</pre></div>
</div>
<p>In the next cells, we are going to perform a Bayesian calibration,
based on Gaussian assumptions.
In the Bayesian framework, we define the standard deviation of the prior
Gaussian distribution of the observation errors.
Although the exact value of the standard deviation of the
observation errors is equal to 0.1e-6, we set slightly
different values because the value of the true standard deviation of
the observation error is not known in general.
We will be able to check if these hypotheses are correct
after calibration, using the <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.drawResiduals" title="openturns.CalibrationResult.drawResiduals"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drawResiduals()</span></code></a> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaObservation</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2e-6</span><span class="p">,</span> <span class="mf">0.3e-6</span><span class="p">,</span> <span class="mf">0.3e-6</span><span class="p">]</span>  <span class="c1"># Exact : [0.1e-6, 0.5e-6, 0.5e-6]</span>
<span class="c1"># Set the diagonal of the covariance matrix.</span>
<span class="n">errorCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">errorCovariance</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaObservation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">errorCovariance</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaObservation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">errorCovariance</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaObservation</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibrationFunction</span><span class="o">.</span><span class="n">setParameter</span><span class="p">(</span><span class="n">thetaPrior</span><span class="p">)</span>
<span class="n">predictedOutput</span> <span class="o">=</span> <span class="n">calibrationFunction</span><span class="p">(</span><span class="n">observedInput</span><span class="p">)</span>
<span class="n">predictedOutput</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Deflection</th><th>Left angle</th><th>Right angle</th></tr>
  <tr><th>0</th><td>-2.968605e-06</td><td>-9.895348e-06</td><td>1.607994e-05</td></tr>
  <tr><th>1</th><td>-3.105378e-06</td><td>-1.035126e-05</td><td>1.68208e-05</td></tr>
  <tr><th>2</th><td>-2.652591e-06</td><td>-8.841971e-06</td><td>1.43682e-05</td></tr>
  <tr><th>3</th><td>-3.096092e-06</td><td>-1.032031e-05</td><td>1.67705e-05</td></tr>
  <tr><th>4</th><td>-2.996259e-06</td><td>-9.987531e-06</td><td>1.622974e-05</td></tr>
</table>
</div>
<br />
<br /></section>
<section id="calibration-with-gaussian-non-linear-calibration">
<h2>Calibration with Gaussian non linear calibration<a class="headerlink" href="#calibration-with-gaussian-non-linear-calibration" title="Permalink to this heading">¶</a></h2>
<p>We are finally able to use the <a class="reference internal" href="../../user_manual/_generated/openturns.GaussianNonLinearCalibration.html#openturns.GaussianNonLinearCalibration" title="openturns.GaussianNonLinearCalibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianNonLinearCalibration</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianNonLinearCalibration</span><span class="p">(</span>
    <span class="n">calibrationFunction</span><span class="p">,</span>
    <span class="n">observedInput</span><span class="p">,</span>
    <span class="n">observedOutput</span><span class="p">,</span>
    <span class="n">thetaPrior</span><span class="p">,</span>
    <span class="n">parameterCovariance</span><span class="p">,</span>
    <span class="n">errorCovariance</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.GaussianNonLinearCalibration.html#openturns.GaussianNonLinearCalibration.run" title="openturns.GaussianNonLinearCalibration.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method launches the optimization algorithm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="analysis-of-the-results">
<h2>Analysis of the results<a class="headerlink" href="#analysis-of-the-results" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.getParameterMAP" title="openturns.CalibrationResult.getParameterMAP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getParameterMAP()</span></code></a> method returns the optimized parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta After = &quot;</span><span class="p">,</span> <span class="n">thetaMAP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta Before = &quot;</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>theta After =  [1.50671,1.0088,0.801516,0.199872]
theta Before =  [1.4, 1.2, 0.7, 0.2]
</pre></div>
</div>
<p>Compute a 95% credibility interval for each marginal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">dim</span> <span class="o">=</span> <span class="n">thetaPosterior</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">thetaPosterior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">computeBilateralConfidenceInterval</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1.48811, 1.52898]
[0.985314, 1.03571]
[0.797819, 0.80569]
[0.199866, 0.199877]
</pre></div>
</div>
<p>We see that the parameters are accurately estimated in this case.</p>
<p>Increase the default number of points in the plots.
This produces smoother spiky distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Distribution-DefaultPointNumber&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to see how the predicted outputs first to the observed
outputs, we plot the outputs depending on the inputs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_deflection_tube_002.png" srcset="../../_images/sphx_glr_plot_calibration_deflection_tube_002.png" alt="plot calibration deflection tube" class = "sphx-glr-single-img"/><p>For all outputs, the predicted outputs of the model correspond to the
observed outputs.</p>
<p>The next cell plots the predicted outputs depending on
the observed outputs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_deflection_tube_003.png" srcset="../../_images/sphx_glr_plot_calibration_deflection_tube_003.png" alt="plot calibration deflection tube" class = "sphx-glr-single-img"/><p>We see that, after calibration, the points are on the first
diagonal of the plot: this shows that the calibration
performs correctly.</p>
<p>In the next cell, we analyse the residuals before and after
calibration.
In order to clearly see these results, the next table
presents the true standard deviation of the
output error of observation compared to the hypothesis used
in Gaussian calibration.
In a practical study, the true sigma is unknown.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Output</p></th>
<th class="head"><p>Sigma True</p></th>
<th class="head"><p>Sigma hypothesis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Deflection</p></td>
<td><p>0.1e-6</p></td>
<td><p>0.2e-6</p></td>
</tr>
<tr class="row-odd"><td><p>Left angle</p></td>
<td><p>0.5e-6</p></td>
<td><p>0.3e-6</p></td>
</tr>
<tr class="row-even"><td><p>Right angle</p></td>
<td><p>0.5e-6</p></td>
<td><p>0.3e-6</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 3.</strong> For each output, the true standard deviation of the
output error of observation compared to the hypothesis used
in Gaussian calibration.</p>
<p>One of the hypotheses of the Gaussian calibration is
that the observation errors are Gaussian.
In order to check this hypothesis, we plot the distribution
of the residuals before and after calibration.
Furthermore, we plot the distribution of the observation
errors, which is an hypothesis of the Gaussian calibration.
Since there are three output, there are three residuals to check.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">13.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_deflection_tube_004.png" srcset="../../_images/sphx_glr_plot_calibration_deflection_tube_004.png" alt="Residual analysis" class = "sphx-glr-single-img"/><p>We see that the distribution of the residuals after calibration
is centered on zero: this is a good point, since this shows that
we have roughly equal chances to over or under predict the output
when we use the calibrated model.
We see that the distribution of each the residuals after calibration
is relatively close to the Gaussian assumption that we used.
For the first output, i.e. the deflection, the calibrated distribution
of the residuals has a distribution which has spread lower
than the hypothesis.
This corresponds to the parameters that we used, since the true
standard deviation of the errors is equal to 0.1e-6 while
we used the 0.2e-6 hypothesis.
The opposite happens for the left and right angle residuals:
the calibrated residuals are narrower than the normal hypothesis
that we used.
This is because we used 0.3e-6 as the hypothesis while the
true value is 0.05e-5.</p>
<p>Check that the results are Gaussian, using a Normal-plot.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResidualsNormalPlot</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_deflection_tube_005.png" srcset="../../_images/sphx_glr_plot_calibration_deflection_tube_005.png" alt="Residuals after calibration vs Gaussian hypothesis" class = "sphx-glr-single-img"/><p>Finally, we observe the prior and posterior distribution of each
parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_deflection_tube_006.png" srcset="../../_images/sphx_glr_plot_calibration_deflection_tube_006.png" alt="plot calibration deflection tube" class = "sphx-glr-single-img"/><p>Reset default settings</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">Reload</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  3.774 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-deflection-tube-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/174ce485c3418dfaa469d75903e89a39/plot_calibration_deflection_tube.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_calibration_deflection_tube.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ee6161c0102e9672b9cc431394141be3/plot_calibration_deflection_tube.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_calibration_deflection_tube.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_calibration_flooding.html" title="Calibration of the flooding model"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_logistic.html" title="Calibration of the logistic model"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the deflection of a tube</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>