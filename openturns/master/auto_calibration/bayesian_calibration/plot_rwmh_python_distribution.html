
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Posterior sampling using a PythonDistribution &#8212; OpenTURNS 1.22dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Customize your Metropolis-Hastings algorithm" href="plot_ackley_distribution.html" />
    <link rel="prev" title="Bayesian calibration of the flooding model" href="plot_bayesian_calibration_flooding.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_ackley_distribution.html" title="Customize your Metropolis-Hastings algorithm"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_bayesian_calibration_flooding.html" title="Bayesian calibration of the flooding model"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Posterior sampling using a PythonDistribution</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Posterior sampling using a PythonDistribution</a><ul>
<li><a class="reference internal" href="#set-up-the-pythondistribution">Set up the PythonDistribution</a></li>
<li><a class="reference internal" href="#observations-prior-initial-point-and-proposal-distributions">Observations, prior, initial point and proposal distributions</a></li>
<li><a class="reference internal" href="#sample-from-the-posterior-distribution">Sample from the posterior distribution</a></li>
<li><a class="reference internal" href="#define-an-improper-prior">Define an improper prior</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_bayesian_calibration_flooding.html"
                          title="previous chapter">Bayesian calibration of the flooding model</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_ackley_distribution.html"
                          title="next chapter">Customize your Metropolis-Hastings algorithm</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/bayesian_calibration/plot_rwmh_python_distribution.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-calibration-bayesian-calibration-plot-rwmh-python-distribution-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="posterior-sampling-using-a-pythondistribution">
<span id="sphx-glr-auto-calibration-bayesian-calibration-plot-rwmh-python-distribution-py"></span><h1>Posterior sampling using a PythonDistribution<a class="headerlink" href="#posterior-sampling-using-a-pythondistribution" title="Permalink to this heading">Â¶</a></h1>
<p>In this example we are going to show how to do Bayesian inference using the <a class="reference internal" href="../../user_manual/_generated/openturns.RandomWalkMetropolisHastings.html#openturns.RandomWalkMetropolisHastings" title="openturns.RandomWalkMetropolisHastings"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomWalkMetropolisHastings</span></code></a> algorithm
in a statistical model defined through a <a class="reference internal" href="../../user_manual/_generated/openturns.PythonDistribution.html#openturns.PythonDistribution" title="openturns.PythonDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">PythonDistribution</span></code></a>.</p>
<p>This method is illustrated on a simple lifetime study test-case, which involves censored data, as described hereafter.</p>
<p>In the following, we assume that the lifetime <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQBAMAAADUulMJAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAdPvPr/O/Mp0Yi2Dp0VTpdwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAGhJREFUCNdjYFR2CXVJdWBgLmAIY2BsYJjFwHmRgX0DgyQD400G7gKGCQxsAQycDEDAk8AABrwCEHpvAQODFJB2gnAZDkPpWwwMXAYMDNzXGRgWRDJwuF52Z2A/AJFiWQChWWdBaLblAKoYEVt6pmi4AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="T_i" style="vertical-align: -3px"/> of an industrial component follows the Weibull distribution <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAATBAMAAADVH8ihAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMvNgv6+L+xhIdJ3P3emzyUJCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABbElEQVQoz12SP0jDQBSHv2tr27RNGwQRoWLFQVCHgpPikEXwz9LZqYMIKkgnVzNIHVTQURwsCCK6dCwFoaOTxqHgIhRcBJeqi+Diu6SlaY/cy7u8715+9+5BYBwzMKoyh6fELEOoCI1gML5T51DeatqBbzjKkcwHgTJpKyG7uKqQfLaI50gPpDfztMSJ2ZxMVHT+m2Bc5Yk5bIhnuqwKZBR5CQJRWIcl8SItZZstIlCS1f2m1QFSTwVJrwHXdIZKXEJOFoV4KeoD4QUXMhpo7JJo46JE0R7MXHjAOayhZZBacTG+okUMAfbhs+oBRU9DSID0wxn8jKMPqn7hzeoC776G0KyYP32CEkYbmr7IAirnAxnRwoEu2QdMEm7G1SMYNqeSWRIzKr9hTm+qw8j1bbZmiJJE+a4mn7ZkzuuYrU22W6SE9+jx2ld90+kBfjFU3/2i7I4jNzPmORGnvz8We0DFc7YHGkgNdpSU5B/TDUcsfpAitQAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\mathcal W(\alpha, \beta)" style="vertical-align: -5px"/>,
with CDF given by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK8AAAAaBAMAAAAzuxGAAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/P7v92LdJ1gSBgyz+nOd8SGAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACfklEQVRIx62WTWgTQRTH/0mTbDa7+fJgpVDpxUtPOYhHiQexiEJBFMGCqweFelkvaZUe1ouxejBQSqAi1LvYRW0R9LBCvRS09SaIpV7Ej0tPhYZifDOz0/3IxojZR3jzdnb3t2/e++9sgLhMs8RIQ65uObFxkXfHl8AyDsYInmVuA1AMPMGV+LjYYuXY4EG2eXMxNi4lCqyeJjeIWC3Nqppi7nG84AFO12Xks1fMpTpusP4RnOS3z5AryqkDR8snd3hD6ZFBaV6vM/X0sjvl8iF88HK3ZXXGWcGzDeB1CLyCgsOb4jP1ZzT9Gcu13W5T7hJcpNUuoEDRxRDYQrrBZeSZfr8VDX7O/S3DV+Ml0twj1ChqBcF6gy0rrJ7WX5qnoOoDP4QKBxP0ileC4Aww1qmeLuCCze+gTr2TU5tIkK9APfzVILBy94wE5zdLneoJgWvTYsya5NbO0eqvyVPHy9/Jj1AXDZbxCbyAaFhGXRh31XP2C9nHCHDeUhuibkxVJivFJVnJXQyRpx4VHQJntpC8Ld70p8Apn3oiM76KhLuRMZ6hV8UTeF7bLMEcgeeYjgcMFO6JMwavcTIKPH+e7AIFR2qz7vwq2yaoLil5fZ7rSaNSDDPwuo30xD74R48aa3uewE1obKWT+zop8aECfNPMNJaILmZQgj7igrvVWNv2YofUxQfX1kXxfwGjWco46WC+ZOufqTpVLC/61OPabuBoFEqXrTdxWSRSB6ZnCKwPNt98snPHSHcrUw/gU49Icfj3kP/47dSNHjvJewQ2IYX/ZLf72qjtMDjj6bMfIwX6wfQerfEgZff7CWiGwSYPJvv+trCvCnId0//7B+EPM7SO5FP2j08AAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="F(t|\alpha,\beta)= 1 - e^{-\left( \frac{t}{\beta} \right)^\alpha}" style="vertical-align: -5px"/>.</p>
<p>Our goal is to estimate the model parameters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAARBAMAAADXimp6AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAnklEQVQY02NgQALshooMKKCYgTMARUCBgecCMp/1AgNHAbIAMwODE5BiVHaFCfC9TABSbgwVDAYQAd7bB4DkBAYu6Q1gga0MDI4MDBwGDJxKEC0GYDPiCxh4jsIF5jIw7Gdg4EmACCQwsC5gYOAKYLiTUBAHtJ/bgaEGaBhr4sXSRwU7gMoZiwXVEY4SAAqgeEMA7FAEAMlGowsIgFkAwskZTmL4XYAAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\alpha, \beta" style="vertical-align: -4px"/> based on
a dataset of recorded failures <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAAATBAMAAAD47ecbAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABDklEQVQoz2NgYFRgIAygapiJUMogC6FUGBgYBXAqgkqxFYCpAAYGDtzOgEkFwHTwH8CpFib1DKxxAgPDKdwOhUk5gwguBga/0Oe4lMKluEAENxC34zYXJsUPIqYC8U8Gxgwcan9CaS5QeBxlYGBZwMCWil0pUAoCuEFqpRkY+AwgxmMBICmEe4EEa4EYLrVAKaEnuQJQtawCDNwHFEBqOQ0xMVCq4A9fAgPDDBCXKYGBTW0CSC3PciBeiYSBfKAUTwMzMD7KQVxOiItAbmBDcwCEz6QAsr8RzG0Ei8zGqZb5gPMUsIlA7lxw2LyqZGBIQFML4XMwCBcw8AqAuSwJqHLoasGgBsqdQERaB6sBAOWlMAE1KpBOAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(t_1, \ldots, t_n)," style="vertical-align: -5px"/> some of which
correspond to actual failures, and the remaining are right-censored.
Let <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKEAAAATBAMAAAAKfXD7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACFklEQVQ4y42UPUgcQRTH/2tW78OTvcoUohdy6YJiJBACQhblRHIkXhWS5lhSWCjqkUIbkQukuHLJB6QJSXcIFlZWFtsIweawS5P2mjQG0gRS5L352I9ZR1x2Z3fm//Y3b+a9N4BzBze5TCvnp5/pV5LuLW5Gdu0sqU0bo6PmFI0OnLmVC/q6x903m3ai1MY62VEvBJYOlGONiJz8jYIXDanX4qHTj3ai0lo5YqWFV+L7/YCIzl/gOxbV3KVLO1BrQ/m6/aMXKGIxwKzCExFEvItvQDHkJbXsRK0ti7bwrhr7SJynWeKi+9hHmeP2q+3bgLFWFu2BHq+FGNBdzRC7ziNgnEeKHbuPWvMEv6uHB8CagMbEP0r5JOaPMNm1EMuRerM7rp668gKMW0sRG4GUzsQSgHXbVtbUe5yJIy97PRGZVUq8rxF2UquefigNp7hpUkhtxKb2lRs3zuv7xPGxkYpMO21Yv4ZYV6UgIxPvTa3KO1xPEf/pamK/FwSx9AC5hzVZCp+F+VYqw90uZfgH/t/zZaxl1fKuHAlipU87fph6+pCaKIW9XD7i9baPc4rVzJN2lBBL85QTl3LVY2ZyQ2qiFN7makZegbbWRLJ0J4laOr6SKDQuBZ7ZPCkyRCcmfoH3jHx+3g+T6RJjoXEpTFQNYpCsQ2ZofDa4QWHPXEDSj7V90/8Tg9hI/g5vdIbnrNzo6jP8P4UFevJcn/u5AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(f_1, \ldots, f_n) \in \{0,1\}^n" style="vertical-align: -5px"/> represent the nature of each
datum, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAARBAMAAABQu4N8AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAg0lEQVQY02NgYGBgVGbAChRN0ATYW8GUazqqMJvoVzD1AcMEsDhzA1ZxziVdBVjVcytAOG/vAsEthDhPAAOzAhb18xmw21uCQ1yWgUEXm/kXGZhYJqCq/w4ijjIwZKCIcq79sRRIAr27CNMK9skXGBg8FTDE+esCGBgeJWCIMylhDXsAbkYllpp3m88AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="f_i=1" style="vertical-align: -4px"/> if <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAPBAMAAAAv0UM9AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGN2dSPtgr+mLMs9087/l7iXCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAASUlEQVQI12NgYBRgAAImAxDJ7wAiXUFEekcliNIEEQy/GBhOMrAFgJjsG0AkxwQZzg0MvA4GEy4y8Ngs4GoAS00AkbySIJJvFgCuogtbG3CJigAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="t_i" style="vertical-align: -3px"/> corresponds to an actual failure,
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAARBAMAAAC/eehCAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAr0lEQVQY02NgYGBgVGbADhRN0AQKtQrAtGs6qjhrA0MbiGb7gKaB24BBDkQzN6BJ8Acw1AApziVdBagS8QkM8RNAOhUg/Ld3geAWkFGfAJJjYOAJYGBWQNNRD5KYj+78/AAGe5BRJegS/AUMNiBaloFBF8UOoKWyIIGLDEwsE5B1sG+AePAoA0MGqlmGViAPcAI9vghLCLJPvsDA4KmAKcFfF8DA8CgBU4JJCXtcAAD69iXlaDp35wAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="f_i=0" style="vertical-align: -4px"/> if it is right-censored.</p>
<p>Note that the likelihood of each recorded failure is given by the Weibull density:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAAwBAMAAABZMFoSAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdOnPi0jzv68YYN0ynft8XVi0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE9ElEQVRYw82Zf2gbVRzAv0kul7vk0t62zrFpMMjAihsG5j/7Y3h1QhE2OITNP9S1E0UKAyNsuMH+SHWTUkROHGMDNVn/0gkaQaHqJsEyp4IkhSE4ceQPZQj9IwMLtszN977v7t27X8laWi+P5eX7zd27fu77890NIIah3g/9OBIb+xILvusrmvlptQ+w9jvCHPtK1WQpfqxE2ZGydfw6CPLT+ampqVasWDN0Oo/iXpxHIdmK3VrqBJ0vM/cZdN4CZ0127Pv4sHKIssgQF+isjGyYZk59Z19sWPfRKd1mypu9zk6tL0xhtGFLL1GzvDGMNoOq2W3RBwDv0e88+bxQ0NaeKlNR26wIJDquJ4n/St1WlUB7nXKrZVDryjo4+EmAwwdQSlboPNiABCVTl7osytcATqKphiBdkSprj/UHwE5WBJrozE+dAzu7LEqST71hS9c3nF5zKo0Y5RsWXG95Q/2XLquGyOe1H0epr/V1Cfg0CahZJr6C83ZVZ6W02SXmL+EdXaUpUlqfRDwC2Vlsx+ot1F/OS7JFhQEjehErIqcbXBSLst0XoLwCirz/hx+2bZ37FRORxXjhAbvR5LrYYRznoxS/I/bUx0pCPcO2eu0enHymoKuR96Dw+z7FKsd46G3Rxq0VScbeJYMw/SUcfPwgaRHXicEsB0ua919lJhAbqgE7MFrDW0/RkSbQfVInOiCLrjwh1P2yQixOjuVaDpb8fM279OcxM8SBX2Nuhw6ZO+0oZmZ6MbqnMxNsM7yx9ZmVtrDoDZoOVjOwdjCA9RM1eWRGD/iKonarR8gnMKgFrEfR6OSeDvHY2ngPWAZkWtEZPejLPPXvaKxH0MukBYFWd+8DFwwAfPTQKRvr3IvTUViJaycdrF3DYRkdgQX/BnevI3byz9PpyrfkL0juqjymskw+X2DBrXMJMrvoqIhYx+FDYGuNi8/ZGS2cxkfV791/Alh74KKw1depE3OW25GKzjb2Nnfin1FOlIogb0Yx3YCM7s1oO89pokNT9+pw039FaRzetrOWwhhamT+L4H2hKZ8hlb/tYKmdKCxSrJO/s6sCjS0xoz1jzG+tAJb8+X473SkQTBbIdMI9/CAa7izuiaQSYmXHUQrBalqQu+RgJWvRsdXs6cRqg4sXiCXo9SUhrx4mWJtoyCeNd40JxMqXgEohsTVGTM6CSGEPCu2o2OoZ8lWhehBL2N/cxXfvXD5wBJIWyCb2AYKVaoFW9FmrBtpuYvkGfFKx5sidPAvql56M9p3f8v0QqFuyCZuj9ke7Ye78lldvWpDXITHfUAzEGjBB8d7tuSeGzTTZ42mTF97fYx0iB7eOFCxPRrudErEqXl1bDvztySErqh0t8JMwluQziFVlUqDQcEnHf+DJaKFT0iuVvXp2cXU7pa+wz++jWB9vYlJXLEN8u+DrlLTRFr26tLQ6rKvuxmb5WPgpusCnsRQ4EdopKU7Hqyvt1WFldY71lNEbi1lOCu+U9HJLXj1XX+V+1ykj5koeKQK/sE5JxrJXD2Tm/ztYp+SPGFwfM+OksjslGTe8+o1YjWV3Sv7WgeuzcWMlWQNOVURdux0rlsJfqbH9iKNnirFisU7JXyRxvRprxNudEvhbEUf/LVYqEHZZ+Hhn6+pCvFhCf8BXuraeMmKl0sQQmnH1vfEaK+EpFmVHT9ehj4b/P1dWMP4DrigwDmIzaAMAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\mathcal L(t_i | f_i=1, \alpha, \beta) = \frac{\alpha}{\beta}\left( \frac{t_i}{\beta} \right)^{\alpha-1} e^{-\left( \frac{t_i}{\beta} \right)^\alpha}."/></p>
</div><p>On the other hand, the likelihood of each right-censored observation is given by:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANMAAAAbBAMAAAAUkqczAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdOnPi0jzv68YYN0ynft8XVi0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADCUlEQVRIx7WWQUgUURjH/7vOOjuzo04kpdKWdEmoaMEOXYKxrBQKlsAKCqWDB0looTp0M5DwEqwgRXRwI6gISg8FVhRDSykVNOKh8uQhiW4d6iBI9r3vzawzs27mwrzD22933nu/9/2//3uzQHQt434mZh07QozmQGOUA9zBcJSoGmD6ighuAWfQFSEJ84Bqi5RiFuruNmUjRLUCKcOLIm2UC9RtYzkKr0WMSrEPPgrUvYhR9dwnz5XCkDu5qRtZsa7Sg1q5Vjd1DQFh92XYnTJ1XqLjPzhjaVPLlf/8ZWTkBt5QsCIaZZX3Pdx/6je7U8t7qBNbQvMfdxXKZLCwB40VtnHSl6APVZNLLkl3Oh6q/31wZqKVli0X7wXiFVA3uW+xQrWayCfy7M6GrIsyfoYNZeJzeDXazQ8kzX/YIoZcCLXbc2evV6tY+NjRJp6EV7OgOtAza6PiQjWFL9wPq78av9xtPNw5LFHa9bZQZfps9EnJ08e8m9Nqb6N+ITiwMe2qK7J9+1rI1OnTfMlz51MaylmlLBYUl9qpHRAa24Im7DukLSgu6tFZ6oXUqhjWPiTK7uhyk4bIx2QBn/tyZbWEO5c9AevDtyNxJhh1CDjfI51iQzVFufztKJJu0gJgGTkX6rZxx3WnvuChxsPSf8piBwv4DdgrzzrlRrXCQGDchcZ5N5oWt59QU/V5Xa5B7kxmoGQYdR84HLRFAdtZFxL7pe2h4oVQrbTlUqib0FibI77nuwi1Wdgibo1aA4yag8IHr1QrKt4cq0almZLTksA71xalWmm+Q2JDdz9LTVn586pnULizNusYrYw6KGu32vRJOsJFog9Cn9I4Og3tGaU5GRjXj1illyDNKd7eevF7XrgzNmsnLUYtAsPBgemmAnrJlDMtzcWvHDV3pAmoWIFhM5u6K92YvaX0pFFqx/hckQ4DVvlo0x/JL6l8FW8Ytr96nFD6KGEv2+ug5FaK1bzMpksvkYYHa+sd80eGHHO1GpRueiilE+uj5Belun9CrmKJjcwxNjL4Lw0lpor/fD7cAAAACnRFWHREZXB0aAD/////+ZjB7wAAAABJRU5ErkJggg==" alt="\mathcal L(t_i | f_i=0, \alpha, \beta) = e^{-\left( \frac{t_i}{\beta} \right)^\alpha}."/></p>
</div><p>Furthermore, assume that the prior information available on <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAARBAMAAADXimp6AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAnklEQVQY02NgQALshooMKKCYgTMARUCBgecCMp/1AgNHAbIAMwODE5BiVHaFCfC9TABSbgwVDAYQAd7bB4DkBAYu6Q1gga0MDI4MDBwGDJxKEC0GYDPiCxh4jsIF5jIw7Gdg4EmACCQwsC5gYOAKYLiTUBAHtJ/bgaEGaBhr4sXSRwU7gMoZiwXVEY4SAAqgeEMA7FAEAMlGowsIgFkAwskZTmL4XYAAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\alpha, \beta" style="vertical-align: -4px"/> is represented by independent prior laws,
whose respective densities are denoted by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAATBAMAAADojanHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAyUlEQVQY02WQMQ/BQBiGn2oRVTRisrAb/AVGm8UkkW7YThgN4g/o1JnJYDdIJH6Cxd7RJBKLjWt7bRNuuOe59/vucncQjXw/okIwSoqLNBoq5vwkav5JWvRiMe3YzqC1P58XetA56spZmmH3x2DJRY85PhVYaY4LVSg3sSYrdAEF0YG13OGTGch+GZlsYQkNgbkLz2LKM5SNrLpR1OINGYFlc3IFdfneCwfIOmjecXYTPOILatfY9vxaWqOmaIgkKjoR7+l/YSf4AvZzJHdmagLnAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\pi(\alpha)" style="vertical-align: -5px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAATBAMAAAAQbVIwAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA4UlEQVQY002Quw4BQRSGv3FZrNtGFKLSK8QbaKhVFJqtiG4LlYjgCVRqnUKj1Eg8gmi0KlGJRKNjLivmTyb/P985czIzYJRoGw/NKKsKtw4jG/bkmhLxnKsFK/qou9MhlGoQO6IBqz90PchBEw5qK2qfz4uoTLnseYlOxLz2ADIKpvdryCs4E76sF2SaQws1VioVNGAhw1XPzGjoIg9NDKyGMxnyNHGJOP5glTdEApINxjMoIy4kjmwh7uNM+13Z8yBZDy8vTjgmbay3b9SDTPWvIiXtscCCad/Xfrf/E8+yLwt1KEgIUmxeAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\pi(\beta)." style="vertical-align: -5px"/></p>
<p>The posterior distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAATBAMAAAD7WukzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA90lEQVQY012RvUoDQRCAvzPe5ec83S5ECQQJ2Iq+gJAgKdOmCZvUKbbSJo1gE0hxYARBRHwTG0GEkDqNpMpzZG4uFy4ZZmdnvxnmhwWvwYEoKOyh6tBST5xmnnqOHoETr5vHR/CsSEM7mcEXrKEU57EjkoYtqMgjuFpm+LaPslCuf85Ja7n2r9gzeIVil3D0ndCTmMhKtuFHrMO/1OQiWjs0XMCnoTTJsH+ntUUXMs9K8Sm8py19QxjTWZkXA3O8qeA32ctSXt/XbsyfzDJ4GEqQRyhfZ6tY1USetifD6fCa+bGlgbx1eKKk0LHd4SD1xmrjw98RsAFgTyYJezK1lgAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(\alpha, \beta)" style="vertical-align: -5px"/> represents the update of the prior information on <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAATBAMAAAD7WukzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA90lEQVQY012RvUoDQRCAvzPe5ec83S5ECQQJ2Iq+gJAgKdOmCZvUKbbSJo1gE0hxYARBRHwTG0GEkDqNpMpzZG4uFy4ZZmdnvxnmhwWvwYEoKOyh6tBST5xmnnqOHoETr5vHR/CsSEM7mcEXrKEU57EjkoYtqMgjuFpm+LaPslCuf85Ja7n2r9gzeIVil3D0ndCTmMhKtuFHrMO/1OQiWjs0XMCnoTTJsH+ntUUXMs9K8Sm8py19QxjTWZkXA3O8qeA32ctSXt/XbsyfzDJ4GEqQRyhfZ6tY1USetifD6fCa+bGlgbx1eKKk0LHd4SD1xmrjw98RsAFgTyYJezK1lgAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(\alpha, \beta)" style="vertical-align: -5px"/> given the dataset.
Its PDF is known up to a multiplicative constant:</p>
<div class="math">
<p><img src="data:image/png;base64,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" alt="\pi(\alpha, \beta | (t_1, f_1), \ldots, (t_n, f_n) ) \propto \pi(\alpha)\pi(\beta) \left(\frac{\alpha}{\beta}\right)^{\sum_i f_i}
\left(\prod_{f_i = 1} \frac{t_i}{\beta}\right)^{\alpha-1} \exp\left[-\sum_{i=1}^n\left(\frac{t_i}{\beta}\right)^\alpha\right]."/></p>
</div><p>The <a class="reference internal" href="../../user_manual/_generated/openturns.RandomWalkMetropolisHastings.html#openturns.RandomWalkMetropolisHastings" title="openturns.RandomWalkMetropolisHastings"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomWalkMetropolisHastings</span></code></a> class can be used to sample from the posterior distribution. It relies on the following objects:</p>
<ul class="simple">
<li><p>The prior probability density <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAATBAMAAADojanHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA5UlEQVQY012QsWrCUBSGv9TYpGpqKJ2EgoNbByP4AJ1dmr1LNul2wY6FSl+gTs7i0qHPUPABCvUNzNiphEZEtBBPck0CHu7l/+93Dj/3XtBl+VqPkpYj+2bu81SiB7D79obzsEBtGC3YZUZX2lyFVgzTHNVcrETZgj7B6CZJTAUu/9KVOtP1h9CAs+Trew1NGBvBBK7E76lsZErBhbqDV3iJePNkXlCNGTwL8rj3syweiTLTbFv/aHTLVrIVpuf05NiS9y74gGoAg47E8Jtf1Vjm7p1TV/a4PqqpClQPtP6U/4VbyAFsFy/PI2fLywAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\pi(\vect{\theta})" style="vertical-align: -5px"/> reflects beliefs about the possible values
of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAATBAMAAADMlCYHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABVUlEQVQoz22SPUjDQBTH/2ljmiZpG4KDIGIpOKsgDoIQNyfp4qZQUNCtcRMnxc1Bb6mDOFynDgp11sFb3QQnB6GrW0FBRaS+uxDJxTwuL+/d/Xhfd8B/cZqZjTGlg4XMfkHzrjvMOaS/tW996dymFlxgBZdk9G7wpnNhJucyTDJmhfOhYWWR9qaAA1QZnBG3dK7opz0Bu4lKHd67XGkpyZgbRwnXWCMdwRzd3X+SZTekDMhy6TtFD3F68bJFeojaD0p6v+OAF8I9b0nH8mEzWWJ/iHakcduUWsBcV44HWR9u0Y9wps/5CpjmKM4nnPko66uFzje0+qiPNnU9UFwVmFR92FFhTx+zyeH6eBrwgAO7cBYBYw44XuWZW2cwXp+7M3yHOr546NCxJ3Kei1FPLKaWHD3P4bCU4uJAQR6GieSiKbYaIk5yuQr748rxcFq5HPxsxcAvONpIgZblzJwAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\vect{\theta} = (\alpha, \beta)" style="vertical-align: -5px"/> before the experimental data are considered.</p></li>
<li><p>Initial values <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAQBAMAAAACH4lsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfUlEQVQI12NgYBAyCWAAA7YKtp8Q1vINDJ8hLP0DXN/BDK7/C9ggLJ4vIAQCLP937/8BZvH/ZWD/yZA6lYFh/QeG/AIGA54DDOsLGPoDeBXYDBj4Hbh+M7A2sBUwcBQwFTLwNTAWMDA0eyyAiIEBrwKvAYTF4ADUCwGp8xgAn3IgYj9VSnYAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="\vect{\theta}_0" style="vertical-align: -3px"/> of the parameters.</p></li>
<li><p>An proposal distribution used to update parameters.</p></li>
</ul>
<p>Additionnaly we want to define the likelihood term defined by these objects:</p>
<ul class="simple">
<li><p>The conditional density <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHcAAAATBAMAAABYco/1AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACEklEQVQ4y4WUT2jUQBTGv92sk3XT7KZVKyjIrrUFb7mJ678U16NlFfEmxFKF6qHppdSCskKvwvZU6UEW/HOrbFWE4qXSsxIoiCBiKUXxVlAUDwW/mTE1CYQOO8ubJL+873tvJoAeo0iMJnYd1f9hJ3mnK/+OOVmgGK7hxs4qHwA3U3ChtpIFj6Hs5rxoVeZ8kYJ71oJsyVaA9Wi1n3M7BZ/LtGsEKPqYi5YvAbuVgo9kwgXgMjDDqG+g0UQL5qPvXgIefz+fYvouuP/g0vM2UGTh+n/iClgay0tlfpVi97RFq6Bh8y4fqACm2cKCQfMVF9e7cfgBxOE4PAK8/ayiNeASpG3kO3hqE54GetdjsNhCLmF7FtjQO8NTnnsIWw7uC8peYBXjsMlrZ+Ml/gW8cSP4m/KMis/HWOlN4RBeEscnryqYighbzuj8AV8S9hawrN/ThrGi4S9+OcRX4F1eZv5QqIRzCi5VJWz73vZeB3XyqzCXhfGMr2nidgicIjw4PADU2Ih9WvYnLCq4GGrZdrcU4iOVnjzYXx+y6Tw31jvEG42oI3VtS8JHpQfCE9Bwvir17ZyRnPrJ8ZrzhwwsZYtOXCyajwPCU4d44TQMlMKZE0lYN9vo6DowUgf4zqy7hK54IjP/vsaCPzxvORZueVEyLeGM3jPMd++PCifT57kR33BJWKu4GOtiEg53/5Kw5X8B1750PGHgDXgAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="p(t_{1:n}|f_{1:n}, \alpha, \beta)" style="vertical-align: -5px"/> will be defined as a <a class="reference internal" href="../../user_manual/_generated/openturns.PythonDistribution.html#openturns.PythonDistribution" title="openturns.PythonDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">PythonDistribution</span></code></a>.</p></li>
<li><p>The sample of observations acting as the parameters of the conditional density</p></li>
</ul>
<section id="set-up-the-pythondistribution">
<h2>Set up the PythonDistribution<a class="headerlink" href="#set-up-the-pythondistribution" title="Permalink to this heading">Â¶</a></h2>
<p>The censured Weibuill likelihood is outside the usual catalog of probability distributions in OpenTURNS, hence we need to define it using the <a class="reference internal" href="../../user_manual/_generated/openturns.PythonDistribution.html#openturns.PythonDistribution" title="openturns.PythonDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">PythonDistribution</span></code></a> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">from</span> <span class="nn">openturns.viewer</span> <span class="kn">import</span> <span class="n">View</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
<p>The following methods must be defined:</p>
<ul class="simple">
<li><p><cite>getRange</cite>: required for conversion to the <a class="reference internal" href="../../user_manual/_generated/openturns.Distribution.html#openturns.Distribution" title="openturns.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a> format</p></li>
<li><p><cite>computeLogPDF</cite>: used by <a class="reference internal" href="../../user_manual/_generated/openturns.RandomWalkMetropolisHastings.html#openturns.RandomWalkMetropolisHastings" title="openturns.RandomWalkMetropolisHastings"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomWalkMetropolisHastings</span></code></a> to evaluate the posterior density</p></li>
<li><p><cite>setParameter</cite> used by <a class="reference internal" href="../../user_manual/_generated/openturns.RandomWalkMetropolisHastings.html#openturns.RandomWalkMetropolisHastings" title="openturns.RandomWalkMetropolisHastings"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomWalkMetropolisHastings</span></code></a> to test new parameter values</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We formally define a bivariate distribution on the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAATBAMAAAAdcyJ3AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABCklEQVQY02WRoU7EQBCGvx7XbvcKR9UhEFwCQR88AZ5wqcFe6hCYDSQQHChsE0CSFIXB1CNqMChQPAICcxbHzPaOkmOT/f/Nt5OZ2VkIhiyujsrSAjuD4E0OW+Jpy0+ORY5kZxD/SfV8KxJC5GC1/sV2qtrPiQt4bcOjTLU7ogfjw885Dr4me+olieh1Gx87b1PuRL+bDnT1al/xgRfJVrbxG41VrEv1Ucv3Gyu1bugGZn61CaeehylJPXQVdkf5LiZJsZd0cqLtwmYsPyp/QjsxDusz9KWHSPuX58pjYhnYlfJkzfPuQKIqx42ge+UrF5DLoA5kUh8F7zqLfNaKuDn3J+PnWPz7Lws/OKEsQsC0DFkAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="(t_i, f_i)" style="vertical-align: -5px"/> couple, even though <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAARBAMAAAD00TuvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAYUlEQVQI12NgYGBgVGYAA0UTCO2aDqbYPkC4zA1ginNJVwGYwa0AEecJYGAGMedDuAwlUFqWgUEXRF9kYGKZAKSPMjBkgPQDjVvEwMA++QIDg6cCA39dAAPDowQGJiWwJgAX8w6S1rvtiQAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="f_i" style="vertical-align: -4px"/> has no distribution (it is simply a covariate).
This is not an issue, since the sole purpose of this <a class="reference internal" href="../../user_manual/_generated/openturns.PythonDistribution.html#openturns.PythonDistribution" title="openturns.PythonDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">PythonDistribution</span></code></a> object is to pass the likelihood calculation over to <a class="reference internal" href="../../user_manual/_generated/openturns.RandomWalkMetropolisHastings.html#openturns.RandomWalkMetropolisHastings" title="openturns.RandomWalkMetropolisHastings"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomWalkMetropolisHastings</span></code></a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CensoredWeibull</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">PythonDistribution</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Right-censored Weibull log-PDF calculation</span>
<span class="sd">    Each data point x is assumed 2D, with:</span>
<span class="sd">        x[0]: observed functioning time</span>
<span class="sd">        x[1]: nature of x[0]:</span>
<span class="sd">            if x[1]=0: x[0] is a censoring time</span>
<span class="sd">            if x[1]=1: x[0] is a time-to failure</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">5000.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CensoredWeibull</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>

    <span class="k">def</span> <span class="nf">getRange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">computeLogPDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">log_pdf</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">log_pdf</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">log_pdf</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">log_pdf</span>

    <span class="k">def</span> <span class="nf">setParameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getParameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">]</span>
</pre></div>
</div>
<p>Convert to <a class="reference internal" href="../../user_manual/_generated/openturns.Distribution.html#openturns.Distribution" title="openturns.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conditional</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Distribution</span><span class="p">(</span><span class="n">CensoredWeibull</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="observations-prior-initial-point-and-proposal-distributions">
<h2>Observations, prior, initial point and proposal distributions<a class="headerlink" href="#observations-prior-initial-point-and-proposal-distributions" title="Permalink to this heading">Â¶</a></h2>
<p>Define the observations</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tobs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4380</span><span class="p">,</span> <span class="mi">1791</span><span class="p">,</span> <span class="mi">1611</span><span class="p">,</span> <span class="mi">1291</span><span class="p">,</span> <span class="mi">6132</span><span class="p">,</span> <span class="mi">5694</span><span class="p">,</span> <span class="mi">5296</span><span class="p">,</span> <span class="mi">4818</span><span class="p">,</span> <span class="mi">4818</span><span class="p">,</span> <span class="mi">4380</span><span class="p">])</span>
<span class="n">fail</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">Tobs</span><span class="p">,</span> <span class="n">fail</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p>Define a uniform prior distribution for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgYFR2ZQACN4YKBgMG5gkMXNIbGDgMGDiVGBjiCxh4jjIw7Gdg4ElgYOAKYLiTUMDAmnix9FEBANuoCvKuJg1RAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\alpha" style="vertical-align: 0px"/> and a Gamma prior distribution for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAARBAMAAAD5z0voAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGIt0neky3WD7v8+vSPPQYmj8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAX0lEQVQI12NgYGBUdmYAAiEG1gQg5cDA3sDAwNbAwCnAwMDEwLAEKMbEvfUAiOLoLQBS1xgYFgMpBYgckIoAUgcY2B4wMPAuYBC/wMDALGTsCBRjZgADJgiVC6EMwCQAKb4MjgsXX1YAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\beta" style="vertical-align: -4px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_min</span><span class="p">,</span> <span class="n">alpha_max</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.8</span>
<span class="n">a_beta</span><span class="p">,</span> <span class="n">b_beta</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2e-4</span>

<span class="n">priorCopula</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">IndependentCopula</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># prior independence</span>
<span class="n">priorMarginals</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># prior marginals</span>
<span class="n">priorMarginals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="n">a_beta</span><span class="p">,</span> <span class="n">b_beta</span><span class="p">))</span>  <span class="c1"># Gamma prior for beta</span>
<span class="n">priorMarginals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">alpha_min</span><span class="p">,</span> <span class="n">alpha_max</span><span class="p">))</span>  <span class="c1"># uniform prior for alpha</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">priorMarginals</span><span class="p">,</span> <span class="n">priorCopula</span><span class="p">)</span>
<span class="n">prior</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>We select prior means as the initial point of the Metropolis-Hastings algorithm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialState</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_beta</span> <span class="o">/</span> <span class="n">b_beta</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha_max</span> <span class="o">-</span> <span class="n">alpha_min</span><span class="p">)]</span>
</pre></div>
</div>
<p>For our random walk proposal distributions, we choose normal steps, with standard deviation equal to roughly <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAPBAMAAADuVgmRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYOlIMp0Yr8+L3XS/+/NS2zlYAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAu0lEQVQI10WPwQoBURSGP00uodwUFhILZXt3NlMzGxspWwuL2cna0tIDuBtpdlfKekqShbyFJ/AAHsExDU5n8ff1d/7/wHfy2wiW/CdW+2jgRNQM1HeaJ7Y1EtMwMHhderywxB9r1VBKmPHAKpcB2TYHbDHMQBASRL5nzmSgIyD0Tsqpxs8hjIoZL6IUTAx3UU3WkpQe1dzE69LoNNYyhYLOgCbnpBg+ny7MN33D+aLhCCuV/J8riy5ceQNnLijWsjjvCgAAAAp0RVh0RGVwdGgAAAAAAVAk0ZoAAAAASUVORK5CYII=" alt="10\%" style="vertical-align: -1px"/> of the prior range (for the uniform prior)
or standard deviation (for the normal prior).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proposal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">proposal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a_beta</span> <span class="o">/</span> <span class="n">b_beta</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">proposal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha_max</span> <span class="o">-</span> <span class="n">alpha_min</span><span class="p">)))</span>
<span class="n">proposal</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">proposal</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sample-from-the-posterior-distribution">
<h2>Sample from the posterior distribution<a class="headerlink" href="#sample-from-the-posterior-distribution" title="Permalink to this heading">Â¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RandomWalkMetropolisHastings</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">initialState</span><span class="p">,</span> <span class="n">proposal</span><span class="p">)</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">setLikelihood</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="c1"># compute acceptance rate</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Acceptance rate: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sampler</span><span class="o">.</span><span class="n">getAcceptanceRate</span><span class="p">()))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Acceptance rate: 0.3347
</pre></div>
</div>
<p>Plot prior to posterior marginal plots.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Bayesian inference&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">parameter_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">parameter_index</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">priorGraph</span> <span class="o">=</span> <span class="n">prior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">parameter_index</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">priorGraph</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Posterior&quot;</span><span class="p">,</span> <span class="s2">&quot;Prior&quot;</span><span class="p">])</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">parameter_index</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_rwmh_python_distribution_001.png" srcset="../../_images/sphx_glr_plot_rwmh_python_distribution_001.png" alt="Bayesian inference" class = "sphx-glr-single-img"/></section>
<section id="define-an-improper-prior">
<h2>Define an improper prior<a class="headerlink" href="#define-an-improper-prior" title="Permalink to this heading">Â¶</a></h2>
<p>Now, define an improper prior:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAAAoBAMAAAAYilkJAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABx0lEQVQ4y+2UsUvDQBTGv1ibtI2NRRTqUBDBQTrYSTepg4pbFy3ikkWLCJJVkVLt4mb/AAedpApanDppXXQtzoJFxFXFQbf6LmeS5qo2WZx8ELh8ud+99+59LeA9zgvwGQN7vhH0/iN/jigZ4XvwG6Tieo0y7Gmh5Yy0SGzcj7rSLNGTR1fMUdY71TlETwaRltRdHQi5AUgVBAxHCuu/IxGqSAOmWyS1/tNmaazZfEOAVlr0tsS15UfWU8pMf3cIdc5wId2xTA7oYYhaPeBSSUlRyhe2vsBzZV7IUpB0OruPVtvAjCk9ANe7wATMKwmOl8TKwgZNYIcWDauXSWCEJnsDLp7xfU0zeOegcrb416TZ3TtwHPvqhcTLhphllRXN2i9BqjEhRO9lOMjpq4gk8UFzMxBKY7OABF3OFdSyAsm8iyqihf0WT7ANSg0nZEIdcn4lCxTp2MG1XCILzaxHXpyCPMwv2fRg0eKlOmS+smceMcR63B7EERu+C0m0Td3tQfQjzs1mK7NtPnF7EKquuxGt7VcreBCIiWe21eV40HPYHvQetge9R0PsxROS9IlYHvQe3IO+gnvQH+L7D9nyoJ+I+0dsi38Ck+Bjqx9aSJcAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\mathcal \pi(\beta, \alpha) \propto \frac{1}{\beta}."/></p>
</div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logpdf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;-log(beta)&quot;</span><span class="p">])</span>
<span class="n">support</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">support</span><span class="o">.</span><span class="n">setFiniteUpperBound</span><span class="p">([</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample from the posterior distribution</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampler2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RandomWalkMetropolisHastings</span><span class="p">(</span><span class="n">logpdf</span><span class="p">,</span> <span class="n">support</span><span class="p">,</span> <span class="n">initialState</span><span class="p">,</span> <span class="n">proposal</span><span class="p">)</span>
<span class="n">sampler2</span><span class="o">.</span><span class="n">setLikelihood</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">sampler2</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Acceptance rate: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sampler2</span><span class="o">.</span><span class="n">getAcceptanceRate</span><span class="p">()))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Acceptance rate: 0.37
</pre></div>
</div>
<p>Plot posterior marginal plots only as prior cannot be drawn meaningfully.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Bayesian inference (with log-pdf)&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">parameter_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">parameter_index</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Posterior&quot;</span><span class="p">])</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">parameter_index</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

<span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_rwmh_python_distribution_002.png" srcset="../../_images/sphx_glr_plot_rwmh_python_distribution_002.png" alt="Bayesian inference (with log-pdf)" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  6.051 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-bayesian-calibration-plot-rwmh-python-distribution-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8e126c6456a3c1920cbd867d4b8d3e20/plot_rwmh_python_distribution.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_rwmh_python_distribution.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/941ea6116c4e723b549c21ca31a783eb/plot_rwmh_python_distribution.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_rwmh_python_distribution.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_ackley_distribution.html" title="Customize your Metropolis-Hastings algorithm"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_bayesian_calibration_flooding.html" title="Bayesian calibration of the flooding model"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Posterior sampling using a PythonDistribution</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>