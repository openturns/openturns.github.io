
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Customize your Metropolis-Hastings algorithm &#8212; OpenTURNS 1.20dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Linear Regression with interval-censored observations" href="plot_gibbs_simus.html" />
    <link rel="prev" title="Posterior sampling using a PythonDistribution" href="plot_rwmh_python_distribution.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_gibbs_simus.html" title="Linear Regression with interval-censored observations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_rwmh_python_distribution.html" title="Posterior sampling using a PythonDistribution"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Customize your Metropolis-Hastings algorithm</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Customize your Metropolis-Hastings algorithm</a><ul>
<li><a class="reference internal" href="#prepare-the-metropolis-hastings-algorithm">Prepare the Metropolis-Hastings algorithm</a></li>
<li><a class="reference internal" href="#sample-from-the-ackley-distribution">Sample from the Ackley distribution</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_rwmh_python_distribution.html"
                          title="previous chapter">Posterior sampling using a PythonDistribution</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_gibbs_simus.html"
                          title="next chapter">Linear Regression with interval-censored observations</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/bayesian_calibration/plot_ackley_distribution.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-calibration-bayesian-calibration-plot-ackley-distribution-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="customize-your-metropolis-hastings-algorithm">
<span id="sphx-glr-auto-calibration-bayesian-calibration-plot-ackley-distribution-py"></span><h1>Customize your Metropolis-Hastings algorithm<a class="headerlink" href="#customize-your-metropolis-hastings-algorithm" title="Permalink to this heading">¶</a></h1>
<p>This simple example shows how you can build your own variant
of the Metropolis-Hastings algorithm.</p>
<p>We want to sample from the distribution with support <img class="math" src="../../_images/math/dd25924f1cd0f37c1985116c759fb5c0dbfae2bb.svg" alt="[-3, 3]^2"/>
whose PDF <img class="math" src="../../_images/math/51916a9aa71f574e1426044f0bc2d637b6160cde.svg" alt="f"/> is proportional to the Ackley function to the tenth power:</p>
<div class="math">
<p><img src="../../_images/math/214d7919583c900c9873f430d22cd3371d9df6d9.svg" alt="\forall \vect{x} \in [-3, 3]^2 \quad f(\vect{x}) \propto a(\vect{x})^{10},"/></p>
</div><p>where <img class="math" src="../../_images/math/64294e22974ce4dda9ee51a8b96ace4c17e1b7ee.svg" alt="a"/> is the Ackey function defined in <a class="reference internal" href="../../usecases/use_case_ackley.html#use-case-ackley"><span class="std std-ref">The Ackley test case</span></a> page.
In the following we call it the “Ackley distribution”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.experimental</span> <span class="k">as</span> <span class="nn">otexp</span>
<span class="kn">from</span> <span class="nn">openturns.viewer</span> <span class="kn">import</span> <span class="n">View</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">ackley_function</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">format_float_scientific</span>

<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<section id="prepare-the-metropolis-hastings-algorithm">
<h2>Prepare the Metropolis-Hastings algorithm<a class="headerlink" href="#prepare-the-metropolis-hastings-algorithm" title="Permalink to this heading">¶</a></h2>
<p>Define the Ackley distribution support and density (up to a constant factor).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">am</span> <span class="o">=</span> <span class="n">ackley_function</span><span class="o">.</span><span class="n">AckleyModel</span><span class="p">()</span>
<span class="n">ackley</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">model</span>
<span class="n">power10</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x^10&quot;</span><span class="p">)</span>
<span class="n">ackley_pdf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedFunction</span><span class="p">(</span><span class="n">power10</span><span class="p">,</span> <span class="n">ackley</span><span class="p">)</span>
<span class="n">logarithm</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;10 * log(x)&quot;</span><span class="p">)</span>
<span class="n">ackley_logpdf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedFunction</span><span class="p">(</span><span class="n">logarithm</span><span class="p">,</span> <span class="n">ackley</span><span class="p">)</span>
<span class="n">lb</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span>
<span class="n">ub</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">support</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="n">lb</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">ub</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the proposal distribution as a <a class="reference internal" href="../../user_manual/_generated/openturns.Histogram.html#openturns.Histogram" title="openturns.Histogram"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram</span></code></a>.
Its ticks (on the X axis of the PDF of the histogram) will remain the same,
but its frequencies (on the Y axis) will be updated
during the course of the Metropolis-Hastings algorithm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_bins</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">myticks</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RegularGrid</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_bins</span><span class="p">,</span> <span class="n">n_bins</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
<span class="n">frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">myticks</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">proposal</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">myticks</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">)</span>
</pre></div>
</div>
<p>The state of the Markov chain must be converted to an acceptable set
of parameters for the <a class="reference internal" href="../../user_manual/_generated/openturns.Histogram.html#openturns.Histogram" title="openturns.Histogram"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram</span></code></a> distribution.
This is the job of the <em>link function</em>,
which we construct with the <a class="reference internal" href="../../user_manual/_generated/openturns.OpenTURNSPythonFunction.html#openturns.OpenTURNSPythonFunction" title="openturns.OpenTURNSPythonFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpenTURNSPythonFunction</span></code></a> class.
It takes a state as input and outputs the parameters (ticks and frequencies)
of the proposal distribution.
In our case, the ticks will not depend on the inputs,
but the frequencies will be outputs of the Ackley function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameter_dim</span> <span class="o">=</span> <span class="n">proposal</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="n">parameter_desc</span> <span class="o">=</span> <span class="n">proposal</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">ConditionalAckley</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">OpenTURNSPythonFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    When executed, this function returns the parameters of a Histogram</span>
<span class="sd">    which approximates the conditional Ackley distribution obtained</span>
<span class="sd">    when one of the 2 coordinates is fixed.</span>
<span class="sd">    To compute the frequencies of the Histogram,</span>
<span class="sd">    this OpenTURNSPythonFunction computes the values of the Ackley function</span>
<span class="sd">    on a regular grid on the line parallel to</span>
<span class="sd">    either the (1, 0) vector (if the second coordinate is fixed)</span>
<span class="sd">    or the (0, 1) vector (if the first coordinate is fixed)</span>
<span class="sd">    containing the point passed as input.</span>
<span class="sd">    The regular grid covers the part of this line which is contained in</span>
<span class="sd">    the support of the Ackley distribution, implicitly defined as the</span>
<span class="sd">    smallest square that contains the cartesian product of the regular grid</span>
<span class="sd">    with itself. For example, if the regular grid covers the interval [-3, 3],</span>
<span class="sd">    then the support is the square [-3, 3] x [-3, 3].</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    marginal : int</span>
<span class="sd">        The marginal whose value is *not* fixed.</span>
<span class="sd">        If 0, then the line of the regular grid is parallel to the (1, 0) vector.</span>
<span class="sd">        If 1, then the line of the regular grid is parallel to the (0, 1) vector.</span>
<span class="sd">    ticks : RegularGrid</span>
<span class="sd">        Ticks of the Histogram distribution.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">marginal</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">parameter_dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setInputDescription</span><span class="p">([</span><span class="s2">&quot;X0&quot;</span><span class="p">,</span> <span class="s2">&quot;X1&quot;</span><span class="p">])</span>  <span class="c1"># input: X0 and X1 coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOutputDescription</span><span class="p">(</span><span class="n">parameter_desc</span><span class="p">)</span>  <span class="c1"># output: parameters of the Histogram</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_marginal</span> <span class="o">=</span> <span class="n">marginal</span>  <span class="c1"># parameter which does not vary after initialization</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_marginal_inputs</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">BuildFromPoint</span><span class="p">(</span><span class="n">ticks</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="c1"># _marginal_inputs contains the varying coordinate of the points in the regular grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marginal_inputs</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ticks</span> <span class="o">=</span> <span class="n">ticks</span>

    <span class="k">def</span> <span class="nf">_exec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute the function on a point X = (X0, X1).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : list of 2 floats</span>
<span class="sd">            Point through which the line containing the regular grid passes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        parameters : :class:`~openturns.Point`</span>
<span class="sd">            Parameters of the :class:`~openturns.Histogram`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>  <span class="c1"># sample of inputs for the Ackley function</span>
        <span class="c1"># All input points are initialized at the point X passed as argument.</span>

        <span class="c1"># Replace the varying coordinate with the values of the regular grid.</span>
        <span class="n">inputs</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marginal</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marginal_inputs</span>

        <span class="c1"># Compute the Ackley function on these inputs.</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">ackley_logpdf</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="o">.</span><span class="n">asPoint</span><span class="p">())</span>

        <span class="c1"># The outputs are the unnormalized frequencies of the Histogram</span>
        <span class="c1"># proposal distribution, but the Histogram.setParameter() method</span>
        <span class="c1"># expects a full set of parameters.</span>
        <span class="c1"># The easiest way to provide it is to construct a new Histogram object</span>
        <span class="c1"># with the adequate frequencies and call its getParameter() method.</span>
        <span class="k">return</span> <span class="n">ot</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ticks</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
</pre></div>
</div>
<p>The 2 components of the state of the Markov chain will be updated
one after the other, not simultaneously.
We define 2 <a class="reference internal" href="../../user_manual/_generated/openturns.experimental.UserDefinedMetropolisHastings.html#openturns.experimental.UserDefinedMetropolisHastings" title="openturns.experimental.UserDefinedMetropolisHastings"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserDefinedMetropolisHastings</span></code></a> algorithms
encapsulated within a <a class="reference internal" href="../../user_manual/_generated/openturns.Gibbs.html#openturns.Gibbs" title="openturns.Gibbs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gibbs</span></code></a> algorithm,
so we need 2 link functions, each corresponding to one of the marginals
of the Ackley distribution.</p>
<p>Note that thanks to the <a class="reference internal" href="../../user_manual/_generated/openturns.OpenTURNSPythonFunction.html#openturns.OpenTURNSPythonFunction" title="openturns.OpenTURNSPythonFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpenTURNSPythonFunction</span></code></a> class,
we were able to only code one template to be used by two different functions
instead of directly coding two functions with the <a class="reference internal" href="../../user_manual/_generated/openturns.PythonFunction.html#openturns.PythonFunction" title="openturns.PythonFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">PythonFunction</span></code></a> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">link_function_0</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">ConditionalAckley</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">myticks</span><span class="p">))</span>
<span class="n">link_function_1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="n">ConditionalAckley</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">myticks</span><span class="p">))</span>
</pre></div>
</div>
<p>Let us illustrate the first of these functions.
We can start by evaluating it at <img class="math" src="../../_images/math/e6791498cfcdcec838b05ebce2a4cc80d1bf5c07.svg" alt="(0.5, 1.5)"/>.
Let <img class="math" src="../../_images/math/aeb4c45f579264248b19299f665c2211cad119e7.svg" alt="(X_0, X_1)"/> be a bidimensional random variable
following the Ackley distribution.
The output is the set of parameters for a <a class="reference internal" href="../../user_manual/_generated/openturns.Histogram.html#openturns.Histogram" title="openturns.Histogram"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram</span></code></a>
distribution that approximates the distribution of <img class="math" src="../../_images/math/506d90d14f52425b0d970e187b95038298af1f47.svg" alt="X_0"/>
conditional on <img class="math" src="../../_images/math/d074cd293e9bca6d73f5dfebb48bfc2e3c4435f4.svg" alt="X_1 = 1.5"/>.
Let us update the Histogram we created before with this set of parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par</span> <span class="o">=</span> <span class="n">link_function_0</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">proposal</span><span class="o">.</span><span class="n">setParameter</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-3,0.12,0.574885,0.12,0.590611,0.12,0.616354,0.12,0.575301,0.12,0.474915,0.12,0.345447,0.12,0.217746,0.12,0.127608,0.12,0.0892587,0.12,0.086088,0.12,0.093021,0.12,0.0909145,0.12,0.0769473,0.12,0.0565498,0.12,0.0353399,0.12,0.0193349,0.12,0.0118315,0.12,0.01083,0.12,0.0129736,0.12,0.0148585,0.12,0.0146287,0.12,0.0124841,0.12,0.0091527,0.12,0.00577608,0.12,0.00381056,0.12,0.00381056,0.12,0.00577608,0.12,0.0091527,0.12,0.0124841,0.12,0.0146287,0.12,0.0148585,0.12,0.0129736,0.12,0.01083,0.12,0.0118315,0.12,0.0193349,0.12,0.0353399,0.12,0.0565498,0.12,0.0769473,0.12,0.0909145,0.12,0.093021,0.12,0.086088,0.12,0.0892587,0.12,0.127608,0.12,0.217746,0.12,0.345447,0.12,0.474915,0.12,0.575301,0.12,0.616354,0.12,0.590611,0.12,0.574885]#101
</pre></div>
</div>
<p>The <cite>link_function_0</cite> function computes histogram frequencies proportional
to the values of the unnormalized Ackley distribution PDF
along the <img class="math" src="../../_images/math/d074cd293e9bca6d73f5dfebb48bfc2e3c4435f4.svg" alt="X_1 = 1.5"/> line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Ackley PDF (up to a constant factor) and $X_1 = 1.5$ cross-section&quot;</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s2">&quot;$X_0$&quot;</span><span class="p">,</span> <span class="s2">&quot;$X_1$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ackley_pdf</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="n">lb</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">ub</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">reversed_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">contour</span><span class="o">.</span><span class="n">getColors</span><span class="p">())]</span>
<span class="n">contour</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">reversed_colors</span><span class="p">)</span>
<span class="n">legends</span> <span class="o">=</span> <span class="n">contour</span><span class="o">.</span><span class="n">getLegends</span><span class="p">()</span>
<span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">legends</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">contour</span><span class="o">.</span><span class="n">setLegends</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">getFigure</span><span class="p">()</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ackley_distribution_001.png" srcset="../../_images/sphx_glr_plot_ackley_distribution_001.png" alt="Ackley PDF (up to a constant factor) and $X_1 = 1.5$ cross-section" class = "sphx-glr-single-img"/><p>Let us compare the histogram to the unnormalized PDF
(we still need to rescale it to make it appear properly on the graph).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scaling</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;1.3e-10 * x&quot;</span><span class="p">)</span>
<span class="n">scaled_ackley_pdf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedFunction</span><span class="p">(</span><span class="n">scaling</span><span class="p">,</span> <span class="n">ackley_pdf</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">proposal</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">scaled_ackley_pdf</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Histogram PDF&quot;</span><span class="p">,</span> <span class="s2">&quot;Rescaled unnormalized PDF&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Conditional distribution of $X_0$ given $X_1 = 1.5$&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ackley_distribution_002.png" srcset="../../_images/sphx_glr_plot_ackley_distribution_002.png" alt="Conditional distribution of $X_0$ given $X_1 = 1.5$" class = "sphx-glr-single-img"/><p>Let us now do the same think with <cite>link_function_1</cite>.
This time, the relevant cross-section is along the line <img class="math" src="../../_images/math/2ec1b23e02385387d48718e774495b07d45d7fc6.svg" alt="X_1 = 0.5"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par</span> <span class="o">=</span> <span class="n">link_function_1</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">proposal</span><span class="o">.</span><span class="n">setParameter</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Ackley PDF (up to a constant factor) and $X_0 = 0.5$ cross-section&quot;</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s2">&quot;$X_0$&quot;</span><span class="p">,</span> <span class="s2">&quot;$X_1$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ackley_pdf</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="n">lb</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">ub</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">reversed_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">contour</span><span class="o">.</span><span class="n">getColors</span><span class="p">())]</span>
<span class="n">contour</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">reversed_colors</span><span class="p">)</span>
<span class="n">legends</span> <span class="o">=</span> <span class="n">contour</span><span class="o">.</span><span class="n">getLegends</span><span class="p">()</span>
<span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">legends</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">contour</span><span class="o">.</span><span class="n">setLegends</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">getFigure</span><span class="p">()</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">scaling</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;3.1e-10 * x&quot;</span><span class="p">)</span>
<span class="n">scaled_ackley_pdf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedFunction</span><span class="p">(</span><span class="n">scaling</span><span class="p">,</span> <span class="n">ackley_pdf</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">proposal</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">scaled_ackley_pdf</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Histogram PDF&quot;</span><span class="p">,</span> <span class="s2">&quot;Rescaled unnormalized PDF&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Conditional distribution of $X_1$ given $X_0 = 0.5$&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_ackley_distribution_003.png" srcset="../../_images/sphx_glr_plot_ackley_distribution_003.png" alt="Ackley PDF (up to a constant factor) and $X_0 = 0.5$ cross-section" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_ackley_distribution_004.png" srcset="../../_images/sphx_glr_plot_ackley_distribution_004.png" alt="Conditional distribution of $X_1$ given $X_0 = 0.5$" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-3,0.12,0.714193,0.12,0.709153,0.12,0.714195,0.12,0.635879,0.12,0.49337,0.12,0.331163,0.12,0.187923,0.12,0.0968651,0.12,0.0598784,0.12,0.0526439,0.12,0.0522747,0.12,0.0457978,0.12,0.0334477,0.12,0.0202285,0.12,0.00973413,0.12,0.00378105,0.12,0.00159728,0.12,0.0011016,0.12,0.001075,0.12,0.00097469,0.12,0.00070403,0.12,0.00040715,0.12,0.0001854,0.12,6.70262e-05,0.12,2.77594e-05,0.12,2.77594e-05,0.12,6.70262e-05,0.12,0.0001854,0.12,0.00040715,0.12,0.00070403,0.12,0.00097469,0.12,0.001075,0.12,0.0011016,0.12,0.00159728,0.12,0.00378105,0.12,0.00973413,0.12,0.0202285,0.12,0.0334477,0.12,0.0457978,0.12,0.0522747,0.12,0.0526439,0.12,0.0598784,0.12,0.0968651,0.12,0.187923,0.12,0.331163,0.12,0.49337,0.12,0.635879,0.12,0.714195,0.12,0.709153,0.12,0.714193]#101
</pre></div>
</div>
<p>We now choose the initial state of the Markov chain.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialState</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="sample-from-the-ackley-distribution">
<h2>Sample from the Ackley distribution<a class="headerlink" href="#sample-from-the-ackley-distribution" title="Permalink to this heading">¶</a></h2>
<p>We can finally define the two Metropolis-Hastings algorithms
and the Gibbs algorithm which encapsulates them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmh_0</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">UserDefinedMetropolisHastings</span><span class="p">(</span>
    <span class="n">ackley_logpdf</span><span class="p">,</span> <span class="n">support</span><span class="p">,</span> <span class="n">initialState</span><span class="p">,</span> <span class="n">proposal</span><span class="p">,</span> <span class="n">link_function_0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">gmh_1</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">UserDefinedMetropolisHastings</span><span class="p">(</span>
    <span class="n">ackley_logpdf</span><span class="p">,</span> <span class="n">support</span><span class="p">,</span> <span class="n">initialState</span><span class="p">,</span> <span class="n">proposal</span><span class="p">,</span> <span class="n">link_function_1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">gibbs</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Gibbs</span><span class="p">([</span><span class="n">gmh_0</span><span class="p">,</span> <span class="n">gmh_1</span><span class="p">])</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">gibbs</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Print the acceptance rates of the two Metropolis-Hastings samplers</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mhlist</span> <span class="o">=</span> <span class="n">gibbs</span><span class="o">.</span><span class="n">getMetropolisHastingsCollection</span><span class="p">()</span>
<span class="n">rate_gmh_0</span> <span class="o">=</span> <span class="n">mhlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getAcceptanceRate</span><span class="p">()</span>
<span class="n">rate_gmh_1</span> <span class="o">=</span> <span class="n">mhlist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getAcceptanceRate</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Acceptance rates: </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rate_gmh_0</span><span class="p">,</span> <span class="n">rate_gmh_1</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Acceptance rates: 0.99 and 0.91
</pre></div>
</div>
<p>Draw the contour plot of the Ackley distribution PDF (up to a multiplicative constant)
and the MCMC sample: we can see the sample is accurate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Ackley PDF (up to a constant factor) and Metropolis-Hastings sample&quot;</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s2">&quot;$X_0$&quot;</span><span class="p">,</span> <span class="s2">&quot;$X_1$&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ackley_pdf</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="n">lb</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">ub</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">reversed_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">getColors</span><span class="p">())]</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">reversed_colors</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;plus&quot;</span><span class="p">))</span>
<span class="n">legends</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">getLegends</span><span class="p">()</span>
<span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">legends</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">getFigure</span><span class="p">()</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_ackley_distribution_005.png" srcset="../../_images/sphx_glr_plot_ackley_distribution_005.png" alt="Ackley PDF (up to a constant factor) and Metropolis-Hastings sample" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.870 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-bayesian-calibration-plot-ackley-distribution-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9ed46628cf366e1ecc59c3ab167a46cd/plot_ackley_distribution.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_ackley_distribution.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/88b0fd834c771eda3ff3857d23f0e783/plot_ackley_distribution.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_ackley_distribution.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_gibbs_simus.html" title="Linear Regression with interval-censored observations"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_rwmh_python_distribution.html" title="Posterior sampling using a PythonDistribution"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Customize your Metropolis-Hastings algorithm</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>