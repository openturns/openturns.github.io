
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Kolmogorov-Smirnov : get the statistics distribution &#8212; OpenTURNS 1.21dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Estimate dependency and copulas" href="../estimate_dependency_and_copulas/index.html" />
    <link rel="prev" title="Kolmogorov-Smirnov : understand the p-value" href="plot_kolmogorov_pvalue.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../estimate_dependency_and_copulas/index.html" title="Estimate dependency and copulas"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_kolmogorov_pvalue.html" title="Kolmogorov-Smirnov : understand the p-value"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Statistical tests</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Kolmogorov-Smirnov : get the statistics distribution</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Kolmogorov-Smirnov : get the statistics distribution</a><ul>
<li><a class="reference internal" href="#known-parameters-versus-estimated-parameters">Known parameters versus estimated parameters</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_kolmogorov_pvalue.html"
                          title="previous chapter">Kolmogorov-Smirnov : understand the p-value</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../estimate_dependency_and_copulas/index.html"
                          title="next chapter">Estimate dependency and copulas</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_data_analysis/statistical_tests/plot_kolmogorov_distribution.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-data-analysis-statistical-tests-plot-kolmogorov-distribution-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="kolmogorov-smirnov-get-the-statistics-distribution">
<span id="sphx-glr-auto-data-analysis-statistical-tests-plot-kolmogorov-distribution-py"></span><h1>Kolmogorov-Smirnov : get the statistics distribution<a class="headerlink" href="#kolmogorov-smirnov-get-the-statistics-distribution" title="Permalink to this heading">¶</a></h1>
<p>In this example, we draw the Kolmogorov-Smirnov distribution for a sample size 10.
We want to test the hypothesis that this sample has the <cite>Uniform(0, 1)</cite>
distribution.
The K.S. distribution is first plotted in the case where the
parameters of the uniform distribution are known.
Then we plot the distribution when the parameters of the uniform
distribution are estimated from the sample.</p>
<p><em>Reference</em> : Hovhannes Keutelian, “The Kolmogorov-Smirnov test when
parameters are estimated from data”, 30 April 1991, Fermilab</p>
<p>Note: There is a sign error in the paper; the equation:
<cite>D[i]=max(abs(S+step),D[i])</cite> must be replaced with <cite>D[i]=max(abs(S-step),D[i])</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9374</span><span class="p">,</span> <span class="mf">0.7629</span><span class="p">,</span> <span class="mf">0.4771</span><span class="p">,</span> <span class="mf">0.5111</span><span class="p">,</span> <span class="mf">0.8701</span><span class="p">,</span> <span class="mf">0.0684</span><span class="p">,</span> <span class="mf">0.7375</span><span class="p">,</span> <span class="mf">0.5615</span><span class="p">,</span> <span class="mf">0.2835</span><span class="p">,</span> <span class="mf">0.2508</span><span class="p">]</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([[</span><span class="n">xi</span><span class="p">]</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">samplesize</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="n">samplesize</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
<p>Plot the empirical distribution function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">UserDefined</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">.</span><span class="n">drawCDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Sample&quot;</span><span class="p">])</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Uniform&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Cumulated distribution function&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_kolmogorov_distribution_001.png" srcset="../../_images/sphx_glr_plot_kolmogorov_distribution_001.png" alt="Cumulated distribution function" class = "sphx-glr-single-img"/><p>The computeKSStatisticsIndex function computes the Kolmogorov-Smirnov
distance between the sample and the distribution.
The following function is for teaching purposes only: use <cite>FittingTest</cite>
for real applications.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeKSStatistics</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">distribution</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
    <span class="n">D</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">D_previous</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">computeCDF</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">Fminus</span> <span class="o">=</span> <span class="n">F</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
        <span class="n">Fplus</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="o">-</span> <span class="n">F</span>
        <span class="n">D</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Fminus</span><span class="p">,</span> <span class="n">Fplus</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">D</span> <span class="o">&gt;</span> <span class="n">D_previous</span><span class="p">:</span>
            <span class="n">D_previous</span> <span class="o">=</span> <span class="n">D</span>
    <span class="k">return</span> <span class="n">D</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dist</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>Uniform(a = 0, b = 1)</p>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">computeKSStatistics</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.17710000000000004
</pre></div>
</div>
<p>The following function generates a sample of K.S. distances when the tested distribution is the <cite>Uniform(0,1)</cite> distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generateKSSampleKnownParameters</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">,</span> <span class="n">samplesize</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    nrepeat : Number of repetitions, size of the table</span>
<span class="sd">    samplesize : the size of each sample to generate from the Uniform distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">samplesize</span><span class="p">)</span>
        <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">computeKSStatistics</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span>
</pre></div>
</div>
<p>Generate a sample of KS distances.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrepeat</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Size of the KS distances sample</span>
<span class="n">sampleD</span> <span class="o">=</span> <span class="n">generateKSSampleKnownParameters</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">,</span> <span class="n">samplesize</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute exact Kolmogorov CDF.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pKolmogorovPy</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">DistFunc</span><span class="o">.</span><span class="n">pKolmogorov</span><span class="p">(</span><span class="n">samplesize</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pKolmogorov</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pKolmogorovPy</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dKolmogorov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">samplesize</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute Kolmogorov PDF for given x.</span>
<span class="sd">    x : an array, the points where the PDF must be evaluated</span>
<span class="sd">    samplesize : the size of the sample</span>
<span class="sd">    Reference</span>
<span class="sd">    Numerical Derivatives in Scilab, Michael Baudin, May 2009</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pKolmogorov</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">linearSample</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">npoints</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a sample created from a regular grid</span>
<span class="sd">    from xmin to xmax with npoints points.&quot;&quot;&quot;</span>
    <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">npoints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">rg</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RegularGrid</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">getVertices</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">vertices</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Number of points in the plot</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">linearSample</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dKolmogorov</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">samplesize</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Exact distribution&quot;</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HistogramFactory</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sampleD</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Empirical distribution&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Kolmogorov-Smirnov distribution (known parameters)&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;KS-Statistics&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_kolmogorov_distribution_002.png" srcset="../../_images/sphx_glr_plot_kolmogorov_distribution_002.png" alt="Kolmogorov-Smirnov distribution (known parameters)" class = "sphx-glr-single-img"/><section id="known-parameters-versus-estimated-parameters">
<h2>Known parameters versus estimated parameters<a class="headerlink" href="#known-parameters-versus-estimated-parameters" title="Permalink to this heading">¶</a></h2>
<p>The following function generates a sample of K.S. distances when the tested
distribution is the <cite>Uniform(a,b)</cite> distribution, where the <cite>a</cite> and <cite>b</cite>
parameters are estimated from the sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generateKSSampleEstimatedParameters</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">,</span> <span class="n">samplesize</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    nrepeat : Number of repetitions, size of the table</span>
<span class="sd">    samplesize : the size of each sample to generate from the Uniform distribution</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distfactory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">UniformFactory</span><span class="p">()</span>
    <span class="n">refdist</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">refdist</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">samplesize</span><span class="p">)</span>
        <span class="n">trialdist</span> <span class="o">=</span> <span class="n">distfactory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">computeKSStatistics</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">trialdist</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span>
</pre></div>
</div>
<p>Generate a sample of KS distances.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleDP</span> <span class="o">=</span> <span class="n">generateKSSampleEstimatedParameters</span><span class="p">(</span><span class="n">nrepeat</span><span class="p">,</span> <span class="n">samplesize</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sampleD</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Known parameters&quot;</span><span class="p">])</span>
<span class="n">graphP</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sampleDP</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graphP</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Estimated parameters&quot;</span><span class="p">])</span>
<span class="n">graphP</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="s2">&quot;blue&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">graphP</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Kolmogorov-Smirnov distribution&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;KS-Statistics&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_kolmogorov_distribution_003.png" srcset="../../_images/sphx_glr_plot_kolmogorov_distribution_003.png" alt="Kolmogorov-Smirnov distribution" class = "sphx-glr-single-img"/><p>We see that the distribution of the KS distances when the parameters are
estimated is shifted towards the left: smaller distances occur more often.
This is a consequence of the fact that the estimated parameters tend to make
the estimated distribution closer to the empirical sample.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.678 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-data-analysis-statistical-tests-plot-kolmogorov-distribution-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5c3ed7990c196edd3d0d82732c3a52f0/plot_kolmogorov_distribution.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_kolmogorov_distribution.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d2c03eba248681c4f7b35be132f32281/plot_kolmogorov_distribution.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_kolmogorov_distribution.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../estimate_dependency_and_copulas/index.html" title="Estimate dependency and copulas"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_kolmogorov_pvalue.html" title="Kolmogorov-Smirnov : understand the p-value"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Statistical tests</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Kolmogorov-Smirnov : get the statistics distribution</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>