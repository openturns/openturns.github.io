
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Bandwidth sensitivity in kernel smoothing &#8212; OpenTURNS 1.22dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Fit an extreme value distribution" href="plot_fit_extreme_value_distribution.html" />
    <link rel="prev" title="Estimate a GEV on the Venice sea-levels data" href="plot_estimate_gev_venice.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_fit_extreme_value_distribution.html" title="Fit an extreme value distribution"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_gev_venice.html" title="Estimate a GEV on the Venice sea-levels data"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bandwidth sensitivity in kernel smoothing</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Bandwidth sensitivity in kernel smoothing</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#generate-the-mixture-by-merging-two-samples">Generate the mixture by merging two samples</a></li>
<li><a class="reference internal" href="#simulation-based-on-a-mixture">Simulation based on a mixture</a></li>
<li><a class="reference internal" href="#sensitivity-to-the-bandwidth">Sensitivity to the bandwidth</a></li>
<li><a class="reference internal" href="#sensitivity-to-the-bandwidth-rule">Sensitivity to the bandwidth rule</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_estimate_gev_venice.html"
                          title="previous chapter">Estimate a GEV on the Venice sea-levels data</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_fit_extreme_value_distribution.html"
                          title="next chapter">Fit an extreme value distribution</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_data_analysis/distribution_fitting/plot_smoothing_mixture.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-data-analysis-distribution-fitting-plot-smoothing-mixture-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="bandwidth-sensitivity-in-kernel-smoothing">
<span id="sphx-glr-auto-data-analysis-distribution-fitting-plot-smoothing-mixture-py"></span><h1>Bandwidth sensitivity in kernel smoothing<a class="headerlink" href="#bandwidth-sensitivity-in-kernel-smoothing" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>When we have a sample, we may estimate the probability density function of the
underlying distribution using kernel smoothing.
One of the parameters of this method is the bandwidth, which can be either
set by the user, or estimated from the data.
This is especially true when the density is multimodal.
In this example, we consider a bimodal distribution and see how the bandwidth
can change the estimated probability density function.</p>
<p>We consider the distribution:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANUAAAATBAMAAAD131UZAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACp0lEQVRIx42VT2gTQRTGv90mm2yTphEPghBMY1VQCCH+OZaASOltwYsg4l4k4r8EKwhFS8CLetqSXgTRYMSbEj0o3oqi0Fty8CIs5CBCD0JOQi7WmXmz2Z1lt+lA9mUmv/d9M29mJ8CkbVDIY3ozCdL2gYZktaMi9Kn3Yo88SWJOWg6noyHZhTPixyb1ZorxAkQCh2S/Oh0NyV6o82fao1rxAkT6iJfjxKOqrDFS59iNtZKkv/TZCsUTsWhIdoZm+dEbfBjrJUlkbDmQ6sd5eagqa75+Kkq6xVKX6mUHWSUpuYRc5bkQ90hBrP6+uyOSfK8oNCSboYrUgIvJD4km5nnvj8vaT/alnbCyVpoSJYkE061cLi4Do6BXFBqSzVpo92CwReeTY531lZ1uNtCAZjNCkOxgWbjOX62rDpPbDnpJtPqOUPNXqeCEZF8Cp1tI8gJrvP4J9VS9xSnonBAkcKuISzwW+GOFfXKu+9h1Ox5q5Oc6hB5GbhiSvQe+KLPGD2hF7kagLWPAvPj8OAmUO9jk8ZHcjcDZEGiypfcI/cQqGZItCC+e1mw4mhyc7BfGTOIaefGlpDb6nEgZY37tqF6EYrZD6LZ5ICw7IK8n0GuLznHgprqu7+ZXFMlrwA8zO81pB4v6im7D6ClehGLTIdHz1Tdh2W/kdRBGt95lu19SvdZLVxYc8mIkXp3cglbBjXNrZwG9qHgRih+E6kNeSUXWHJHXbU/8c+SV0ZKkxZ6GfIWRcSLeZc2yBZor4oEqm2qzRKPm502EVK8akazwf/3peELPguh95AWasPFelZ1fZ+tb+8JqL/8gck6UFyM4abjQ/wF35OhO1Kx2dzscNY+UyqzEQVl9sj2rFI7F3YY+iRTdubo1HY2WNSjY+/mztYMZezdf9j9PXL6VNmvfMAAAAAp0RVh0RGVwdGgA/////o6f8XkAAAAASUVORK5CYII=" alt="f_1(x) = w_1 f_A(x) + w_2 f_B(x)"/></p>
</div><p>for any <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAOBAMAAABJDIgxAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYHS/MosYSN3znc/pr/uvp9FeAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoklEQVQY02NgQAMxp+d0NjFgArYLG1guGWAVZ9iwBFkguKMJJl6KJB4hhlCvCGQImYiaASnWCwjzDTcwMLArVARMBPIz4OZ3950C0lwM9QkBQFoULr7FbAOYtRpMrunogNl7fRFY5BCYlEK4k5sjgYGBkeUbwwIgnwMhzhQCNCiSdRqrA5DPZAATN2DYpsXA4Ksiq47sfp3Dsws87C5g+BcKAFTMMdMVOJxiAAAACnRFWHREZXB0aAAAAAABUCTRmgAAAABJRU5ErkJggg==" alt="x\in\mathbb{R}" style="vertical-align: -1px"/> where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARBAMAAADNtor0AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAcElEQVQI12NgYGBgVGaAAUUTONM1HcZi+wAXZG6AsTiXdBXA2NwKcAU8ASADQQTDfBCRA5YqARF6C0CkLBCzT7wAYl4EGQgx8SgQL9I6ADIXaBlbAIhknwxUxcjA8I2Bgb8ugIHtLgPTPwYGJiWYVQCIaBRFLhlYCAAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="f_A" style="vertical-align: -4px"/> is the density of the Normal distribution
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAATBAMAAAAzNgPlAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/vddM/pGK+dMmCLSPOZ/k9gAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABN0lEQVQoz12RPUvEQBCGnzN3l6/TExtLBUHbNGIbxEJRuPwD0ykWkvJs5H6CFjZaGIsTBMFgIdh4KcXGYGFpSlvBSkF0NjnPrAvDO7vPzuzsDAzXlId5QHXZpayINeZ8GhrEnCxkXqwrdgK390mJbjLYKO58R3AsTsh4yE4BL3KhTeW5MylIlnqK4XNYxraFWr44rZcQemDE6uz6j7qBODX7E1eeG4M8Jo9GlFlFnQ8s0QkYxOrCiL6JXbJLTfS8iB1U6ILYA4/JnugzXGV0KplfUeW2g3XRfTlLWEZ71+xhfUnJqioj5UijphVjvqumNSNcT7rRV7klC45HZ1H8UxVry+fXVhOepDndze2MVsrdlmqISuYEw/b7QzWi6lCW/tG+NrKzUuq/+2mNur5GW5k+71jbOfADghpIFw1IMAkAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\mathcal{N}(0,1)" style="vertical-align: -5px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARBAMAAADNtor0AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAeklEQVQI12NgYGBgVGaAAUUTONM1HcZi+wAXZG6AsTiXdBXA2NwKcAU8AQycT5RkJwCZ84FYioHvAZAqAeLtEGWyQHySUxCk9iLQaGejZSDmUQYGpgdgZZxAy/gUGGoYGNgnX2BgYElg2MjAwF8HNFZeSQ9oAJMSzCoAHKoUTm7x6wcAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="f_B" style="vertical-align: -4px"/> is the density of the Normal distribution
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAVBAMAAABoAqesAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/vddM/pGK+dMmCLSPOZ/k9gAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACPElEQVQ4y51TPWgUQRT+7vYus7u3lzOxEBSMICp222jAaoV0EbxCEAvJdlqFRRC00RMLiQTcwkhQgpfiQgTBFCFNRFas/AEXC8FG06WNKEjEsL73Zmdvt9SBme+9N/u9eX8L/Ps6dwf/t9y42Svr4z5UbJR9Q/tNI9TkdIB26PmOtk3Rbh4N0Cy8lnx2jbAqp2Kndk9p38dp36D9BPiwwO/afSzuD/Qba8BGytJ9eG8vUZIk3ooEoLIIeExCCDvBLgkWcdUfYY4Az74J08c8OjEbcFnsQGsikcwaCWwfx8jyBaMpDus60u4wsx3jLupd2AGctM8AeF9DgDKz+hwAP3UQ9QQPhHnGMGt8eztBq4tNxAxkc36jRenUJa9QAqN1WphHDNNi7RFb3Czr6YuauwubcJTfH+PwE67vnjC3DPMl7ddc0R1daobnmJVmrbDBm6QORVyaRPoTGuZFVt/QzQnNZHiHj2vc78/Ig5S+zovWLpjSV4vUbc3cloHpdKe5S8RJMRHJZHiJbryJthFwM2q/dIK6AKoHe4+Hhir0IsCMdr8Or1IhisP9ieZOialoYNQPTn0kgh2pk1DEbB/aPIsBZXWFmVT464T3cC2G6+sB9XH+FOFTftOhgBYXAnjcoSz7jk8U8UMazJmrKd7zB3MXijQIXrFXiczNh9sqpp1cDXLRNzYrKkO+JjUsl5n5F27x3w0qgAplyeiNIcVJjfFABfLVCqqBMZOKXMnAS8tQrH7pLP7y0jkUCP4C/WF+7d/dvLEAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\mathcal{N}(3/2,(1/3)^2)" style="vertical-align: -5px"/> and the weights are <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAAWBAMAAACS8MnbAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPsy8+lgna/Pi928fmsRAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAuklEQVQoz2NgwA6YJpkw4AKsDKdwyrExNOKUY8hagFvOE7d9DAx2OGX0GK7jlJvFYM3AwKjMwKzgmoAux3t3AwODE7sAqwDHBIiIzRkgOA1XMCGfIZ+BK8HpATaT9zDcY+BlUGpAFf3///8HBoZKYOjwMrA1YNP3BSibCJVDtu8AEIexBDFcwNTHBRKYfFfmlgOmXBJCAEPuCpJcAVrcuiDkZseiBg0TSwPO8Fx7KxZ3FDHi1seQHMsAAH33LoW0eW4EAAAACnRFWHREZXB0aAAAAAAGzkBEOQAAAABJRU5ErkJggg==" alt="w_1 = \frac{3}{4}" style="vertical-align: -6px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAAWBAMAAACS8MnbAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPsy8+lgna/Pi928fmsRAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAs0lEQVQoz2NgwA5Y9BhwAiYN3HIMGYNILh2IGZUZmBVcE9ClOLdeY2BwYhdgFeCYABGxOQMEp+EKJuQz5DNwJehuxmbwHoZ7DLxsC3g2oIj+////AwNDJcMpBl7GBt4HWPR9AcomMjBwb0Cz7wAQh7EEMVxgYHB3QNXC1QAkJt+VuQUUP4hmXFIDQpkAmhevIORmMixAjT8XuBzb//+ofmBiacAZnGtvxeIOa0bc+hiSYxkAbNgvd2M8QSEAAAAKdEVYdERlcHRoAAAAAAbOQEQ5AAAAAElFTkSuQmCC" alt="w_2 = \frac{1}{4}" style="vertical-align: -6px"/>.</p>
<p>This is a mixture of two Normal distributions: 1/4th of the observations have the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAATBAMAAAAzNgPlAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/vddM/pGK+dMmCLSPOZ/k9gAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABN0lEQVQoz12RPUvEQBCGnzN3l6/TExtLBUHbNGIbxEJRuPwD0ykWkvJs5H6CFjZaGIsTBMFgIdh4KcXGYGFpSlvBSkF0NjnPrAvDO7vPzuzsDAzXlId5QHXZpayINeZ8GhrEnCxkXqwrdgK390mJbjLYKO58R3AsTsh4yE4BL3KhTeW5MylIlnqK4XNYxraFWr44rZcQemDE6uz6j7qBODX7E1eeG4M8Jo9GlFlFnQ8s0QkYxOrCiL6JXbJLTfS8iB1U6ILYA4/JnugzXGV0KplfUeW2g3XRfTlLWEZ71+xhfUnJqioj5UijphVjvqumNSNcT7rRV7klC45HZ1H8UxVry+fXVhOepDndze2MVsrdlmqISuYEw/b7QzWi6lCW/tG+NrKzUuq/+2mNur5GW5k+71jbOfADghpIFw1IMAkAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\mathcal{N}(0,1)" style="vertical-align: -5px"/>
distribution and 3/4th of the observations have the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAVBAMAAABoAqesAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/vddM/pGK+dMmCLSPOZ/k9gAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACPElEQVQ4y51TPWgUQRT+7vYus7u3lzOxEBSMICp222jAaoV0EbxCEAvJdlqFRRC00RMLiQTcwkhQgpfiQgTBFCFNRFas/AEXC8FG06WNKEjEsL73Zmdvt9SBme+9N/u9eX8L/Ps6dwf/t9y42Svr4z5UbJR9Q/tNI9TkdIB26PmOtk3Rbh4N0Cy8lnx2jbAqp2Kndk9p38dp36D9BPiwwO/afSzuD/Qba8BGytJ9eG8vUZIk3ooEoLIIeExCCDvBLgkWcdUfYY4Az74J08c8OjEbcFnsQGsikcwaCWwfx8jyBaMpDus60u4wsx3jLupd2AGctM8AeF9DgDKz+hwAP3UQ9QQPhHnGMGt8eztBq4tNxAxkc36jRenUJa9QAqN1WphHDNNi7RFb3Czr6YuauwubcJTfH+PwE67vnjC3DPMl7ddc0R1daobnmJVmrbDBm6QORVyaRPoTGuZFVt/QzQnNZHiHj2vc78/Ig5S+zovWLpjSV4vUbc3cloHpdKe5S8RJMRHJZHiJbryJthFwM2q/dIK6AKoHe4+Hhir0IsCMdr8Or1IhisP9ieZOialoYNQPTn0kgh2pk1DEbB/aPIsBZXWFmVT464T3cC2G6+sB9XH+FOFTftOhgBYXAnjcoSz7jk8U8UMazJmrKd7zB3MXijQIXrFXiczNh9sqpp1cDXLRNzYrKkO+JjUsl5n5F27x3w0qgAplyeiNIcVJjfFABfLVCqqBMZOKXMnAS8tQrH7pLP7y0jkUCP4C/WF+7d/dvLEAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\mathcal{N}(3/2,(1/3)^2)" style="vertical-align: -5px"/> distribution.
This example is considered in (Wand, Jones, 1994), page 14, Figure 2.3.</p>
<p>We consider a sample generated from independent realizations of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAARBAMAAADwJOuSAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXElEQVQI12NgYGBgVGaAAEUTKMM1HUKzfYAKMDdAaM4lXQUQFrcCVIongGHyBhBjPgODMVhZCVAjmCELY1yEMY5CGZwfIAz2yReADAcGBv66AAaGqkMJDExKEGMBRxURbR+EUrYAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="f_1" style="vertical-align: -4px"/> and
want to approximate the distribution from kernel smoothing.
More precisely, we want to observe the sensitivity of the resulting density to the
bandwidth.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>“Kernel Smoothing”, M.P.Wand, M.C.Jones. Chapman and Hall / CRC (1994).</p></li>
</ul>
</section>
<section id="generate-the-mixture-by-merging-two-samples">
<h2>Generate the mixture by merging two samples<a class="headerlink" href="#generate-the-mixture-by-merging-two-samples" title="Permalink to this heading">¶</a></h2>
<p>In this section, we show that a mixture of two Normal distributions is
nothing more than the merged sample of two independent Normal distributions.
In order to generate a sample with size <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LGM9IMmD73fO/r+mGTbZDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgVHY2TWBgqMg0YFzAwCBgzcAUwMDAcJaBVQFIzWDgL2BgYP/AIMfBwMD8gOEsMwMDkwFDrggDAP0FCNj5FTHGAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="n" style="vertical-align: 0px"/>, we sample
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAATBAMAAAD/rzkOAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv92vi0h0GPsy8+lgnc9qT8RBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAApUlEQVQY02MQYMAEAgwKWEQVaCkaJsAgxt4J4ua6uzyFirInLGVoZdgD5HEebWFIgorycH7g/MBwkz2JgY1lAcM9mAnMD1gUGBzYshkYGA0Y3sJEuQ7wXWBwYJjNwMBxgOEnTJS/gOsAZwBIdD4D24YDUFGOCRUJLAwgUW+gGQ5QUR4R1yfXwaJXGFjNClB9MRur32ZhE+Wx8CQUDkZKDmhiSUoCAHLPJW5Z2kNEAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\lfloor w_1 n\rfloor" style="vertical-align: -5px"/> points from the first Normal distribution
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARBAMAAADNtor0AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAcElEQVQI12NgYGBgVGaAAUUTONM1HcZi+wAXZG6AsTiXdBXA2NwKcAU8ASADQQTDfBCRA5YqARF6C0CkLBCzT7wAYl4EGQgx8SgQL9I6ADIXaBlbAIhknwxUxcjA8I2Bgb8ugIHtLgPTPwYGJiWYVQCIaBRFLhlYCAAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="f_A" style="vertical-align: -4px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAATBAMAAAD/rzkOAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv92vi0h0GPsy8+lgnc9qT8RBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAsElEQVQY02MQYMAEAgwKWEQVaCkaJsAgxt4J4ua6uzyFirInLGVoZdgD5HEebWFIgorycH7g/MBwk81ZgI1lAcM9mAnMD1gUGBzmMjxmYDRgeAsT5TrAd4HBIZrBiYHjAMNPmCh/AdcBzgAGBmOG+QxsGw5ARTkmVCSwMDCwL2fwBprhABXlEXF9cp2BgS+A4QoDq1kBqi+ucmLxG88BXiyi8/9/JhQORkoOaGJJSgIAiAwoY7qI6/oAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\lfloor w_2 n\rfloor" style="vertical-align: -5px"/> points from the second Normal
distribution <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARBAMAAADNtor0AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAeklEQVQI12NgYGBgVGaAAUUTONM1HcZi+wAXZG6AsTiXdBXA2NwKcAU8AQycT5RkJwCZ84FYioHvAZAqAeLtEGWyQHySUxCk9iLQaGejZSDmUQYGpgdgZZxAy/gUGGoYGNgnX2BgYElg2MjAwF8HNFZeSQ9oAJMSzCoAHKoUTm7x6wcAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="f_B" style="vertical-align: -4px"/>. Then we merge the two samples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
</pre></div>
</div>
<p>We choose a rather large sample size: <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEcAAAAMBAMAAADCAb2DAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LGM9IMmD73fO/r+mGTbZDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA50lEQVQY02NgwAR9CQwMTbYNDBzKNyAMLKAoP4GB7QHDc4Y8Br4CMAMb4E9g4BJg0GFYyMB0AMzAoQiIOhm+MXBMADMYGJWdTRMwFOUXMOS7fWdg+wJiODBUZBowLgDK8ISCwAWoon6gXAVQ0XcQo4BBwJqBKQCbSf1l3xk4voMYBQwMZxlYFTAU1ScwyLt/Y2D8AmI4MDDMYOAvwHR4A4Mkww8GxglgBgP7BwY5Dgw3cRkwqDIsBjoEzGBgfsBwlhnNJGBgLwCGYRcwMMEMBiYDhlwRFDW+8W8TGIRkGxgYFYHRAmIAANhYQ4A8sGm9AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="n=1000" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
<p>Then we define the two Normal distributions and their parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w1</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">w2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">w1</span>
<span class="n">distribution1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">distribution2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
<p>We generate two independent sub-samples from the two Normal distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample1</span> <span class="o">=</span> <span class="n">distribution1</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">w1</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">distribution2</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">w2</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<p>Then we merge the sub-samples into a larger one with the <cite>add</cite> method of the <cite>Sample</cite> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span>
<span class="n">sample</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span>
<span class="n">sample</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1000
</pre></div>
</div>
<p>In order to see the result, we build a kernel smoothing approximation on the sample. In order to keep it simple, let us use the default bandwidth selection rule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_smoothing_mixture_001.png" srcset="../../_images/sphx_glr_plot_smoothing_mixture_001.png" alt="plot smoothing mixture" class = "sphx-glr-single-img"/><p>We see that the distribution of the merged sample has two modes.
However, these modes are not clearly distinct. To distinguish them, we could increase the sample size.
However, it might be interesting to see if the bandwidth selection rule can be better chosen: this is the purpose of the next section.</p>
</section>
<section id="simulation-based-on-a-mixture">
<h2>Simulation based on a mixture<a class="headerlink" href="#simulation-based-on-a-mixture" title="Permalink to this heading">¶</a></h2>
<p>Since the distribution that we approximate is a mixture, it will be more convenient to create it from the <cite>Mixture</cite> class.
It takes as input argument a list of distributions and a list of weights.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Mixture</span><span class="p">([</span><span class="n">distribution1</span><span class="p">,</span> <span class="n">distribution2</span><span class="p">],</span> <span class="p">[</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">])</span>
</pre></div>
</div>
<p>Then we generate a sample from it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span><span class="o">.</span><span class="n">getBandwidth</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[0.208514]</p>
</div>
<br />
<br /><p>We see that the default bandwidth is close to 0.17.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="s2">&quot;dodgerblue3&quot;</span><span class="p">,</span> <span class="s2">&quot;darkorange1&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Mixture&quot;</span><span class="p">,</span> <span class="s2">&quot;Kernel smoothing&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_smoothing_mixture_002.png" srcset="../../_images/sphx_glr_plot_smoothing_mixture_002.png" alt="plot smoothing mixture" class = "sphx-glr-single-img"/><p>We see that the result of the kernel smoothing approximation of the mixture is similar to the previous one and could be improved.</p>
</section>
<section id="sensitivity-to-the-bandwidth">
<h2>Sensitivity to the bandwidth<a class="headerlink" href="#sensitivity-to-the-bandwidth" title="Permalink to this heading">¶</a></h2>
<p>In this section, we observe the sensitivity of the kernel smoothing to the bandwidth.
We consider the three following bandwidths: the small bandwidth 0.05, the large bandwidth 0.54 and 0.18 which is in-between.
For each bandwidth, we use the second optional argument of the <cite>build</cite> method in order to select a specific bandwidth value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hArray</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">]</span>
<span class="n">nLen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hArray</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hArray</span><span class="p">))</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nLen</span><span class="p">):</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">[</span><span class="n">hArray</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">exact</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="n">exact</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Mixture&quot;</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;h=</span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hArray</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">bounding_box</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">()</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">bounding_box</span><span class="o">.</span><span class="n">getUpperBound</span><span class="p">()</span>
    <span class="n">upper_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Common y-range</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setBoundingBox</span><span class="p">(</span><span class="n">bounding_box</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_smoothing_mixture_003.png" srcset="../../_images/sphx_glr_plot_smoothing_mixture_003.png" alt=", h=0.0500, h=0.5400, h=0.1800" class = "sphx-glr-single-img"/><p>We see that when the bandwidth is too small, the resulting kernel smoothing has many more modes than the distribution it is supposed to approximate.
When the bandwidth is too large, the approximated distribution is too smooth and has only one mode instead of the expected two modes which are in the mixture distribution.
When the bandwidth is equal to 0.18, the two modes are correctly represented.</p>
</section>
<section id="sensitivity-to-the-bandwidth-rule">
<h2>Sensitivity to the bandwidth rule<a class="headerlink" href="#sensitivity-to-the-bandwidth-rule" title="Permalink to this heading">¶</a></h2>
<p>The library provides three different rules to compute the bandwidth. In this section, we compare the results that we can get with them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h1</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">computeSilvermanBandwidth</span><span class="p">(</span><span class="n">sample</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">h1</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.3445636453391276
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h2</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">computePluginBandwidth</span><span class="p">(</span><span class="n">sample</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">h2</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.2021709523195656
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h3</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">computeMixedBandwidth</span><span class="p">(</span><span class="n">sample</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">h3</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.20851397168332242
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span><span class="o">.</span><span class="n">getBandwidth</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.18
</pre></div>
</div>
<p>We see that the default rule is the “Mixed” rule. This is because the sample is in dimension 1 and the sample size is quite large.
For a small sample in 1 dimension, the “Plugin” rule would have been used.</p>
<p>The following script compares the results produced by the three rules.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">h3</span><span class="p">]</span>
<span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Silverman&quot;</span><span class="p">,</span> <span class="s2">&quot;Plugin&quot;</span><span class="p">,</span> <span class="s2">&quot;Mixed&quot;</span><span class="p">]</span>
<span class="n">nLen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hArray</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hArray</span><span class="p">))</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nLen</span><span class="p">):</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">[</span><span class="n">hArray</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">exact</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="n">exact</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Mixture&quot;</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;h=</span><span class="si">%.4f</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hArray</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">legends</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">setYTitle</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">bounding_box</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">()</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">bounding_box</span><span class="o">.</span><span class="n">getUpperBound</span><span class="p">()</span>
    <span class="n">upper_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Common y-range</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setBoundingBox</span><span class="p">(</span><span class="n">bounding_box</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)})</span>

<span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_smoothing_mixture_004.png" srcset="../../_images/sphx_glr_plot_smoothing_mixture_004.png" alt=", h=0.3446, Silverman, h=0.2022, Plugin, h=0.2085, Mixed" class = "sphx-glr-single-img"/><p>We see that the bandwidth produced by Silverman’s rule is too large, leading to an oversmoothed distribution.
The results produced by the Plugin and Mixed rules are comparable in this case.</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-data-analysis-distribution-fitting-plot-smoothing-mixture-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/2242e461c01f576f8cea78922bdc5863/plot_smoothing_mixture.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_smoothing_mixture.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9abdf96bf7d89bdfb64b04dd1dd9d2bf/plot_smoothing_mixture.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_smoothing_mixture.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_fit_extreme_value_distribution.html" title="Fit an extreme value distribution"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_gev_venice.html" title="Estimate a GEV on the Venice sea-levels data"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bandwidth sensitivity in kernel smoothing</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>