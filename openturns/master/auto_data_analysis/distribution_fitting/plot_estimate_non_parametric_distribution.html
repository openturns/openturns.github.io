
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Fit a non parametric distribution &#8212; OpenTURNS 1.20dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Statistical tests" href="../statistical_tests/index.html" />
    <link rel="prev" title="Estimate a multivariate distribution" href="plot_estimate_multivariate_distribution.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../statistical_tests/index.html" title="Statistical tests"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_multivariate_distribution.html" title="Estimate a multivariate distribution"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fit a non parametric distribution</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Fit a non parametric distribution</a><ul>
<li><a class="reference internal" href="#an-introductory-example">An introductory example</a></li>
<li><a class="reference internal" href="#choosing-a-kernel">Choosing a kernel</a></li>
<li><a class="reference internal" href="#bandwidth-selection">Bandwidth selection</a></li>
<li><a class="reference internal" href="#boundary-corrections">Boundary corrections</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_estimate_multivariate_distribution.html"
                          title="previous chapter">Estimate a multivariate distribution</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../statistical_tests/index.html"
                          title="next chapter">Statistical tests</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_data_analysis/distribution_fitting/plot_estimate_non_parametric_distribution.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-non-parametric-distribution-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="fit-a-non-parametric-distribution">
<span id="sphx-glr-auto-data-analysis-distribution-fitting-plot-estimate-non-parametric-distribution-py"></span><h1>Fit a non parametric distribution<a class="headerlink" href="#fit-a-non-parametric-distribution" title="Permalink to this heading">¶</a></h1>
<p>In this example we are going to estimate a non parametric distribution using the kernel smoothing method. After a short introductory example we focus on a few basic features of the API :</p>
<ul class="simple">
<li><p>kernel selection</p></li>
<li><p>bandwidth estimation</p></li>
<li><p>an advanced feature such as boundary corrections</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<section id="an-introductory-example">
<h2>An introductory example<a class="headerlink" href="#an-introductory-example" title="Permalink to this heading">¶</a></h2>
<p>We create the data from a Gamma distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
<p>We define the kernel smoother and build the smoothed estimate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">estimated</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We can draw the original distribution vs the kernel smoothing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Kernel smoothing vs original&quot;</span><span class="p">)</span>
<span class="n">kernel_plot</span> <span class="o">=</span> <span class="n">estimated</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel_plot</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;KS&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_001.png" srcset="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_001.png" alt="Kernel smoothing vs original" class = "sphx-glr-single-img"/><p>We can obtain the bandwdth parameter :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">getBandwidth</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.529581]
</pre></div>
</div>
<p>We now compute a better bandwitdh with the Silverman rule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bandwidth</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">computeSilvermanBandwidth</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bandwidth</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.639633]
</pre></div>
</div>
<p>The new bandwidth is used to regenerate another fitted distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimated</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Kernel smoothing vs original&quot;</span><span class="p">)</span>
<span class="n">kernel_plot</span> <span class="o">=</span> <span class="n">estimated</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel_plot</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Silverman&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_002.png" srcset="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_002.png" alt="Kernel smoothing vs original" class = "sphx-glr-single-img"/><p>The Silverman rule of thumb to estimate the bandwidth provides a better estimate for the distribution. We can also study the impact of the kernel selection.</p>
</section>
<section id="choosing-a-kernel">
<h2>Choosing a kernel<a class="headerlink" href="#choosing-a-kernel" title="Permalink to this heading">¶</a></h2>
<p>We experiment with several kernels to perform the smoothing :</p>
<ul class="simple">
<li><p>the standard normal kernel</p></li>
<li><p>the triangular kernel</p></li>
<li><p>the Epanechnikov kernel</p></li>
<li><p>the uniform kernel</p></li>
</ul>
<p>We first create the data from a Gamma distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
<p>The definition of the Normal kernel :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernelNormal</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">())</span>
<span class="n">estimatedNormal</span> <span class="o">=</span> <span class="n">kernelNormal</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>The definition of the Triangular kernel :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernelTriangular</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Triangular</span><span class="p">())</span>
<span class="n">estimatedTriangular</span> <span class="o">=</span> <span class="n">kernelTriangular</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>The definition of the Epanechnikov kernel :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernelEpanechnikov</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Epanechnikov</span><span class="p">())</span>
<span class="n">estimatedEpanechnikov</span> <span class="o">=</span> <span class="n">kernelEpanechnikov</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>The definition of the Uniform kernel :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernelUniform</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">())</span>
<span class="n">estimatedUniform</span> <span class="o">=</span> <span class="n">kernelUniform</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We finally compare all the distributions :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Different kernel smoothings vs original distribution&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setGrid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">kernel_estimatedNormal_plot</span> <span class="o">=</span> <span class="n">estimatedNormal</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel_estimatedNormal_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel_estimatedNormal_plot</span><span class="p">)</span>

<span class="n">kernel_estimatedTriangular_plot</span> <span class="o">=</span> <span class="n">estimatedTriangular</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel_estimatedTriangular_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel_estimatedTriangular_plot</span><span class="p">)</span>

<span class="n">kernel_estimatedEpanechnikov_plot</span> <span class="o">=</span> <span class="n">estimatedEpanechnikov</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel_estimatedEpanechnikov_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel_estimatedEpanechnikov_plot</span><span class="p">)</span>

<span class="n">kernel_estimatedUniform_plot</span> <span class="o">=</span> <span class="n">estimatedUniform</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel_estimatedUniform_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">kernel_estimatedUniform_plot</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel_estimatedUniform_plot</span><span class="p">)</span>

<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Normal&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Triangular&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Epanechnikov&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Uniform&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_003.png" srcset="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_003.png" alt="Different kernel smoothings vs original distribution" class = "sphx-glr-single-img"/><p>We observe that all the kernels produce very similar results in practice. The Uniform kernel may be seen as the worst of them all while the Epanechnikov one is said to be a good theoritical choice. In practice the standard normal kernel is a fine choice.
The most important aspect of kernel smoothing is the choice of the bandwidth.</p>
</section>
<section id="bandwidth-selection">
<h2>Bandwidth selection<a class="headerlink" href="#bandwidth-selection" title="Permalink to this heading">¶</a></h2>
<p>We reproduce a classical example of the literature : the fitting of a bimodal distribution.
We will show the result of a kernel smoothing with different bandwidth computation :</p>
<ul class="simple">
<li><p>the Silverman rule</p></li>
<li><p>the Plugin bandwidth</p></li>
<li><p>the Mixed bandwidth</p></li>
</ul>
<p>We define the bimodal distribution and generate a sample out of it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">myDist</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Mixture</span><span class="p">([</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">])</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">myDist</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
<p>We now compare the fitted distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">myDist</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Kernel smoothing vs original&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>With the Silverman rule :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernelSB</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">bandwidthSB</span> <span class="o">=</span> <span class="n">kernelSB</span><span class="o">.</span><span class="n">computeSilvermanBandwidth</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">estimatedSB</span> <span class="o">=</span> <span class="n">kernelSB</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bandwidthSB</span><span class="p">)</span>
<span class="n">kernelSB_plot</span> <span class="o">=</span> <span class="n">estimatedSB</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernelSB_plot</span><span class="p">)</span>
</pre></div>
</div>
<p>With the Plugin bandwidth :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernelPB</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">bandwidthPB</span> <span class="o">=</span> <span class="n">kernelPB</span><span class="o">.</span><span class="n">computePluginBandwidth</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">estimatedPB</span> <span class="o">=</span> <span class="n">kernelPB</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bandwidthPB</span><span class="p">)</span>
<span class="n">kernelPB_plot</span> <span class="o">=</span> <span class="n">estimatedPB</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernelPB_plot</span><span class="p">)</span>
</pre></div>
</div>
<p>With the Mixed bandwidth :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernelMB</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">bandwidthMB</span> <span class="o">=</span> <span class="n">kernelMB</span><span class="o">.</span><span class="n">computeMixedBandwidth</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">estimatedMB</span> <span class="o">=</span> <span class="n">kernelMB</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bandwidthMB</span><span class="p">)</span>
<span class="n">kernelMB_plot</span> <span class="o">=</span> <span class="n">estimatedMB</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernelMB_plot</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernelMB_plot</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Silverman&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Plugin&quot;</span><span class="p">,</span> <span class="s2">&quot;KS-Mixed&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_004.png" srcset="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_004.png" alt="Kernel smoothing vs original" class = "sphx-glr-single-img"/><p>As expected the Silverman seriously overfit the data and the other rules are more to the point.</p>
</section>
<section id="boundary-corrections">
<h2>Boundary corrections<a class="headerlink" href="#boundary-corrections" title="Permalink to this heading">¶</a></h2>
<p>We finish this example on an advanced feature of the kernel smoothing, the boundary corrections.</p>
<p>We consider a Weibull distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myDist</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">WeibullMin</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>We generate a sample from the defined distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">myDist</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
<p>We draw the exact Weibull distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">myDist</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
</pre></div>
</div>
<p>We use two different kernels :</p>
<ul class="simple">
<li><p>a standard normal kernel</p></li>
<li><p>the same kernel with a boundary correction</p></li>
</ul>
<p>The first kernel without the boundary corrections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">estimated1</span> <span class="o">=</span> <span class="n">kernel1</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>The second kernel with the boundary corrections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">kernel2</span><span class="o">.</span><span class="n">setBoundaryCorrection</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">estimated2</span> <span class="o">=</span> <span class="n">kernel2</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We compare the estimated PDFs :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Kernel smoothing vs original&quot;</span><span class="p">)</span>

<span class="n">kernel1_plot</span> <span class="o">=</span> <span class="n">estimated1</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel1_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel1_plot</span><span class="p">)</span>

<span class="n">kernel2_plot</span> <span class="o">=</span> <span class="n">estimated2</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel2_plot</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">kernel2_plot</span><span class="p">)</span>


<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;KS&quot;</span><span class="p">,</span> <span class="s2">&quot;KS with boundary correction&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_005.png" srcset="../../_images/sphx_glr_plot_estimate_non_parametric_distribution_005.png" alt="Kernel smoothing vs original" class = "sphx-glr-single-img"/><p>The boundary correction made has a remarkable impact on the quality of the estimate for the small values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.141 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-non-parametric-distribution-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/437c175b9578c47e60ba2c069be55866/plot_estimate_non_parametric_distribution.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_estimate_non_parametric_distribution.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/3661d2a740be879b048fc346a710eb73/plot_estimate_non_parametric_distribution.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_estimate_non_parametric_distribution.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../statistical_tests/index.html" title="Statistical tests"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_multivariate_distribution.html" title="Estimate a multivariate distribution"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fit a non parametric distribution</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>