
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Fitting a distribution with customized maximum likelihood &#8212; OpenTURNS 1.22dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Estimate a GEV on the Port Pirie sea-levels data" href="plot_estimate_gev_pirie.html" />
    <link rel="prev" title="Fit a non parametric distribution" href="plot_estimate_non_parametric_distribution.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_estimate_gev_pirie.html" title="Estimate a GEV on the Port Pirie sea-levels data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_non_parametric_distribution.html" title="Fit a non parametric distribution"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fitting a distribution with customized maximum likelihood</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Fitting a distribution with customized maximum likelihood</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#simulating-a-sample">Simulating a sample</a></li>
<li><a class="reference internal" href="#defining-the-estimation-problem">Defining the estimation problem</a></li>
<li><a class="reference internal" href="#setting-the-solver-and-bounds">Setting the solver and bounds</a></li>
<li><a class="reference internal" href="#using-resourcemap-to-set-the-solver">Using ResourceMap to set the solver</a></li>
<li><a class="reference internal" href="#fitting-a-lognormal-with-zero-location-parameter">Fitting a LogNormal with zero location parameter</a></li>
<li><a class="reference internal" href="#see-the-list-of-solvers-compatible-with-a-given-mle-problem">See the list of solvers compatible with a given MLE problem</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_estimate_non_parametric_distribution.html"
                          title="previous chapter">Fit a non parametric distribution</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_estimate_gev_pirie.html"
                          title="next chapter">Estimate a GEV on the Port Pirie sea-levels data</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_data_analysis/distribution_fitting/plot_advanced_mle_estimator.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-data-analysis-distribution-fitting-plot-advanced-mle-estimator-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="fitting-a-distribution-with-customized-maximum-likelihood">
<span id="sphx-glr-auto-data-analysis-distribution-fitting-plot-advanced-mle-estimator-py"></span><h1>Fitting a distribution with customized maximum likelihood<a class="headerlink" href="#fitting-a-distribution-with-customized-maximum-likelihood" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>When we perform distribution fitting using the <a class="reference internal" href="../../user_manual/_generated/openturns.MaximumLikelihoodFactory.html#openturns.MaximumLikelihoodFactory" title="openturns.MaximumLikelihoodFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodFactory</span></code></a>
class, the default optimization solver sometimes fails to
maximize the likelihood.
This might be because the optimization solver is not appropriate in
this particular case, or because the bounds of the problem
are not properly set.
In this example, we configure the optimization solver by two different
methods.</p>
<ul class="simple">
<li><p>The first method sets a specific solver among the NLopt solvers.
Moreover, we customize the distribution parameters bounds.
This helps the solver to avoid the part of the domain where
the distribution cannot be built.</p></li>
<li><p>The second method sets the <a class="reference internal" href="../../user_manual/_generated/openturns.ResourceMap.html#openturns.ResourceMap" title="openturns.ResourceMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceMap</span></code></a> key
that is used by the <a class="reference internal" href="../../user_manual/_generated/openturns.MaximumLikelihoodFactory.html#openturns.MaximumLikelihoodFactory" title="openturns.MaximumLikelihoodFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodFactory</span></code></a> in
order to select the default solver.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
</pre></div>
</div>
</section>
<section id="simulating-a-sample">
<h2>Simulating a sample<a class="headerlink" href="#simulating-a-sample" title="Permalink to this heading">¶</a></h2>
<p>In this example, we consider the <a class="reference internal" href="../../user_manual/_generated/openturns.TruncatedNormal.html#openturns.TruncatedNormal" title="openturns.TruncatedNormal"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruncatedNormal</span></code></a> distribution
with default parameters and generate a large sample from it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">TruncatedNormal</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribution=&quot;</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Distribution= TruncatedNormal(mu = 0, sigma = 1, a = -1, b = 1)
</pre></div>
</div>
<p>We can use the <code class="xref py py-class docutils literal notranslate"><span class="pre">TruncatedNormalFactory</span></code> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">TruncatedNormalFactory</span><span class="p">()</span>
<span class="n">fittedDistribution</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fitted distribution=&quot;</span><span class="p">,</span> <span class="n">fittedDistribution</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fitted distribution= TruncatedNormal(mu = -0.0087698, sigma = 0.984923, a = -0.999836, b = 1)
</pre></div>
</div>
<p>But this method sometimes fails for specific distributions, for example
when the sample size is very small or when the distribution has
specific properties (e.g. some parameter is known beforehand).
In these cases, general-purpose methods cannot be used, and the
methods presented below may be relevant.</p>
</section>
<section id="defining-the-estimation-problem">
<h2>Defining the estimation problem<a class="headerlink" href="#defining-the-estimation-problem" title="Permalink to this heading">¶</a></h2>
<p>The truncated normal distribution has 4 parameters:</p>
<ul class="simple">
<li><p>the mean and standard deviation parameters of the
underlying Normal distribution,</p></li>
<li><p>the minimum and maximum of the underlying truncated distribution.</p></li>
</ul>
<p>Estimating the parameters will be easier if two conditions are met:</p>
<ul class="simple">
<li><p>the starting point (i.e., the initial values of the parameters)
of the optimization is compatible with the sample,</p></li>
<li><p>the bounds are compatible with the distribution.</p></li>
</ul>
<p>First, we define the starting point of the optimization,
using statistics from the sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample_min</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getMin</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sample_max</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">getMax</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">computeMean</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sigma_hat</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">computeStandardDeviation</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">startingPoint</span> <span class="o">=</span> <span class="p">[</span><span class="n">sample_mean</span><span class="p">,</span> <span class="n">sigma_hat</span><span class="p">,</span> <span class="n">sample_min</span><span class="p">,</span> <span class="n">sample_max</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;startingPoint=&quot;</span><span class="p">,</span> <span class="n">startingPoint</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>startingPoint= [-0.002562574711278147, 0.5384068806033934, -0.9997360092906988, 0.9999009268469972]
</pre></div>
</div>
<p>Secondly, we set the bounds of the parameters.
We assume that the minimum and maximum cannot be lower than -1
or greater than 1.
The parameters have the following bounds:</p>
<ul class="simple">
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAATBAMAAAC+W0SxAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABRUlEQVQ4y2NgQAfcsgxEAF4pTDFGBqIAI110suFUlrvZuAGfTl4FHDp5jRLw24mhk1GBwQTEvIVhmHPlBQYm6R0oOlnM5zIwKO5uACnjD2D7BvKFAbpOlg1MNQm3GFgakHV6M6gf413A4AFSps7AMQEoxHQBXScfA0P4iQ0MDA+QdT5gYK3pBskBlS1k4N4AUnfY2BgaQkzGIHCBF2jcd6CAKljfRkGZg4JSDEDz9QuAEgFAnScYOEEamB6g2wnUyWB/AaYTaieQz/wXqvMrQ34KKFQNsOjkff0JzbVAnff2K4Bdy/SFYTnIdIZujBBqAIrJX+C9wCqG0OnBwLGB8S/DXaAyroMd2Zewx6fWxgsMHMdPMLDUInQyrQZmiJ4aUKzwNBBOQxxYUwJ/AOF0C9HJloCqTJ2IFN+ANa90ka2T3DJBGgBRmkUS4sTgdwAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\mu \in [-\infty, +\infty]" style="vertical-align: -5px"/> ;</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAAATBAMAAADi0QeVAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABKElEQVQoz2NgQAesjgw4AKMfphgLA07AglVopdwC4lXzbGDYDuWw4VSdGNFxASzEcYFhKsypC3CoZuxKgArxH2BYjEs1o/7/zyCmHFzofAHD+QQk1TzNigwMS0IvgFS7pneCXdgAV72+AKQBofoow+JtjA8YzgKlGBsYVoPEuQSQzV6PrHoCA7v1VQYGTqAU8wGGGyBxzh0dHVBf1h9guA92SYiL9xYXPwagOesNgOYVsDAUMzDEgc2eADebfwHDZWRfAlVzfISoBjrDDCyBcDeHAMMUNNWS8QsgLmFguQCWuApXzdUAjJ2SBLjqswy8ASwfGQRBETd3Dnp4M9y8t4DhsABcNddTYEK7bX0Be1xCwAW8cYkuBFbNlkCcal6iUywJqvHkHVcADbFKIylUpPEAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\sigma \in [0, +\infty]" style="vertical-align: -5px"/> ;</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAATBAMAAAD185dcAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAnXRIMt2Lz+mv+2AYvwxtY48AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAC8SURBVCjPY2BAB9cTGDABWyWmWAEDNsCOT+EOAwjN3YxfoaMdRCGL8GMUhceuhiqgmsgHNZEBRSFb9AF0q9EUMgqZgDiZmG5EUxjGUAFk8wQQUsgWwAAKI+4EQgq5EhhWA9mMraGhMM9sBTJDw9AV+jkwPwCZKEDIRDsGxoANQA5BN3IxnJgAcp8uFoUbGFhqQIzXIIXcl5SvHcAajifrOg2YlwEDZPqLyfhjBgSYiEkUJClUoIJC7Cm8FgAHyTTiZbrTKQAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="a \in [-1, 1]" style="vertical-align: -5px"/> ;</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAATBAMAAADMlCYHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs9Ii92d+2B0GK/z6b87bgVuAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAzElEQVQoz2NgQAOPHBgwAYs2A6O+AIqQAgM2wMTAYM+AQ12vAYTmuAxW54pDnZg9RB1j8mewOjWIMJdfaCSqefxQ8xgg6iogHNcudHtR1TH+nDYB5KMNDPjVsRQyVAHZSxkIqGPaALa5hZA69gYQzZAbGgrzRyuQGRqCrm49A+cHILuNkHkyDEwJQDYrIXU8DL0gNucDTHUNDIxaIMYPkDqOnQnYw2+1/m0D5hJgBGz6uxkUzgy44gNsDSIdMDDgSS/EqptAsTrs6VkPAHw8L3oqNHlwAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="b \in [-1, 1]" style="vertical-align: -5px"/>.</p></li>
</ul>
<p>But this may not give satisfactory results, because infinite parameters
are impossible and a zero standard deviation is infeasible.
Furthermore, we must have <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAOBAMAAABA5yhLAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnXRIMt2Lz+mv+2AYv/OLvb/5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAmUlEQVQY02NgQAfuXxiwAOYP2ETZAtAEWA4ACXYBNL21IFGuDSA2o5AJRJApECTI4K8kBCTDGCrAggeDIJJZDlwHQIZXgji+xVBzKkFmcCUwrAayuVfDTF/NwG/A4O8AcSBMLc8HBn0GBnsGxgCwrSeLIK57wFAIdAjDiQkJEOcHgqkH3A1AAy8pXzsA0cxdCWLsVMTmNxAAAEHOIDwyAz2aAAAACnRFWHREZXB0aAAAAAABUCTRmgAAAABJRU5ErkJggg==" alt="a &lt; b" style="vertical-align: -1px"/>.
We assume that we know that the mean parameter cannot be greater than 10
and lower than -10.
Similarly, the standard deviation cannot be greater than 10.
Hence, we use the following bounds:</p>
<ul class="simple">
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHEAAAATBAMAAABVbP+yAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABOklEQVQ4y2NgQAfcsgxEgIsLMMUYGYgCAvh0Mh0B4reLUGThYvh0sj75wsDgw8ATAOUnoIgh68zdbNyA6lqgKgsGvg1Q3iUUMSSdvEYJ6P78AkJMBeg6wWJAnYwKDCYgoVuYIfSFgeUrA8s3NJ0QMaBO/gA2kBybATadTF9BClF1QsSAOtUZOCaAAu0CDjuZvmLayQTWuZCBGxQGfIeNjaEhxGQMAhdAqli/MHCAXcstKHhGUHABQgyo8wQDJ0gD0wNsdjJ8YuDACCGwGFDnV4b8FFCoYvUngy0DnwC6TrCYAAPTF4blvCChbkydnxgYlIGxziqGpBMqBtTJdbAj+xLW+GRb+GcJA8eLRQwstXCdcDGgTp4G3GkIBjiQ7ESkeP4AwnkFojMNTac6EbmsAWsu6yJbJ7llwgYAmgJlX3/oz/oAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\mu \in [-10, +10]" style="vertical-align: -5px"/> ;</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAATBAMAAADmJNeoAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFUlEQVQoz2NgQAesjgzYAaMfphgLAy7AQozQ6gMMDCvlFhBSzAYiKs8fYODZwLAdRSYxouMCmmLGBSCS/wADxwWGqcgyjF0JGCbDFQPRYpAMo/7/zyAhOYQzON8tQFN8voDhfAJQxjW9E+y8BoTivRgmrwcqLmBhYGxgWA0S4RKAK2Z1wFAMNHk9UDHzAYYbIBHOHR0dUA/y+z0EKw1x8d7i4gdWXH+A4T7QGcUMDHFgkyfATc4vwPTgAobLQBmgG8zAEgg382Mq5hBgmAKUYWZguQCWuIpwM9D5JQlIihcwcDWAI4Vn7hyMcH54MeGwAFxxnv++Aww37y3AE4MXECYTTkhgxWwJRCnmJSWJEqkYd05xBQDt7Uz8cunlWQAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\sigma \in [\epsilon, +10]" style="vertical-align: -5px"/> ;</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAAATBAMAAACw3vibAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnXRIMt2Lz+mv+2AYv/OLvb/5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABGElEQVQ4y2NgQAfXExhIBWyVmGIFDKQDdnzG7DCghjGO9liNYZs5cxIeY45dDVVAdQ0/Ga5hiz6A7imSjGEUMgGxMjHDBs0YxpkbQBS3rnfuATRxoDFhDBVANk8AQWOaIJQRcxjfBjRxdga2AAZQrHMnEDKGFyohwPyHDV2cnYErgWE1yGWtoaGwIN4KZIaGQY3hBnFCgZbwV06DegJsHoo4O4O/A/MHkKgAIdecd4AyOBQY0MXZGewZGANAXiUYNvxQYzb4H2BEFwd6iuHEBFC46GIxBiUkeYGq3A8wsD3IO5CCLs7OwH1J+doBrOnmZH0ninOmqR2wSmBgmeQ9CTUGgeJ4UzEWoEBG1qSZMUwM9DaGnNKvFgDZckeeJLPZCQAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="a \in [-1 - \epsilon, \bar{x} - \epsilon]" style="vertical-align: -5px"/> ;</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAAATBAMAAABCTm97AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs9Ii92d+2B0GK/z6b87bgVuAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABPUlEQVQ4y2NgQAOPHBiIBk4bGBj1BVCEFBhIAEDF9gxEaue4jE27K7oIy+7dO8FMLhQJxuTPDOjCQO1qUEG/0Eg021kaUE3+jCEMVFwBYbl2YTieGO2MP6dNAIltgItwzJPwW4CsLnsHVu1AYaBPCxmqgOylCAMtmUN4GpDU8U7AajtIWIGBaQPY+S0I7QnMv1iQ1T3C7vhHYMXsDWDh3NBQeNCxgf3/SEn3kpI2kPFptwOSdhRhBYb1DJwfgJw2pMCEuRZiDddHrLaDhRUYZBiYEoAMVoT2BvkFbMiuxK6dAaKdh6EXxOF8ANPOcsBngSOyuifAJKMFYvxgQBMGRdPOBNR4Z9wpsdMAWR23pxdzCdC1m/5uRhNGSiT4Ux0nA1ZhBWy5AG7iAqzakYTxakcCE3BmWOpqJ6m0eQAAsWhXssvqR5cAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="b \in [\bar{x} + \epsilon, 1 + \epsilon]" style="vertical-align: -5px"/></p></li>
</ul>
<p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAALBAMAAAC0QAErAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAi690YL8yGEjd853P6RrzQzAAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA5SURBVAjXY2AQUlIyYEABzmGO4QwcBp0CSxi4GfoKBIBCe8ASl4GYhe05wwYGKcbljAkMSWZOFgwA+x4JqzZsgw8AAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\bar{x}" style="vertical-align: 0px"/> is the sample mean and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAIBAMAAADHKvg1AAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAna9g6XS/z4sYMlMluB4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAApSURBVAjXY2BgVDJgYHBlYGBgKwAS3EUaDAyzF4BYIIKtAUgwaERMAABV6gUwUkjxMQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\epsilon" style="vertical-align: 0px"/>
is a small parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.0e-3</span>
<span class="n">bounds_lower</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">sample_mean</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">]</span>
<span class="n">bounds_upper</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">sample_mean</span> <span class="o">-</span> <span class="n">epsilon</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bounds_lower=&quot;</span><span class="p">,</span> <span class="n">bounds_lower</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bounds_upper=&quot;</span><span class="p">,</span> <span class="n">bounds_upper</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>bounds_lower= [-10.0, 0.001, -1.001, -0.0015625747112781468]
bounds_upper= [10.0, 10.0, -0.003562574711278147, 1.001]
</pre></div>
</div>
<p>The boolean <cite>False</cite> means unbounded and <cite>True</cite> means bounded.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">finiteLowerBound</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">finiteUpperBound</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">interval</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">bounds_lower</span><span class="p">,</span> <span class="n">bounds_upper</span><span class="p">,</span> <span class="n">finiteLowerBound</span><span class="p">,</span> <span class="n">finiteUpperBound</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="setting-the-solver-and-bounds">
<h2>Setting the solver and bounds<a class="headerlink" href="#setting-the-solver-and-bounds" title="Permalink to this heading">¶</a></h2>
<p>The two methods that we suggest are based on the <a class="reference internal" href="../../user_manual/_generated/openturns.MaximumLikelihoodFactory.html#openturns.MaximumLikelihoodFactory" title="openturns.MaximumLikelihoodFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodFactory</span></code></a> class
which uses the maximum likelihood estimator to estimate
the parameters of the distribution depending on the sample.
The first method is to use the <a class="reference internal" href="../../user_manual/_generated/openturns.MaximumLikelihoodFactory.html#openturns.MaximumLikelihoodFactory.setOptimizationAlgorithm" title="openturns.MaximumLikelihoodFactory.setOptimizationAlgorithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setOptimizationAlgorithm()</span></code></a>
method.
This sets the optimization algorithm as a replacement for the
default optimization solver.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printTruncatedNormalParameters</span><span class="p">(</span><span class="n">truncatedNormalDistribution</span><span class="p">):</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">truncatedNormalDistribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">truncatedNormalDistribution</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span><span class="o">.</span><span class="n">getClassName</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  mu= </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mu</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  sigma= </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  a= </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  b= </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MaximumLikelihoodFactory</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
<span class="n">factory</span><span class="o">.</span><span class="n">setOptimizationBounds</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="n">distribution_MLE</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fitted distribution with default solver:&quot;</span><span class="p">)</span>
<span class="n">printTruncatedNormalParameters</span><span class="p">(</span><span class="n">distribution_MLE</span><span class="p">)</span>
<span class="n">default_solver</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">getOptimizationAlgorithm</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default solver=&quot;</span><span class="p">,</span> <span class="n">default_solver</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span><span class="o">.</span><span class="n">getClassName</span><span class="p">())</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NLopt</span><span class="p">(</span><span class="s2">&quot;LN_COBYLA&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New solver=&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">getClassName</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">getAlgorithmName</span><span class="p">())</span>
<span class="n">solver</span><span class="o">.</span><span class="n">setStartingPoint</span><span class="p">(</span><span class="n">startingPoint</span><span class="p">)</span>
<span class="n">factory</span><span class="o">.</span><span class="n">setOptimizationAlgorithm</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Updated solver=&quot;</span><span class="p">,</span>
    <span class="n">factory</span><span class="o">.</span><span class="n">getOptimizationAlgorithm</span><span class="p">()</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span><span class="o">.</span><span class="n">getClassName</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">distribution_MLE</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fitted distribution with new solver:&quot;</span><span class="p">)</span>
<span class="n">printTruncatedNormalParameters</span><span class="p">(</span><span class="n">distribution_MLE</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fitted distribution with default solver:
  TruncatedNormal
  mu= -0.000
  sigma= 1.0000
  a= -1.00
  b= 1.00
Default solver= TNC
New solver= NLopt LN_COBYLA
Updated solver= NLopt
Fitted distribution with new solver:
  TruncatedNormal
  mu= -0.016
  sigma= 0.5526
  a= -1.00
  b= 1.00
</pre></div>
</div>
</section>
<section id="using-resourcemap-to-set-the-solver">
<h2>Using ResourceMap to set the solver<a class="headerlink" href="#using-resourcemap-to-set-the-solver" title="Permalink to this heading">¶</a></h2>
<p>Another method is to use a special key of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceMap</span></code>,
which defines the default solver used by <a class="reference internal" href="../../user_manual/_generated/openturns.MaximumLikelihoodFactory.html#openturns.MaximumLikelihoodFactory" title="openturns.MaximumLikelihoodFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodFactory</span></code></a>.
In this case, we do not define the starting point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsString</span><span class="p">(</span>
    <span class="s2">&quot;MaximumLikelihoodFactory-DefaultOptimizationAlgorithm&quot;</span><span class="p">,</span> <span class="s2">&quot;LN_COBYLA&quot;</span>
<span class="p">)</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MaximumLikelihoodFactory</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
<span class="n">factory</span><span class="o">.</span><span class="n">setOptimizationBounds</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Default solver=&quot;</span><span class="p">,</span>
    <span class="n">factory</span><span class="o">.</span><span class="n">getOptimizationAlgorithm</span><span class="p">()</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span><span class="o">.</span><span class="n">getClassName</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">distribution_MLE</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fitted distribution:&quot;</span><span class="p">)</span>
<span class="n">printTruncatedNormalParameters</span><span class="p">(</span><span class="n">distribution_MLE</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Default solver= NLopt
Fitted distribution:
  TruncatedNormal
  mu= -0.009
  sigma= 1.0016
  a= -1.00
  b= 1.00
</pre></div>
</div>
</section>
<section id="fitting-a-lognormal-with-zero-location-parameter">
<h2>Fitting a LogNormal with zero location parameter<a class="headerlink" href="#fitting-a-lognormal-with-zero-location-parameter" title="Permalink to this heading">¶</a></h2>
<p>We now consider the <a class="reference internal" href="../../user_manual/_generated/openturns.LogNormal.html#openturns.LogNormal" title="openturns.LogNormal"><code class="xref py py-class docutils literal notranslate"><span class="pre">LogNormal</span></code></a> distribution
and present two different topics.</p>
<ul class="simple">
<li><p>We show how to estimate the parameters of a LogNormal distribution
which has a zero location parameter.</p></li>
<li><p>We compute the list of solvers which are compatible with a specific
MLE problem.</p></li>
</ul>
<p>We generate a large sample from the standard LogNormal distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">standardLogNormal</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">()</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">standardLogNormal</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>If we estimate the parameters using <a class="reference internal" href="../../user_manual/_generated/openturns.LogNormalFactory.html#openturns.LogNormalFactory" title="openturns.LogNormalFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">LogNormalFactory</span></code></a>,
the algorithm does not know that the true value of the location parameter
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> is zero.
Hence, the estimator may not necessarily lead to an estimated parameter
exactly equal to zero.
In this example, we assume that we know that this parameter is zero.
In this case, the simplest method is to use the
<a class="reference internal" href="../../user_manual/_generated/openturns.MaximumLikelihoodFactory.html#openturns.MaximumLikelihoodFactory.setKnownParameter" title="openturns.MaximumLikelihoodFactory.setKnownParameter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setKnownParameter()</span></code></a> method.
Furthermore, we know that the absolute value of the mean of the underlying normal
distribution cannot be greater than 5.
Finally, we know that the standard deviation of the underlying
normal distribution cannot be lower than, say, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAQBAMAAABQPLQnAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAna9g6XS/z4sYMkjd++6R63IAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACwSURBVCjPY2DAD9gZCAERQgq4Qgip4JiCRdBkAwODYZMBhBOJRcXCfRsYuB0YvBiElJQUGQKwmcG3gYEngEEMzGbskG3AqgKIbKG8LSB1SgboKvYtYNg3AeKXXKAZriAWWzkIKEBV2C0AKYIBtgJMW4DSdggVfEUaGCrWbWCImwAXmLcAi0sNGGKRBBZguoOngUEcoYIN3cNAA5gPAEMMATQiJiArmFTntIEhMAgRAgCa6SrvnCS0wwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\epsilon = 10^{-4}" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logNormalFactoryWithZeroLocation</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MaximumLikelihoodFactory</span><span class="p">(</span><span class="n">standardLogNormal</span><span class="p">)</span>
<span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">setKnownParameter</span><span class="p">([</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">lowerBound</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0e-4</span><span class="p">]</span>
<span class="n">upperBound</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]</span>
<span class="n">finiteLowerBound</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="n">finiteUpperBound</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">,</span> <span class="n">finiteLowerBound</span><span class="p">,</span> <span class="n">finiteUpperBound</span><span class="p">)</span>
<span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">setOptimizationBounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">fittedDistribution</span> <span class="o">=</span> <span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   fittedDistribution = &quot;</span><span class="p">,</span> <span class="n">fittedDistribution</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>fittedDistribution =  LogNormal(muLog = 0.00970194, sigmaLog = 1.00033, gamma = 0)
</pre></div>
</div>
</section>
<section id="see-the-list-of-solvers-compatible-with-a-given-mle-problem">
<h2>See the list of solvers compatible with a given MLE problem<a class="headerlink" href="#see-the-list-of-solvers-compatible-with-a-given-mle-problem" title="Permalink to this heading">¶</a></h2>
<p>In the next script, we perform a loop over the algorithms
from the <code class="xref py py-class docutils literal notranslate"><span class="pre">NLopt</span></code> class and select the algorithms
which can solve the problem.
This is done using <cite>try/except</cite> statements.
Moreover, some solvers pretend to solve the problem, but do
not make any change to the parameters.
In this case, we do not select them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">defaultParameter</span> <span class="o">=</span> <span class="n">standardLogNormal</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="n">defaultSolver</span> <span class="o">=</span> <span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">getOptimizationAlgorithm</span><span class="p">()</span>
<span class="n">startingPoint</span> <span class="o">=</span> <span class="n">defaultSolver</span><span class="o">.</span><span class="n">getStartingPoint</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default solver = &quot;</span><span class="p">,</span> <span class="n">defaultSolver</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span><span class="o">.</span><span class="n">getClassName</span><span class="p">())</span>
<span class="n">availableSolverList</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">differenceThreshold</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
<span class="k">for</span> <span class="n">algorithmName</span> <span class="ow">in</span> <span class="n">ot</span><span class="o">.</span><span class="n">NLopt</span><span class="o">.</span><span class="n">GetAlgorithmNames</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- &quot;</span><span class="p">,</span> <span class="n">algorithmName</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NLopt</span><span class="p">(</span><span class="n">algorithmName</span><span class="p">)</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">setStartingPoint</span><span class="p">(</span><span class="n">startingPoint</span><span class="p">)</span>
    <span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">setOptimizationAlgorithm</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fittedDistribution</span> <span class="o">=</span> <span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   fittedDistribution = &quot;</span><span class="p">,</span> <span class="n">fittedDistribution</span><span class="p">)</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="n">fittedDistribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
        <span class="n">differenceOfParameters</span> <span class="o">=</span> <span class="n">parameter</span> <span class="o">-</span> <span class="n">defaultParameter</span>
        <span class="k">if</span> <span class="n">differenceOfParameters</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">differenceThreshold</span><span class="p">:</span>
            <span class="c1"># Consider only solvers which make a difference after optimization</span>
            <span class="n">availableSolverList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">algorithmName</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Fail : Impossible to build with &quot;</span><span class="p">,</span> <span class="n">algorithmName</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Default solver =  NLopt
-  AUGLAG
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  AUGLAG_EQ
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  GD_MLSL
   Fail : Impossible to build with  GD_MLSL
-  GD_MLSL_LDS
   Fail : Impossible to build with  GD_MLSL_LDS
-  GD_STOGO
   Fail : Impossible to build with  GD_STOGO
-  GD_STOGO_RAND
   Fail : Impossible to build with  GD_STOGO_RAND
-  GN_AGS
   Fail : Impossible to build with  GN_AGS
-  GN_CRS2_LM
   Fail : Impossible to build with  GN_CRS2_LM
-  GN_DIRECT
   Fail : Impossible to build with  GN_DIRECT
-  GN_DIRECT_L
   Fail : Impossible to build with  GN_DIRECT_L
-  GN_DIRECT_L_NOSCAL
   Fail : Impossible to build with  GN_DIRECT_L_NOSCAL
-  GN_DIRECT_L_RAND
   Fail : Impossible to build with  GN_DIRECT_L_RAND
-  GN_DIRECT_L_RAND_NOSCAL
   Fail : Impossible to build with  GN_DIRECT_L_RAND_NOSCAL
-  GN_DIRECT_NOSCAL
   Fail : Impossible to build with  GN_DIRECT_NOSCAL
-  GN_ESCH
   Fail : Impossible to build with  GN_ESCH
-  GN_ISRES
   Fail : Impossible to build with  GN_ISRES
-  GN_MLSL
   Fail : Impossible to build with  GN_MLSL
-  GN_MLSL_LDS
   Fail : Impossible to build with  GN_MLSL_LDS
-  GN_ORIG_DIRECT
   Fail : Impossible to build with  GN_ORIG_DIRECT
-  GN_ORIG_DIRECT_L
   Fail : Impossible to build with  GN_ORIG_DIRECT_L
-  G_MLSL
   Fail : Impossible to build with  G_MLSL
-  G_MLSL_LDS
   Fail : Impossible to build with  G_MLSL_LDS
-  LD_AUGLAG
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  LD_AUGLAG_EQ
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  LD_CCSAQ
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  LD_LBFGS
   fittedDistribution =  LogNormal(muLog = 0.0158819, sigmaLog = 1.00312, gamma = 0)
-  LD_MMA
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  LD_SLSQP
   fittedDistribution =  LogNormal(muLog = 0.0174256, sigmaLog = 1.00132, gamma = 0)
-  LD_TNEWTON
   fittedDistribution =  LogNormal(muLog = 0.0158698, sigmaLog = 1.00311, gamma = 0)
-  LD_TNEWTON_PRECOND
   fittedDistribution =  LogNormal(muLog = 0.0158698, sigmaLog = 1.00311, gamma = 0)
-  LD_TNEWTON_PRECOND_RESTART
   fittedDistribution =  LogNormal(muLog = 0.0158698, sigmaLog = 1.00311, gamma = 0)
-  LD_TNEWTON_RESTART
   fittedDistribution =  LogNormal(muLog = 0.0158698, sigmaLog = 1.00311, gamma = 0)
-  LD_VAR1
   fittedDistribution =  LogNormal(muLog = 0.0160269, sigmaLog = 1.00314, gamma = 0)
-  LD_VAR2
   fittedDistribution =  LogNormal(muLog = 0.0160269, sigmaLog = 1.00314, gamma = 0)
-  LN_AUGLAG
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  LN_AUGLAG_EQ
   fittedDistribution =  LogNormal(muLog = 0, sigmaLog = 1, gamma = 0)
-  LN_BOBYQA
   fittedDistribution =  LogNormal(muLog = 0.0153223, sigmaLog = 1.00494, gamma = 0)
-  LN_COBYLA
   fittedDistribution =  LogNormal(muLog = 0.00970194, sigmaLog = 1.00033, gamma = 0)
-  LN_NELDERMEAD
   fittedDistribution =  LogNormal(muLog = 0.0128211, sigmaLog = 1.00282, gamma = 0)
-  LN_NEWUOA
   Fail : Impossible to build with  LN_NEWUOA
-  LN_PRAXIS
   fittedDistribution =  LogNormal(muLog = 0.0158698, sigmaLog = 1.00311, gamma = 0)
-  LN_SBPLX
   fittedDistribution =  LogNormal(muLog = 0.0143433, sigmaLog = 1.00252, gamma = 0)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available solvers = &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">availableSolverList</span><span class="p">))</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">availableSolverList</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Available solvers =  13
-  LD_LBFGS
-  LD_SLSQP
-  LD_TNEWTON
-  LD_TNEWTON_PRECOND
-  LD_TNEWTON_PRECOND_RESTART
-  LD_TNEWTON_RESTART
-  LD_VAR1
-  LD_VAR2
-  LN_BOBYQA
-  LN_COBYLA
-  LN_NELDERMEAD
-  LN_PRAXIS
-  LN_SBPLX
</pre></div>
</div>
<p>Pick one and try it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algorithmName</span> <span class="o">=</span> <span class="s2">&quot;LD_SLSQP&quot;</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NLopt</span><span class="p">(</span><span class="n">algorithmName</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   New solver = &quot;</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">getClassName</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">getAlgorithmName</span><span class="p">())</span>
<span class="n">solver</span><span class="o">.</span><span class="n">setStartingPoint</span><span class="p">(</span><span class="n">startingPoint</span><span class="p">)</span>
<span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">setOptimizationAlgorithm</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span>
<span class="n">fittedDistribution</span> <span class="o">=</span> <span class="n">logNormalFactoryWithZeroLocation</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   fittedDistribution = &quot;</span><span class="p">,</span> <span class="n">fittedDistribution</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>New solver =  NLopt LD_SLSQP
fittedDistribution =  LogNormal(muLog = 0.0174256, sigmaLog = 1.00132, gamma = 0)
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-data-analysis-distribution-fitting-plot-advanced-mle-estimator-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/389c781307c8a386ffdbbd14da41305c/plot_advanced_mle_estimator.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_advanced_mle_estimator.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9cab3b6caffd84fa09d4fa6453953f46/plot_advanced_mle_estimator.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_advanced_mle_estimator.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_estimate_gev_pirie.html" title="Estimate a GEV on the Port Pirie sea-levels data"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_non_parametric_distribution.html" title="Fit a non parametric distribution"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.22dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fitting a distribution with customized maximum likelihood</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>