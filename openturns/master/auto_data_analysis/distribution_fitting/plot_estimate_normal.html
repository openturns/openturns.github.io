
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fit a parametric distribution &#8212; OpenTURNS 1.17dev documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Get the asymptotic distribution of the estimators" href="plot_asymptotic_estimators_distribution.html" />
    <link rel="prev" title="Fit a distribution by maximum likelihood" href="plot_maximumlikelihood_estimator.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_asymptotic_estimators_distribution.html" title="Get the asymptotic distribution of the estimators"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_maximumlikelihood_estimator.html" title="Fit a distribution by maximum likelihood"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.17dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" accesskey="U">Data analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fit a parametric distribution</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fit a parametric distribution</a><ul>
<li><a class="reference internal" href="#the-normal-distribution">The Normal distribution</a></li>
<li><a class="reference internal" href="#the-student-distribution">The Student distribution</a></li>
<li><a class="reference internal" href="#the-pareto-distribution">The Pareto distribution</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_maximumlikelihood_estimator.html"
                        title="previous chapter">Fit a distribution by maximum likelihood</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_asymptotic_estimators_distribution.html"
                        title="next chapter">Get the asymptotic distribution of the estimators</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_data_analysis/distribution_fitting/plot_estimate_normal.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-normal-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="fit-a-parametric-distribution">
<span id="sphx-glr-auto-data-analysis-distribution-fitting-plot-estimate-normal-py"></span><h1>Fit a parametric distribution<a class="headerlink" href="#fit-a-parametric-distribution" title="Permalink to this headline">¶</a></h1>
<p>In this example we estimate the parameters of a distribution from a given sample.
Once we are settled on a good candidate, we use the corresponding factory to fit
the distribution. Each distribution factory has one or several estimators available.
They are all derived from either the Maximum Likelihood method or from the method of moments (see <a class="reference internal" href="../../theory/data_analysis/parametric_estimation.html#parametric-estimation"><span class="std std-ref">Parametric Estimation</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="the-normal-distribution">
<h2>The Normal distribution<a class="headerlink" href="#the-normal-distribution" title="Permalink to this headline">¶</a></h2>
<p>The parameters are estimated by the method of moments.</p>
<p>We consider a sample, here created from a standard normal distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">()</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>We can estimate a normal distribution with <cite>ǸormalFactory</cite> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NormalFactory</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We take a look at the estimated parameters with the <cite>getParameter</cite> method :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.00320214,1.02733]
</pre></div>
</div>
<p>We draw the fitted distribution</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Fitted Normal distribution&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Fitted Normal distribution" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_estimate_normal_001.png" />
</div>
<div class="section" id="the-student-distribution">
<h2>The Student distribution<a class="headerlink" href="#the-student-distribution" title="Permalink to this headline">¶</a></h2>
<p>The parameters of the Student law are estimated by a mixed method of moments and reduces MLE.</p>
<p>We generate a sample from a Student distribution with parameters <img class="math" src="../../_images/math/22822a2e80bf59ba77c75b284db7e7eba9d39f18.svg" alt="\nu=5.0"/>, <img class="math" src="../../_images/math/b90238362dc9e1300ac589a128f54a2da063e88f.svg" alt="\mu = -0.5"/> and a scale parameter <img class="math" src="../../_images/math/4f8720ee71fe49d9c31384215f03d7b96d2fdff2.svg" alt="\sigma=2.0"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Student</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>We use the factory to build an estimated distribution :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">StudentFactory</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We can obtain the estimated parameters with the <cite>getParameter</cite> method :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[3.65576,-0.515215,1.84614]
</pre></div>
</div>
<p>Draw fitted distribution</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Fitted Student distribution&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Fitted Student distribution" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_estimate_normal_002.png" />
</div>
<div class="section" id="the-pareto-distribution">
<h2>The Pareto distribution<a class="headerlink" href="#the-pareto-distribution" title="Permalink to this headline">¶</a></h2>
<p>By default the parameters of the Pareto distribution are estimated by least squares.</p>
<p>We use a sample from a Pareto distribution with a scale parameter <img class="math" src="../../_images/math/4e47f684d311528c028bb71a3733cddf8cd3968b.svg" alt="\beta=1.0"/>, a shape parameter <img class="math" src="../../_images/math/45cb49584adb2d2c4415f96a2ea0adadff3cdadc.svg" alt="\alpha &gt; 1.0"/> and a location parameter <img class="math" src="../../_images/math/c3cc84c9f72398a7c2431103963e9cefd4e500cd.svg" alt="\gamma = 0.0"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Pareto</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Draw fitted distribution</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParetoFactory</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">())</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Fitted Pareto distribution&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Fitted Pareto distribution" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_estimate_normal_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.787856,0.944192,0.246677]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.380 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-normal-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/056fe9ca1a0d95c4fc446b7592cbc12b/plot_estimate_normal.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_estimate_normal.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c9e6d419e450ee7bf23b58ae2dd1d9bc/plot_estimate_normal.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_estimate_normal.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_asymptotic_estimators_distribution.html" title="Get the asymptotic distribution of the estimators"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_maximumlikelihood_estimator.html" title="Fit a distribution by maximum likelihood"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.17dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fit a parametric distribution</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2018 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2018.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.0+.
    </div>
  </body>
</html>