
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calibration of the Chaboche mechanical model &#8212; OpenTURNS 1.16dev documentation</title>
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bayesian calibration of a computer code" href="../bayesian_calibration/plot_bayesian_calibration.html" />
    <link rel="prev" title="Calibration of the flooding model" href="plot_calibration_flooding.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../bayesian_calibration/plot_bayesian_calibration.html" title="Bayesian calibration of a computer code"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_flooding.html" title="Calibration of the flooding model"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.16dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" accesskey="U">Calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the Chaboche mechanical model</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Calibration of the Chaboche mechanical model</a><ul>
<li><a class="reference internal" href="#deterministic-model">Deterministic model</a></li>
<li><a class="reference internal" href="#parameters-to-calibrate">Parameters to calibrate</a></li>
<li><a class="reference internal" href="#observations">Observations</a></li>
<li><a class="reference internal" href="#thanks-to">Thanks to</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#generate-the-observations">Generate the observations</a></li>
<li><a class="reference internal" href="#set-the-calibration-parameters">Set the calibration parameters</a></li>
<li><a class="reference internal" href="#calibration-with-linear-least-squares">Calibration with linear least squares</a></li>
<li><a class="reference internal" href="#analysis-of-the-results">Analysis of the results</a></li>
<li><a class="reference internal" href="#calibration-with-nonlinear-least-squares">Calibration with nonlinear least squares</a></li>
<li><a class="reference internal" href="#id1">Analysis of the results</a></li>
<li><a class="reference internal" href="#gaussian-calibration-parameters">Gaussian calibration parameters</a></li>
<li><a class="reference internal" href="#gaussian-linear-calibration">Gaussian linear calibration</a></li>
<li><a class="reference internal" href="#id2">Analysis of the results</a></li>
<li><a class="reference internal" href="#gaussian-nonlinear-calibration">Gaussian nonlinear calibration</a></li>
<li><a class="reference internal" href="#id3">Analysis of the results</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_calibration_flooding.html"
                        title="previous chapter">Calibration of the flooding model</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../bayesian_calibration/plot_bayesian_calibration.html"
                        title="next chapter">Bayesian calibration of a computer code</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_py_calibration/least_squares_and_gaussian_calibration/plot_calibration_chaboche.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-py-calibration-least-squares-and-gaussian-calibration-plot-calibration-chaboche-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="calibration-of-the-chaboche-mechanical-model">
<span id="sphx-glr-auto-py-calibration-least-squares-and-gaussian-calibration-plot-calibration-chaboche-py"></span><h1>Calibration of the Chaboche mechanical model<a class="headerlink" href="#calibration-of-the-chaboche-mechanical-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="deterministic-model">
<h2>Deterministic model<a class="headerlink" href="#deterministic-model" title="Permalink to this headline">¶</a></h2>
<p>The Chaboche mecanical law predicts the stress depending on the strain:</p>
<div class="math">
<p><img src="../../_images/math/bd7fdc83214b04f9104c6ea7d5a876350a62096c.svg" alt="\sigma = G(\epsilon,R,C,\gamma) = R + \frac{C}{\gamma} (1-\exp(-\gamma\epsilon))"/></p>
</div><p>where:</p>
<ul class="simple">
<li><p><img class="math" src="../../_images/math/0d105e8ee3d8ee933b1f68424693c02a02189d3a.svg" alt="\epsilon"/> is the strain,</p></li>
<li><p><img class="math" src="../../_images/math/c407acdc527ca1937ae333fa8475cb95384c8087.svg" alt="\sigma"/> is the stress (Pa),</p></li>
<li><p><img class="math" src="../../_images/math/ddc35335d91f00501b1be972e341ffcba6893269.svg" alt="R"/>, <img class="math" src="../../_images/math/3b3be2405d41848960032b917a9b3d6e64e3ea81.svg" alt="C"/>, <img class="math" src="../../_images/math/92b1fba2de1ce37c8da793f184e1f3a622ac3afa.svg" alt="\gamma"/> are the parameters.</p></li>
</ul>
<p>The variables have the following distributions and are supposed to be independent.</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Random var.</p></th>
<th class="head"><p>Distribution</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><img class="math" src="../../_images/math/ddc35335d91f00501b1be972e341ffcba6893269.svg" alt="R"/></p></td>
<td><p>Lognormal (<img class="math" src="../../_images/math/c6473d21430daadc5aa560648baab71fc5aea34d.svg" alt="\mu = 750"/> MPa, <img class="math" src="../../_images/math/1869f089fa288608049db3155e3ba0096c8d4cda.svg" alt="\sigma = 11"/> MPa)</p></td>
</tr>
<tr class="row-odd"><td><p><img class="math" src="../../_images/math/3b3be2405d41848960032b917a9b3d6e64e3ea81.svg" alt="C"/></p></td>
<td><p>Normal (<img class="math" src="../../_images/math/422cce3ab83c6d6ba5d743c6aac2f297e17ba2a7.svg" alt="\mu = 2750"/> MPa, <img class="math" src="../../_images/math/e303fd1c1f213d3a07a8c49277d148cb0d5b2180.svg" alt="\sigma = 250"/> MPa)</p></td>
</tr>
<tr class="row-even"><td><p><img class="math" src="../../_images/math/92b1fba2de1ce37c8da793f184e1f3a622ac3afa.svg" alt="\gamma"/></p></td>
<td><p>Normal (<img class="math" src="../../_images/math/f86827601ea87fd03e3262e99493d8c90742c12e.svg" alt="\mu = 10"/>, <img class="math" src="../../_images/math/3942e2944f4378a66b55c2d49c2c34a087b090e2.svg" alt="\sigma = 2"/>)</p></td>
</tr>
<tr class="row-odd"><td><p><img class="math" src="../../_images/math/0d105e8ee3d8ee933b1f68424693c02a02189d3a.svg" alt="\epsilon"/></p></td>
<td><p>Uniform(a=0, b=0.07).</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="parameters-to-calibrate">
<h2>Parameters to calibrate<a class="headerlink" href="#parameters-to-calibrate" title="Permalink to this headline">¶</a></h2>
<p>The vector of parameters to calibrate is:</p>
<div class="math">
<p><img src="../../_images/math/8d115fd798ae574aab5b14d41fdf34d196e001a3.svg" alt="\theta = (R,C,\gamma)."/></p>
</div><p>We set:</p>
<ul class="simple">
<li><p><img class="math" src="../../_images/math/e913f3951b14fd1db7c9a0d19ba3346cc85f7934.svg" alt="R = 750\times 10^6"/>,</p></li>
<li><p><img class="math" src="../../_images/math/69b1ae5d366276e60ac6f8e664639882bab211e0.svg" alt="C = 2750\times 10^6"/>,</p></li>
<li><p><img class="math" src="../../_images/math/b92c5ba9194d807f880a872331ec50c85d79e574.svg" alt="\gamma = 10"/>.</p></li>
</ul>
</div>
<div class="section" id="observations">
<h2>Observations<a class="headerlink" href="#observations" title="Permalink to this headline">¶</a></h2>
<p>In order to create a calibration problem, we make the hypothesis that the strain has the following distribution:</p>
<div class="math">
<p><img src="../../_images/math/1ec616c0942470f99bd452523b2227b7fff5fff8.svg" alt="\epsilon \sim Uniform(0,0.07)."/></p>
</div><p>Moreover, we consider a gaussian noise on the observed constraint:</p>
<div class="math">
<p><img src="../../_images/math/a629df8c2575e4fd0405fa6a4cf05d4ebf1241c1.svg" alt="\epsilon_\sigma \sim \mathcal{N} \left(0,10\times 10^6\right)"/></p>
</div><p>and we make the hypothesis that the observation errors are independent.
We set the number of observations to:</p>
<div class="math">
<p><img src="../../_images/math/298af68dada19e561b2b0514a66eea21824936e6.svg" alt="n = 100."/></p>
</div><p>We generate a Monte-Carlo sampling with size <img class="math" src="../../_images/math/80b394abd4fb264a3879675f92f191c3e346c3a0.svg" alt="n"/>:</p>
<div class="math">
<p><img src="../../_images/math/c8a71bc5b72ba0b3c0178f6815ba31991c6e89af.svg" alt="\sigma_i = G(\epsilon_i,R,C,\gamma) + (\epsilon_\sigma)_i,"/></p>
</div><p>for <img class="math" src="../../_images/math/bc47943f393ac295e9660a3a3ec9191cef7a1704.svg" alt="i = 1,..., n"/>.
The observations are the pairs <img class="math" src="../../_images/math/d4b243df3fa42f032026f015480b6381573f482e.svg" alt="\{(\epsilon_i,\sigma_i)\}_{i=1,...,n}"/>, i.e. each observation is a couple made of the strain and the corresponding stress.</p>
</div>
<div class="section" id="thanks-to">
<h2>Thanks to<a class="headerlink" href="#thanks-to" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Antoine Dumas, Phimeca</p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><ol class="upperalpha simple" start="10">
<li><p>Lemaitre and J. L. Chaboche (2002) “Mechanics of solid materials” Cambridge University Press.</p></li>
</ol>
</li>
</ul>
</div>
<div class="section" id="generate-the-observations">
<h2>Generate the observations<a class="headerlink" href="#generate-the-observations" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">modelChaboche</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">strain</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">stress</span> <span class="o">=</span> <span class="n">R</span> <span class="o">+</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">strain</span><span class="p">))</span> <span class="o">/</span> <span class="n">gamma</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">stress</span><span class="p">]</span>
</pre></div>
</div>
<p>Create the Python function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">modelChaboche</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the random vector.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Strain</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span>
<span class="n">unknownR</span> <span class="o">=</span> <span class="mf">750e6</span>
<span class="n">unknownC</span> <span class="o">=</span> <span class="mf">2750e6</span>
<span class="n">unknownGamma</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Dirac</span><span class="p">(</span><span class="n">unknownR</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Dirac</span><span class="p">(</span><span class="n">unknownC</span><span class="p">)</span>
<span class="n">Gamma</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Dirac</span><span class="p">(</span><span class="n">unknownGamma</span><span class="p">)</span>

<span class="n">Strain</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Strain&quot;</span><span class="p">])</span>
<span class="n">R</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;R&quot;</span><span class="p">])</span>
<span class="n">C</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="n">Gamma</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Gamma&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Create the joint input distribution function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputDistribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">([</span><span class="n">Strain</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">])</span>
</pre></div>
</div>
<p>Create the Monte-Carlo sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inputSample</span> <span class="o">=</span> <span class="n">inputDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">outputStress</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
<span class="n">outputStress</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<TABLE><TR><TD></TD><TH>y0</TH></TR>
<TR><TH>0</TH><TD>8.488914e+08</TD></TR>
<TR><TH>1</TH><TD>8.783113e+08</TD></TR>
<TR><TH>2</TH><TD>8.754496e+08</TD></TR>
<TR><TH>3</TH><TD>8.872187e+08</TD></TR>
<TR><TH>4</TH><TD>8.595783e+08</TD></TR>
</TABLE>
<br />
<br /><p>Plot the histogram of the output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">histoGraph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HistogramFactory</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">outputStress</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">histoGraph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Histogram of the sample stress&quot;</span><span class="p">)</span>
<span class="n">histoGraph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;Stress (MPa)&quot;</span><span class="p">)</span>
<span class="n">histoGraph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">histoGraph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Histogram of the sample stress" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_001.png" />
<p>Generate observation noise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stressObservationNoiseSigma</span> <span class="o">=</span> <span class="mf">10.0e6</span>  <span class="c1"># (Pa)</span>
<span class="n">noiseSigma</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stressObservationNoiseSigma</span><span class="p">)</span>
<span class="n">sampleNoiseH</span> <span class="o">=</span> <span class="n">noiseSigma</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">observedStress</span> <span class="o">=</span> <span class="n">outputStress</span> <span class="o">+</span> <span class="n">sampleNoiseH</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observedStrain</span> <span class="o">=</span> <span class="n">inputSample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Observations&quot;</span><span class="p">,</span> <span class="s2">&quot;Strain&quot;</span><span class="p">,</span> <span class="s2">&quot;Stress (MPa)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span> <span class="o">/</span> <span class="mf">1.0e6</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Observations" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_002.png" />
</div>
<div class="section" id="set-the-calibration-parameters">
<h2>Set the calibration parameters<a class="headerlink" href="#set-the-calibration-parameters" title="Permalink to this headline">¶</a></h2>
<p>Define the value of the reference values of the <img class="math" src="../../_images/math/7e3e48300089e25fc3edb19ddc60fb5e8bbfea3d.svg" alt="\theta"/> parameter. In the bayesian framework, this is called the mean of the <em>prior</em> gaussian distribution. In the data assimilation framework, this is called the <em>background</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="mf">700e6</span>  <span class="c1"># Exact : 750e6</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">2500e6</span>  <span class="c1"># Exact : 2750e6</span>
<span class="n">Gamma</span> <span class="o">=</span> <span class="mf">8.0</span>  <span class="c1"># Exact : 10</span>
<span class="n">thetaPrior</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">])</span>
</pre></div>
</div>
<p>The following statement create the calibrated function from the model. The calibrated parameters <cite>R</cite>, <cite>C</cite>, <cite>Gamma</cite> are at indices 1, 2, 3 in the inputs arguments of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibratedIndices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">mycf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">calibratedIndices</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calibration-with-linear-least-squares">
<h2>Calibration with linear least squares<a class="headerlink" href="#calibration-with-linear-least-squares" title="Permalink to this headline">¶</a></h2>
<p>The <cite>LinearLeastSquaresCalibration</cite> class performs the linear least squares calibration by linearizing the model in the neighbourhood of the reference point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearLeastSquaresCalibration</span><span class="p">(</span>
    <span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">,</span> <span class="s2">&quot;SVD&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <cite>run</cite> method computes the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="analysis-of-the-results">
<h2>Analysis of the results<a class="headerlink" href="#analysis-of-the-results" title="Permalink to this headline">¶</a></h2>
<p>The <cite>getParameterMAP</cite> method returns the maximum of the posterior distribution of <img class="math" src="../../_images/math/7e3e48300089e25fc3edb19ddc60fb5e8bbfea3d.svg" alt="\theta"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="n">thetaMAP</span>
</pre></div>
</div>
<p>[7.48178e+08,2.80672e+09,10.4592]</p>
<br />
<br /><p>We can compute a 95% confidence interval of the parameter <img class="math" src="../../_images/math/b57c014f32c1e20b3d05757fc29e0d77fec3cb67.svg" alt="\theta^\star"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>[7.40369e+08, 7.55986e+08]<br>
[2.27903e+09, 3.33441e+09]<br>
[-517.284, 538.203]</p>
<br />
<br /><p>We can see that the <cite>Gamma</cite> parameter has a large confidence interval : even the sign of the parameter is unknown.
The parameter which is calibrated with the smallest confidence
interval is <cite>R</cite>, which confidence interval is [708.3,780.0] (MPa).
This is why this parameter seems the most important in this case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_003.png" />
<p>We see that there is a good fit after calibration, since the predictions after calibration (i.e. the green crosses) are close to the observations (i.e. the blue crosses).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_004.png" />
<p>We see that there is a much better fit after calibration, since the predictions are close to the diagonal of the graphics.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="n">observationError</span>
</pre></div>
</div>
<p>Normal(mu = 0, sigma = 1.1025e+07)</p>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_005.png" />
<p>The analysis of the residuals shows that the distribution is centered on zero and symmetric. This indicates that the calibration performed well.</p>
<p>Moreover, the distribution of the residuals is close to being gaussian.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_006.png" />
</div>
<div class="section" id="calibration-with-nonlinear-least-squares">
<h2>Calibration with nonlinear least squares<a class="headerlink" href="#calibration-with-nonlinear-least-squares" title="Permalink to this headline">¶</a></h2>
<p>The <cite>NonLinearLeastSquaresCalibration</cite> class performs the non linear least squares calibration by minimizing the squared euclidian norm between the predictions and the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NonLinearLeastSquaresCalibration</span><span class="p">(</span><span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>run</cite> method computes the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>Analysis of the results<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The <cite>getParameterMAP</cite> method returns the maximum of the posterior distribution of <img class="math" src="../../_images/math/7e3e48300089e25fc3edb19ddc60fb5e8bbfea3d.svg" alt="\theta"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="n">thetaMAP</span>
</pre></div>
</div>
<p>[7.47522e+08,2.88854e+09,11.1915]</p>
<br />
<br /><p>We can compute a 95% confidence interval of the parameter <img class="math" src="../../_images/math/b57c014f32c1e20b3d05757fc29e0d77fec3cb67.svg" alt="\theta^\star"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>[7.38602e+08, 7.58579e+08]<br>
[2.16219e+09, 3.62933e+09]<br>
[3.5572, 18.8279]</p>
<br />
<br /><p>We can see that all three parameters are estimated with a large confidence interval.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_007.png" />
<p>We see that there is a good fit after calibration, since the predictions after calibration (i.e. the green crosses) are close to the observations (i.e. the blue crosses).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_008.png" />
<p>We see that there is a much better fit after calibration, since the predictions are close to the diagonal of the graphics.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="n">observationError</span>
</pre></div>
</div>
<p>Normal(mu = 2160.56, sigma = 1.09017e+07)</p>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">observationError</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_009.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_010.png" />
<p>The analysis of the residuals shows that the distribution is centered on zero and symmetric. This indicates that the calibration performed well.</p>
<p>Moreover, the distribution of the residuals is close to being gaussian. This indicates that the observation error might be gaussian.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_011.png" />
</div>
<div class="section" id="gaussian-calibration-parameters">
<h2>Gaussian calibration parameters<a class="headerlink" href="#gaussian-calibration-parameters" title="Permalink to this headline">¶</a></h2>
<p>The standard deviation of the observations errors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaStress</span> <span class="o">=</span> <span class="mf">1.0e7</span>  <span class="c1"># (Pa)</span>
</pre></div>
</div>
<p>Define the covariance matrix of the output Y of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">errorCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">errorCovariance</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaStress</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Define the covariance matrix of the parameters <img class="math" src="../../_images/math/7e3e48300089e25fc3edb19ddc60fb5e8bbfea3d.svg" alt="\theta"/> to calibrate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaR</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">R</span>
<span class="n">sigmaC</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">C</span>
<span class="n">sigmaGamma</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Gamma</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaR</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sigma</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaC</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sigma</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaGamma</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sigma</span>
</pre></div>
</div>
<p>[[ 4.9e+15  0        0        ]<br>
 [ 0        6.25e+16 0        ]<br>
 [ 0        0        0.64     ]]</p>
<br />
<br /></div>
<div class="section" id="gaussian-linear-calibration">
<h2>Gaussian linear calibration<a class="headerlink" href="#gaussian-linear-calibration" title="Permalink to this headline">¶</a></h2>
<p>The <cite>GaussianLinearCalibration</cite> class performs the gaussian linear calibration by linearizing the model in the neighbourhood of the prior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianLinearCalibration</span><span class="p">(</span><span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">errorCovariance</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>run</cite> method computes the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>Analysis of the results<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>The <cite>getParameterMAP</cite> method returns the maximum of the posterior distribution of <img class="math" src="../../_images/math/7e3e48300089e25fc3edb19ddc60fb5e8bbfea3d.svg" alt="\theta"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="n">thetaMAP</span>
</pre></div>
</div>
<p>[7.5035e+08,2.60977e+09,8.17958]</p>
<br />
<br /><p>We can compute a 95% confidence interval of the parameter <img class="math" src="../../_images/math/b57c014f32c1e20b3d05757fc29e0d77fec3cb67.svg" alt="\theta^\star"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>[7.45134e+08, 7.55566e+08]<br>
[2.41407e+09, 2.80548e+09]<br>
[6.48461, 9.87455]</p>
<br />
<br /><p>We can see that all three parameters are estimated with a large confidence interval.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_012.png" />
<p>We see that there is a good fit after calibration, since the predictions after calibration (i.e. the green crosses) are close to the observations (i.e. the blue crosses).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_013.png" />
<p>We see that there is a much better fit after calibration, since the predictions are close to the diagonal of the graphics.</p>
<p>The observation error is predicted by linearizing the problem at the prior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="n">observationError</span>
</pre></div>
</div>
<p>Normal(mu = 0, sigma = 1e+07)</p>
<br />
<br /><p>This can be compared to the residuals distribution, which is computed at the posterior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_014.png" />
<p>The analysis of the gaussian distribution (the blue line) of the observation errors is close to the posterior distribution of the residuals (the green line). Moreover, the posterior distribution is centered. These informations indicate that the calibration performed well.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_015.png" />
<p>For the <img class="math" src="../../_images/math/ddc35335d91f00501b1be972e341ffcba6893269.svg" alt="R"/> variable, the observations are much more important than the prior: this is shown by the fact that the posterior and prior distribution of the <img class="math" src="../../_images/math/ddc35335d91f00501b1be972e341ffcba6893269.svg" alt="R"/> variable are very different.</p>
<p>We see that the prior and posterior distribution are close to each other for the <img class="math" src="../../_images/math/92b1fba2de1ce37c8da793f184e1f3a622ac3afa.svg" alt="\gamma"/> variable: the observations did not convey much information for this variable.</p>
</div>
<div class="section" id="gaussian-nonlinear-calibration">
<h2>Gaussian nonlinear calibration<a class="headerlink" href="#gaussian-nonlinear-calibration" title="Permalink to this headline">¶</a></h2>
<p>The <cite>GaussianNonLinearCalibration</cite> class performs the gaussian nonlinear calibration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GaussianNonLinearCalibration</span><span class="p">(</span><span class="n">mycf</span><span class="p">,</span> <span class="n">observedStrain</span><span class="p">,</span> <span class="n">observedStress</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">errorCovariance</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>run</cite> method computes the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>Analysis of the results<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>The <cite>getParameterMAP</cite> method returns the maximum of the posterior distribution of <img class="math" src="../../_images/math/7e3e48300089e25fc3edb19ddc60fb5e8bbfea3d.svg" alt="\theta"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="n">thetaMAP</span>
</pre></div>
</div>
<p>[7.50466e+08,2.61003e+09,8.19629]</p>
<br />
<br /><p>We can compute a 95% confidence interval of the parameter <img class="math" src="../../_images/math/b57c014f32c1e20b3d05757fc29e0d77fec3cb67.svg" alt="\theta^\star"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>[7.44651e+08, 7.54581e+08]<br>
[2.47164e+09, 2.85086e+09]<br>
[6.9034, 10.3133]</p>
<br />
<br /><p>We can see that all three parameters are estimated with a large confidence interval.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_016.png" />
<p>We see that there is a good fit after calibration, since the predictions after calibration (i.e. the green crosses) are close to the observations (i.e. the blue crosses).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_017.png" />
<p>We see that there is a much better fit after calibration, since the predictions are close to the diagonal of the graphics.</p>
<p>The observation error is predicted by bootstraping the problem at the posterior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observationError</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getObservationsError</span><span class="p">()</span>
<span class="n">observationError</span>
</pre></div>
</div>
<p>Normal(mu = -7013.81, sigma = 1e+07)</p>
<br />
<br /><p>This can be compared to the residuals distribution, which is computed at the posterior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_018.png" />
<p>The analysis is very similar to the linear calibration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot calibration chaboche" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_calibration_chaboche_019.png" />
<p>We see that the prior and posterior distribution for the <img class="math" src="../../_images/math/92b1fba2de1ce37c8da793f184e1f3a622ac3afa.svg" alt="\gamma"/> parameter are close to each other, but not superimposed: the observations significantly brought information to the variable <img class="math" src="../../_images/math/92b1fba2de1ce37c8da793f184e1f3a622ac3afa.svg" alt="\gamma"/> during the calibration.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  7.236 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-py-calibration-least-squares-and-gaussian-calibration-plot-calibration-chaboche-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/bedeade69e054b36276bc63e674adcb1/plot_calibration_chaboche.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_calibration_chaboche.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ef5d5d70fc84f9ce573a1592b975230b/plot_calibration_chaboche.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_calibration_chaboche.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../bayesian_calibration/plot_bayesian_calibration.html" title="Bayesian calibration of a computer code"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_flooding.html" title="Calibration of the flooding model"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.16dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the Chaboche mechanical model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2018 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2018.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.3.0+.
    </div>
  </body>
</html>