
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Sensivity analysis by Fourier decomposition &#8212; OpenTURNS  documentation</title>
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Importance factors from FORM method" href="importance_form.html" />
    <link rel="prev" title="Sensivity analysis with correlated inputs" href="sensitivity_ancova.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="importance_form.html" title="Importance factors from FORM method"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sensitivity_ancova.html" title="Sensivity analysis with correlated inputs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" accesskey="U">Reliability, sensitivity</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="sensitivity_ancova.html"
                        title="previous chapter">Sensivity analysis with correlated inputs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="importance_form.html"
                        title="next chapter">Importance factors from FORM method</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/reliability_sensitivity/sensitivity_fast.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sensivity-analysis-by-fourier-decomposition">
<span id="sensitivity-fast"></span><h1>Sensivity analysis by Fourier decomposition<a class="headerlink" href="#sensivity-analysis-by-fourier-decomposition" title="Permalink to this headline">Â¶</a></h1>
<p>FAST is a sensitivity analysis method which is based upon the ANOVA
decomposition of the variance of the model response
<img class="math" src="../../_images/math/7c08ec82684e51b0d06c83441376a93523094ff0.svg" alt="y = f(\vect{X})"/>, the latter being represented by its Fourier
expansion. <img class="math" src="../../_images/math/97cda7cb3949c10c5c203865877dd5e1e21bf527.svg" alt="\vect{X}=\{X^1,\dots,X^{n_X}\}"/> is an input random
vector of <img class="math" src="../../_images/math/18f433fcab0734815e8be7f6303812f711e98b29.svg" alt="n_X"/> independent components.</p>
<div class="line-block">
<div class="line">The extended FAST method consists in computing
alternately the first order and the total-effect indices of each
input. This approach relies upon a Fourier decomposition of the model
response. Its key idea is to recast this representation as a function
of a <img class="math" src="../../_images/math/ddc8104ebd78d352bbd2dfe3cde6ea35019e114f.svg" alt="\mathit{scalar}"/> parameter <img class="math" src="../../_images/math/9bce6d499b26997265ba4f99471962bb537f3676.svg" alt="s"/>, by defining
parametric curves <img class="math" src="../../_images/math/1e116b26497609c134b6d434910c1cf78599064c.svg" alt="s \mapsto x_i(s)"/>, <img class="math" src="../../_images/math/93e6034d0838250062cc97209e010acd24f56f52.svg" alt="i=1, \dots, n_X"/>
exploring the support of the input random vector <img class="math" src="../../_images/math/f42d6d904ce64df0fa70524fe51b71ddfdcd2254.svg" alt="\vect{X}"/>.</div>
<div class="line">For each input, the same procedure is realized in three steps:</div>
</div>
<ul>
<li><p>Sampling:</p>
<p>Deterministic space-filling paths with random starting points are
defined, i.e. each input <img class="math" src="../../_images/math/9ca2297a9208cc5df7c70101c052869f6e010295.svg" alt="X^i"/> is transformed as follows:</p>
<div class="math">
<p><img src="../../_images/math/81cefdc4b3d2a1b2066381d22b80dfeb6d674972.svg" alt="x^i_j = \frac{1}{2} + \frac{1}{\pi} \arcsin(\sin(\omega_i s_j + \phi_i)),
    \quad i=1, \dots, n_X, \, j=1, \dots, N"/></p>
</div><p>where <img class="math" src="../../_images/math/18f433fcab0734815e8be7f6303812f711e98b29.svg" alt="n_X"/> is the number of input variables. <img class="math" src="../../_images/math/e5fa696008624bbb4544f764ae5cd7c73d4c7450.svg" alt="N"/> is the
length of the discretization of the s-space, with <img class="math" src="../../_images/math/9bce6d499b26997265ba4f99471962bb537f3676.svg" alt="s"/> varying
in <img class="math" src="../../_images/math/00a0f3f89f0e66d84727f049441042c496383d8d.svg" alt="(-\pi, \pi)"/> by step of <img class="math" src="../../_images/math/caea0ea263b2d2b0aa04ff05856961a3e99d6df2.svg" alt="2\pi/N"/>. <img class="math" src="../../_images/math/d6daf94bb4e40b162d5e03f65f89cfb88bea232c.svg" alt="\phi_i"/> is a
random phase-shift chosen uniformly in <img class="math" src="../../_images/math/84b9339095a150c53fd938213efbb670f7786f1f.svg" alt="[0, 2\pi]"/> which
enables to make the curves start anywhere within the unit hypercube
<img class="math" src="../../_images/math/d6d3b726f547bbbdc3a86f72e45e422b58ec5118.svg" alt="K^{n_X}=(\vect{X}|0\leq x_i\leq1; i=1, \dots, n_X)"/>. The
selection of the set <img class="math" src="../../_images/math/c39343ed8da6d30cac672c7b39fa0b8240de980f.svg" alt="\{\phi_1, \dots, \phi_{n_X}\}"/> induces a
part of randomness in the procedure. So it can be asked to realize
the procedure <img class="math" src="../../_images/math/23ec88516e8e0cc1f00ece2c8e47ed8221fc2a40.svg" alt="Nr"/> times and then to calculate the arithmetic
means of the results over the <img class="math" src="../../_images/math/23ec88516e8e0cc1f00ece2c8e47ed8221fc2a40.svg" alt="Nr"/> estimates. This operation is
called <img class="math" src="../../_images/math/4a32547ac0587d3033d7d6ec11b07445430b3c1f.svg" alt="\mathit{resampling}"/>.</p>
<p><img class="math" src="../../_images/math/d0d0cf1929d2bc84d43556c4b9b97a4acf3537bf.svg" alt="\{\omega_i\}, \forall i=1, \dots, n_X"/> is a set of integer
frequencies assigned to each input <img class="math" src="../../_images/math/9ca2297a9208cc5df7c70101c052869f6e010295.svg" alt="X^i"/>. The frequency
associated with the input of interest is set to the maximum
admissible frequency satisfying the Nyquist criterion (which ensures
to avoid aliasing effects):</p>
<div class="math">
<p><img src="../../_images/math/39d420855f285954dae82f8292d304122a6ab52d.svg" alt="\omega_i = \frac{N - 1}{2M}"/></p>
</div><p>with <img class="math" src="../../_images/math/7f1057286184ff78da020559a1fa880141be89ad.svg" alt="M"/> the interference factor usually equal to 4 or higher.
It corresponds to the truncation level of the Fourier series, i.e.
the number of harmonics that are retained in the decomposition
realized in the third step of the procedure.</p>
<p>In the paper <a class="reference internal" href="../../bibliography.html#saltelli1999" id="id1"><span>[saltelli1999]</span></a>, for high sample size, it is
suggested that <img class="math" src="../../_images/math/79d363e49c2ecc98f9ea8692282f79b81f91bb2f.svg" alt="16 \leq \omega_i/N_r \leq 64"/>.</p>
<p>And the maximum frequency of the complementary set of frequencies is:</p>
<div class="math">
<p><img src="../../_images/math/2c9606e5df6930877671061a0f84276cb8c0952b.svg" alt="\max(\omega_{-i}) = \frac{\omega_i}{2M} = \frac{N - 1}{4M^2}"/></p>
</div><p>with the index â<img class="math" src="../../_images/math/f2455155847e7c3edf92056c139b8c62d8c57656.svg" alt="-i"/>â which meaning âall but <img class="math" src="../../_images/math/c47ea0eab9f0f521327c38ece8a0d25e433bbbb2.svg" alt="i"/>â.</p>
<p>The other frequencies are distributed uniformly between <img class="math" src="../../_images/math/3e2835c3a9472e68f379970dd9f6b88e518e8133.svg" alt="1"/> and
<img class="math" src="../../_images/math/3fc4c74c5e957be3cf9af8dee9fdc6c55c78420c.svg" alt="\max(\omega_{-i})"/>. The set of frequencies is the same
whatever the number of resamplings is.</p>
<p>Let us make an example with eight input factors, <img class="math" src="../../_images/math/638ff5d534f4575a026761e62f4b6e6151d540df.svg" alt="N=513"/> and
<img class="math" src="../../_images/math/684b555e2bc48364825b6aa8266b0bdd8756124a.svg" alt="M=4"/> i.e. <img class="math" src="../../_images/math/486f183aadf604493b7a7b44444430c4f5b6db85.svg" alt="\omega_i = \frac{N - 1}{2M} = 64"/> and
<img class="math" src="../../_images/math/55cce12334433d7a32e754aed1cb72e21a626b2c.svg" alt="\max(\omega_{-i}) = \frac{N - 1}{4M^2} = 8"/> with <img class="math" src="../../_images/math/c47ea0eab9f0f521327c38ece8a0d25e433bbbb2.svg" alt="i"/> the
index of the input of interest.</p>
<div class="line-block">
<div class="line">When computing the sensitivity indices for the first input, the
considered set of frequencies is :
<img class="math" src="../../_images/math/a546f54becffa35e4db628536513e462d440de97.svg" alt="\{64, 1, 2, 3, 4, 5, 6, 8\}"/>.</div>
<div class="line">When computing the sensitivity indices for the second input, the
considered set of frequencies is :
<img class="math" src="../../_images/math/de628c149bc928be0667c99e9673c058c9b2e1e9.svg" alt="\{1, 64, 2, 3, 4, 5, 6, 8\}"/>.</div>
<div class="line">etc.</div>
</div>
<p>The transformation defined above provides a uniformly distributed
sample for the <img class="math" src="../../_images/math/2ea1b55c1702ad41d6cdca1bd6ee60ffd728a59d.svg" alt="x_i, \forall i=1, \dots, n_X"/> oscillating
between <img class="math" src="../../_images/math/ad264466d9ed045b7883bbe56d2a319e370622eb.svg" alt="0"/> and <img class="math" src="../../_images/math/3e2835c3a9472e68f379970dd9f6b88e518e8133.svg" alt="1"/>. In order to take into account the
real distributions of the inputs, we apply an isoprobabilistic
transformation on each <img class="math" src="../../_images/math/fe6ce244182b587194181405a017ad06880a0941.svg" alt="x_i"/> before the next step of the
procedure.</p>
</li>
<li><p>Simulations:</p>
<p>Output is computed such as:
<img class="math" src="../../_images/math/961b3f505be4d2dcf3fd8059c562213e4782133f.svg" alt="y = f(s) = f(x_1(s), \dots, x_{n_X}(s))"/></p>
<p>Then <img class="math" src="../../_images/math/6b74e1f80e15f3d4fbdb684f20e3eef07e8cd222.svg" alt="f(s)"/> is expanded onto a Fourier series:</p>
<div class="math">
<p><img src="../../_images/math/c0b73fc4f0b31a0a702607cd1510a1860303818b.svg" alt="f(s) = \sum_{k \in \Zset^N} A_k \cos(ks) + B_k \sin(ks)"/></p>
</div><p>where <img class="math" src="../../_images/math/ee2899e92998d494791a530baf6cceb012547a04.svg" alt="A_k"/> and <img class="math" src="../../_images/math/e82612125068410b44430ea4f91acf5187aa826c.svg" alt="B_k"/> are Fourier coefficients defined as
follows:</p>
<div class="math">
<p><img src="../../_images/math/21f413884018c6c08330a14f0f9238cce7fb7fa4.svg" alt="\begin{aligned}
    A_k &amp;=&amp; \frac{1}{2\pi}\int_{-\pi}^{\pi}f(s) \cos(ks) \, ds \\
    B_k &amp;=&amp; \frac{1}{2\pi}\int_{-\pi}^{\pi}f(s) \sin(ks) \, ds
  \end{aligned}"/></p>
</div><p>These coefficients are estimated thanks to the following discrete
formulations:</p>
<div class="math">
<p><img src="../../_images/math/ef78a7c4ef4e13e1a0565ee87e654a33af756ae4.svg" alt="\begin{aligned}
    \hat{A}_k &amp;=&amp; \frac{1}{N} \sum_{j=1}^N f(x_j^1,\dots,x_j^{N_X}) cos \left( \frac{2k\pi (j-1)}{N} \right) \quad , \quad -\frac{N}{2} \leq k \leq \frac{N}{2}\\
    \hat{B}_k &amp;=&amp; \frac{1}{N} \sum_{j=1}^N f(x_j^1,\dots,x_j^{N_X}) sin \left( \frac{2k\pi (j-1)}{N} \right) \quad , \quad -\frac{N}{2} \leq k \leq \frac{N}{2}
  \end{aligned}"/></p>
</div></li>
<li><p>Estimations by frequency analysis:</p>
<p>The first order indices are estimated as follows:</p>
<div class="math">
<p><img src="../../_images/math/d41178cdbf3bac7e3c59513fea30af17f2b09e3c.svg" alt="\hat{S}_i = \frac{\hat{D}_i}{\hat{D}} \\
              = \frac{\sum_{p=1}^M(\hat{A}_{p\omega_i}^2 + \hat{B}_{p\omega_i}^2)^2}
                     {\sum_{n=1}^{(N-1)/2}(\hat{A}_n^2 + \hat{B}_n^2)^2}"/></p>
</div><p>where <img class="math" src="../../_images/math/29cd93af2d06141c6ee5ff4a7828b4860b721f4d.svg" alt="\hat{D}"/> is the total variance and <img class="math" src="../../_images/math/38488b46c3cb1494982d29f528ff6f829b6f5c8d.svg" alt="\hat{D}_i"/> the
portion of <img class="math" src="../../_images/math/1e8e807b80609400c2d9ec82ad7b8f996570aa9f.svg" alt="D"/> arising from the uncertainty of the
<img class="math" src="../../_images/math/8e3f44f37eaed85ce78c3c44e0107507f245190f.svg" alt="i^{th}"/> input. <img class="math" src="../../_images/math/e5fa696008624bbb4544f764ae5cd7c73d4c7450.svg" alt="N"/> the size of the sample using to
compute the Fourier series and <img class="math" src="../../_images/math/7f1057286184ff78da020559a1fa880141be89ad.svg" alt="M"/> is the interference factor.
Saltelli et al. (1999) recommanded to set <img class="math" src="../../_images/math/7f1057286184ff78da020559a1fa880141be89ad.svg" alt="M"/> to a value in the
range <img class="math" src="../../_images/math/67d85982b6f44bd33d9052262de3dba8fda8ab98.svg" alt="[4, 6]"/>.</p>
<p>The total order indices are estimated as follows:</p>
<div class="math">
<p><img src="../../_images/math/cd1cde199a68798db18e7c0e7aeed6af2aa6e64b.svg" alt="\hat{T}_i = 1 - \frac{\hat{D}_{-i}}{\hat{D}} \\
              = 1 - \frac{\sum_{k=1}^{\omega_i/2}(\hat{A}_k^2 + \hat{B}_k^2)^2}
                         {\sum_{n=1}^{(N-1)/2}(\hat{A}_n^2 + \hat{B}_n^2)^2}"/></p>
</div><p>where <img class="math" src="../../_images/math/1971cfb7870440a2413ccf97e2c8aa198899fa3b.svg" alt="\hat{D}_{-i}"/> is the part of the variance due to all the
inputs except the <img class="math" src="../../_images/math/8e3f44f37eaed85ce78c3c44e0107507f245190f.svg" alt="i^{th}"/> input.</p>
</li>
</ul>
<div class="topic">
<p class="topic-title first">API:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.FAST.html#openturns.FAST" title="openturns.FAST"><code class="xref py py-class docutils literal notranslate"><span class="pre">FAST</span></code></a></p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../examples/reliability_sensitivity/sensitivity_fast.html"><span class="doc">FAST sensitivity indices</span></a></p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../bibliography.html#saltelli1999" id="id2"><span>[saltelli1999]</span></a></p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="importance_form.html" title="Importance factors from FORM method"
             >next</a> |</li>
        <li class="right" >
          <a href="sensitivity_ancova.html" title="Sensivity analysis with correlated inputs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" >Reliability, sensitivity</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2018 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>