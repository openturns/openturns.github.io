
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>ARMA stochastic process &#8212; OpenTURNS 1.20dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ARMA process estimation" href="arma_estimation.html" />
    <link rel="prev" title="Box Cox transformation" href="boxcox_transformation.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="arma_estimation.html" title="ARMA process estimation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="boxcox_transformation.html" title="Box Cox transformation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="probabilistic_modeling.html" accesskey="U">Probabilistic modeling</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ARMA stochastic process</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="boxcox_transformation.html"
                          title="previous chapter">Box Cox transformation</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="arma_estimation.html"
                          title="next chapter">ARMA process estimation</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/probabilistic_modeling/arma_process.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="arma-stochastic-process">
<span id="arma-process"></span><h1>ARMA stochastic process<a class="headerlink" href="#arma-stochastic-process" title="Permalink to this heading">¶</a></h1>
<div class="line-block">
<div class="line">Consider a stationary multivariate stochastic process
<img class="math" src="../../_images/math/6abe1ef1af098a65f51af1bd91841ca8c44bda50.svg" alt="X: \Omega \times[0,T] \rightarrow \Rset^d"/> of dimension
<img class="math" src="../../_images/math/5da6e6d65e4ae3032c58fe8c94955247fc4ebe22.svg" alt="d"/>, where <img class="math" src="../../_images/math/c5274fa0cbe5adbc35d6f78d3095db84c85686ea.svg" alt="X_t : \Omega \rightarrow \Rset^d"/> is the
random variable at time <img class="math" src="../../_images/math/3f28684e3688ea9352c095d52ef651d78b793c72.svg" alt="t"/>. Under some general
conditions,<img class="math" src="../../_images/math/ea775056706c0642a79ca7b47cbc53cd1a63fc8d.svg" alt="X"/> can be modeled by an <img class="math" src="../../_images/math/226d13d2920a173e8b55e79daf7e3d3f7e793d31.svg" alt="ARMA(p,q)"/> model
defined at the time stamp <img class="math" src="../../_images/math/3f28684e3688ea9352c095d52ef651d78b793c72.svg" alt="t"/> by:</div>
</div>
<blockquote>
<div><div class="math" id="equation-dimn">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-dimn" title="Permalink to this equation">¶</a></span><img src="../../_images/math/306a0d55f903d4d9625db3e51f4263275d3cf40c.svg" alt="X_t + \mat{A}_{\, 1}   \, X_{t-1} + \hdots +  \mat{A}_{\, p} \,   X_{t-p} =
  \varepsilon_{t}+  \mat{B}_ {\, 1} \,  \varepsilon_{t-1}+   \hdots + \mat{B}_{\, q}  \, \varepsilon_{t-q}"/></p>
</div></div></blockquote>
<p>where the coefficients of the recurrence are matrix in
<img class="math" src="../../_images/math/32098f0b1034bfe23b7a339e263bc6917e098990.svg" alt="\Rset^d"/> and <img class="math" src="../../_images/math/a3715916a460403d2ed31f1993717a2288eeba54.svg" alt="(\varepsilon_t)_t"/>is white noise
discretized on the same time grid as the process <img class="math" src="../../_images/math/ea775056706c0642a79ca7b47cbc53cd1a63fc8d.svg" alt="X"/>.</p>
<p>The coefficients <img class="math" src="../../_images/math/57efcf9001a3714bc007c91969c519c1acb1ec89.svg" alt="(\mat{A}_{\, 1} , \hdots, \mat{A}_{\, p} )"/>
form the Auto Regressive (AR) part of the model, while the
coefficients <img class="math" src="../../_images/math/5c544b86498062cce341548d32fb397948151004.svg" alt="(\mat{B}_{\, 1} \, \hdots, \mat{B}_{\, q}  )"/> the
Moving Average (MA) part.</p>
<p>We introduce the homogeneous system associated to <a class="reference internal" href="#equation-dimn">(1)</a>:</p>
<blockquote>
<div><div class="math" id="equation-dimnhom">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-dimnhom" title="Permalink to this equation">¶</a></span><img src="../../_images/math/d7f9ce24376d0acf284570f99e3041aa245e6dbc.svg" alt="X_t + \mat{A}_{\, 1}   \,  X_{t-1} + \hdots +  \mat{A}_{\, p} \,  X_{t-p} = 0"/></p>
</div></div></blockquote>
<p>To get stationary solutions of <a class="reference internal" href="#equation-dimn">(1)</a>, it is necessary to get its
characteristic polynomial defined in <a class="reference internal" href="#equation-polphi">(3)</a>:</p>
<div class="math" id="equation-polphi">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-polphi" title="Permalink to this equation">¶</a></span><img src="../../_images/math/8f1ac515c4c27c9b20df1c4f1a9d61ed75a53621.svg" alt="\Phi(\vect{r}) = \vect{r}^p + \sum_{i=1}^p a_i\vect{r}^{p-i}"/></p>
</div><p>Thus the solutions of <a class="reference internal" href="#equation-dimnhom">(2)</a> are of the form
<img class="math" src="../../_images/math/92b4801a83db2e1688f54da4e12d080d0cd81841.svg" alt="P(t)\vect{r}_i^t"/> where the <img class="math" src="../../_images/math/82e35c991d34e9481765d064418fb8578325d2f1.svg" alt="\vect{r}_i"/> are the roots of
the polynomials <img class="math" src="../../_images/math/fbf769bb94be2126fff295f1d7f8dd0110bb6396.svg" alt="\Phi(\vect{r})"/> defined in <a class="reference internal" href="#equation-polphi">(3)</a> and
<img class="math" src="../../_images/math/451a3d9a99f2dcc2293b7b30519b42cf46cb38ac.svg" alt="P"/> is a polynomials of degree the order of the root
<img class="math" src="../../_images/math/82e35c991d34e9481765d064418fb8578325d2f1.svg" alt="\vect{r}_i"/>:</p>
<p>The processes <img class="math" src="../../_images/math/92b4801a83db2e1688f54da4e12d080d0cd81841.svg" alt="P(t)\vect{r}_i^t"/> decrease with time if and only if
the modulus of all the components of the roots <img class="math" src="../../_images/math/82e35c991d34e9481765d064418fb8578325d2f1.svg" alt="\vect{r}_i"/> are
less than 1:</p>
<div class="math" id="equation-modul">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-modul" title="Permalink to this equation">¶</a></span><img src="../../_images/math/77b957ee039cb455b0ca0b03f2e95b4de413dd35.svg" alt="\forall i,j \in [1,d], \,  |r_{ij}| &lt;1"/></p>
</div><p>Once given the coefficients of the model <img class="math" src="../../_images/math/226d13d2920a173e8b55e79daf7e3d3f7e793d31.svg" alt="ARMA(p,q)"/>, we
evaluate the roots of the polynomials <img class="math" src="../../_images/math/fbf769bb94be2126fff295f1d7f8dd0110bb6396.svg" alt="\Phi(\vect{r})"/> and checks
the previous condition <a class="reference internal" href="#equation-modul">(4)</a>. The roots <img class="math" src="../../_images/math/82e35c991d34e9481765d064418fb8578325d2f1.svg" alt="\vect{r}_i"/>, are the
eigenvalues of the matrix <img class="math" src="../../_images/math/4dda32935b8f0301973f05f9b75b48c0d5a58be6.svg" alt="\mat{M}"/> which writes in dimension
<img class="math" src="../../_images/math/5da6e6d65e4ae3032c58fe8c94955247fc4ebe22.svg" alt="d"/> as:</p>
<div class="math" id="equation-matrixmdimn">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-matrixmdimn" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b21fafdb67bc0ce41d44931cd2666ccd32b0dec4.svg" alt="\mat{M} = \left(
  \begin{array}{cccccc}
    \mat{0}_{\, d} &amp; \mat{1}_{\, d} &amp; \mat{0}_{\, d} &amp; \hdots &amp; \mat{0}_{\, d} &amp; \mat{0}_{\, d} \\
    \mat{0}_{\, d} &amp; \mat{0}_{\, d} &amp; \mat{1}_{\, d} &amp; \hdots &amp; \mat{0}_{\, d} &amp; \mat{0}_{\, d}\\
    \hdots \\
    \mat{0}_{\, d} &amp; \mat{0}_{\, d} &amp; \mat{0}_{\, d} &amp; \hdots &amp; \mat{0}_{\, d} &amp; \mat{1}_{\, d}\\
    - \mat{A}_{\, 1} &amp; -\mat{A}_{\, 2} &amp; - \mat{A}_{\, 3}&amp; \hdots  &amp; -\mat{A}_{\, p-1}&amp; -\mat{A}_{\, p}
  \end{array}
  \right)"/></p>
</div><p>and in dimension 1:</p>
<div class="math" id="equation-matrixmdim1">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-matrixmdim1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/51de404e3a5432a703e5430f74ee7e6a8bb6e2b0.svg" alt="\mat{M} = \left(
  \begin{array}{cccccc}
    0 &amp; 1 &amp; 0 &amp; \hdots &amp; 0 &amp; 0\\
    0 &amp; 0 &amp; 1 &amp; \hdots &amp; 0 &amp; 0\\
    \hdots \\
    0 &amp; 0 &amp; 0 &amp; \hdots &amp; 0 &amp; 1\\
    -\alpha_1 &amp; -\alpha_2 &amp; -\alpha_3 &amp; \hdots  &amp; -\alpha_{p-1} &amp; -\alpha_p
  \end{array}
  \right)"/></p>
</div><p>The matrix <img class="math" src="../../_images/math/4dda32935b8f0301973f05f9b75b48c0d5a58be6.svg" alt="\mat{M}"/> is known to be the companion matrix.</p>
<p>It is important to note that:</p>
<ul class="simple">
<li><p>when asking for a <em>realization</em> of the stationary process modeled by
<img class="math" src="../../_images/math/226d13d2920a173e8b55e79daf7e3d3f7e793d31.svg" alt="ARMA(p,q)"/>, one has to obtain a realization that does not
depend on the current state of the process;</p></li>
<li><p>whereas, when one asks for a <em>possible future</em> extending a particular
current state of the process, the realization of the model must depend
on that current sate.</p></li>
</ul>
<p>How to proceed to respect these constraints?</p>
<p>If we note <img class="math" src="../../_images/math/16f1f09cf048445b283b333b38e90803aa801f8a.svg" alt="\vect{X}_1(\omega,t)"/> and
<img class="math" src="../../_images/math/654da448a51ae255a8e2ed2c2a91450699e8e2b5.svg" alt="\vect{X}_2(\omega,t)"/> two distinct solutions of <a class="reference internal" href="#equation-dimn">(1)</a>
associated to two distinct initial states, then, the process
<img class="math" src="../../_images/math/301430c98f09dd79697e85c4bb69a2d4dfb05890.svg" alt="\vect{D}(\omega,t) = \vect{X}_2(\omega,t) - \vect{X}_1(\omega,t)"/>
is solution of the homogeneous equation associated to <a class="reference internal" href="#equation-dimn">(1)</a> and
then decreases with time under the condition <a class="reference internal" href="#equation-modul">(4)</a>. Let us note
<img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/> the number such that:</p>
<div class="math" id="equation-nther">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-nther" title="Permalink to this equation">¶</a></span><img src="../../_images/math/fc7d2adbdf0cc4ebf6afb099785f284690aeed14.svg" alt="\left( \max_{i,j} |r_{ij}| \right)^{N_{ther}} &lt; \varepsilon ,\Longleftrightarrow N_{ther} &gt; \displaystyle \frac{\ln  \varepsilon}{\ln \max_{i,j} |r_{ij}|}"/></p>
</div><p>where the <img class="math" src="../../_images/math/74ce8cb7508f7adda762af40ce7daed48dbd6b56.svg" alt="r_i"/> are the roots of the polynomials <a class="reference internal" href="#equation-polphi">(3)</a> and
<img class="math" src="../../_images/math/1d9ab772a68d781a9a73c08e7953f063cd668479.svg" alt="\varepsilon"/> is the precision of the computer (
<img class="math" src="../../_images/math/ef1d294a7570a7930f5138ac0ad88145a5191ea0.svg" alt="\varepsilon =2^{-53} \simeq 10^{-16}"/>). Then, after
<img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/> instants, the process <img class="math" src="../../_images/math/d3a67f8754633e34d524a821c287557333287b44.svg" alt="\vect{D}(\omega,t)"/> has
disappeared, which means that the processes
<img class="math" src="../../_images/math/16f1f09cf048445b283b333b38e90803aa801f8a.svg" alt="\vect{X}_1(\omega,t)"/> and <img class="math" src="../../_images/math/654da448a51ae255a8e2ed2c2a91450699e8e2b5.svg" alt="\vect{X}_2(\omega,t)"/> do not
differ any more. As a conclusion, after <img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/> instants, the
realization of the ARMA process does not depend any more on the
initial state.</p>
<p>That is why, when making a realization of the ARMA model, we perform
a <em>thermalization step</em> that simply consists in realizing the
model upon <img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/> additional instants, erasing the
<img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/> first values and finally only retaining the other
ones. That step ensures that the realization of the process does not
depend on the initial state.</p>
<p>By default, the number <img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/> is evaluated according to
<a class="reference internal" href="#equation-nther">(7)</a> by the method <em>computeNThermalization</em>. The User could get
access to it with the method <em>getNThermalization</em> and can change the
value with the method <em>setNThermalization</em>. (In order to give back to
<img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/> its default value, it is necessary to re-use the
method <em>computeNThermalization</em>).</p>
<p>On the contrary, in the context of getting a possible future from a
specified current state, the User should care that the number of
additional instants <img class="math" src="../../_images/math/afa5e87a7a7df7122203281f1477aa189afcab56.svg" alt="N_{it}"/> on which he wants to extend the
process, is such that <img class="math" src="../../_images/math/17df2906ea33edf972a276345ac503182e46fa2a.svg" alt="N_{it} &lt;  N_{ther}"/> because beyond
<img class="math" src="../../_images/math/0e1229a6cb840354db4e083205ce6f6db8aaa609.svg" alt="N_{ther}"/>, the future has no link with the present.
More precisely, after <img class="math" src="../../_images/math/0cadbe7e13ff4192a9594c2386b0f550ecff23c6.svg" alt="N_{it}^*"/> instants, such that:</p>
<div class="math" id="equation-nitet">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-nitet" title="Permalink to this equation">¶</a></span><img src="../../_images/math/6f7096a7653064ea10bebc24dc72d2c0dc99fc1c.svg" alt="\left( \max_{i,j} |r_{ij}| \right)^{N_{it}^*} &lt;  \max_{i} \sigma_i, \Longleftrightarrow N_{ther} &gt; \displaystyle \frac{\max_{i} \sigma_i}{\ln \max_{i,j} |r_{ij}|}"/></p>
</div><p>where the <img class="math" src="../../_images/math/cfea43b069bfa35fcea80c72570203bbefddf1d4.svg" alt="\sigma_i"/> are the components of the covariance matrix
of the white noise <img class="math" src="../../_images/math/40c369c2ac82481671af26a5e7a28501b88da9b4.svg" alt="\vect{\varepsilon}"/>, the influence of the
initial state is of same order than the influence of the white noise.</p>
<p>Let us note that when the ARMA model is created without specifying
the current state, we automatically proceed to a
thermalization step at the creation of the ARMA object.</p>
<p>Before asking for the generation of a possible future, the user has to
specify the current state of the ARMA model, thanks to the creation
method that takes into account the current state. In that case,
we do not proceed to the thermalization step.</p>
<p>As an ARMA model is a stochastic process, the object <em>ARMA</em> inherits
the methods of the <em>Process</em> object. Thus, it is possible to get its
marginal processes, its time grid, its dimension and to get several
realizations at a time of the process.</p>
<aside class="topic">
<p class="topic-title">API:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.ARMA.html#openturns.ARMA" title="openturns.ARMA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARMA</span></code></a></p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.ARMACoefficients.html#openturns.ARMACoefficients" title="openturns.ARMACoefficients"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARMACoefficients</span></code></a></p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.ARMAState.html#openturns.ARMAState" title="openturns.ARMAState"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARMAState</span></code></a></p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.ARMALikelihoodFactory.html#openturns.ARMALikelihoodFactory" title="openturns.ARMALikelihoodFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">ARMALikelihoodFactory</span></code></a></p></li>
</ul>
</aside>
<aside class="topic">
<p class="topic-title">Examples:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../auto_data_analysis/estimate_stochastic_processes/plot_estimate_arma.html"><span class="doc">Estimate a scalar ARMA process</span></a></p></li>
</ul>
</aside>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="arma_estimation.html" title="ARMA process estimation"
             >next</a> |</li>
        <li class="right" >
          <a href="boxcox_transformation.html" title="Box Cox transformation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.20dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="probabilistic_modeling.html" >Probabilistic modeling</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ARMA stochastic process</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2022 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jan 01, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>