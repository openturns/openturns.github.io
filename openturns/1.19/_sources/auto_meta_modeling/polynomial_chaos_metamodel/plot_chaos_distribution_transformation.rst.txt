
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_meta_modeling/polynomial_chaos_metamodel/plot_chaos_distribution_transformation.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_meta_modeling_polynomial_chaos_metamodel_plot_chaos_distribution_transformation.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_meta_modeling_polynomial_chaos_metamodel_plot_chaos_distribution_transformation.py:


Apply a transform or inverse transform on your polynomial chaos
===============================================================

.. GENERATED FROM PYTHON SOURCE LINES 6-10

Introduction
------------

In this document we present the transformation involved in the creation of a polynomial chaos. Indeed, the polynomial chaos expansion is never directly applied to the input random variable of a model :math:`g`. Instead, the expansion is expressed based on the associated standard random variable. In this example,  we show how to transform a Log-Normal random variable into its standardized variable with the class `DistributionTransformation`.

.. GENERATED FROM PYTHON SOURCE LINES 13-29

Probabilistic transform
-----------------------

Let :math:`T` be the probabilistic transform which maps the physical random variable :math:`X` to the standardized random variable :math:`\xi`:

.. math::
   \xi = T(X).


Let :math:`F_X` be the Cumulative Distribution Function (CDF) associated with the random variable :math:`X` and let :math:`F_\xi` be the CDF associated with the random variable :math:`\xi`. Therefore, :math:`F_\xi` is the CDF associated with the orthogonal polynomials involved in the polynomial chaos expansion. In this case, the transform is:

.. math::
   \xi = F_\xi^{-1} \left( F_X(X) \right),


for any :math:`X \in \mathbb{R}`.

.. GENERATED FROM PYTHON SOURCE LINES 31-48

Example
-------

We want to use the Hermite orthogonal polynomials to expand a Log-Normal random variable:

* let :math:`X` follow the Log-Normal distribution with the following parameters: Lognormal(:math:`\mu=3 \times 10^4`, :math:`\sigma=9\times 10^3`),
* let :math:`Z=\xi` follow the Normal distribution with zero mean and unit standard deviation (the letter :math:`Z` is often used for standard Normal random variables).

Let :math:`F_{LN}` be the CDF of the Log-Normal distribution associated with :math:`X` and let :math:`\Phi` be the CDF of the standard Normal distribution.

Therefore,

.. math::
   Z = T(X) = \Phi^{-1}(F_{LN}(X)),


for any :math:`X \in \mathbb{R}`.

.. GENERATED FROM PYTHON SOURCE LINES 50-52

.. code-block:: default

    import openturns as ot








.. GENERATED FROM PYTHON SOURCE LINES 53-54

In the first step, we define the LogNormal distribution. Its parameters - mean and standard deviation - have been selected so that there is no ambiguity with the standard Normal distribution. This parametrization can be used thanks to the `ParametrizedDistribution` class.

.. GENERATED FROM PYTHON SOURCE LINES 56-59

.. code-block:: default

    Xparam = ot.LogNormalMuSigma(3.0e4, 9.0e3, 15.0e3)  # in N
    X = ot.ParametrizedDistribution(Xparam)








.. GENERATED FROM PYTHON SOURCE LINES 60-61

Then we generate a 5-point sample.

.. GENERATED FROM PYTHON SOURCE LINES 63-66

.. code-block:: default

    sampleX = X.getSample(5)
    sampleX






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <TABLE><TR><TD></TD><TH>X0</TH></TR>
    <TR><TH>0</TH><TD>24851.57</TD></TR>
    <TR><TH>1</TH><TD>39644.81</TD></TR>
    <TR><TH>2</TH><TD>27619.95</TD></TR>
    <TR><TH>3</TH><TD>28962.72</TD></TR>
    <TR><TH>4</TH><TD>25575.91</TD></TR>
    </TABLE>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 67-68

In the second step, we define the random variable :math:`Z` with standard Normal distribution.

.. GENERATED FROM PYTHON SOURCE LINES 70-72

.. code-block:: default

    Z = ot.Normal()








.. GENERATED FROM PYTHON SOURCE LINES 73-74

We also generate a sample from it.

.. GENERATED FROM PYTHON SOURCE LINES 76-79

.. code-block:: default

    sampleZ = Z.getSample(5)
    sampleZ






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <TABLE><TR><TD></TD><TH>X0</TH></TR>
    <TR><TH>0</TH><TD>-0.2627547</TD></TR>
    <TR><TH>1</TH><TD>0.2319856</TD></TR>
    <TR><TH>2</TH><TD>-0.3728253</TD></TR>
    <TR><TH>3</TH><TD>-0.3093705</TD></TR>
    <TR><TH>4</TH><TD>-1.054682</TD></TR>
    </TABLE>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 80-81

In the third step, we create the transform T which maps X to Z.

.. GENERATED FROM PYTHON SOURCE LINES 83-85

.. code-block:: default

    T = ot.DistributionTransformation(X, Z)








.. GENERATED FROM PYTHON SOURCE LINES 86-87

We apply this transform on the sample generated from `X`.

.. GENERATED FROM PYTHON SOURCE LINES 89-91

.. code-block:: default

    T(sampleX)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <TABLE><TR><TD></TD><TH>y0</TH></TR>
    <TR><TH>0</TH><TD>-0.4809216</TD></TR>
    <TR><TH>1</TH><TD>1.172666</TD></TR>
    <TR><TH>2</TH><TD>-0.03431651</TD></TR>
    <TR><TH>3</TH><TD>0.1480268</TD></TR>
    <TR><TH>4</TH><TD>-0.3529745</TD></TR>
    </TABLE>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 92-93

The inverse transform maps :math:`Z` into :math:`X`.

.. GENERATED FROM PYTHON SOURCE LINES 95-97

.. code-block:: default

    Tinverse = T.inverse()








.. GENERATED FROM PYTHON SOURCE LINES 98-100

.. code-block:: default

    Tinverse(sampleZ)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <TABLE><TR><TD></TD><TH>y0</TH></TR>
    <TR><TH>0</TH><TD>26118.46</TD></TR>
    <TR><TH>1</TH><TD>29628.14</TD></TR>
    <TR><TH>2</TH><TD>25460.13</TD></TR>
    <TR><TH>3</TH><TD>25834.74</TD></TR>
    <TR><TH>4</TH><TD>22166.9</TD></TR>
    </TABLE>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 101-105

Conclusion
----------

The `DistributionTransformation` class is rarely used directly because the polynomial chaos classes perform the transformation automatically. However, understanding how this transform is done clarifies why the coefficients of the chaos expansion cannot be related to the input random variable :math:`X`: the expansion is based on the standard variables :math:`\xi`. Hence, the absolute values of the corresponding coefficients have no straightforward interpretation, even though squaring them yields the part of the global variance associated with each coefficient.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.003 seconds)


.. _sphx_glr_download_auto_meta_modeling_polynomial_chaos_metamodel_plot_chaos_distribution_transformation.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_chaos_distribution_transformation.py <plot_chaos_distribution_transformation.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_chaos_distribution_transformation.ipynb <plot_chaos_distribution_transformation.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
