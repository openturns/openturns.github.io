
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Estimate a GEV on race times data &#8212; OpenTURNS 1.21 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Statistical tests" href="../statistical_tests/index.html" />
    <link rel="prev" title="Estimate a GEV on the Fremantle sea-levels data" href="plot_estimate_gev_fremantle.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../statistical_tests/index.html" title="Statistical tests"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_gev_fremantle.html" title="Estimate a GEV on the Fremantle sea-levels data"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate a GEV on race times data</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_estimate_gev_fremantle.html"
                          title="previous chapter">Estimate a GEV on the Fremantle sea-levels data</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../statistical_tests/index.html"
                          title="next chapter">Statistical tests</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_data_analysis/distribution_fitting/plot_estimate_gev_racetime.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-gev-racetime-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="estimate-a-gev-on-race-times-data">
<span id="sphx-glr-auto-data-analysis-distribution-fitting-plot-estimate-gev-racetime-py"></span><h1>Estimate a GEV on race times data<a class="headerlink" href="#estimate-a-gev-on-race-times-data" title="Permalink to this heading">¶</a></h1>
<p>In this example, we illustrate various techniques of extreme value modeling applied
to the fatest annual race times for the women’s 1500 meter event over the period 1975-1992.
Readers should refer to <a class="reference internal" href="../../bibliography.html#coles2001" id="id1"><span>[coles2001]</span></a> to get more details.</p>
<p>We illustrate techniques to:</p>
<ul class="simple">
<li><p>estimate a stationary and a non stationary GEV,</p></li>
<li><p>estimate a return level,</p></li>
</ul>
<p>using:</p>
<ul class="simple">
<li><p>the log-likelihood function,</p></li>
<li><p>the profile log-likelihood function.</p></li>
</ul>
<p>This analyse is particular as we are interested in modeling the annual minimum race times and not
the annual maximum race times. In order to transform the minimum modeling into a maximum modeling,
we proceeds as follows.</p>
<p>We denote by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAWBAMAAACWKdujAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL/znft0z90qVouCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACHklEQVQ4y91UPWgUQRT+9vYP7m5z6UQMEi0sbLKIEixCBqwExS1UhGicgFVA7xq7hKRJKuVSCWqjjaAIXqNVxCUIWpkTPWMjHNjYRYiJIgZ88+5n9u6yc1xh44N5+2a/b7958+bNAmTWoeMh/old9Jfwf9rsANws+/3b5DK/Sv3YVWDm1Sesv5RpDA17i6y/Sm5tMY1+upWGWvpZiBuGxTX8mj85SmsspKY833xmlCsOY9igrGFmj38G8ldlv2JwFkHFMnE0bMXkxEHqu8d9D+Wrcu6fRyaOhv2qUqZKxt96WNNbZ25dO1tyN0OKNoAKv71vvlIaVnSxgDxWW29ufyF7r473N6aEX0EhVBGwwnDZrKzh76QQT8oT9k4v6yeKJW+HlFUk7VHe5Dr1kPcuTZjhhr2gw5OFKHZWemlbKl1Wpki6rHw5oF3m19KUGW7YHcBB7o0MqnsqS63sqbVt4f6gx7EU4SbcqrODzAhywns4t9xR5y5lPpIZ4LBBuQHP7nsrWfk8glFMhk4hGunOudiuRjHEEcqJdnYuYuUJ2TuasNimZrbrsO6KbGSNLWEatQ7hS7s3yxtXdi+UaxzhKdzN53DH7rHylKARJoZow249iOAIrfQEFWNDTehQVSPugvU8+yAHDCXudM3/YPzdJbgnjcpBND+ezAN176MxZ7vdqv6BU3S3Oi0xH8J1geVB/vxzKUp7zZ1oEGV7MO5fLuqeF02t9kAAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\tilde{M}_n = \min (X_1, \dots, X_n)" style="vertical-align: -5px"/> where all the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAQBAMAAAAG6llRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAcElEQVQI12NgYFT+IsD62ZEBBNi+MzA2gFkMjJ8YmBigwJlBAcacHyYAY3KZw1gM3N/hzKO/gQTrBSDBGeAME6xlmH8BaqwCA98DBoYrQGYJAwPvTwZeLgGGGZ8nMMz7lcBQBzeFQRfBXHgBztxbAACNqhd9g0KOdAAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="X_i" style="vertical-align: -3px"/> are
independent and identically distributed variables. We introduce
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEkAAAAQBAMAAACo3E/QAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMr/73WDPi3RIGJ2v8+l0lYufAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA2UlEQVQoz2MQ+qzAwKDvyoANcB3+toDjcxaImQ/E5QzYAfdHBi4HMCu+gYGzAYcqrj8MPBAWswPDagZcIJnhAITB8wvGwgLmdy+AMDi/8yzAqYrXEMa6VwhlqKUBQQ6KKqaPMNb5AAaGdhxmRXwCEhwFQOIshhyrCwgA5TgbkmFij3C6ikGcYX4BlPmDgYE9Aau7uA4w8D1gYCgDGf+LgaHgFlajxID6fzKw8y5g4Dr7ZwID4wNsiqZ8nsAw7+8GBjkon6eAAQ84Dgu85fhU3YKawVSIT5W6AACuWTRqWhUToQAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="Y_i = -X_i" style="vertical-align: -3px"/> for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAAAPBAMAAACxa0SdAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYOlIMp0Yr8+/3XTzi/uVVPmDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAuklEQVQoz2NgEDJggIEUEMF4AIULAa72cFWZi0EkiwAKFwr4Yao8kEXRuTBVUi0oitC4UFW7yiBc5p0oXIat1+42w1XZhEFFs/kMkLkswm8ZdsFVsa+GCgv4o3C5eQ8wRCBsZNWFileicjkLGFqRXM+9PAFMP0bl8gkwfEEOCcaVDiDZAwLIXAZ/Bm4FoAg/LBQZmHtBLiq4gMxluAS08wJDer+6AXLAMFcnoARULIYIlYDUKiBYjYsLAIaLLkmsYiH/AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="1 \leq i \leq n" style="vertical-align: -3px"/>,
and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKkAAAATBAMAAAAZqjAPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/NI6b9gnft0GDLPi90j4oowAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACLklEQVQ4y5WUTWgTQRTH/9tNs5udTbdEEOLBBvHugggq/chFBEEseFKERDwVColexFsvHopU9qCCB2F6kCIoWRB7ElsJ9uAHLnoSFXLRgx5UilXTKr4ZZ2uazSTpwMy82fff386892aBvttCn7qqHHOrNKS+l3upl1npMjD4p7Pwwc9JoPSRrNtybc3ScG1SB3ulZqsM9yuQjTS6l9TfCyMjFdZRwKlotzqt5hSQ/gUc0ukqAcxAWkUxLD4h/gTvFYBb1K/Cqer8diOOfF4M0W7g8IWeSfhMfYQbWr/RxHDL6SKKXPAhoRpff3Pq3ruy+SUkawWYoWcT0S4t1fxtqPPaklpBBrOx88xzao/JcH7gYJSegRcKCyjQs4Hjof4we98qwxNvB0v8PmsmVWuolZ0mUYXFmciBsQbcaWioI3HCbdpzhnt+kC0kVetim5JKFjcllWQ3ixpqLjYGiJqFfYO7yx2p/D/VEd9NUVUzHfXIZjVAUFN52JFzfur0lri2UWW2vKALlYp5Yed1/o86BreIpTDr+fn2vdY2I1ALcUxUOpdU9hSJjjSlJlo16LuPKFR7Iss3TpzEOOpboAc2zpVWRjf2l+rSwiVgft8OSTXnqJCutHRaO7lvPsyG66t7q9pFeUZ9e6hmEYFMmy9eW1Vx+k8tnnr6Wdff1pCqcVbQU11/ehGsNfMN50XXvTL1Vzs7FyJo88XrIdyNMMixjTaVpHRcv94OFKxPHV3qv4LvowN9H3YxAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="M_n = \min (Y_1, \dots, Y_n)" style="vertical-align: -5px"/>. Then, we have:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF4AAAATBAMAAADrOqfvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL/znft0z90qVouCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA3UlEQVQoz2NgAAJGRRMDBhJAGHsrw+ABkl+BBNOPAmLlufYAiUMNOM1Dl+fSYmBgqy/ArR5N3vwGAwNPfAJO9ejyDnLAEF2J23/o8g6eDAwHXuBRjybvUM/Aw7AHxuu9CwQXUdSjyDOwHbBPMGX+htN4dHmeBP6AAywTMNSxvwMBBwx5Fgbu4wm8F9gW1rRhNR9dnoWBSYaB24GFP0AGq/vR5BlCGHgVGOwNGOIYrmI1H1me+RoD40wHrgBG/VaGVQwbsClHkWfdjJC4yn65AF+yRJd/wHYFbzKGyAMAwj5P7dOpcV8AAAAKdEVYdERlcHRoAP////xgkZBVAAAAAElFTkSuQmCC" alt="\tilde{M}_n = - M_n."/></p>
</div><p>We can show that if the renormalized maximum <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUBAMAAACKWYuOAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL/znft0z90qVouCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoElEQVQY02NgAAJGRRMDBjgIY29lIAZIfgUSTD8KIDyuPUDiUANUjkuLgYGtHirFYH6DgYEnPgHKc5AD2rESZoqDJwPDgRdwXj0DD8MeKIftgH2CKfM3KI8ngT/gAMsEKI+Fgft4Au8FOI9JhoHbgW1hTRuQF8LAq8Bgb8DCHyAD9NtMB64ARv1WhjiGq0iOX8WwAYl3lf1yAYL3gO0KAwDrhCCaMzdZ5gAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="\tilde{M}_n" style="vertical-align: -3px"/> tends to the GEV distribution
parametrized by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAATBAMAAADYAbjmAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABJElEQVQoz2NgYFRgwA7A4szY5RwYZEGUCnbZZwfYCoBUAFbJo+0XQDJgFRiAZSVIOwMDxwRsslwgJzkDaZDDHBh6IKLV//8vANHyBxjAUtxAin8C40ewJPPFGRD/cdxJBAozMEwFsr0Y2DaABSsYWCCO5FlcBNQrwHAUyH7MwHsBLLiGga0BzDgHIrgFGKSBVBgDdwKIy7mAgfcBWNaAAWIvyFU/GeRlBED+CACZBgTsBVBZVgEGlj8Mr9gZJgPFFzCYMYAYfGC3zWBgYEpg4AtOky1hOAVUfygJ6BMgg+UfyIhyoF0GDKxgSxkSYEEBZLj+cGBgaGQAYf4JGLIMZz+B9DEwzAV6FwTYYJIQRjIDL9ihCXlYZMteMtSAeRNwpA2gOADogzgrU6p94gAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(\mu, \sigma, \xi)" style="vertical-align: -5px"/>, then the renormalized minimum <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUBAMAAACKWYuOAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL/znft0z90qVouCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoElEQVQY02NgAAJGRRMDBjgIY29lIAZIfgUSTD8KIDyuPUDiUANUjkuLgYGtHirFYH6DgYEnPgHKc5AD2rESZoqDJwPDgRdwXj0DD8MeKIftgH2CKfM3KI8ngT/gAMsEKI+Fgft4Au8FOI9JhoHbgW1hTRuQF8LAq8Bgb8DCHyAD9NtMB64ARv1WhjiGq0iOX8WwAYl3lf1yAYL3gO0KAwDrhCCaMzdZ5gAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="\tilde{M}_n" style="vertical-align: -3px"/> tends to
the <em>GEV for minima</em> distribution parametrized by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAWBAMAAABj+5JWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABRElEQVQoz2NgwA744qZPYMAJDrLcYSAMGBVwSDCBCGbsciwMjBeAlAqyE56+rIQ5K4chHUgFIDmBR8D3AJQVUcvAysDAVoDVYC+gYXwJDBzYvbUIZLUBAxfIYQ4MPRDB6v//F4A98gdELmDgBpL8Exg/giWZL86A+q/3mAADwweGqSBLGNg2gMUqGFgCILKnzIHKFjIcBTIfM/BeAIutYWBrgDj5AYjcyCANJMMYuBNAPM4FDLwPGBBBtADsqp8M8jICIEcGMHAJgMXLobKsAgwsfxhesTNMFgBxzYAmGDIwPAIb1cDAlMDAF5wmW8JwChgsh5KAQcWznIHB/yFQlr2AgdOAgRVsKUMCLCTYgHbEtzAwcABNawR6F0OWgee+AsNkID0X6F2YGANCGZsBw0WQQxPysMiy501gB0cXrtTFycAAAMlXQhIljgGBAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\tilde{\mu}, \tilde{\sigma}, \tilde{\xi})" style="vertical-align: -5px"/> where:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABIBAMAAABYYYuWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL/P3ft0850EMixyAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABlUlEQVRIx2NgYFQ0MWDADcLYWxloBjgLGJZilZjOwBXAwMBvwPYNyOGYCQICSNKfGfITGBiqGXguYNPMvoHhLJCSZOBoQBGvWgUESxgYJzB0AHk6DLwHsOlmOsBwB2JFagIWu0FuCmNg/8ogzYJNd30A4wYHBkbNMxnu2KSF5hxrKQBZgR3oQK3AIf0ZTFbjkAV6GwQO4pDmEWAYBWSDgcwlLPf//0YV8f3/fwOcMyN5HQNKLuFss3qA0LyAoQhVsxcDuwKcwx3AcApVeisDzwI4x5qBoRFFlnkDAwciIQFN3oZiN9Bk7gSE4QycaCl9A8McBIf1zVM0n8adCxhNaoMbCAk745FlTaigYQyyowsUoObRo2jSMshuYdXyQJUNWoJcPVSjZW/2zSjcfWhGcz9A5rF9RZPORw2FFTEJKDmUq/UYsnT0lAeoobjTD5mHXnAHotah6IEyAYXnAqHgdrM4oEjLoZdzqC6pF0MLlY8JKFz95ajyRb9QooS1H9U4hoh/qHXSBDTrT6KUewfR4sRHGM4EAMyUZjxNYA0uAAAACnRFWHREZXB0aAD////+jp/xeQAAAABJRU5ErkJggg==" alt="\begin{align*}
  \tilde{\mu} &amp; = -\mu \\
  \tilde{\sigma} &amp; = \sigma\\
  \tilde{\xi} &amp; = \xi
\end{align*}"/></p>
</div><p>The cumulated distribution function of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUBAMAAACKWYuOAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL/znft0z90qVouCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoElEQVQY02NgAAJGRRMDBjgIY29lIAZIfgUSTD8KIDyuPUDiUANUjkuLgYGtHirFYH6DgYEnPgHKc5AD2rESZoqDJwPDgRdwXj0DD8MeKIftgH2CKfM3KI8ngT/gAMsEKI+Fgft4Au8FOI9JhoHbgW1hTRuQF8LAq8Bgb8DCHyAD9NtMB64ARv1WhjiGq0iOX8WwAYl3lf1yAYL3gO0KAwDrhCCaMzdZ5gAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="\tilde{M}_n" style="vertical-align: -3px"/>, denoted by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAARBAMAAAAf5oCsAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr+kyi0gYYL+dz3Tz+87TzoEAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABqSURBVAjXY2BgYBASdgaSDKwJFQEMWADbLMEJlkB6zwaGjOMMDJyHGRjYHzAw7DMAiikwMFwEqRFg4HwMohMYeBQguvgaoPQEBoYZjxwYeAWAJr1mYGAEyrMAtTMcZGCoAqnlXDgzoIABAGykExxSFVC4AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\tilde{G}" style="vertical-align: 0px"/>, is defined by:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbYAAAA5BAMAAACothP6AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL+dz3Tz+92wESGcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGKUlEQVRo3t2aX2gcRRjAv7vL7eZyf5NiNS1qAvVBBDmkD61ic2DERGt79qHoU9YXaTHlYu2DKDZBbBERckWKNsTmD6hg0ZwoRU1pTosoRuRqKxX/kWoo9MH00jRXS6DnzOzu7c7uzuyk5DKl38Nmd/J9c/ObP9988wfg1pPHxzS4ZeU52QX4tI55h2akoqnFeubeLJVtT3bl83weN1cKCgDBgky2i3XIc7INoCGtflKA0BmZXbJUj2GG2BrhJH69SyJbLGP/GqkusVUb8ox/PEieiWrVzrYRZvFrvE8e2zD1dYin+gWz7Q1vmLSzrYU7XkSvkaI8trPCbGobe5K22A41N7cStgF4uNn9A6sp0YowW69XkNGy5hH0bMq42k3tUwbI+2vS2IIzwmyzHmlh7SU8hShnHGxF5EoiafLen5bF1lEQZYvyBs46mu2Fs+ndZmPGU7LYRkCUjXaoDsllKTYkb0Po37X4pbEki+1+YbYp8mz8PUzFMR9CAn8HRp1saLCFWkh7L0pCU+aF2drJs3v/ESp1AXLYxSgVB1sI9XX1c/IT12S5yauibKEF8icNGUdUc4K83OtsN0v+ksQWqPiz6W4+YLiSh/Bj/xySWb0vvmGFAN5sH+u/1L5xlR1moujLZrj5mD5bqfSqAYX507q/zTLZRgjTTvXAKrdbfEa0T+b0yeIziNhTk2mlspNklGGyTdmmGUUPSfOC3oDSyy+TLTcgyjZFopLo0GP/2FP7s4ESGYCJUSZbDy6UMtSc34wCGD1pl1+5do+1hvKmNggaOX83JcBGIvk79UWn8iMV17ccO/46SWgsMtlI/Z0owK7vAN4xXJhjrlTvcbi4aVDe6jO1QczI1RoZN9te50J8PU7429P+vtr6p8xkS6J+HzmFyoJUzHCbDrtDhx1z4DAaov1OLT8jp2zvc7Ft7nGw7ZjFFf+Dp/1CzeMsMtniqEmn0qRstapf79ChixnF2QZdDcU3csndWXe7Jek0VY+DT/MX7aElJlusbFinIGFOAy9zi0lC0IClLWTkkkF/trjun654Tv214apcYbIFyxAh7atB3Iza4txikllDsSsJGEFnl7bteuiP2y/t6yKeeTDty6aHwd5sNrnGY4sZQyVmRm1E882PkIx5FPMbS9sQAaNAKlyE8/ABdGT0OXdC82VLHDiOa3HJh22eyZYoQ9KYah4wo7a4xmuC/yxtQwSMcmn4Fvbs03CA+6QgW/i3bnM88eRXNlsFkqhfv3s5AzvMqC3mVcxaJIf6QGRwA9ZWcdJcRsRoanJyGtRzgNl6cHe8hNVrGdjYrLSndEKdreolZT5bU4U4B9zyvWbUxh86p/U4qNfmtPyNthOXNmexCbTbqOUHb7BPViDQps+AcTNqi3OHToteVBuLgFGHhtxPJJhfRp9syFh+8MZ8CWKDr5EHR3xBzYjatjh06KVWLAXqONE2/bGAUWMK1cCAcg63+DTTT1LzeSBvlZ0nSzw/CZGxI1mUbaRgRG2ddEy87vJtVMJQ62GVaBsiZNTdmR1eDP95MPdKVx9jfnt2ot2eqM5rtT7HkdBVLpupNWq8XBAJdmvayzECfSOAEZc4ZO91Ugvf8zNUF7lxiaN4zlIz5AIX1Y/NI550ydOkO457LcZtw7LCjSdN2WSMDU2olJvoAaUtj60/I7DG+cq92Wcsxm3DssRdB9SaVx9Cj4qVUqU2T0WNJt43HKfA+u2JNaQW+LWWmGGv3+x9KW17+kua+bGi6+4k/6wJRx6sdbekjeWk8H5JjK6FrdUqtV/ckxXaL7nJ9rkMiVAoTQe30Fsz74HPPtfNuT9pTJVUhLPNeRp3ns02IWnvVRXeV4Yx+8cvEKV6s77r7M32syQ2ED8PeNWOUsLhm33uaWOySTsPgJ+E2exnVKhD0gtF9xmVte8g6xxnGedv1GWNEhyj/nkUmGzyzt9ywuem1CWbZ76kwhLnmTAVcg3IYkuMCrP1siMT51m+XfqzstiiZWE2sTsYLhkHaSJ+vwS6WP8Iz3DYluSxbaVdy8rcebIbleSxca8frIDEJV4yVOtcr0dBolysa+6KzPuT0FtXH53Iy2QLF+uZ+xBIlfrfM/8fkWnTAlwIykQAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\tilde{G}(z) = 1-G(-z) = 1-\exp \left( -\left[ 1-\tilde{\xi} \left( \dfrac{z-\tilde{\mu}}{\tilde{\sigma}}\right)\right]^{-1/\tilde{\xi}}\right)"/></p>
</div><p>for all <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIBAMAAADZ48iGAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAv/t0SIudYN0yzxjzRJk6YgAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADJJREFUCNdjYGBUZnFgYAirSGNgYJjAEAAkGSaDCHYHEGnJwMbAwJwV3snAsJn7TAEDAIm7Bt2vf1g6AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="z" style="vertical-align: 0px"/> such that <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAAAWBAMAAADUaqg0AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYOlIMp0Yr8/di790+/MD6fh/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACG0lEQVQ4y2NgQAdFJUsYqAOYE6QNGAYnYAvAKswKoTYQawwjEHPgsAFsCEsBLq1CaEHDfpiBIRBTGbu6lwPDKTDLAcJBsT+qkIHB1R7VKGbN1QwMCphGmTFuZmBgArE4oRxkYMTABDSbH9UoWaAQzwIcPmA/ACRMER5OgLHmMLBuwDDqKsheB1zh2AAktiCM2g3T+5mB8QK6UWyfgQQvEHPfYUaRaGTgBPKB6hkmMDBwvf//F6y6QgASKl8YmL9huGq2TQIDH5BeKhmKIv6FIR/onQ9AlwF9350yFSq8EhwWjF9ApqEbZdsVwOAEpB0YUAIM6P5zQOoaMKEkMHBNYBCCSUiUQVzFCDOKcSYIADUzF4DjAwh8QIQkSHgWKMAbGHYDqWfgNMdrwHASbsl5oH6Wzww8GB4EJ848kOGojmU6wPCGARxWZxgYfBkYtsNdBY6Fjww8GMG+igEa7Edg2QQC+B3YvpmBjQJGohDYp5CwgmSxWQysQHF+AWQtpWAnJDDwRCycgiwub8B+YQEDywQGtgaQVRwHIPEdCaEZJEFJNL1fHdlZ8qBQZD3AkMP2DsWKop5juwQYuBYwcAGFmWOCISbtgGnliSnETIT6E4Gh2IAhrgMmORNA2QYOWBLwF337gb6fhiH8BUx6MDB4k1BW8TRgUQ/KFkCwjYEhmHiTuI4DMyDjAXTzwWUUlwE425AGsOdnFpwyIAAAxvNuP1+9vNoAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="1-\tilde{\xi}(z-\tilde{\mu})/\tilde{\sigma} &gt; 0" style="vertical-align: -5px"/>.</p>
<p>In that example, we model the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAQBAMAAAARyMmYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/NI6b9gnft0GDLPi90j4oowAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAl0lEQVQI12NgYBD6zMDAwPI1gQEM2DuBxJQABijPnYGBKx8qxbDtKAMDp/0CKO+CHAODVREDjHeJgWHCUzgvn4GToRPK4Zqwf8Fm7l9QHucCfoMJvApQHi8Dx7QFPAfgPBZJBo4LXIWZUUCeLQOPA8P+Dbz8BpIMDIxKF9gNGP2DGewYDjMgQDlDAxLvMNvpBATvAddZBgCleCFZpSVfTwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="M_n" style="vertical-align: -3px"/> variable which is the annual maximum of the opposite race times.</p>
<p>First, we load the race times dataset. We start by looking at them through time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">import</span> <span class="nn">openturns.experimental</span> <span class="k">as</span> <span class="nn">otexp</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">coles</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">coles</span><span class="o">.</span><span class="n">Coles</span><span class="p">()</span><span class="o">.</span><span class="n">racetime</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="s2">&quot;Fastest annual women&#39;s 1500m race times&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;race time (s)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
<span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setIntegerXTick</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_gev_racetime_001.png" srcset="../../_images/sphx_glr_plot_estimate_gev_racetime_001.png" alt="Fastest annual women's 1500m race times" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    [ Year      Race time ]
0 : [ 1972       241.371  ]
1 : [ 1973       244.616  ]
2 : [ 1974       242.301  ]
3 : [ 1975       246      ]
4 : [ 1976       235.994  ]
</pre></div>
</div>
<p>We select the race times column. We transform them into their opposite values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Stationary GEV modeling via the log-likelihood function</strong></p>
<p>We first assume that the dependence through time is negligible, so we first model the data as
independent observations over the observation period. We estimate the parameters of the
GEV distribution by maximizing the log-likelihood of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GeneralizedExtremeValueFactory</span><span class="p">()</span>
<span class="n">result_LL</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildMethodOfLikelihoodMaximizationEstimator</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We get the fitted GEV for the variable <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAQBAMAAAARyMmYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/NI6b9gnft0GDLPi90j4oowAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAl0lEQVQI12NgYBD6zMDAwPI1gQEM2DuBxJQABijPnYGBKx8qxbDtKAMDp/0CKO+CHAODVREDjHeJgWHCUzgvn4GToRPK4Zqwf8Fm7l9QHucCfoMJvApQHi8Dx7QFPAfgPBZJBo4LXIWZUUCeLQOPA8P+Dbz8BpIMDIxKF9gNGP2DGewYDjMgQDlDAxLvMNvpBATvAddZBgCleCFZpSVfTwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="M_n" style="vertical-align: -3px"/> and its parameters
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAXBAMAAACop0HzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABR0lEQVQoz4WSO0sDURCFv81jN5uX6RRUTOEPiI221jYGBLFzsdBGwhaCgggJWCosBMEmEG1sUug/CIIWqUxpZdTOSkshEGd2s7hgEqeYe2fO3DlnhgtjbKbABHt+mgDGmOZ/M4pjn4vFoxKMWoglMJR5MSoh1wjR/D57cpSjEoqGG1yyWyckwXRHkq558twh5Y1Er5W6RFqFrXIWJI8Hg6avrq++SUb8lGd8+WC8ezmc7/xRxvjkQkkwb/3cEYlygHZWpOyKB7m+kwtGamFWA8k99XfMit8k42hkN8n1CFekvKrqm4U53Za0TQdbOxyiyQKJPh8W9YKGy9JhCd78VlViDvmN3fkDOrKW+522cN7A+quglotdIumT4oSbMIVj+xRS0q0m4/5Byb4UqcvZkHHDHL9lZomuCnUqI1Cr4lltDbwxf8OGH00pPcuV2/LgAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\hat{\mu}, \hat{\sigma}, \hat{\xi})" style="vertical-align: -5px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitted_GEV</span> <span class="o">=</span> <span class="n">result_LL</span><span class="o">.</span><span class="n">getDistribution</span><span class="p">()</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">fitted_GEV</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">()</span>
<span class="n">param</span> <span class="o">=</span> <span class="n">fitted_GEV</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">param</span><span class="p">)]))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>mu: -239.260, sigma: 3.643, xi: -0.470
</pre></div>
</div>
<p>We get the asymptotic distribution of the estimator <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAXBAMAAACop0HzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABR0lEQVQoz4WSO0sDURCFv81jN5uX6RRUTOEPiI221jYGBLFzsdBGwhaCgggJWCosBMEmEG1sUug/CIIWqUxpZdTOSkshEGd2s7hgEqeYe2fO3DlnhgtjbKbABHt+mgDGmOZ/M4pjn4vFoxKMWoglMJR5MSoh1wjR/D57cpSjEoqGG1yyWyckwXRHkq558twh5Y1Er5W6RFqFrXIWJI8Hg6avrq++SUb8lGd8+WC8ezmc7/xRxvjkQkkwb/3cEYlygHZWpOyKB7m+kwtGamFWA8k99XfMit8k42hkN8n1CFekvKrqm4U53Za0TQdbOxyiyQKJPh8W9YKGy9JhCd78VlViDvmN3fkDOrKW+522cN7A+quglotdIumT4oSbMIVj+xRS0q0m4/5Byb4UqcvZkHHDHL9lZomuCnUqI1Cr4lltDbwxf8OGH00pPcuV2/LgAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\hat{\mu}, \hat{\sigma}, \hat{\xi})" style="vertical-align: -5px"/>.
In that case, the asymptotic distribution is normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameterEstimate</span> <span class="o">=</span> <span class="n">result_LL</span><span class="o">.</span><span class="n">getParameterDistribution</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Asymptotic distribution of the estimator : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parameterEstimate</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Asymptotic distribution of the estimator :
Normal(mu = [-239.26,3.64268,-0.469834], sigma = [0.891274,0.778059,0.236181], R = [[  1        -0.113124 -0.406653 ]
 [ -0.113124  1        -0.706993 ]
 [ -0.406653 -0.706993  1        ]])
</pre></div>
</div>
<p>We get the covariance matrix  and the standard deviation of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAXBAMAAACop0HzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABR0lEQVQoz4WSO0sDURCFv81jN5uX6RRUTOEPiI221jYGBLFzsdBGwhaCgggJWCosBMEmEG1sUug/CIIWqUxpZdTOSkshEGd2s7hgEqeYe2fO3DlnhgtjbKbABHt+mgDGmOZ/M4pjn4vFoxKMWoglMJR5MSoh1wjR/D57cpSjEoqGG1yyWyckwXRHkq558twh5Y1Er5W6RFqFrXIWJI8Hg6avrq++SUb8lGd8+WC8ezmc7/xRxvjkQkkwb/3cEYlygHZWpOyKB7m+kwtGamFWA8k99XfMit8k42hkN8n1CFekvKrqm4U53Za0TQdbOxyiyQKJPh8W9YKGy9JhCd78VlViDvmN3fkDOrKW+522cN7A+quglotdIumT4oSbMIVj+xRS0q0m4/5Byb4UqcvZkHHDHL9lZomuCnUqI1Cr4lltDbwxf8OGH00pPcuV2/LgAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\hat{\mu}, \hat{\sigma}, \hat{\xi})" style="vertical-align: -5px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cov matrix = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">parameterEstimate</span><span class="o">.</span><span class="n">getCovariance</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Standard dev = &quot;</span><span class="p">,</span> <span class="n">parameterEstimate</span><span class="o">.</span><span class="n">getStandardDeviation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Cov matrix =
 [[  0.79437   -0.0784475 -0.0856013 ]
 [ -0.0784475  0.605376  -0.129919  ]
 [ -0.0856013 -0.129919   0.0557815 ]]
Standard dev =  [0.891274,0.778059,0.236181]
</pre></div>
</div>
<p>At last, we can validate the inference result thanks the 4 usual diagnostic plots:</p>
<ul class="simple">
<li><p>the probability-probability pot,</p></li>
<li><p>the quantile-quantile pot,</p></li>
<li><p>the return level plot,</p></li>
<li><p>the data histogram and the density of the fitted model.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validation</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">GeneralizedExtremeValueValidation</span><span class="p">(</span><span class="n">result_LL</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">validation</span><span class="o">.</span><span class="n">drawDiagnosticPlot</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_gev_racetime_002.png" srcset="../../_images/sphx_glr_plot_estimate_gev_racetime_002.png" alt=", Sample versus model PP-plot, Sample versus model QQ-plot, Return level plot, Density" class = "sphx-glr-single-img"/><p><strong>Stationary GEV modeling via the profile log-likelihood function</strong></p>
<p>Now, we use the profile log-likehood function rather than log-likehood function  to estimate the parameters of the GEV.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_PLL</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildMethodOfProfileLikelihoodMaximizationEstimator</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>The following graph allows one to get the profile log-likelihood plot.
It also indicates the optimal value of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAARBAMAAAD9OpvVAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABLSURBVAjXY2BgYGQAASYTIMESVgEkJReABGaDCJ4nYMkM5wNA0vP6BqASBZAAL1i4HExqg0k5HRDJGJcIolj6NoAo5gtAgt1oAQMAGy8LVPWDKP0AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\xi" style="vertical-align: -4px"/>, the maximum profile log-likelihood and
the confidence interval for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAARBAMAAAD9OpvVAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABLSURBVAjXY2BgYGQAASYTIMESVgEkJReABGaDCJ4nYMkM5wNA0vP6BqASBZAAL1i4HExqg0k5HRDJGJcIolj6NoAo5gtAgt1oAQMAGy8LVPWDKP0AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\xi" style="vertical-align: -4px"/> of order 0.95 (which is the default value).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">result_PLL</span><span class="o">.</span><span class="n">setConfidenceLevel</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">result_PLL</span><span class="o">.</span><span class="n">drawProfileLikelihoodFunction</span><span class="p">())</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_gev_racetime_003.png" srcset="../../_images/sphx_glr_plot_estimate_gev_racetime_003.png" alt="profile likelihood" class = "sphx-glr-single-img"/><p>We can get the numerical values of the confidence interval: it appears to be a bit smaller
with the interval obtained from the profile log-likelihood function than with the log-likelihood
function.
Note that if the order requested is too high, the confidence interval might not be calculated because
one of its bound is out of the definition domain of the log-likelihood function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confidence interval for xi = &quot;</span><span class="p">,</span> <span class="n">result_PLL</span><span class="o">.</span><span class="n">getParameterConfidenceInterval</span><span class="p">())</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Confidence interval for xi =  [-0.791703, -0.156295]
</pre></div>
</div>
<p><strong>Return level estimate from the estimated stationary GEV</strong></p>
<p>We estimate the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIBAMAAAACWGKkAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi50Yz0h0MmD76d3zv6/wjZZjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATklEQVQI12NgVDQUCU5zZWCoiBRgW8aQzcCQIMPAeIBBhYGB4R4DiwLDJiBjBgNnAPN3Bgb2Dwz1DIwLGoCYQZqBV0GAgUmA4RkDxzMGAOaYDdS9xl8QAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="m" style="vertical-align: 0px"/>-block return level <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALBAMAAACNJ7BwAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAv/t0SIudYN0yzxjzrzeTyLoAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABYSURBVAjXY2BgVGZxYICAsIo0KIthAkMAjMkwGc5id4AzLRnYtl03nGrLwMCcFd4Z8IStgYeBYTP3mQKWBq6CPRA1bAk8GwwhTC6HPQzLIUZyMPgypDkAAFy4ETi8dVXAAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="z_m" style="vertical-align: -3px"/>: it is computed as a particular quantile of the
GEV model estimated using the log-likelihood function. We just have to use the maximum log-likelihood
estimator built in the previous section.
The return level of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAQBAMAAAARyMmYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/NI6b9gnft0GDLPi90j4oowAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAl0lEQVQI12NgYBD6zMDAwPI1gQEM2DuBxJQABijPnYGBKx8qxbDtKAMDp/0CKO+CHAODVREDjHeJgWHCUzgvn4GToRPK4Zqwf8Fm7l9QHucCfoMJvApQHi8Dx7QFPAfgPBZJBo4LXIWZUUCeLQOPA8P+Dbz8BpIMDIxKF9gNGP2DGewYDjMgQDlDAxLvMNvpBATvAddZBgCleCFZpSVfTwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="M_n" style="vertical-align: -3px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUBAMAAACKWYuOAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr+kyi0gYYL/znft0z90qVouCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoElEQVQY02NgAAJGRRMDBjgIY29lIAZIfgUSTD8KIDyuPUDiUANUjkuLgYGtHirFYH6DgYEnPgHKc5AD2rESZoqDJwPDgRdwXj0DD8MeKIftgH2CKfM3KI8ngT/gAMsEKI+Fgft4Au8FOI9JhoHbgW1hTRuQF8LAq8Bgb8DCHyAD9NtMB64ARv1WhjiGq0iOX8WwAYl3lf1yAYL3gO0KAwDrhCCaMzdZ5gAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="\tilde{M}_n" style="vertical-align: -3px"/> have opposite values.</p>
<p>As the data are annual sea-levels, each block corresponds to one year: the 10-year return level
corresponds to <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAMBAMAAADBtrOrAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi50Yz0h0MmD76d3zv6/wjZZjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQY02NgwAY4lgKx4guscgzsql8ZGKIYuAqwSzMAZbcxMF3ALfuVgWMCA6OioUhwmiuGLOt3BtbPDBWRAmzLGLJBQldcgMAPKsvxHaQgQYaB8QCDCja9QAUM9xhYFBg2Yciyf2Vg+8zAMIOBM4D5O6arfjCwTWBg/8BQz8C4oAHdXoaNDEwOQAkGaQZeBQFUvT8YGLpBocEkwPCMgeMZihzzk19PGdjUXjAAAGeeMN863F3jAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="m=10" style="vertical-align: 0px"/> and the 100-year return level corresponds to <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAAMBAMAAADL6h35AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi50Yz0h0MmD76d3zv6/wjZZjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA5UlEQVQY02NgwAY4lgKx4gsGhia5BqwKGNhVvzIwRDFwFbAuYFjOgAMAlWxjYLrAncCgi0fJVwaOCfwBDJ0MDIyKhiLBaa4YSli/M7B+ji9giDdgqIgUYFvGkA0Sv+ICBH5QJRxAJd/7gUoKGBJkGBgPMKhgM4XjO1AeqIrhHgOLAsMmDCXsXxnYPtcHMOQbMDDMYOAMYP6O6dwfDGwT+BsYMoFh8IGhnoFxQQO6Wxg2MjA5cAuAnMC4gEGagVdBANWUHwwM3cCg49gACjomAYZnDBzPUBQwP/n1lIFNDRgBSXkNDACL8D8ZdxoITQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="m=100" style="vertical-align: 0px"/>.</p>
<p>The method provides the asymptotic distribution of the estimator <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQBAMAAADkNkIoAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAGN2/Mp2L+3RIYM/zr1Vl00IAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABjSURBVAjXY2BgEBJggAETAxiLlUGMAS9gruCcAGWmLgqFiTowJMBVeMBZXBPgzBYGVtFbzW69DAwc0VkqCS9ZFXgYGCQYzyzgVOBeIAO1O4BHoBnC5J4gw7ALYiQTw1yG0AkArPMQi/vfPdgAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="\hat{z}_m" style="vertical-align: -3px"/> of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAQBAMAAAARyMmYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/NI6b9gnft0GDLPi90j4oowAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAl0lEQVQI12NgYBD6zMDAwPI1gQEM2DuBxJQABijPnYGBKx8qxbDtKAMDp/0CKO+CHAODVREDjHeJgWHCUzgvn4GToRPK4Zqwf8Fm7l9QHucCfoMJvApQHi8Dx7QFPAfgPBZJBo4LXIWZUUCeLQOPA8P+Dbz8BpIMDIxKF9gNGP2DGewYDjMgQDlDAxLvMNvpBATvAddZBgCleCFZpSVfTwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="M_n" style="vertical-align: -3px"/>
which mean is the return-level estimate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zm_10</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildReturnLevelEstimator</span><span class="p">(</span><span class="n">result_LL</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">return_level_10</span> <span class="o">=</span> <span class="n">zm_10</span><span class="o">.</span><span class="n">getMean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum log-likelihood function : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10-year return level=</span><span class="si">{</span><span class="n">return_level_10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">return_level_ci10</span> <span class="o">=</span> <span class="n">zm_10</span><span class="o">.</span><span class="n">computeBilateralConfidenceInterval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CI=</span><span class="si">{</span><span class="n">return_level_ci10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Maximum log-likelihood function :
10-year return level=[-234.2]
CI=[-235.552, -232.849]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zm_100</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildReturnLevelEstimator</span><span class="p">(</span><span class="n">result_LL</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
<span class="n">return_level_100</span> <span class="o">=</span> <span class="n">zm_100</span><span class="o">.</span><span class="n">getMean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;100-year return level=</span><span class="si">{</span><span class="n">return_level_100</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">return_level_ci100</span> <span class="o">=</span> <span class="n">zm_100</span><span class="o">.</span><span class="n">computeBilateralConfidenceInterval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CI=</span><span class="si">{</span><span class="n">return_level_ci100</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>100-year return level=[-232.4]
CI=[-235.071, -229.729]
</pre></div>
</div>
<p><strong>Return level estimate via the profile log-likelihood function of a stationary GEV</strong></p>
<p>We can estimate the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIBAMAAAACWGKkAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi50Yz0h0MmD76d3zv6/wjZZjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATklEQVQI12NgVDQUCU5zZWCoiBRgW8aQzcCQIMPAeIBBhYGB4R4DiwLDJiBjBgNnAPN3Bgb2Dwz1DIwLGoCYQZqBV0GAgUmA4RkDxzMGAOaYDdS9xl8QAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="m" style="vertical-align: 0px"/>-block return level <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALBAMAAACNJ7BwAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAv/t0SIudYN0yzxjzrzeTyLoAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABYSURBVAjXY2BgVGZxYICAsIo0KIthAkMAjMkwGc5id4AzLRnYtl03nGrLwMCcFd4Z8IStgYeBYTP3mQKWBq6CPRA1bAk8GwwhTC6HPQzLIUZyMPgypDkAAFy4ETi8dVXAAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="z_m" style="vertical-align: -3px"/> directly from the data using the profile
likelihood with respect to <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALBAMAAACNJ7BwAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAv/t0SIudYN0yzxjzrzeTyLoAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABYSURBVAjXY2BgVGZxYICAsIo0KIthAkMAjMkwGc5id4AzLRnYtl03nGrLwMCcFd4Z8IStgYeBYTP3mQKWBq6CPRA1bAk8GwwhTC6HPQzLIUZyMPgypDkAAFy4ETi8dVXAAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="z_m" style="vertical-align: -3px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_zm_10_PLL</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildReturnLevelProfileLikelihoodEstimator</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">zm_10_PLL</span> <span class="o">=</span> <span class="n">result_zm_10_PLL</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;10 years return level (profile)=</span><span class="si">{</span><span class="n">zm_10_PLL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>10 years return level (profile)=-234.20091228177077
</pre></div>
</div>
<p>We can get the confidence interval of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALBAMAAACNJ7BwAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAv/t0SIudYN0yzxjzrzeTyLoAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABYSURBVAjXY2BgVGZxYICAsIo0KIthAkMAjMkwGc5id4AzLRnYtl03nGrLwMCcFd4Z8IStgYeBYTP3mQKWBq6CPRA1bAk8GwwhTC6HPQzLIUZyMPgypDkAAFy4ETi8dVXAAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="z_m" style="vertical-align: -3px"/>:  once more, it appears to be a bit smaller
than the interval obtained from the log-likelihood function.
As for the confidence interval of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAARBAMAAAD9OpvVAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABLSURBVAjXY2BgYGQAASYTIMESVgEkJReABGaDCJ4nYMkM5wNA0vP6BqASBZAAL1i4HExqg0k5HRDJGJcIolj6NoAo5gtAgt1oAQMAGy8LVPWDKP0AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\xi" style="vertical-align: -4px"/>, dependeding on the order requested, the interval might
not be calculated.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_zm_10_PLL</span><span class="o">.</span><span class="n">setConfidenceLevel</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">return_level_ci10</span> <span class="o">=</span> <span class="n">result_zm_10_PLL</span><span class="o">.</span><span class="n">getParameterConfidenceInterval</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
    <span class="k">pass</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum profile log-likelihood function : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CI=</span><span class="si">{</span><span class="n">return_level_ci10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Maximum profile log-likelihood function :
CI=[-235.485, -232.301]
</pre></div>
</div>
<p>We can also plot the profile log-likelihood function and get the confidence interval, the optimal value
of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALBAMAAACNJ7BwAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAv/t0SIudYN0yzxjzrzeTyLoAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABYSURBVAjXY2BgVGZxYICAsIo0KIthAkMAjMkwGc5id4AzLRnYtl03nGrLwMCcFd4Z8IStgYeBYTP3mQKWBq6CPRA1bAk8GwwhTC6HPQzLIUZyMPgypDkAAFy4ETi8dVXAAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="z_m" style="vertical-align: -3px"/> and its confidence interval.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">result_zm_10_PLL</span><span class="o">.</span><span class="n">drawProfileLikelihoodFunction</span><span class="p">())</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_gev_racetime_004.png" srcset="../../_images/sphx_glr_plot_estimate_gev_racetime_004.png" alt="profile likelihood" class = "sphx-glr-single-img"/><p><strong>Non stationary GEV modeling via the log-likelihood function</strong></p>
<p>If we look at the data carefully, we see that the pattern of variation has not remained constant over
the observation period. There is an increase in the data through time.
We want to model this trend because a slight increase in extreme sea-levels might have
a significant impact on the safety of coastal flood defenses.</p>
<p>We still work on the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAQBAMAAAARyMmYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/NI6b9gnft0GDLPi90j4oowAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAl0lEQVQI12NgYBD6zMDAwPI1gQEM2DuBxJQABijPnYGBKx8qxbDtKAMDp/0CKO+CHAODVREDjHeJgWHCUzgvn4GToRPK4Zqwf8Fm7l9QHucCfoMJvApQHi8Dx7QFPAfgPBZJBo4LXIWZUUCeLQOPA8P+Dbz8BpIMDIxKF9gNGP2DGewYDjMgQDlDAxLvMNvpBATvAddZBgCleCFZpSVfTwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="M_n" style="vertical-align: -3px"/> variable.
First we need to get the time stamps (in years here).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timeStamps</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Then, we define the functional basis for each parameter of the GEV model. Even if we have
the possibility to affect a time-varying model to each of the 3 parameters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAATBAMAAADYAbjmAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABJElEQVQoz2NgYFRgwA7A4szY5RwYZEGUCnbZZwfYCoBUAFbJo+0XQDJgFRiAZSVIOwMDxwRsslwgJzkDaZDDHBh6IKLV//8vANHyBxjAUtxAin8C40ewJPPFGRD/cdxJBAozMEwFsr0Y2DaABSsYWCCO5FlcBNQrwHAUyH7MwHsBLLiGga0BzDgHIrgFGKSBVBgDdwKIy7mAgfcBWNaAAWIvyFU/GeRlBED+CACZBgTsBVBZVgEGlj8Mr9gZJgPFFzCYMYAYfGC3zWBgYEpg4AtOky1hOAVUfygJ6BMgg+UfyIhyoF0GDKxgSxkSYEEBZLj+cGBgaGQAYf4JGLIMZz+B9DEwzAV6FwTYYJIQRjIDL9ihCXlYZMteMtSAeRNwpA2gOADogzgrU6p94gAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(\mu, \sigma, \xi)" style="vertical-align: -5px"/>,
it is strongly recommended not to vary the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAARBAMAAAD9OpvVAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABLSURBVAjXY2BgYGQAASYTIMESVgEkJReABGaDCJ4nYMkM5wNA0vP6BqASBZAAL1i4HExqg0k5HRDJGJcIolj6NoAo5gtAgt1oAQMAGy8LVPWDKP0AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\xi" style="vertical-align: -4px"/> and to let it constant.</p>
<p>For numerical reasons, it is strongly recommended to normalize all the data as follows:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF0AAAAlBAMAAADSLvhcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v3RI3WCv8xidz4uAiZHKAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABYUlEQVQ4y2NgwAe4NzCQBNgPkKaeP4E09cmkKe9UmofMZX0aSEBDHQrvHsNNAuo/InN4FBii8SvnMAAR5SDwAOj5B4Tcz3kBmSdPMDKYHmxF4uUD4w8ekaCI4UFXz5WAHF9cAgwPYWxesCYHNPWsRwWQeIxT4+AuOgFOK3FEx4wCOK0wEauc9QE4rXAGEJsOBcBpheMCYaWM+v//GzBD04oBYfUsAsBExAVNKx9AIr53gQBnSklgAIaiEDStWBPj+AIGhiRoWlmNKvMfAwAdwDGBgWEXNK0Q4X4GFmAgMkPTigFh9zMwA8OSaQM4rTAWEGG+FCilBYDTCt8DIuOLERJR7LhSOFu9AKpANZiUxWlgMxpfBEx641R/Fj2nglIaXwKRBQUQgNzHSGRBQRCcCTUgRTn7A94LpKh/zsBLUjltx8BMSjnN+BFU9BAP2D4wHOcgRYMBtyYfKepbQlNew9gAg9FcgyM3uVIAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\tau(t) = \dfrac{t-c}{d}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><p>the <em>CenterReduce</em> method where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAAAlBAMAAACt/+qtAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIsyz6+d6RhI879g+90c0KzaAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABfUlEQVQ4y2NgwAA8lQwkA+bMnwxkgFFNA62pLUa6gbCmP2Dyft27d+9q//9iUPjJKkBIC0fI90gQLR8AIhvXT+B8wDKBWEdyQyxk28CWwIsk3IFf11qITwJYJhyxQYg+w6/JvgBMNfAxtCgQHbSMX7EIcl6AyCkK49DlfwAzr4WXgm11YnAFkltcgMAVVQXXDUyD+MB62AoYJHDYxPkPU4zfgIFRgYFfAU34Pwh8ADPjMDWdhYQR7iTCDAk+BiFIpMuByBAwez6Qi8NPfAYogSkOIos4BFSAvjVgUMZhkw8q1xxErGRj4mpgYA4UwuFAVohvLZgckDSJCUNoXEAaQjkorGgNDQ2NgCsOwlf+PQBTfQGw8IBpWqGAW1M7yNUcR/8bQJ0J17TJALem9+AIA2ZCriaI86xIyf3ckNDliVXGk7iTmlQmkFqs2MxVYHxAqiYBLQY2B5JLsK0MLAkka7oDSv+kVmofGMR5SNXEVMCwlYlUTWwKDFMl8CsBACvTXNqiQjZrAAAACnRFWHREZXB0aAAAAAANWZKdsQAAAABJRU5ErkJggg==" alt="c = \dfrac{1}{n} \sum_{i=1}^n t_i" style="vertical-align: -13px"/> is the mean time stamps
and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAAAsBAMAAAAOWp4OAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0yYPudz4t0GOmvv/MXNcn2AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC8klEQVRIx9WXS2gTQRjHv2Szz+aFVw8NEaTowUVEwVdWQYsgGG/ixRQELV4iiAURXPVgrSKxYmiR4uLBVy1GQRARuopSqwGLXuotIl5y0RoPvto4O7Ob7OyDHLJ76MBkvt2d/c3M933z3wmAX9nY7Kb4YuEihFNOhcTNhIOViuFwRRUg9ih4bkIGZmAheG7U+FlG3N0hcV+ExM0sL25ED4fLKR7c268mtC65PAb8xPahx9ls9klzCdSFeKk9iPeLBbRVL89hc0XDO32lmb84K25in9z7lo5k+HSrh49+TCHlhtPYjOXdj7fZtzSZNjfHFVjKUfe9dWUlnCNdih1U/Svxqs6n+zdY93pQXe014QqqVbJm1f30o/0iV8GNFoU7ra5jfukyixxYx1ZK7qDq4j93h1UoF/Ne3H4UdCMK3OD1jqp+RnH1yEPs3XPnQsfGZUAhGGCQ3QdDRmyGjIIDL5iqbivJgy5uzcN/vMrrkIKYwiFKBk7ST6+gGk/Tu++HE8tUsP/o8Y+BqAGr5ZrIb6wK+2kXTGskfVO2g8BL1z5H3F2mvRNtm2wfMn7htZHkycmR7/QO7lVMVadnZyUBGnkUVeSHGeca/hi/Zor3ApdR7P6VUgVT1W27j8oY8QaOGzyVSheoNaAJahaXhUmd9n8PyrHDNPcEfbkF1WcAnzkhSenQFxBkWE/s2Ker87RIJfLOQ0mcDLxZKLa5gwDla9hql63jIwDDflImNJzcCVNp1PqDarX6FtM24Vtv3K+v8eMyv4HRqRtklFu6FT6DG8WLrLskgPE/Jy2CULJfTxoIaW9TNv2BuQzW2HmXBCT8lX+tqepWWUeOtEuQvEv8sN24u8f75bP+34r3zvRtzeU8CfVro2W8+8j+3H3pKdyWR4aPB/nNfKjifcXsOACjQXLZIlZ1UajBkSC5fI0kVkJ3Sl2XZ4cGyUFWgUagZ53FApE6ECtKkOAmUfVLyBNqkNxp0hyFyKwWJPdDSH/dyt0j/gM8kvOfcndzDwAAAAp0RVh0RGVwdGgAAAAAD7ec/J0AAAAASUVORK5CYII=" alt="d = \sqrt{\dfrac{1}{n} \sum_{i=1}^n (t_i-c)^2}" style="vertical-align: -15px"/> is the standard deviation of the time stamps;</p></li>
<li><p>the <em>MinMax</em> method where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAPBAMAAABtkjCqAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIsyz6+d6RhI87/d+2Bkhg6oAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfklEQVQY02NgQAccDQzYAE8CVmH+CViF50IoRkVhZNGn5UFg2onBFUhucQECEIPhEFiUrYBBAsWQzwwcMkAbFFCN5rvAwCjOwGCP5kxWBwYGcwaG+UAPIJvNrtAIEuYyYFBGVs01IQEkzBwohGIMY6IBSBgbwCFshVWUL1YZAMihEzbYoV0iAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="c = t_1" style="vertical-align: -3px"/> is the initial time and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAAAQBAMAAACYUF7xAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0yYPudz4t0GOmvv/MXNcn2AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1UlEQVQoz2NgYGAQ+sxALGAJQOGuwlQBF2IrQBFXw1QKF2JqQBH/iKkULsRvgCzMGIChEibEljkVxeGn9zSg+wUmpMFQDiR5y0HgAKZzkFzIocBQhiKO6hyY0EoFBgbWBoZAFHFXuL1KINAAEZq5gYHB3oDxA4rS45gBABRiBiqVZ2BTcEB26w6uWTmet1CU7uCaAFLKyrD6AIpHHrJx8AucZEAVApvKcnPijQXI4tMmMwgxFDKgCYGUYgNpDBjRgEtpIUuxA7rSB9iVKnBVoAv5RBgAAEB8Mz3UMEgoAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="d = t_n-t_1" style="vertical-align: -3px"/> the final time;</p></li>
<li><p>the <em>None</em> method where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAMBAMAAAANL4lAAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIsyz6+d6RhI879g3fsNA6oDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAeUlEQVQY02NgQAfHVA9giDFwFjAUY4ryCjBkY4ryT2A4B6QYFYWRRecbMMxvYGBwYnAFcra4AAGIcd4AJMFWwCCBphYowa+Aaq79BAb5Bgb7BjTbDjDIAXUwMHAgm8urwJDCwMBlwKCMrJbnAsgXzIFCqGaIiR5gAACyVBdxJXqIQgAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="c = 0" style="vertical-align: 0px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAANBAMAAADGc1rlAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMASN0yYPudz4t0GOmvv40dxUsAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABqSURBVBjTY2BgYBB6zIAFsASgcL0FwBRbAbKgmRxElKkBRS0fRJTPAFOULXMqA6aoBkM5kOQtB4EDMFEOBYYyTLWsDQyBmKJ2BowPMEXlGNgUHDDMZWVYfQDNvUBFLDcn3liALLimbo8AAMrSFnMzhjXjAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="d = 1" style="vertical-align: 0px"/>: in that case, data are not normalized.</p></li>
</ul>
<p>We suppose that <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAMBAMAAABGh1qtAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAz2DdSDIY+3Tzr7/pi4mQ6v4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABJSURBVAjXY2BgVGAwYWBg4Atgewak1Bk4JgCphQzcG4DUCQbOBiD1lCEvJYGB6QnDcl4GBq6DHdmXGBh4QBIgbWBKHUwydIFJAEhtDOg0qsToAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\mu" style="vertical-align: -4px"/> is linear in time, and that the other parameters remain constant.</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIwAAABHBAMAAAAnwbJ6AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADEklEQVRYw+2XS2jUQBjH//vIbnaT9HH1AYsIhVpwKcWLKAGRCvYQRRBRNOCDihb35E1ZfJSlatmTV9eLgqDsScVDrYogUmiol1IpBCnag4iHVqGXdSbptsmsmX5b91CkH2SSbPL/55tvJvPbAH6kXNa0odkQZTHvx6p429BosUE5PR8t+8LObNwTJQ7eNzhDtyJl40DChS5IWLq99WN7ee8ikYuSqQ7QbiIrdOEocLV+POXvlBzSdpQswfLsB+IdYRsHmivYGMDYyvWALJZDH9JA98RToCDYdH6EaBPbVvGymqzVCgFZu5X6hQy7sI9tP9mmdfLw7nV2HGiwie/M871m3UZQ1gW1jFPseBGBSniRtKAVB/Mhm4PAS3WmChNsmAOyh9CqGGAd5B26H7JhddDc0rif4YSfISvq2GlsYUfMPiD7gEwRF4EsL29BtNFzyngoG2bzdgCfmJ6ZBmSLuHLOZrXSnUHfZrU2WeAEBJsKlDLwhN3GRnlVFl/AYwO6jYzpQsmHsjmMVJ9gk6zirIkU60WaDfaqLPumdGkKbUWo8xYMJ2QzPD1qCzbqUOkrmyQmzxMBme7NQMWfdwk7ZONfCtt47ZyyPKVXZO3+e7bHa4+Ik5jfWvZPLtSrzqqbq68NK7Iu//yk1z4PuSgmb7uvWYHfjvHmTG0JgmzEP4/zDhhmyEb9yzolvLsNMv5IpenVb72yzfhPYp3UFINOTWnQqSmNtalJCQI1KUGg5hphPKj9plBzjdh6fj9k1Lxxx6Ykk0cPZNQsxCj9Spu4CRk1Ld0k2BwHXkFKzR+U0vR4PZFQM7WLUps0YkXIqAktT7BJzs+F8CdSU80bZfL0i6Zm3NUq9GkcTc3ZmSbehmhqNhVUam7ibzM2JjXjraFm9lYrqJl897kV1OyyWkLN6y2hZmrBW5H/lZrYe8iWfmvGaDb9210ZNfGdNlD8uRJqKnfpf9ck1DQuk2xmfehFUnOYZvOMNxJqFmk2ux9Jqdk2+80hvZiTvdJvTV5+0lC9dqXfmi8cmo/a0QpqGiPWRqHmHxAk+vcyuq37AAAACnRFWHREZXB0aAD/////+ZjB7wAAAABJRU5ErkJggg==" alt="\begin{align*}
  \mu(t) &amp; = \beta_1 + \beta_2\tau(t) \\
  \sigma(t) &amp; = \beta_3 \\
  \xi(t) &amp; = \beta_4
\end{align*}"/></p>
</div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constant</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;1.0&quot;</span><span class="p">])</span>
<span class="n">basis_lin</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Basis</span><span class="p">([</span><span class="n">constant</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])])</span>
<span class="n">basis_cst</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Basis</span><span class="p">([</span><span class="n">constant</span><span class="p">])</span>
<span class="c1"># basis for mu, sigma, xi</span>
<span class="n">basis_coll</span> <span class="o">=</span> <span class="p">[</span><span class="n">basis_lin</span><span class="p">,</span> <span class="n">basis_cst</span><span class="p">,</span> <span class="n">basis_cst</span><span class="p">]</span>
</pre></div>
</div>
<p>We can now estimate the list of coefficients <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI8AAAATBAMAAABb6UOYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASM/p3Ri/i/tgMq/znXRXs4/UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACKUlEQVQ4y5VUMWsUQRT+9i67d7d3ux4qQdJ4JphOWNNdLIxgCrsrNCGQIoLBIpychQRE08m1iV2KyBolIKhsJVZyPyBFGhEtZMFIqoQggqJF8t7s7psd7ywy3N7d9773vnnzzc4AA4a9g5ONNP/02LQZL7DYylcdmN2P9Sx5IgUzCjgL+GkKfeZaFENJ72BSi+aIDPgdBneB36ZQoLodWs2wB9zILUMTArii0oBldsT67irKrSzwCniS/TcIAR/YkBDVX4bQEHVbAtoS6MAR+w1CwFN6avbE1cAQKnNKYSzSQqNXdG2eEMAlw+7E9h/2fJQHx2ucUlmb0kLrZ3VtnhBwih7aP++v0dELekaAe/Zugq0QTrz3LgFM+M8WNQAaUE7RO1T9YQidUbag7X8TJ5wvO4Uo9QvtMi5BADwypkZCPaBomj2fpDRVa4lQcS0oTWW1TReXRaiJt4HyyDoEzvcMj9i5CG4vE6oCr+k76UgRb9JNVOBBIuSNw90OjY6KLVgLuFlnoU3qeRj2Neqz5V5ESswtQoB/i4Re0kszN379nzPqxfBnDz4q189R999X9knuAqwuUgJ3NPBtElqm6fvPstuAL9sXqw+p10OOKmIXjyDg0+Ou2rHNAbfCNPsL5QyrqBO5TufKR0JsYAkCYAU8NTfVN7bwnH8q7x9yulvnLo+OIhZVRGk5ggBsdeHQ0m8PEKrEcv1kC1AjW2YfuP+/Gy884Q1J+ceLU4l83nKEZwAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\vect{\beta} = (\beta_1, \beta_2, \beta_3, \beta_4)" style="vertical-align: -5px"/> using the log-likelihood of the data.
We test the 3 normalizing methods and both initial points in order to evaluate their impact on the results.
We can see that:</p>
<ul class="simple">
<li><p>both normalization methods lead to the same result for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAARBAMAAAAmgTH3AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGIt0neky3WD7v8+vSPPQYmj8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAb0lEQVQI12NgYGBUdmYAAyEG1gQww4GBvQFEszUwcAqAGEwMDEvAMkzcWw9AGBy9BWDGNQaGxYzmQIYCUA2zKYQRwZAKZBxgYHsAYvAuYBC/AGIwCxk7MoAZYK2pYIOBII+BIRdEc5xUYzCAuIUBALFVEFwUrEg2AAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\beta_1" style="vertical-align: -4px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAARBAMAAAAmgTH3AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGIt0neky3WD7v8+vSPPQYmj8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfUlEQVQI12NgYGBUdmYAAyEG1gQww4GBvQFEszUwcAqAGEwMDEvAMkzcWw9AGBy9BWDGNQaGxczNCxkYFIBqOBm2gBkRbAyxDAwHGNgeMKQ4MPAuYBC/wCCxkIFZyNgRqGU5AzNIpzmDHshgBoYWhjUMuWBDlQ4wGEDcwgAAVj0TUqxLphoAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\beta_3" style="vertical-align: -4px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARBAMAAADJQ1rJAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGIt0neky3WD7v8+vSPPQYmj8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAd0lEQVQI12NgYGBUdmaAACEG1gQIy4GBvQHMYGtg4BQAs5gYGJZAJJm4tx6Asjh6CyCsawwMixkYNgBZCiB1LAEQVgRDMoh1gIHtAYMikMW7gEH8ArMgkMUsZOzIwMwIYoH0O6lMAlsBBLxAsVwwKwsoZgB1GwMAmHIRv+BMxV0AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\beta_4" style="vertical-align: -4px"/>
(note that <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAARBAMAAAAmgTH3AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGIt0neky3WD7v8+vSPPQYmj8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfklEQVQI12NgYGBUdmYAAyEG1gQww4GBvQFEszUwcAqAGEwMDEvAMkzcWw9AGBy9BWDGNQaGxcw6CxgYFIBqUhj2gBkRVxnUGRgOMLA9YGA4w8C7gEH8AgPjQwZmIWNHBgbuCwzMYK2+bCCDGRg4GlgYckGM/P9/GAwgbmEAAJfFFUvOcc9bAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\beta_2" style="vertical-align: -4px"/> depends on the normalization function),</p></li>
<li><p>both initial points lead to the same result when the data have been normalized,</p></li>
<li><p>it is very important to normalize all the data: if not, the result strongly depends on the initial point
and it differs from the result obtained with normalized data. The results are not optimal in that case
since the associated log-likelihood are much smaller than those obtained with normalized data.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initiPoint_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">initiPoint_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Gumbel&quot;</span><span class="p">)</span>
<span class="n">initiPoint_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Static&quot;</span><span class="p">)</span>
<span class="n">normMethod_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">normMethod_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;MinMax&quot;</span><span class="p">)</span>
<span class="n">normMethod_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CenterReduce&quot;</span><span class="p">)</span>
<span class="n">normMethod_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;None&quot;</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span>
    <span class="s2">&quot;GeneralizedExtremeValueFactory-MaximumEvaluationNumber&quot;</span><span class="p">,</span> <span class="mi">1000000</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear mu(t) model: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">normMeth</span> <span class="ow">in</span> <span class="n">normMethod_list</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">initPoint</span> <span class="ow">in</span> <span class="n">initiPoint_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;normMeth, initPoint = &quot;</span><span class="p">,</span> <span class="n">normMeth</span><span class="p">,</span> <span class="n">initPoint</span><span class="p">)</span>
        <span class="c1"># The ot.Function() is the identity function.</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildTimeVarying</span><span class="p">(</span>
            <span class="n">sample</span><span class="p">,</span> <span class="n">timeStamps</span><span class="p">,</span> <span class="n">basis_coll</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Function</span><span class="p">(),</span> <span class="n">initPoint</span><span class="p">,</span> <span class="n">normMeth</span>
        <span class="p">)</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getOptimalParameter</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta1, beta2, beta3, beta4 = &quot;</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max log-likelihood =  &quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Linear mu(t) model:
normMeth, initPoint =  MinMax Gumbel
beta1, beta2, beta3, beta4 =  [-242.635,6.25764,2.73173,-0.201355]
Max log-likelihood =   -51.8940418474017
normMeth, initPoint =  MinMax Static
beta1, beta2, beta3, beta4 =  [-242.635,6.25777,2.73171,-0.201359]
Max log-likelihood =   -51.894041787764984
normMeth, initPoint =  CenterReduce Gumbel
beta1, beta2, beta3, beta4 =  [-239.506,1.94197,2.73166,-0.201303]
Max log-likelihood =   -51.89404131401922
normMeth, initPoint =  CenterReduce Static
beta1, beta2, beta3, beta4 =  [-239.506,1.94201,2.73163,-0.201294]
Max log-likelihood =   -51.894041292150014
normMeth, initPoint =  None Gumbel
beta1, beta2, beta3, beta4 =  [-239.942,-0.000578171,2.80599,0.0958746]
Max log-likelihood =   -61.18805537945545
normMeth, initPoint =  None Static
beta1, beta2, beta3, beta4 =  [-239.26,1.15331e-06,3.6427,-0.469838]
Max log-likelihood =   -54.622262531545104
</pre></div>
</div>
<p>According to the previous results, we choose the <em>MinMax</em> normalization method and the <em>Gumbel</em> initial point.
This initial point is cheaper than the <em>Static</em> one as it requires no optimization computation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_NonStatLL</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildTimeVarying</span><span class="p">(</span>
    <span class="n">sample</span><span class="p">,</span> <span class="n">timeStamps</span><span class="p">,</span> <span class="n">basis_coll</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Function</span><span class="p">(),</span> <span class="s2">&quot;Gumbel&quot;</span><span class="p">,</span> <span class="s2">&quot;MinMax&quot;</span>
<span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">getOptimalParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear mu(t) model : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta1, beta2, beta3, beta_4 = &quot;</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mu(t) = </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> * tau&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sigma = = </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;xi = = </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Linear mu(t) model :
beta1, beta2, beta3, beta_4 =  [-242.635,6.25764,2.73173,-0.201355]
mu(t) = -242.6347 + 6.2576 * tau
sigma = = 2.7317
xi = = -0.2014
</pre></div>
</div>
<p>You can get the expression of the normalizing function <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAATCAMAAAAXrfu1AAAAM1BMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxgEwMAAAAEHRSTlMAGN2dSPtgr+mLMs9087/hcIBw2gAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAO1JREFUOMudlEcSwyAMRQXGFCEI9z9tTLU80SJYCwYYva9CAdg1dczZAa8s3lJ5TtQGf9ibodD39E4unjNjUYxUqpzWDNoZR3U0p+RpsiigERhjr4ZY570LPw26XO8p+lKtQg28mbbUQYKa+rCMQD0ypOE4K2kDigJAcbShlptnLgMczHm5WNaC8tHMiv8pyPStxaRLwEWQM8jsdK0bZ9NLWEwV8gEUCQKB345MjGBMXSYD4u1+ZHPOPvnWl8lgdaKDUDhwy8UwrRAt8GRC2H5KGB/XSu0/Rs481f5NgV3xrN78B5bWOZl3Pwo+Jl8c9QVhoq/19gAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="t \mapsto \tau(t)" style="vertical-align: -5px"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">normFunc</span> <span class="o">=</span> <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">getNormalizationFunction</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function tau(t): &quot;</span><span class="p">,</span> <span class="n">normFunc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c = &quot;</span><span class="p">,</span> <span class="n">normFunc</span><span class="o">.</span><span class="n">getEvaluation</span><span class="p">()</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span><span class="o">.</span><span class="n">getCenter</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1/d = &quot;</span><span class="p">,</span> <span class="n">normFunc</span><span class="o">.</span><span class="n">getEvaluation</span><span class="p">()</span><span class="o">.</span><span class="n">getImplementation</span><span class="p">()</span><span class="o">.</span><span class="n">getLinear</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Function tau(t):  class=LinearFunction name=Unnamed implementation=class=LinearEvaluation name=Unnamed center=[1972] constant=[0] linear=[[ 0.05 ]]
c =  1972.0
1/d =  0.05
</pre></div>
</div>
<p>You can get the function <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAATCAMAAAD4b5CLAAAAM1BMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxgEwMAAAAEHRSTlMAGN2dSPtgr+mLMs9087/hcIBw2gAAAAlwSFlzAAAOxAAADsQBlSsOGwAAARJJREFUOMudk1mSxSAIRXFKcGz2v9oWR9Jl1es8PyyMnCteCcDrocyMzBssRI0DiFurzEB9FLCugKXUDr42lHzf1h+rUS7XmTTHKKGxIHuCZGGR6mGKnDi2Q3fqFR7rLkKNqOrZpqADCOiqplw34u3hr0k1dYeecM2N3FBban+imvwYSJRzJuKy8sicl2lTOCpAitMKIvbf8VuE6d2AXM25hA30o8UgXDbAtMH2bwvKVeGOcK6hmGUk5xfiteq3WBDvoAeVDgp+dwkXoygvREC8zBaOjS7USs2Lrt8cmzkTCpyVTAqHfrikWtFYhq2mHT0h79//mUH2DGj1XuEBPeX+XYRo9/JNCdWhtJ7LwncjPIJfZNsHX9q/P1wAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="t \mapsto \vect{\theta}(t)" style="vertical-align: -5px"/> where
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK8AAAATBAMAAAAUtEBIAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACi0lEQVQ4y31VPYgTQRh9m5/NZpNNQmJxZbDTxhPUIlyxiIWKyLZXHKQ4OStdLUTEIiBYXOMqXKGIbKOeWiSVhRYGxAPxhCCC2MgpgggWJ6d3nqLx+2Zud2fGnyE78817L2++b3YmAWRzA+qKMJpA/0Xf5C74Q15M0eYeGnOC6BnGOS0w6DZ3i+l0pKgEap+1N4EZQmJcN4xnlMCki+R0F+VhMv/YzVQCvT3AGuAD+QAFw9hXApPmyd5MMjvVU1SM7hq6G2KJehe1SPNN0/kbzemvU6Jy5p3SVIS649jeQL4BzBHd1owZTQOT3k27GAIv5KwUaCpCq1/4UwLeHPgEhJpxiV/bCPtM+tl4HFLsvT86FBpq/S5UFYWF8cNH31AhboqeVXqc7dxWKGK03nC/azStNd+i/AaUIte+VdPFa6qK0PpPlDaxjeaf6TmnZczoK5QHBv0Yng/L50Upt1hg9uknqorQ/ipOhpilreE6H2jGhOIdnJ5Bn0F5ErbPi1JV0viElCcqQvshLgW4B9T4zeh7TCgOoRLptBXCWYE74EWR7HFbyhMVoXXf/SE3e3hHfjPb45KorX8rVmneB66f4iNutGVcHUIzodAJc3QECzEq3QDWpJYxod46PlQVuiksdxB5GLhPvwstWDsp0wCaSYumFw6SthihPN2QCyu3NkJt/9XF5wo9R4pjC3S2MA0sXAaWYZ+nKn7pJsuJhSWPfj7WjAktRAadXr6mHDp042h4uTZSVZ3Uo6OKFbTeMOjUWCbBZmyM418VlZVd0QnRzxvGE+JEqXQ5K0f8iDppEVcUlZNV7jFb7RrGXnTDoDNjvOZuKSni6VtFtaR4cMmW+Q+Cxn9oSxNoKhp/AyMys6C07XufAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\vect{\theta}(t) = (\mu(t), \sigma(t), \xi(t))" style="vertical-align: -5px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionTheta</span> <span class="o">=</span> <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">getParameterFunction</span><span class="p">()</span>
</pre></div>
</div>
<p>We get the asymptotic distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARBAMAAAAbE1CRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASM/p3Ri/i/tgMq/znXRXs4/UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAaklEQVQI1yWLuw1AYBhFj2fi1Si0JBK1WEDDEDoqI1hHTGKAvzCBGUQkhMYXbnFO7k0uQJjWQrvlEPVwgZOgSdNHvBN8qyhziNxC3bBC8IB8vB1mME60DeKZIMNVI2aTVYvsfJl+Db+6jy8HMBQvNG/OiAAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\vect{\beta}" style="vertical-align: -4px"/> to compute some confidence intervals of
the estimates, for example of order <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAQBAMAAABQPLQnAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABA0lEQVQoz2NgwABFngUgqlTLgMFuirYBpgLeBwyPgRTjA4bDDDY/FmMqYOAWYFAFUhwCDKEMhgzYAP8FhgogZV/A4AFVIaTsEoCs4r4Bw/0EoIoLDP4JRi7TGRjYxL4whAAlolYBwUogo94ApIiBX4BhvkESA88FBnb2BoZZaGYAFTGwLGCIBxrFuoGBgWkBw1JkFUDj5YFSDJ4u/kCSqQHs9kYUlxYwSEBYegwHGZg+AEUS2A8gu4PbgUELSLFfYHgODBiQLfcT+C4gm8G+AShhlcA3gSWAwY0hA+gkVUdl1AARkixguGHAq6QCdK5mMFBgCwMh8JmQAt4PhFTU/SSgAAA6dDzXMTrCXAAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="p = 0.95" style="vertical-align: -4px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dist_beta</span> <span class="o">=</span> <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">getParameterDistribution</span><span class="p">()</span>
<span class="n">condifence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">beta</span><span class="o">.</span><span class="n">getSize</span><span class="p">()):</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">dist_beta</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">computeQuantile</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">condifence_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)[</span>
        <span class="mi">0</span>
    <span class="p">]</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">dist_beta</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">computeQuantile</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">condifence_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)[</span>
        <span class="mi">0</span>
    <span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Conf interval for beta_&quot;</span>
        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot; = [&quot;</span>
        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;; &quot;</span>
        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Conf interval for beta_1 = [-245.03004510773928; -240.23928366420085]
Conf interval for beta_2 = [1.4859157842994541; 11.029371024769661]
Conf interval for beta_3 = [1.4710369824709508; 3.992420337465557]
Conf interval for beta_4 = [-0.711193527267937; 0.3084838313738077]
</pre></div>
</div>
<p>In order to compare different modelings, we get the optimal log-likelihood of the data for both stationary
and non stationary models. The difference is significant enough to be in favor of the non stationary model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max log-likelihood: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stationary model =  &quot;</span><span class="p">,</span> <span class="n">result_LL</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non stationary linear mu(t) model =  &quot;</span><span class="p">,</span> <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Max log-likelihood:
Stationary model =   -54.622265554594776
Non stationary linear mu(t) model =   -51.8940418474017
</pre></div>
</div>
<p>We can draw the mean function  <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAATCAMAAAByQAnKAAAAM1BMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxgEwMAAAAEHRSTlMAGN2dSPtgr+mLMs9087/hcIBw2gAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAd9JREFUSMe9lotuwyAMRQ0EjHmN///aEbAJZJHWblKR2kBq7sEPrAL8YZRI75grI7MxoYivbCPvo43RV6/HizgeLhbEA5pGwFzbvGirIemau7zLtqzm5wHKIqDUL9xgumHQGxb1uS+V3Be1vzt8+7LMSWm46GBSEl0C2ryGBeUXLPICV+zp+jZvg+0GxV8C9XhKiLpjyQFd2FAdG17YtoXU+RMtmWQHmYJJBA775OFR7tjoZH3uKnZdDazp5OZS94nC8HI8mOLi2OLQeySAW/Kb+Y5Vxm9Y72dcBCs5AKrhinHHXRQrApqeUHwuwWadccNWvQUHK2KssqpndbNsZmmJ9RQIj1hIUa1BVnnD5jv28q8ZWMksBA6BUKwaAm5Jbf3Sy6j+XlILNg4vCG1FxdjEH3Ct3vgMxxCZlMxYjPDsbTF7SalZnOeOJMcftSWXhovdRrcV+kWR3HoClR6wZH7cWzAXFqL0ju3eJscxnxdhuDkpgs0H3HrmYyX31qbTUvCx5z5sWJVHDEKdefa9QoQSNAskk8LDvXVm7cmFe3LYezIaSuDOnmzPnozRSqz11DT9qEIhul/U18dbu8Jm3fv4J7BM2s7wCWxY2mxRH8OCS7NKDvgH9s1/FxD2CcXyDawuD1cBVBuiAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="t \mapsto \Expect{\mbox{GEV}(t)}" style="vertical-align: -5px"/>. Be careful, it is not the function
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAATCAMAAAD4b5CLAAAAM1BMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxgEwMAAAAEHRSTlMAGN2dSPtgr+mLMs9087/hcIBw2gAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAQJJREFUOMudVNuywyAI9FYFgx7//2tPsFJ0amaS8uDgZRdYSIx5bNaL581vdihXFcc+IfBRQYTvM/coG5hBY9PCrtqLxCTsG5SI1/DavQx1z+CymUDxFCUmgIRfIp1PF/W4eMdhO1JBfetwi4ozXTsj28aFlfFSipHbXVw6PlJEDkUMzqCUPQc7biXUn5usgZwnzqeyMgGUkq3YcbvLoWqTgSUvvNiilKIDoLG0YUD/JUOwQzoF8bYEsx30iS1y89PLsHrQxRFQ5lfkKW/6Hie2BAeRrcgt9T20gBBvDjKpn49lvm5+Ui1fgFa6a4vL2Odp3OvNFCithJ+aMPz4i8mL8w8VmQYpiJ6cUgAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="t \mapsto \mu(t)" style="vertical-align: -5px"/>. As a matter of fact, the mean is defined for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAARBAMAAACyZ5gFAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAACQSURBVBjTY2BgYGTABphMUPmiDkCCJawCRXC1H0hUcgFcgOsAiOQDic6GC7LcgIvyPIEJMmeDBSFqM5whnNPJUFmwqOf1DSD2iisMSKIsCmAm40QGZFFeKBtVbTmMc+gykqg2XCd7NlRUgIFBTgcuzHgJ5JpD94IcGBjjEtH8BvFR3wZsYcZ8AYsgu9ECDDEANEkeUo89i3cAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\xi &lt;1" style="vertical-align: -4px"/> only and in that case,
for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAARCAMAAACcoM4HAAAAOVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACXHtMAAAAEnRSTlMAYK90SOndi7/7Mp0Yz+Px5e1JtuFcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAvUlEQVQoz41S2xbCIAxraaEMhlP+/2OFimPspnnIgdKEcAGoQDggRDiFId6X0rwOMYppZmyd+F0n9wLbQjaoaArHfVw3dVQoqnQ6SYWmjzOrX6E5860p56BcK84zrSs+VTyWQs0YW6vylCRemrYmFbA5Jt0qgwakGiCdJB1mud4plWOJDPWa9fnSwN/dXO2IxdHEH6aArj0BZjOPSyQ7KUX6PCza7IbvYuEa7PMmhQjcgdJ/piBk+odBump7A9cnBSXsRwS1AAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\xi \neq 0" style="vertical-align: -4px"/>, we have:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUcAAAArBAMAAAAZJlfNAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi+nP+90ynRhg86+/dEjvkDqOAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEhklEQVRYw82YT2gUVxzHv7ubHWd2s+6qh1qKsrUXoVXSVkGrxUCgeHOFqrkU1qSeInTpRTxEBg9WguJi2lMRPdhSKG3SCLV0G5NCD9KUEtGoLRSG0ENBDxJqqqZof7/3ZrLvvZkde1B4v5CXx/x+83uf/b0/35cFnpe5DWpWwG7LCdJpuyGPEqKPa3ZDVoF8A1mrGUsVoBygOGszZL4O/Al4PZbyZcae/I0u4NMN3wC9lkLuPHEAKFBnL/3es7SQNZwFBqi3SL+77YTsCjAHzNN65Kn+wk7I94EZYAQo8qaxdE2eFXNMGydbOf2MIbtfT37+ETckw2vG07zadCNHh2PWRyFowKlFMg610yFNktTzK6tf6XtjoSaldnTmShFDYzM/vFube9SAd5GUV5xzpxB2TFv2KrZy+BhfLWZRGq4jUxEyPtRqtS6Hem5YU0mTJPWc3Wn04JCELPaj9DMwReNU0Ue+P2gsynFSyEcSZNsbM0fG530p47t894boeJuNwMlASWNIPQfzY4Z0qwJygh5/LyAxHrZCew8IIU6CbHvZfM3XL9rBUMYp3Yo6dZxjj/UU83unlTS61MvgqoDMNCsM6TyE2JRTcLEWH1TEcuCPRpGTyZBtL9uLmu+waK+GMk6QTlOUXIf03tHSmFLPwZMCMtcU66a7V94Cp2j9+shWkSH53U9zT89HkyHb3jikx+NlglDGeWIC7hiQXQ0tjSn1HDzKkNs+lJBZnjWX8x3n9IsoimPOm3i1wgeK8fp25APFG4cEEzlyu0tIGadDngm0QcwT67F8y2l89qWELNekY6q1i/8s4SC1F6gQfOmSkN1vsonDaBFnfMWbALlshQiyEIfM/3pbHcSUeg4ui+kekZCFCFKUEFt4STpU3TKVpMs3KkmS97vqTYMciCAH4pAr+17Q0uxOqKQvN46AzNEHemnPd5SvRD843xwXZxE+5hqYkCR5v6heLvIGWeQnhrGMS8j5ZchP9pHxJekOtEGE1Hvs3FeJggsC0uWTPocSX1p+kvky9AG2E7tL4JfkutAhs7P4SvWmVXIkghyJV5Kzqmk6rUmKOyK29VZ68pbM9xvV6l/Il152ZyPI9pos190HfyneNMiUjSMESU3TGfLUewIytw2OhHQ/J8cSR20EvqY6HzIreT4o9lYUbxyyLesk4xKSO3iorZqGPohT0yE5mB6vfo20e3+o3ZfXeRjaM9Pack+eXsAwcOsmsMqEnHj79o9NxatDNjVZJxkfGtvhi457aeGKuv+WfG2QjKawMniV8b983AaXNU6H3GR4dUhNjyMZVzrKve5+U02T9+MI/U+FlG9xdn2ARcPLdjJZj5Vh+uMD3P1HTTPY8aaSBumIy1O3b0B6vYY3RY8jGVc7il1X01xNuOj6T4XEOW7Wm/fJ0rjhTdHjUMa1TtvWfaukEVJv2Pr/cTN3QhleM53mTdVjJaKePoiT4Ks/py8vDD220kw9ttJMPbbSTD228msWU49tNFOPrTRTjy39nkXXY0tN12Nb7XonWbfIND222pxnJ7z/AfAPVdte7cgmAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\Expect{\mbox{GEV}(t)} = \mu(t) + \dfrac{\sigma(t)}{\xi(t)} (\Gamma(1-\xi(t))-1)"/></p>
</div><p>and for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAARBAMAAABZUCMGAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAACXSURBVBjTY2BgYGTABphMULiM2xWBJEtYBYqoKwPrAgYGyQWoWpMZuBsYGGajGfiEgXECA88TVEGWVwwsbxgYMpwPADkcd0FAAWjZK5AEg+f1DWhqQRIKqCZwPWFgfsPAi+78hwzMExjKIWy4uQzpDNwXGLTR1YqBfCGngybKvBnoY8a4RGyBw9K3AZsw8wUsguxGCzDEAK63JCHGeeidAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\xi = 0" style="vertical-align: -4px"/>, we have:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMsAAAATBAMAAADMuORCAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi+nP+90ynRhg86+/dEjvkDqOAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC8klEQVQ4y4WVTWgTQRTH/5tN1k0226ztRREl1ougQtSKrSgGeileGkFqL0L86KmCwYPiobJ40FIqButFitSDiiDaWA+KVVvBgxgP8VC/QFjFgycpIkWtqO/NbLrjbrQvZGZn/jP7m/fmzSzgW3ojGtoZLkpAS+V/atRM7l2y0Gxe07npSwHQ6Xmk+shC/3j1wZ7CzI8SklemgRwPGob/ELYFNWK6YE3Xm0Yphz6JsXphPwOmgKYsOkl7R+spA4OwncaYQI3YCYK4eKFizKzATFDzvsCg4peIUbUXyDbGBCqbq0rUlyiJAXWMVnYYY3yn5hBjTCzDEUcEnZfzC3jYGBOobMsVhT3MeLBqAUYvi1im8zKkU7RzLmJZaEWghyJI/SONMYEaxiRo7kcgmVvAtB+VmBj7bjLmFD1oc7CoyiM5sc5BPILpQMJTVAWjjf/+yl2jrbd5vrXLQ40wV29ITKYgh01N7uRqHvupvEwLY/8lJr2ZTaT2HM65iqpgtp+m7UrRw276z2LraNZ2OWhDEpOqY4QbaOOtMcjDDPkfd0PeJPN4q6oBRivgPHBArATosj1c1PwUEBid1rai+x5hbPphrFwRmY0LpKbCGCuH56rKjrYKR+MeZoAPYiXAdYPAnwXG5NOqw2b6E5nQxI93EN0k9B1qR/YmVsNNVQ28OQRURcZaObG39DJHnhscFym2hbq2ScwbGvUTcthqs1bHBHuTKZrfPilqgKGIdQlyzDnrY2oSM7xPYPR2GBJjXiNhnietBW6Rr31hb8Y8K+8oaoCJQ6fXxlykvBIM3m+LYtq8nu60Hv9Ou7syif7u6mTbrDwUwADw6iWwNIyZ2PH6cVlRA0zTwEm+hmqwB4oiXsoF6l91UTsoq94wZkNIDR9PQw5PcA6mF8eIcWLS35i5kMo2qA7oDdbxfnGMIa7ytBvCiGRV1YgdFuVTLo4tjsElLlaFvzd2JaRGLMmXpuaFP3v/+noaXNBJb5n+n9rAinWZ7Q/nVrdfpNH3CwAAAAp0RVh0RGVwdGgA/////o6f8XkAAAAASUVORK5CYII=" alt="\Expect{\mbox{GEV}(t)} = \mu(t) + \sigma(t)\gamma"/></p>
</div><p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAr/vzSHTPnWDpGIsyv1Va0pQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA7SURBVAjXY2AQMmFgZWCrkGSIYghh4GjYwHCAgWGLAwMQ7AYRDFvBpBSYLACTF0AEywYQyX4ATDIwAABn4wjJ8rnDPwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\gamma" style="vertical-align: -4px"/> is the Euler constant.</p>
<p>We can also draw the function <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEUAAAAUCAMAAADsgQBJAAAAM1BMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxgEwMAAAAEHRSTlMAGN2dSPtgr+mLMs9087/hcIBw2gAAAAlwSFlzAAAOxAAADsQBlSsOGwAAASRJREFUOMudVNGWxRAMVBSJ1Pr/r92gKc7V3fZ6UDQzSSZBqa/GZmRl1Pcjdr4ki+0tiXEdSNDO9Ouowgg8N9muMv8jQHHfgJ7KbPeVpU33LBrVAHQskvMhePgQjU0nIQxgp63oDqxbDUukGyg1Bx37z+M8lcTqhGv/FEUao6caoOh5Ane2c4Ms+UcPIwfJgKYa2HZ+AQ9m8fFGiyTOsTi1uZevZXQBC1sAtdGCBa4MKoEJ3PYJwIucHVi2h1XLS9EZNzbD3SsoCkROLFTBBIjFkgzhoifcwEiJKHPTW7bX/DU1BAECPO55zGeSpSAYpx58fg2h1CU6VXWZgDPlP09B6dwDqOU59LFKj0NBnwNJhatqdAVpX74HbogAPxZPX0l9q+MvRLsG52bAI0UAAAAKdEVYdERlcHRoAAAAAAbOQEQ5AAAAAElFTkSuQmCC" alt="t \mapsto q_p(t)" style="vertical-align: -6px"/> where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAUBAMAAAAaSvJBAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYsyv910z/tI6RivYPMEDvUQAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA90lEQVQY002QP0vDYBDGf0nIn6ZtDA5uQiaH0iGDUClCxcHFJQp2cQn9Anawu3uXjOJi506vS3Eq4ifI4Nhv4FJwspN3qdocPA/3/uB9uDv4q2YsZlErv8JnNXIob8OoRmbgxoQ74CWwV9DK/4mbwiO0xxK/f6wkgNX8HR5gyERJJLoWrbEyrpT0RV+iKUHOt5InyZAffDJIG2slS2hJquQ8Y81ezruaHCYLJa+cvCVTvwgNURHjZHgXd2Ujc0srxztIsWVQBthxYJzxdlAj1sEvu3BbkZ7aPdGR3KaanEvR6SZfat/WHe1iu+VH5bIqzu89b0ztTj+ecCmRK/7g9gAAAAp0RVh0RGVwdGgAAAAABs5ARDkAAAAASUVORK5CYII=" alt="q_p(t)" style="vertical-align: -6px"/> is the quantile of
order <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAMBAMAAACpRTGTAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAASElEQVQI12NgEFJ2CWBgE/vCEMLAzt7AMIuBgWkBw1IGBm4BhkYGBv4E9gMMDPcT+C4wMKg6KjMwMGxhAIHPIIL3A4is+wkkANf5DTCbGOVMAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="p" style="vertical-align: -4px"/> of the GEV distribution at time <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAMBAMAAACzedEdAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAGN2dSPtgr+mLMs908zTxv1QAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA4SURBVAjXY2BgFGBgYDJgYOBzYGBwZWBI76hkYNBkYGB4xcDAFsDAwL6BgYFjggwDr4MBA4/NAgB9KgZ4Ll8hGwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="t" style="vertical-align: 0px"/>.
Here, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAATBAMAAAB1gKBPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1UlEQVQY00WQIW/CYBCGH9q0tKUt/Qk4kqmJBUdSh0F0eogKBAsCFLpyWUKCmkehSKrQm0MgGn5Bg5qcoNO77yt0l9zlni/3vnf5oA67lBLSREs/5g1fhFLWDX+CWeLf0SmgG+NlNzYTGIERiVOPJ9rwcNrDUsYS+xdXZoaSP9DH2TCRvpJcwZZOzli0MssHHHEzXsETL6WvWExT8fOLmWLjyi7AT3HjEusR7+ttfibMcL4TggJfn2RF9VmprNfdQNdntV7Hi64HeK/ZULIg/v8QJbPgD3T7JWkKdpF7AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\mu(t)" style="vertical-align: -5px"/> is a linear function and the other parameters are constant, so the mean and the quantile
functions are also linear functions.</p>
<p>The graph confirms the increase of the annual maximum sea-levels through time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;Fatest annual race times - Linear $\mu(t)$&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;race time (m)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
<span class="p">)</span>
<span class="n">dataModified</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setIntegerXTick</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># data</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">dataModified</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="c1"># mean function</span>
<span class="n">meandata</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">getDistribution</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">getMean</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asPoint</span><span class="p">()</span>
<span class="p">]</span>
<span class="n">curve_meanPoints</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asPoint</span><span class="p">(),</span> <span class="n">meandata</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve_meanPoints</span><span class="p">)</span>
<span class="c1"># quantile function</span>
<span class="n">graphQuantile</span> <span class="o">=</span> <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">drawQuantileFunction</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">drawQuant</span> <span class="o">=</span> <span class="n">graphQuantile</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">drawQuant</span> <span class="o">=</span> <span class="n">graphQuantile</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">drawQuant</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">drawQuant</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;mean function&quot;</span><span class="p">,</span> <span class="s2">&quot;quantile 0.95  function&quot;</span><span class="p">])</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;bottomright&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_gev_racetime_005.png" srcset="../../_images/sphx_glr_plot_estimate_gev_racetime_005.png" alt="Fatest annual race times - Linear $\mu(t)$" class = "sphx-glr-single-img"/><p>At last, we can test the validity of the stationary model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwa+WpCZbxkyGB4JcH9g4GEwBnI3MNwPUWFga2CIYnjDwMC4gYFj0gMGLgWGMoYXDIzcDgzcQGN4FBi2MXgw3D8FVP+AgYHruwBI9sVEiPl8W4B6YxiQACfYZDjgq90AAKtuJvyo4mSZAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0" style="vertical-align: -3px"/>
relative to the model with time varying parameters  <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAn0lEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwbGOyDuW4YMhkcC3B8YeG+CuBsY7oeoMLABzfME8hg3MHBMesDApQDmMnI7MHADjeGBcO+fAqp4wMDA9V0AxH0xEWI+3xaIXiTghMJj3WECAMpiIvj1y0x9AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_1" style="vertical-align: -3px"/>. The
model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwa+WpCZbxkyGB4JcH9g4GEwBnI3MNwPUWFga2CIYnjDwMC4gYFj0gMGLgWGMoYXDIzcDgzcQGN4FBi2MXgw3D8FVP+AgYHruwBI9sVEiPl8W4B6YxiQACfYZDjgq90AAKtuJvyo4mSZAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0" style="vertical-align: -3px"/> is parametrized by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAATBAMAAAD185dcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABZklEQVQoz4WSvUoDQRSFzyTZ3UzMyjYSwWYVtbAKiH0KSwULGxuZBKM2wlQJNrKCpcVCtFIheYP4BmkEFYSYwsIqtZWP4L2zZidsiizzs9/cM3PP/AAixNwvx02eqmht2tFKQ2VBDKlZZ4QTT0JC4whZOKN6QDVEsTaV5gZZcABXA7KGUjCJ3QE9ZGFRoUg5PWCUxjT8cAYKVZSo8/I7YxvbPsYsdLHAwsJeZGO7r5iFX9xT+wZ8ifNkpBzDVycXgQVzgD28GCcYuc1ESH79sJsPLWCD/p6xkggPzdJJzKnFzsCCbBqPvJkxZH8iXAQeINemwFsyQidAeYjlAQs75OwD4hZiP7BQJ6GMkFNwK6erYOE7eai3GqTwIwuKhJ6GrMI1aTi1MgVu5PVTyLW3NIo0+Zotg82YgOZ7CP1xCuCD6VD3hEdzST+XvLQ0221fwYL81vhkhUqfn4t/G1nwzIx4/guXwB+C3k3RNLuI7wAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(\beta_1, \beta_3, \beta_4)" style="vertical-align: -5px"/> and the model
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAn0lEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwbGOyDuW4YMhkcC3B8YeG+CuBsY7oeoMLABzfME8hg3MHBMesDApQDmMnI7MHADjeGBcO+fAqp4wMDA9V0AxH0xEWI+3xaIXiTghMJj3WECAMpiIvj1y0x9AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_1" style="vertical-align: -3px"/> is parametrized by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAATBAMAAABhFT6uAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABrElEQVQ4y5WTPUvDUBSG3/QjbdpG41ShCFFEcauIm0PBjhUydHGRWPxahOrQIohUcHQI+IFQCzp17U/oIqggSAfnTA6Cv6Gec29zUzBLQ3PL0/O8uefe2wCajcku4cfp1hpL4a/5mhsNI2uOh0WuIempWh3biISRpddpcMSk6VJQiwFXiITAcmTSKCFjBbVb4BlRoKxvIE2TpoCBEusw7UhQ1iaQYY6v+6G4toNIUBZFssyJSisUy6+IBGVNA3f09QZ8aUeylvNguoe/Y7B3LNfMFlAEr+5FdI+Bvq+6N1fsuK/AforbozXSumK0gVkLBclVMakUkxUn1VJQ8pL9IFXFvSPWxbvhw+gFqSmgTaMfgrEgK8I6kamkhdwnZvucuqEFfEC7BgpWCNqWZaxCWvoMpR7o9F3o+YN5sS3v1MRuo0b6xjiYrVwX0tI1SjXpxIvQRQPcoSs+9Ki+p0BvpXqsCGv5lPKX4DslUm2Z4r8myvw6jCBhmz5HpJVzeB6gg0fGxM8Z1wzeL2M49BWgeSGeICx0ujD5+BKueoOCPv5D0Dpf52L0JnyXyf8DP0JjcXDrUsMAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="(\beta_1, \beta_2, \beta_3, \beta_4)" style="vertical-align: -5px"/>: so we have
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAQBAMAAAB3kjXPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABC0lEQVQoz2NgYGAQEgASDMwODJgATco+AETGY1GILpVfACRYOrGpRJNKWgAkOL/BpYVzzpy5gFVqWwOQOPsdxmU+K8CAXYo1+AsDA1vhX5jsbYTlaFLcLJ8ZGKpY/0G5jAcQKtGk2Bi6GHgnMH9k4KsFuZ+1AKESLsV4B8R9y5DB8EiA+wMDD4MxkMsegFAJl+K9CeJuYLgfosLA1sAQxfAGzUy4FIMnyF0bGDgmPWDgUmAoY3iB6k6EFEglI7cDAzfQyTwKDNsYPFD8jiQFUnn/FFDsAQMD13cBiJkMzEeh4YkkBVL5YiJEmG8L0J0x8DgyYECRArsTATjBfscOnFB4fLUbcClk3WECALN6VVL+VljEAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0 \subset \mathcal{M}_1" style="vertical-align: -3px"/>.</p>
<p>We use the Likelihood Ratio test. The null hypothesis is the stationary model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwa+WpCZbxkyGB4JcH9g4GEwBnI3MNwPUWFga2CIYnjDwMC4gYFj0gMGLgWGMoYXDIzcDgzcQGN4FBi2MXgw3D8FVP+AgYHruwBI9sVEiPl8W4B6YxiQACfYZDjgq90AAKtuJvyo4mSZAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0" style="vertical-align: -3px"/>.
The Type I error <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgYFR2ZQACN4YKBgMG5gkMXNIbGDgMGDiVGBjiCxh4jjIw7Gdg4ElgYOAKYLiTUMDAmnix9FEBANuoCvKuJg1RAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\alpha" style="vertical-align: 0px"/> is taken equal to 0.05.</p>
<p>This test confirms that the dependence through time is not negligible: it means that the linear
model:math:<cite>mu(t)</cite> component explains a large variation in the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">llh_LL</span> <span class="o">=</span> <span class="n">result_LL</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">()</span>
<span class="n">llh_NonStatLL</span> <span class="o">=</span> <span class="n">result_NonStatLL</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">()</span>
<span class="n">modelM0_Nb_param</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">modelM1_Nb_param</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">resultLikRatioTest</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HypothesisTest</span><span class="o">.</span><span class="n">LikelihoodRatioTest</span><span class="p">(</span>
    <span class="n">modelM0_Nb_param</span><span class="p">,</span> <span class="n">llh_LL</span><span class="p">,</span> <span class="n">modelM1_Nb_param</span><span class="p">,</span> <span class="n">llh_NonStatLL</span><span class="p">,</span> <span class="mf">0.05</span>
<span class="p">)</span>
<span class="n">accepted</span> <span class="o">=</span> <span class="n">resultLikRatioTest</span><span class="o">.</span><span class="n">getBinaryQualityMeasure</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Hypothesis H0 (stationary model) vs  H1 (linear mu(t) model):  accepted ? = </span><span class="si">{</span><span class="n">accepted</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Hypothesis H0 (stationary model) vs  H1 (linear mu(t) model):  accepted ? = False
</pre></div>
</div>
<p>We detail the statistics of the Likelihood Ratio test: the deviance statistics <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAATBAMAAACNYFu4AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi937dGDPMp1I8+mvvxhkVxmfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAkUlEQVQI12NgYFT+/1mFAQxYU+sbZqxXALOLGeY7MLD9ALM9GfwLGBisIYoYzgOxMpSdDcS3oew1QKwLYfJ9BRLfIWzGDwwMvAcgbKYEBgYnqHJ+BwaeAwwvLsoA2fEMhakMDAJ2bBMYWO2tTwJFOBWYAqAKGRgbmB/A2GwBMjAmA5dIA5z9igEBYhFMPiWgTgBIWBuiROGo2wAAAAp0RVh0RGVwdGgAAAAABs5ARDkAAAAASUVORK5CYII=" alt="\mathcal{D}_p" style="vertical-align: -6px"/> follows
a <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAVBAMAAABS0hjfAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIvpSDJgv/OdrxjP3fsCfaByAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgklEQVQI12NgAAOh5RCagXUCzwIIi8WA6QJUkIFrAYy1YwOMdQTG4HQIgLLSGCYwMCo7MLCm/v+/gIGV3YCBCWrWVwYFqJpORpi+xd4MDBvBVvg7MDAIGoBY8UBlrGDWnAtQFifjByhrNsNHCIsxgKGWG8xyY2DYPImBtQFmZtajAACKgBnxdtmT1wAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\chi^2_1" style="vertical-align: -5px"/> distribution.
The model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwa+WpCZbxkyGB4JcH9g4GEwBnI3MNwPUWFga2CIYnjDwMC4gYFj0gMGLgWGMoYXDIzcDgzcQGN4FBi2MXgw3D8FVP+AgYHruwBI9sVEiPl8W4B6YxiQACfYZDjgq90AAKtuJvyo4mSZAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0" style="vertical-align: -3px"/> is rejected if the deviance statistics estimated on the data is greater than
the threshold <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALBAMAAACEzBAKAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAdIsyz6+d6RhI82C/3hTisAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAE5JREFUCNdjYGBUFGYAAycGVzDNVsAgAWbwKkAkGGwboIy5DAwcDInRHAxcBgzKLBu4mBiYA4UaZjFwaYCldRjYE8AMGYauCWAGq6JgNABpbQjISf3R/wAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="c_{\alpha}" style="vertical-align: -3px"/> or if the p-value is less than the Type I error  <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAAAMBAMAAAApNgaAAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAyElEQVQY02NgwASXzC7AqMhknQAsKrgnMEyFUVE/nmJRwcAjwKACowIZsAL+DQw3YBRECaOyK6qS/QEM+wugVJBxLlDEjaGCwQBI+70DgmdAxv0AkDSEKmLg2sDAPIGBS3oDmilAaRjFcoCBw4CBUwnFovgNDPIFcIqpgSG+gIHnKKpzLzBIwKiFDEwfGPYDvZfAgOwWHgMGPRg1FWQRVwDDnYQCZFN4DwBl4grAlDlDRQADa+LF0kcoShiExC4w7AgAU8xqrgwAYipEUu/QiJoAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\alpha = 0.05" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dp=</span><span class="si">{</span><span class="n">resultLikRatioTest</span><span class="o">.</span><span class="n">getStatistic</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;alpha=</span><span class="si">{</span><span class="n">resultLikRatioTest</span><span class="o">.</span><span class="n">getThreshold</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value=</span><span class="si">{</span><span class="n">resultLikRatioTest</span><span class="o">.</span><span class="n">getPValue</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Dp=5.46
alpha=0.05
p-value=0.02
</pre></div>
</div>
<p>We can perform the same study with a quadratic model for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAATBAMAAAB1gKBPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1UlEQVQY00WQIW/CYBCGH9q0tKUt/Qk4kqmJBUdSh0F0eogKBAsCFLpyWUKCmkehSKrQm0MgGn5Bg5qcoNO77yt0l9zlni/3vnf5oA67lBLSREs/5g1fhFLWDX+CWeLf0SmgG+NlNzYTGIERiVOPJ9rwcNrDUsYS+xdXZoaSP9DH2TCRvpJcwZZOzli0MssHHHEzXsETL6WvWExT8fOLmWLjyi7AT3HjEusR7+ttfibMcL4TggJfn2RF9VmprNfdQNdntV7Hi64HeK/ZULIg/v8QJbPgD3T7JWkKdpF7AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\mu(t)" style="vertical-align: -5px"/>:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANoAAABKBAMAAAAvVVerAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAD5klEQVRYw+1ZS2gTQRj+ssluttls2oIn9RBFULSHINWbslBEsB7iA1R8LfhAKbXxoDchWirFR8lBvFoPoviACioiKFFQRBSDL4rQsohKLxXBR8GDcWaSbbIPx20dF9H8kMnM5Jv55v9n5t8vCRCaqa+HwiPDNswMkW01nttVxSJFaupT7KOFFRBy0e6KMEpPYJXhMc/o7oF8rdFCi65gEOW03fWGNEyc9AxDMuteQAn3JxupNLAbaikQJGLYfUUgaiHpZrMQTdtT2KOBxZOf0wHL2egAkLeyfToJdbOBRN5JJqcRN6t1vUq7Fjg4CaDB+AxcCAKR0va5iJJ4rQSkFiebDtyBi60ErXYqlgCxHDAnCGR7+RuJZhrtiAMLH18Bci62yOxBD1vrI+b203I5R/DS5UclOjwgpDmrfEUTqSwjr4+052orMXYTdWlexsM2t4O+adk+UhZIWOgmBIbMh1rAFlL5gvpwM1sB3FR6HVPFstDyJy/BALkucpGuFvbm1kOOHDf9IGehDZF7DolG8bSTjazpjnqi4u/su8xfspXaOytCAky8jhXpaoEm0w2xchHLCwEeoimPvUCCnpCch+0e87u2cDJVcl5Rz0AihEqBrhaufaOQdDZp+EG+oGenSerJ0p4qW23fBiEXXGwJYBMpB0mwKqt7ouRdbAwif4APRPqM8zqSJpoMC3LG4VpsCDsMF1snlHZgr4k4TTIPgFPkFq3zQpRFfpDE3f6uZ0jloY5loTtTkNrd/x4utqPDA2QHZjAPAZJFB8jBG/GBaBkfSJKlD7lyraOmk42VTjYGTxnV7Lmm8rbUA1EzesEH0pyta6zxpBJUnWBJu3pwgLn2Q6ayvOpa6yGSpQ36QOZX+jaz8oaTbT3b2PMv6zMnzeNyuVydSmbPKM0REgbByGv4QI5V+iTqvm442fI+4sLVXkCLF1OFgAZUnvqzW7bH/hakYQ37v2y6Wnl6NgWtLMCCa2UR9mutLPKb3K+1skALoJXFmH6mPBFEK4uxWbvINxCuVm4R6FoGbeBpZaSK4tjiBnrB08rYKJBtA3ALXK38SiBbGwsfRyuru0VGEhFyyThaWVUEssXG3tJ8/HOtPD56SPTt5mnlWFF4MuFo5c3CfeNo5T9hQbWyIJumVm5Ywxr2V2vldKha+YIRolZevWwoPK0sHQhTK8etELUyegyEp5URvXaUp5W1vusi2WL7R3laOTJREsm2ClytrIuNJD0ZHK2cGBe5dUxDcrSyjCsC2RI0Q/J+V679SSficn8zuVq5A70i963tU5qnlbfittBj0vmdp5XVUUvsqTwcplYePvdvauUfYeM9bmSU7MEAAAAKdEVYdERlcHRoAP/////5mMHvAAAAAElFTkSuQmCC" alt="\begin{align*}
  \mu(t) &amp; = \beta_1 + \beta_2 \tau(t) + \beta_3\tau(t)^2 \\
  \sigma(t) &amp; = \beta_4 \\
  \xi(t) &amp; = \beta_5
\end{align*}"/></p>
</div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">basis_quad</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Basis</span><span class="p">(</span>
    <span class="p">[</span><span class="n">constant</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]),</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;t^2&quot;</span><span class="p">])]</span>
<span class="p">)</span>
<span class="n">basis_coll_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">basis_quad</span><span class="p">,</span> <span class="n">basis_cst</span><span class="p">,</span> <span class="n">basis_cst</span><span class="p">]</span>
<span class="n">result_NonStatLL_2</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildTimeVarying</span><span class="p">(</span>
    <span class="n">sample</span><span class="p">,</span> <span class="n">timeStamps</span><span class="p">,</span> <span class="n">basis_coll_2</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Function</span><span class="p">(),</span> <span class="s2">&quot;Gumbel&quot;</span><span class="p">,</span> <span class="s2">&quot;MinMax&quot;</span>
<span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">result_NonStatLL_2</span><span class="o">.</span><span class="n">getOptimalParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quadratic mu(t) model : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta1, beta2, beta3, beta4, beta5 = &quot;</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mu(t) = </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> * tau + </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> * tau^2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sigma = </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;xi = </span><span class="si">{</span><span class="n">beta</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Quadratic mu(t) model :
beta1, beta2, beta3, beta4, beta5 =  [-245.692,26.0513,-19.5972,2.28398,-0.182332]
mu(t) = -245.6916 + 26.0513 * tau + -19.5972 * tau^2
sigma = 2.2840
xi = -0.1823
</pre></div>
</div>
<p>We get the asymptotic distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARBAMAAAAbE1CRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASM/p3Ri/i/tgMq/znXRXs4/UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAaklEQVQI1yWLuw1AYBhFj2fi1Si0JBK1WEDDEDoqI1hHTGKAvzCBGUQkhMYXbnFO7k0uQJjWQrvlEPVwgZOgSdNHvBN8qyhziNxC3bBC8IB8vB1mME60DeKZIMNVI2aTVYvsfJl+Db+6jy8HMBQvNG/OiAAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="\vect{\beta}" style="vertical-align: -4px"/> to compute some confidence intervals of
the estimates, for example of order <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAQBAMAAABQPLQnAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABA0lEQVQoz2NgwABFngUgqlTLgMFuirYBpgLeBwyPgRTjA4bDDDY/FmMqYOAWYFAFUhwCDKEMhgzYAP8FhgogZV/A4AFVIaTsEoCs4r4Bw/0EoIoLDP4JRi7TGRjYxL4whAAlolYBwUogo94ApIiBX4BhvkESA88FBnb2BoZZaGYAFTGwLGCIBxrFuoGBgWkBw1JkFUDj5YFSDJ4u/kCSqQHs9kYUlxYwSEBYegwHGZg+AEUS2A8gu4PbgUELSLFfYHgODBiQLfcT+C4gm8G+AShhlcA3gSWAwY0hA+gkVUdl1AARkixguGHAq6QCdK5mMFBgCwMh8JmQAt4PhFTU/SSgAAA6dDzXMTrCXAAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="p = 0.95" style="vertical-align: -4px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dist_beta</span> <span class="o">=</span> <span class="n">result_NonStatLL_2</span><span class="o">.</span><span class="n">getParameterDistribution</span><span class="p">()</span>
<span class="n">condifence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">beta</span><span class="o">.</span><span class="n">getSize</span><span class="p">()):</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">dist_beta</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">computeQuantile</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">condifence_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)[</span>
        <span class="mi">0</span>
    <span class="p">]</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">dist_beta</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">computeQuantile</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">condifence_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)[</span>
        <span class="mi">0</span>
    <span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Conf interval for beta_&quot;</span>
        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot; = [&quot;</span>
        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;; &quot;</span>
        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Conf interval for beta_1 = [-248.6277167489553; -242.7555038171466]
Conf interval for beta_2 = [9.891070937443686; 42.21154701845885]
Conf interval for beta_3 = [-35.56488628668891; -3.6294734809612716]
Conf interval for beta_4 = [1.4077955196970833; 3.160168420291918]
Conf interval for beta_5 = [-0.9157225566498194; 0.5510589288330662]
</pre></div>
</div>
<p>In order to compare different modelings, we get the optimal log-likelihood of the data for both stationary
and non stationary models. The difference is significant enough to be in favor of the non stationary model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max log-likelihood = &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non stationary quadratic mu(t) model = &quot;</span><span class="p">,</span> <span class="n">result_NonStatLL_2</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Max log-likelihood =
Non stationary quadratic mu(t) model =  -48.4684335974957
</pre></div>
</div>
<p>At last, we can test the validity of the non stationary model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwa+WpCZbxkyGB4JcH9g4GEwBnI3MNwPUWFga2CIYnjDwMC4gYFj0gMGLgWGMoYXDIzcDgzcQGN4FBi2MXgw3D8FVP+AgYHruwBI9sVEiPl8W4B6YxiQACfYZDjgq90AAKtuJvyo4mSZAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0" style="vertical-align: -3px"/>
where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAATBAMAAAB1gKBPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1UlEQVQY00WQIW/CYBCGH9q0tKUt/Qk4kqmJBUdSh0F0eogKBAsCFLpyWUKCmkehSKrQm0MgGn5Bg5qcoNO77yt0l9zlni/3vnf5oA67lBLSREs/5g1fhFLWDX+CWeLf0SmgG+NlNzYTGIERiVOPJ9rwcNrDUsYS+xdXZoaSP9DH2TCRvpJcwZZOzli0MssHHHEzXsETL6WvWExT8fOLmWLjyi7AT3HjEusR7+ttfibMcL4TggJfn2RF9VmprNfdQNdntV7Hi64HeK/ZULIg/v8QJbPgD3T7JWkKdpF7AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\mu(t)" style="vertical-align: -5px"/> is linear
relative to the model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAn0lEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwbGOyDuW4YMhkcC3B8YeG+CuBsY7oeoMLABzfME8hg3MHBMesDApQDmMnI7MHADjeGBcO+fAqp4wMDA9V0AxH0xEWI+3xaIXiTghMJj3WECAMpiIvj1y0x9AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_1" style="vertical-align: -3px"/> where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAATBAMAAAB1gKBPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1UlEQVQY00WQIW/CYBCGH9q0tKUt/Qk4kqmJBUdSh0F0eogKBAsCFLpyWUKCmkehSKrQm0MgGn5Bg5qcoNO77yt0l9zlni/3vnf5oA67lBLSREs/5g1fhFLWDX+CWeLf0SmgG+NlNzYTGIERiVOPJ9rwcNrDUsYS+xdXZoaSP9DH2TCRvpJcwZZOzli0MssHHHEzXsETL6WvWExT8fOLmWLjyi7AT3HjEusR7+ttfibMcL4TggJfn2RF9VmprNfdQNdntV7Hi64HeK/ZULIg/v8QJbPgD3T7JWkKdpF7AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\mu(t)" style="vertical-align: -5px"/> is quadratic. The
model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwa+WpCZbxkyGB4JcH9g4GEwBnI3MNwPUWFga2CIYnjDwMC4gYFj0gMGLgWGMoYXDIzcDgzcQGN4FBi2MXgw3D8FVP+AgYHruwBI9sVEiPl8W4B6YxiQACfYZDjgq90AAKtuJvyo4mSZAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0" style="vertical-align: -3px"/> is parametrized by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAATBAMAAABhFT6uAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABrElEQVQ4y5WTPUvDUBSG3/QjbdpG41ShCFFEcauIm0PBjhUydHGRWPxahOrQIohUcHQI+IFQCzp17U/oIqggSAfnTA6Cv6Gec29zUzBLQ3PL0/O8uefe2wCajcku4cfp1hpL4a/5mhsNI2uOh0WuIempWh3biISRpddpcMSk6VJQiwFXiITAcmTSKCFjBbVb4BlRoKxvIE2TpoCBEusw7UhQ1iaQYY6v+6G4toNIUBZFssyJSisUy6+IBGVNA3f09QZ8aUeylvNguoe/Y7B3LNfMFlAEr+5FdI+Bvq+6N1fsuK/AforbozXSumK0gVkLBclVMakUkxUn1VJQ8pL9IFXFvSPWxbvhw+gFqSmgTaMfgrEgK8I6kamkhdwnZvucuqEFfEC7BgpWCNqWZaxCWvoMpR7o9F3o+YN5sS3v1MRuo0b6xjiYrVwX0tI1SjXpxIvQRQPcoSs+9Ki+p0BvpXqsCGv5lPKX4DslUm2Z4r8myvw6jCBhmz5HpJVzeB6gg0fGxM8Z1wzeL2M49BWgeSGeICx0ujD5+BKueoOCPv5D0Dpf52L0JnyXyf8DP0JjcXDrUsMAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="(\beta_1, \beta_2, \beta_3, \beta_4)" style="vertical-align: -5px"/> and the model
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAn0lEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwbGOyDuW4YMhkcC3B8YeG+CuBsY7oeoMLABzfME8hg3MHBMesDApQDmMnI7MHADjeGBcO+fAqp4wMDA9V0AxH0xEWI+3xaIXiTghMJj3WECAMpiIvj1y0x9AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_1" style="vertical-align: -3px"/> is parametrized by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIMAAAATBAMAAABB1aMWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB3UlEQVQ4y6WUsWvbQBTGP8W2bNlSokwpmIJSQkM3l5KtEEM9pnCDly5FNU3dpaB0sAkUo0LGDoKkpZAYmslr/gQvgbQQCBkyiw4dCv0b3PfurDtDbrORTv7u973He4+TACfCEj8ZXKLbGTw2uxu92C5sroe8bLFGJdPGBK9gFTaXm9AiZDm1dgFXgCNYhdUlVBqvjXpYwBPgHDZhd/0BalRbFbjVUQmCyCrsrhdAnWFpJzfw2WtYhd1F8Q2G5b3UwM4VrMLuWgO+0uMncOe8V1t+hiDu/1sQbz+oCbALaBlwN6Yh0HguZWO4dfd1x8GTqJRrEf0oRfP2aRYrwoDdCf1rhGgq2JXlKFjZE9VUi3ZWmRYpuvgmDEjms+Bx5vAuihSrwCmtuRHeI0Wk60AY8HukUlRC+Dd4MOUUx9T0NZwvQDM0wnkZek+hXO66MCBbpTq+0zGL4W6825Rz/UVbbwY9sjxfFEHqU9fS5TpiAXC7QzpzLbiyNm4klhflnWZauGn1gi3Stf1xooGfupTiM/iuyhSnKoWcUYdf4rkoR0HO8crlCw28JEi4AmCMM2blv4ds9Hj63myWa4HhSEZJF8YTA/o054DPTDnWX4Si3Pui6PAe+CTXbJmvFgX/BzQ/e+V7z0QxAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\beta_1, \beta_2, \beta_3, \beta_4, \beta_5)" style="vertical-align: -5px"/>: so we have
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAQBAMAAAB3kjXPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABC0lEQVQoz2NgYGAQEgASDMwODJgATco+AETGY1GILpVfACRYOrGpRJNKWgAkOL/BpYVzzpy5gFVqWwOQOPsdxmU+K8CAXYo1+AsDA1vhX5jsbYTlaFLcLJ8ZGKpY/0G5jAcQKtGk2Bi6GHgnMH9k4KsFuZ+1AKESLsV4B8R9y5DB8EiA+wMDD4MxkMsegFAJl+K9CeJuYLgfosLA1sAQxfAGzUy4FIMnyF0bGDgmPWDgUmAoY3iB6k6EFEglI7cDAzfQyTwKDNsYPFD8jiQFUnn/FFDsAQMD13cBiJkMzEeh4YkkBVL5YiJEmG8L0J0x8DgyYECRArsTATjBfscOnFB4fLUbcClk3WECALN6VVL+VljEAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0 \subset \mathcal{M}_1" style="vertical-align: -3px"/>.</p>
<p>We use the Likelihood Ratio test. The null hypothesis is the stationary model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAQBAMAAAD34QLcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGPOLMmC/nfvpz6/ddEjZjsafAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQI12NgYGAQEgASDMwODBBgHwAi46E8hvwCIMHSCeMmLQASnN9g3G0NQOLsdyiPNfgLAwNb4V8ol5vlMwNDFes/KJeNoYuBdwLzRwa+WpCZbxkyGB4JcH9g4GEwBnI3MNwPUWFga2CIYnjDwMC4gYFj0gMGLgWGMoYXDIzcDgzcQGN4FBi2MXgw3D8FVP+AgYHruwBI9sVEiPl8W4B6YxiQACfYZDjgq90AAKtuJvyo4mSZAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\mathcal{M}_0" style="vertical-align: -3px"/>.
The Type I error <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LvzKvGPvp80jdYM9PNwSHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgYFR2ZQACN4YKBgMG5gkMXNIbGDgMGDiVGBjiCxh4jjIw7Gdg4ElgYOAKYLiTUMDAmnix9FEBANuoCvKuJg1RAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\alpha" style="vertical-align: 0px"/> is taken equal to 0.05.</p>
<p>This test confirms that the dependence through time is not negligible: it means that the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAATBAMAAAB1gKBPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1UlEQVQY00WQIW/CYBCGH9q0tKUt/Qk4kqmJBUdSh0F0eogKBAsCFLpyWUKCmkehSKrQm0MgGn5Bg5qcoNO77yt0l9zlni/3vnf5oA67lBLSREs/5g1fhFLWDX+CWeLf0SmgG+NlNzYTGIERiVOPJ9rwcNrDUsYS+xdXZoaSP9DH2TCRvpJcwZZOzli0MssHHHEzXsETL6WvWExT8fOLmWLjyi7AT3HjEusR7+ttfibMcL4TggJfn2RF9VmprNfdQNdntV7Hi64HeK/ZULIg/v8QJbPgD3T7JWkKdpF7AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\mu(t)" style="vertical-align: -5px"/>
quadratic model explains even better a large variation in the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">llh_NonStatLL_2</span> <span class="o">=</span> <span class="n">result_NonStatLL_2</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">()</span>
<span class="n">resultLikRatioTest</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HypothesisTest</span><span class="o">.</span><span class="n">LikelihoodRatioTest</span><span class="p">(</span>
    <span class="mi">4</span><span class="p">,</span> <span class="n">llh_NonStatLL</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">llh_NonStatLL_2</span><span class="p">,</span> <span class="mf">0.05</span>
<span class="p">)</span>
<span class="n">accepted</span> <span class="o">=</span> <span class="n">resultLikRatioTest</span><span class="o">.</span><span class="n">getBinaryQualityMeasure</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Hypothesis H0 (linear mu(t) model) vs H1 (quadratic mu(t) model):  accepted ? = </span><span class="si">{</span><span class="n">accepted</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Hypothesis H0 (linear mu(t) model) vs H1 (quadratic mu(t) model):  accepted ? = False
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  10.124 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-gev-racetime-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1d2b766b646db4e0f6dcb3f95dcd9f4e/plot_estimate_gev_racetime.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_estimate_gev_racetime.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c03786595c437945a6516920b813ad91/plot_estimate_gev_racetime.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_estimate_gev_racetime.ipynb</span></code></a></p>
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../statistical_tests/index.html" title="Statistical tests"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_estimate_gev_fremantle.html" title="Estimate a GEV on the Fremantle sea-levels data"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate a GEV on race times data</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 21, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>