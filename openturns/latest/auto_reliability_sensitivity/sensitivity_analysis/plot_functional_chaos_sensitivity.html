
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Sobol’ sensitivity indices from chaos &#8212; OpenTURNS 1.21 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Use the ANCOVA indices" href="plot_sensitivity_ancova.html" />
    <link rel="prev" title="Estimate Sobol’ indices for a function with multivariate output" href="plot_sensitivity_sobol_multivariate.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_sensitivity_ancova.html" title="Use the ANCOVA indices"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_sobol_multivariate.html" title="Estimate Sobol’ indices for a function with multivariate output"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sobol’ sensitivity indices from chaos</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_sensitivity_sobol_multivariate.html"
                          title="previous chapter">Estimate Sobol’ indices for a function with multivariate output</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_sensitivity_ancova.html"
                          title="next chapter">Use the ANCOVA indices</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/sensitivity_analysis/plot_functional_chaos_sensitivity.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-functional-chaos-sensitivity-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="sobol-sensitivity-indices-from-chaos">
<span id="sphx-glr-auto-reliability-sensitivity-sensitivity-analysis-plot-functional-chaos-sensitivity-py"></span><h1>Sobol’ sensitivity indices from chaos<a class="headerlink" href="#sobol-sensitivity-indices-from-chaos" title="Permalink to this heading">¶</a></h1>
<p>In this example we are going to compute global sensitivity indices from a functional chaos decomposition.</p>
<p>We study the Borehole function that models water flow through a borehole:</p>
<div class="math">
<p><img src="data:image/png;base64,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" alt="\frac{2 \pi T_u (H_u - H_l)}{\ln{r/r_w}(1+\frac{2 L T_u}{\ln(r/r_w) r^2_w K_w}\frac{T_u}{T_l})}"/></p>
</div><p>With parameters:</p>
<ul class="simple">
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAALBAMAAABrDns0AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYK8yi3Tzzxj7v+md3UhrTZF7AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAVUlEQVQI12NgVDRyZAADVjMFdQgrQrJBGMJq0GKAga0wBscPBgaWAq7mDQysGxgYHDI4GS4w8BxgYGDe8JbBAayC5YATQwCYxRSgwtoAZjGregUyAACrKQ4iwvd9IwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="r_w" style="vertical-align: -3px"/>: radius of borehole (m)</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAYK8yi3Tzzxj7v+mdfFzWggAAAAlwSFlzAAAOxAAADsQBlSsOGwAAACpJREFUCNdjYFQ0cmRgNVNQZ4iQbBBmaNBiAIKtQMxxA0iwbgASPAcYGAByEwXczOc1PgAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="r" style="vertical-align: 0px"/>: radius of influence (m)</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQBAMAAADpKDJvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdPvPr/O/Mp0Yi2DpSN04sx0iAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAdElEQVQI12NgVHYJdUl1YGBgYC5gCGNgbACyZjFwfmRg3wBkSTIw/mTgLgCyJjCwBTBwMoABTwIDFPALwFj7C2AsJxiD4TCc9YuBgcuA4wIDA/d3BoYFkTwFDByun90Z2A8wQRVwONyDslgEPKCG8mYvEwAAWywUC3n9tzYAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="T_u" style="vertical-align: -3px"/>: transmissivity of upper aquifer (<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAVBAMAAAAdjxsPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi50Yz0h0MmD76d3zv6/wjZZjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABAklEQVQoz2NggAI2uQsM2EERgx8OmSgGaRCFVeM7IGZ/gEWC+TCQ4CvAIsMSACS4sRmmyg4kgrBIcDQwAcnrSCKMioYiwWmuDPX//wF5GxhYcxnYLvS1P2xgqIgUYFvGkA3VKMBgxhnArZB+js+BIUGGgfEAgwrUFQYMDfEMnGEWkzmAjrzHwKLAsAkqA8RPGOKZ+cAensHAGcD8HSKTBsQnGLQZuBJAvv7AUM/AuKABLOMA9PBnoAH2BiC3LQAGGK+CADgYgDIMH9i/MmSBeEwCDM8YOJ5BfADSKSf3gUEJ3beQsGHCEt61QMzVwIklVFXBDr+IJew2gOwSSsAig2IMALTBMayv83ymAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="m^2/yr" style="vertical-align: -5px"/>)</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAQBAMAAAAPAfkrAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dBj7YN3pz52LSDLi5wBxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgUlEQVQI12NgYBD67BCoJs4AARwNDAyzoGwG/g0MDH9gnPsXGNj/wTj7GRgYE2CcFUBtC2CcDEFB+QNQNt9fsDYI4PkA1gYBXBMYGDpgHDYBBoZsBoZTDHuBnPcFIG08TAHzgFb0L2eV/FzA8JIBbhcDw0beBgRHhHELgnO5xoQBAMkEHc62YT1AAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="H_u" style="vertical-align: -3px"/>: potentiometric head of upper aquifer (m)</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQBAMAAADUulMJAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdPvPr/O/Mp0Yi2DpSN04sx0iAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbElEQVQI12NgVHYJdUl1YGAuYAhjYGxgmMXA+ZGBfQODJAPjTwbuAoYJDGwBDJwMQMCTwAAG/AIQen8BA7c6kHYCYgUgPszAwGsApH8xMHA0MDBwf2dg4LvAwOH62Z2BCaKD4R6UXgI1okwAAOefEgr5sw3oAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="T_l" style="vertical-align: -3px"/>: transmissivity of lower aquifer (<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAVBAMAAAAdjxsPAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi50Yz0h0MmD76d3zv6/wjZZjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABAklEQVQoz2NggAI2uQsM2EERgx8OmSgGaRCFVeM7IGZ/gEWC+TCQ4CvAIsMSACS4sRmmyg4kgrBIcDQwAcnrSCKMioYiwWmuDPX//wF5GxhYcxnYLvS1P2xgqIgUYFvGkA3VKMBgxhnArZB+js+BIUGGgfEAgwrUFQYMDfEMnGEWkzmAjrzHwKLAsAkqA8RPGOKZ+cAensHAGcD8HSKTBsQnGLQZuBJAvv7AUM/AuKABLOMA9PBnoAH2BiC3LQAGGK+CADgYgDIMH9i/MmSBeEwCDM8YOJ5BfADSKSf3gUEJ3beQsGHCEt61QMzVwIklVFXBDr+IJew2gOwSSsAig2IMALTBMayv83ymAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="m^2/yr" style="vertical-align: -5px"/>)</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAQBAMAAAAG6llRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dBj7YN3pz52LSDLi5wBxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfUlEQVQI12NgYBD67BCoJs4AAhwNDAyzwCwG/g0MDH8gzPsXGNj/QZj7GRgYEyDMFUDlCyDMDEFB+QNgFt9fsPKyBwwMPB/AytmAolwTGBg6GBhuAZlsAgwM2QwMu4HM9wVg5b1AI/uXs0p+LmCAmgwEvA1wJo8InMlnwgAAGngbRSi+AD8AAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="H_l" style="vertical-align: -3px"/>: potentiometric head of lower aquifer (m)</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAANBAMAAABvB5JxAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/3Z1Iz/syYIvpdBja9QCoAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAASklEQVQI12NgYBD6LMAABCwOIJKBPwBM5SeAqXgwyVACoVrBJOcvMMX9gYGBi4GB/QADw00GBg6gGQYMDPMXMLBvYGA8byjS/wAAmMUMSqTCWLoAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="L" style="vertical-align: 0px"/>: length of borehole (m)</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAQBAMAAAD+CqKmAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dJ3dSIsYz/tgMunYU1txAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAhUlEQVQI12NgYBD67MDgr8oAAWwJDAyuUDYDfwADSwGMU1/A0AljM8QzzICzGZaxb0dwtp7ZDGfzfr4gD+dwfGC43wDjcD1gYHsA43ALMLB8Z2DoYrC8x8Bw/wADw2YGDqYJG9gYGPPXMDD+N2C4x57AATenlUOABc4RYWzwhHMuepgcAACG/BzTWgzG6AAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="K_w" style="vertical-align: -3px"/>: hydraulic conductivity of borehole (<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAATBAMAAAAUmIINAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi50Yz0h0MmD76d3zv6/wjZZjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA40lEQVQY02NgQABeBmygDqvoc6yiG7AJsipgE+UtQLAZFQ1FgtNcgSxuBoawCwy5HC/qJBgqIgXYljFkA0UbGZgTpjJsYqt58IQhQYaB8QCDClDUmYGD9QPD1OROg3YGhnsMLAoMm4CiDgwMfA6sHwzeggyewcAZwPydgYEtgYGBp4FpA8MyoCD7B4Z6BsYFDQwsQI69AbcC82eQGxYwSDPwKggwmAA5/Az1AWwLgAwmAYZnDBzPGBgkQEoevmdgUsD0ry6qz9gvAIkVDNNRRZkCQI7jFUAV5QYRgmpoYcOOzAEA/Dop0QIWw04AAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="m/yr" style="vertical-align: -5px"/>)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>borehole model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dimension</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">input_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rw&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Tu&quot;</span><span class="p">,</span> <span class="s2">&quot;Hu&quot;</span><span class="p">,</span> <span class="s2">&quot;Tl&quot;</span><span class="p">,</span> <span class="s2">&quot;Hl&quot;</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;Kw&quot;</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span>
    <span class="n">input_names</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;(2*pi_*Tu*(Hu-Hl))/(ln(r/rw)*(1+(2*L*Tu)/(ln(r/rw)*rw^2*Kw)+Tu/Tl))&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">coll</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0161812</span><span class="p">),</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">7.71</span><span class="p">,</span> <span class="mf">1.0056</span><span class="p">),</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">63070.0</span><span class="p">,</span> <span class="mf">115600.0</span><span class="p">),</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">990.0</span><span class="p">,</span> <span class="mf">1110.0</span><span class="p">),</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">63.1</span><span class="p">,</span> <span class="mf">116.0</span><span class="p">),</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">700.0</span><span class="p">,</span> <span class="mf">820.0</span><span class="p">),</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">1120.0</span><span class="p">,</span> <span class="mf">1680.0</span><span class="p">),</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">9855.0</span><span class="p">,</span> <span class="mf">12045.0</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>
<span class="n">distribution</span><span class="o">.</span><span class="n">setDescription</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span>
</pre></div>
</div>
<p>Freeze r, Tu, Tl from model to go faster</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">selection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">complement</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Indices</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">complement</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">selection</span><span class="p">,</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span><span class="o">.</span><span class="n">getMean</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">input_names_copy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span>
<span class="n">input_names</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="o">*</span><span class="n">complement</span><span class="p">)(</span><span class="n">input_names</span><span class="p">)</span>
<span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">complement</span><span class="p">)</span>
</pre></div>
</div>
<p>design of experiment</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<p>create a functional chaos model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FunctionalChaosAlgorithm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getResiduals</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getRelativeErrors</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.00195286]
[4.64697e-06]
</pre></div>
</div>
<p>Quick summary of sensitivity analysis</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FunctionalChaosSobolIndices</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sensitivityAnalysis</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>FunctionalChaosSobolIndices
- input dimension=5
- output dimension=1
- basis size=181
- mean=[76.0794]
- std-dev=[30.2678]

| Index | Multi-index   | Variance part |
|-------|---------------|---------------|
|     1 | [1,0,0,0,0]   | 0.662606      |
|     3 | [0,0,1,0,0]   | 0.0902125     |
|     2 | [0,1,0,0,0]   | 0.0901124     |
|     4 | [0,0,0,1,0]   | 0.0861668     |
|     5 | [0,0,0,0,1]   | 0.0209417     |

| Input | Name          | Sobol&#39; index  | Total index   |
|-------|---------------|---------------|---------------|
|     0 | rw            | 0.677582      | 0.70826       |
|     1 | Hu            | 0.0901124     | 0.101381      |
|     2 | Hl            | 0.0902126     | 0.101371      |
|     3 | L             | 0.0871206     | 0.0992782     |
|     4 | Kw            | 0.0209417     | 0.0240504     |
</pre></div>
</div>
<p>draw Sobol’ indices</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">first_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getSobolIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">)]</span>
<span class="n">total_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getSobolTotalIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">)]</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SobolIndicesAlgorithm</span><span class="o">.</span><span class="n">DrawSobolIndices</span><span class="p">(</span><span class="n">input_names</span><span class="p">,</span> <span class="n">first_order</span><span class="p">,</span> <span class="n">total_order</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_functional_chaos_sensitivity_001.png" srcset="../../_images/sphx_glr_plot_functional_chaos_sensitivity_001.png" alt="Sobol' indices" class = "sphx-glr-single-img"/><p>We saw that total order indices are close to first order,
so the higher order indices must be all quite close to 0</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="n">input_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &amp; &quot;</span> <span class="o">+</span> <span class="n">input_names</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
            <span class="s2">&quot;:&quot;</span><span class="p">,</span>
            <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getSobolIndex</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]),</span>
        <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Hu &amp; rw : 0.009603147153069586
Hl &amp; rw : 0.009486332516243895
Hl &amp; Hu : 6.772494613216887e-08
L &amp; rw : 0.009152262191425037
L &amp; Hu : 0.0012275743968190782
L &amp; Hl : 0.001230665255687928
Kw &amp; rw : 0.0021338960376998777
Kw &amp; Hu : 0.0002952362243352463
Kw &amp; Hl : 0.0002981593839990994
Kw &amp; L : 0.0002935613713562576
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-functional-chaos-sensitivity-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/638532df84c15ab8b3b760534600b27e/plot_functional_chaos_sensitivity.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_functional_chaos_sensitivity.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5bd8041d934818d21b7145db57b37df0/plot_functional_chaos_sensitivity.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_functional_chaos_sensitivity.ipynb</span></code></a></p>
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_sensitivity_ancova.html" title="Use the ANCOVA indices"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_sobol_multivariate.html" title="Estimate Sobol’ indices for a function with multivariate output"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sobol’ sensitivity indices from chaos</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 21, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>