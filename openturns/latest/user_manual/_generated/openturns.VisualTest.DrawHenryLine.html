
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>DrawHenryLine &#8212; OpenTURNS 1.21 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DrawKendallPlot" href="openturns.VisualTest.DrawKendallPlot.html" />
    <link rel="prev" title="DrawParallelCoordinates" href="openturns.VisualTest.DrawParallelCoordinates.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="openturns.VisualTest.DrawKendallPlot.html" title="DrawKendallPlot"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="openturns.VisualTest.DrawParallelCoordinates.html" title="DrawParallelCoordinates"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../user_manual.html" >API</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../statistics_on_sample.html" accesskey="U">Statistics on sample</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">DrawHenryLine</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="openturns.VisualTest.DrawParallelCoordinates.html"
                          title="previous chapter">DrawParallelCoordinates</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="openturns.VisualTest.DrawKendallPlot.html"
                          title="next chapter">DrawKendallPlot</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user_manual/_generated/openturns.VisualTest.DrawHenryLine.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="drawhenryline">
<h1>DrawHenryLine<a class="headerlink" href="#drawhenryline" title="Permalink to this heading">¶</a></h1>
<p>(<a class="reference download internal" download="" href="../../_downloads/eaf58dfb4de5b772e983ba24f921cd24/DrawHenryLine.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../../_downloads/8254d6a58f576d9ae124ec5dca32be6e/DrawHenryLine.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>)</p>
<figure class="align-default">
<img alt="../../_images/DrawHenryLine.png" class="plot-directive" src="../../_images/DrawHenryLine.png" />
</figure>
<dl class="py function">
<dt class="sig sig-object py" id="openturns.VisualTest.DrawHenryLine">
<span class="sig-name descname"><span class="pre">DrawHenryLine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openturns.VisualTest.DrawHenryLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw an Henry plot.</p>
<p>Refer to <a class="reference internal" href="../../theory/data_analysis/graphical_fitting_test.html#graphical-fitting-test"><span class="std std-ref">Graphical goodness-of-fit tests</span></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>sample</strong><span class="classifier">2-d sequence of float</span></dt><dd><p>Tested (univariate) sample.</p>
</dd>
<dt><strong>normal_distribution</strong><span class="classifier"><a class="reference internal" href="openturns.Normal.html#openturns.Normal" title="openturns.Normal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Normal</span></code></a>, optional</span></dt><dd><p>Tested (univariate) normal distribution.</p>
<p>If not given, this will build a <a class="reference internal" href="openturns.Normal.html#openturns.Normal" title="openturns.Normal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Normal</span></code></a> distribution
from the given sample using the <a class="reference internal" href="openturns.NormalFactory.html#openturns.NormalFactory" title="openturns.NormalFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalFactory</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>graph</strong><span class="classifier"><a class="reference internal" href="openturns.Graph.html#openturns.Graph" title="openturns.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></span></dt><dd><p>The graph object</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">VisualTest.DrawQQplot</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">FittingTest.Kolmogorov</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Henry plot is a visual fitting test for the normal distribution. It
opposes the sample quantiles to those of the standard normal distribution
(the one with zero mean and unit variance) by plotting the following points
could:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASMAAAAhBAMAAABgsdChAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGN3pSM+LdPtgnb/zMq9+CP1kAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEIUlEQVRYw61YS2jUQBj+s02T3W4SA6IFPbQeVPCgBUVBUIuXFgq1PguCEi0qaAvRWhVELFgq6mV9oOKhXfGBN/tAD4KwBUH0IEFRKIotvipU1xYf0EPBmX9ms5lsu7tlZyCTzM43+b/5/3++mQ0AKNVQTCkAU5povQCklLJaKbArtIpVS6G0Sw6swqH1fRmM9Jo5wOJLZkdsQF96EihFE8XD1LXts6OvYuRqJFC643sedGc0N22PBWDjNowzn/HESsIJi9xwmIFsX0igdCHzcJtci3ID1p6FWYSI2U9bPXwWNuGcBGigDQ3X3IHSGcU6M+7oo7li5wDeiDBWeHgW04pwtKiDlEnaqrJLphRv4g+aS2aoO6zRuGmlJ1BisB+X0gP/qLuSrO8Qdc0JwgYprsf8TpZMyeAkwPI0wzb7eOusJ3qJwSJEdsZorvO+n+AMwXvy0Exbn/A1ucoUS4nNNQUoVWVsR2xqnb9Q+bWPZEo6nU5ySgw2j7jgGrnv52OWgFkDEfLQQVunMPc6c0yYwio17/4pQKkXspS+8W0B1OVn3+0RvMRgW0h+Xyb33T4ly8FNZAR7aRqpkwUDU4jSAz+pPBhy1FFuute+yd33IQB7CDHwAqv0KRgLoZG6j4rCPPTGVMmUPtPqxtPr/boLjz2S47Sshl47yhwW+97mw2A7WHifJr+fHj5in4R4G8lxnmpRzLfusAX1dHGUDu87uKOyg8xtgA5yNzsvgFIoZ71/CaUyISkHsD6XxlVlkuDUqcuMBMKbMussiovtYthUZZS68NFOUvbmoWRe64Z2VyfJvA11e4vtwHHyVAdhL/GyDUdNwRec9wTRbXVSQxFXqWMjNOAGRv1V2FZipCgv6VoKWqGCWF2K7XtUmGxQuCIEc4kVhGkT4GQo4WAg63IhZCiVIaWNOcbGiwtcfJQsm0iSTx/WhcLfnF1xAS+Vc9GmgYMyN3iYSs7uJegqjhLZ2LtQbAZpChMbougqv46K+EEcxHdlZZqGw64ICa6B73iZE5FUophcIkJiTkBLjNlq1YY0P0xvbVG9A5RGEv5WraVa7bZsN4pAFP12nrpxa2CoNeqI75piRsJXC2jV8ERjgvPxTM9xf0C9I+5xWfmyVu3lrRVgjg2P1QZnKOiSGlQCdUzYiZWvv7+gkXovcDn0QGq50OMG1Nsvbl6Rx9IR7sZD1QidhTmNwSokl26edlVtUZREWDTc3Rza40qiFHXC2TjzchBgVmiQkvLlNF4967TyGNFnPC/lpxSChU4geIRja40tu5IoxTrndvhk5ZbY25CRhsBhR8bZey4wXcxA1CsNhbRFwt+B/bJgBkbruQRKhicJ1pJ1Van/dpskwZ4h81oJlGC5HJiFCZWW8plivicFhgKuy/lyIuf7kondryXw+Q+r3wKbNtQ+XAAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\left(x^{(i)},
      \Phi^{-1}\left(\widehat{F}\left(x^{(i)}\right)\right)
\right), \quad i = 1, \ldots, m"/></p>
</div><p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAATBAMAAABSLiGnAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv90YSOmLdGCvMvP7nc+MQ+DRAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbElEQVQI12NgYGBgVGYAAZaw0gYQPdGAYSKQ4nRgYOASZsAEsw/OFPoGpJkUGBimA2n+CwwMLUDaH6ihGUjfZ+BgWACknzJwgtUfnRkLorh+MEwB0WwfGBJANF8AxDieCRB6PdhyBk79lyAKAHRwE73n02ZHAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\widehat{F}" style="vertical-align: 0px"/> denotes the empirical CDF of the sample and
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAQBAMAAAAYI2niAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMASK/p3TJ0GIvPYPvzneHVlhAAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABtSURBVAjXY2BAAmUODCggzQCVzwriMyo/UUXmM7A9RZFnKHpRwMBwSUlJF8IXSXvaGYCQZ3zI9ZxrK5R/gIGB2YDrOcNOCH/RjgAGvglAvg3CTmR5EEDWDwaSCPMhoOhZAYqrEe6DGIBwPxAAAIUaHOiVwDS8AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="\Phi^{-1}" style="vertical-align: 0px"/> denotes the quantile function of the standard normal
distribution.</p>
<p>If the given sample fits to the tested normal distribution (with mean
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAMBAMAAABGh1qtAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAz2DdSDIY+3Tzr7/pi4mQ6v4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABJSURBVAjXY2BgVGAwYWBg4Atgewak1Bk4JgCphQzcG4DUCQbOBiD1lCEvJYGB6QnDcl4GBq6DHdmXGBh4QBIgbWBKHUwydIFJAEhtDOg0qsToAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\mu" style="vertical-align: -4px"/> and standard deviation <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAANUlEQVQI12NgYNT//5mBgcE1vRNIMjYwrAZSzAcYbgCpYgaGOCAFFDEDCTKwXABSPHPnAEkAOqcJ7ewSY/oAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\sigma" style="vertical-align: 0px"/>), then the points should be
close to be aligned (up to the uncertainty associated with the estimation
of the empirical probabilities) on the <strong>Henry line</strong> whose equation reads:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAAAhBAMAAADXKX+vAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPvdnWCvz/Myi+k+AKxlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABvklEQVRIx2NgwAAcyicuOyALcDUwJDKQCYQYc7kbkAX4D7B8IdewAsYvvCgCrQxMG8g1jIF9AYhsSwOCXBBrFgOzAdmG8Smg8h8xcCuQa1bDeQd2FIE/DP6ODuSZxbvhtsMdlNj9yDCVl0yH8Uw6MUkAWYDzlZLzDQIOeLf62TYFcoIQG/DkYjipTIxh/AeIMoyLnQh1wGSGG7BcTkuCGcZ4gQjDNPHIXWtBuIypgYFRmYGJ9CTZZNNrAgr4CQhvHu5iYHBiFWArYGBgXgUCE4g0i1FB7MIOIO0GDzO2ZXFAUxrkGVgFSM5wDPIOoBDqRUTAYS9IzpNHjbz/2MAHNOOqwGQdMPtCI4BTHJSCdjCUkZG0H4HJdqSksSAFGLlfGNIZSA0zDp4vDMAgYmBDMkz3FJD+wPORqFy2BIlzm3cLLyiJwtOBJzMDlxPQ+Js3PxAVgbFInJM6nYrI6YzpnfVCnuRIUNQQl8yY8OUAWDZuYD1AvmFogIvBlrhAJ6aE4b2uQD3D6AVu//8fQC2zuEyOFVDNYdcYOB5QzbBABqYEapnFE8DAPIFahgH9yOpANW8GMCyiXsoQVye1BAYAHL56FN04+eMAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="y = \frac{x - \mu}{\sigma}, \quad x \in \Rset"/></p>
</div><p>The Henry plot is a special case of the more general QQ-plot.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openturns.viewer</span> <span class="kn">import</span> <span class="n">View</span>
</pre></div>
</div>
<p>Generate a random sample from a Normal distribution:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Draw an Henry plot against a given (wrong) Normal distribution:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">henry_graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">VisualTest</span><span class="o">.</span><span class="n">DrawHenryLine</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">henry_graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s1">&#39;Henry plot against given </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">View</span><span class="p">(</span><span class="n">henry_graph</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Draw an Henry plot against an inferred Normal distribution:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">henry_graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">VisualTest</span><span class="o">.</span><span class="n">DrawHenryLine</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">henry_graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s1">&#39;Henry plot against inferred Normal distribution&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">View</span><span class="p">(</span><span class="n">henry_graph</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="openturns.VisualTest.DrawKendallPlot.html" title="DrawKendallPlot"
             >next</a> |</li>
        <li class="right" >
          <a href="openturns.VisualTest.DrawParallelCoordinates.html" title="DrawParallelCoordinates"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../user_manual.html" >API</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../statistics_on_sample.html" >Statistics on sample</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">DrawHenryLine</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 21, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>