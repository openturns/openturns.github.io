
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Sensivity analysis by Fourier decomposition &#8212; OpenTURNS  documentation</title>
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Importance factors from FORM method" href="importance_form.html" />
    <link rel="prev" title="Sensivity analysis with correlated inputs" href="sensitivity_ancova.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="importance_form.html" title="Importance factors from FORM method"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sensitivity_ancova.html" title="Sensivity analysis with correlated inputs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" accesskey="U">Reliability, sensitivity</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="sensitivity_ancova.html"
                        title="previous chapter">Sensivity analysis with correlated inputs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="importance_form.html"
                        title="next chapter">Importance factors from FORM method</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/reliability_sensitivity/sensitivity_fast.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sensivity-analysis-by-fourier-decomposition">
<span id="sensitivity-fast"></span><h1>Sensivity analysis by Fourier decomposition<a class="headerlink" href="#sensivity-analysis-by-fourier-decomposition" title="Permalink to this headline">Â¶</a></h1>
<p>FAST is a sensitivity analysis method which is based upon the ANOVA
decomposition of the variance of the model response
<img class="math" src="../../_images/math/a5001f7b6c60d31a8c1ee6ebe0ad47688502ef72.svg" alt="y = f(\vect{X})"/>, the latter being represented by its Fourier
expansion. <img class="math" src="../../_images/math/c7eef7c09e3a3a1c3b6102365e1c7c2a34964eb9.svg" alt="\vect{X}=\{X^1,\dots,X^{n_X}\}"/> is an input random
vector of <img class="math" src="../../_images/math/b85da35c527a1972f535d6fb705074858a18a86b.svg" alt="n_X"/> independent components.</p>
<div class="line-block">
<div class="line">The extended FAST method consists in computing
alternately the first order and the total-effect indices of each
input. This approach relies upon a Fourier decomposition of the model
response. Its key idea is to recast this representation as a function
of a <img class="math" src="../../_images/math/97d52fcfdbbb9e86d67a6da7550a9e2bd00e87e8.svg" alt="\mathit{scalar}"/> parameter <img class="math" src="../../_images/math/46e3d6fa7fb2e016881a4aceef95118850742017.svg" alt="s"/>, by defining
parametric curves <img class="math" src="../../_images/math/14124eb16a4f88f4671d36e5d44236a61d6f724e.svg" alt="s \mapsto x_i(s)"/>, <img class="math" src="../../_images/math/029f6decf4acf1b2fbdb2aa267da0758b0959a5e.svg" alt="i=1, \dots, n_X"/>
exploring the support of the input random vector <img class="math" src="../../_images/math/2004c72388bf05e1574f2b73da2cb076fe29d894.svg" alt="\vect{X}"/>.</div>
<div class="line">For each input, the same procedure is realized in three steps:</div>
</div>
<ul>
<li><p>Sampling:</p>
<p>Deterministic space-filling paths with random starting points are
defined, i.e. each input <img class="math" src="../../_images/math/ebc9003e54d5508e06b32253f9252a387fa10e37.svg" alt="X^i"/> is transformed as follows:</p>
<div class="math">
<p><img src="../../_images/math/20151826dcc77b33f777c5d43c881d2e173789ac.svg" alt="x^i_j = \frac{1}{2} + \frac{1}{\pi} \arcsin(\sin(\omega_i s_j + \phi_i)),
    \quad i=1, \dots, n_X, \, j=1, \dots, N"/></p>
</div><p>where <img class="math" src="../../_images/math/b85da35c527a1972f535d6fb705074858a18a86b.svg" alt="n_X"/> is the number of input variables. <img class="math" src="../../_images/math/740219495c5b12f680f503149cd6a3d24d7374cb.svg" alt="N"/> is the
length of the discretization of the s-space, with <img class="math" src="../../_images/math/46e3d6fa7fb2e016881a4aceef95118850742017.svg" alt="s"/> varying
in <img class="math" src="../../_images/math/17ac45fa3cde1e662ad9078a37c3999619fc7289.svg" alt="(-\pi, \pi)"/> by step of <img class="math" src="../../_images/math/e2e4ff792945087e8ba812696c54f87db6c15b14.svg" alt="2\pi/N"/>. <img class="math" src="../../_images/math/9593eb3ea1c796322e1d6ba298920766b9eb1631.svg" alt="\phi_i"/> is a
random phase-shift chosen uniformly in <img class="math" src="../../_images/math/9a02e001bbb4fd63efd6d9bf5f7322802e22bd27.svg" alt="[0, 2\pi]"/> which
enables to make the curves start anywhere within the unit hypercube
<img class="math" src="../../_images/math/e9c18cd01c5b77f79fefa39d91ae6bd262b50570.svg" alt="K^{n_X}=(\vect{X}|0\leq x_i\leq1; i=1, \dots, n_X)"/>. The
selection of the set <img class="math" src="../../_images/math/70c4f80f2399c6aa626cefc5a47b9671fff2591b.svg" alt="\{\phi_1, \dots, \phi_{n_X}\}"/> induces a
part of randomness in the procedure. So it can be asked to realize
the procedure <img class="math" src="../../_images/math/f614a1f83d750f87121bc0babed98895b82a6e02.svg" alt="Nr"/> times and then to calculate the arithmetic
means of the results over the <img class="math" src="../../_images/math/f614a1f83d750f87121bc0babed98895b82a6e02.svg" alt="Nr"/> estimates. This operation is
called <img class="math" src="../../_images/math/d23d2dd8f7c855439fd5ecdc9c06a467dee6dec3.svg" alt="\mathit{resampling}"/>.</p>
<p><img class="math" src="../../_images/math/ea1cafdf423a90db77a95d2818497d2b69863e66.svg" alt="\{\omega_i\}, \forall i=1, \dots, n_X"/> is a set of integer
frequencies assigned to each input <img class="math" src="../../_images/math/ebc9003e54d5508e06b32253f9252a387fa10e37.svg" alt="X^i"/>. The frequency
associated with the input of interest is set to the maximum
admissible frequency satisfying the Nyquist criterion (which ensures
to avoid aliasing effects):</p>
<div class="math">
<p><img src="../../_images/math/53f37f50f45120135bb6c353ead678487e3e0ba3.svg" alt="\omega_i = \frac{N - 1}{2M}"/></p>
</div><p>with <img class="math" src="../../_images/math/2a2dc646b3cafced3b349b741b995cdfcf26f108.svg" alt="M"/> the interference factor usually equal to 4 or higher.
It corresponds to the truncation level of the Fourier series, i.e.
the number of harmonics that are retained in the decomposition
realized in the third step of the procedure.</p>
<p>In the paper <a class="reference internal" href="../../bibliography.html#saltelli1999" id="id1"><span>[saltelli1999]</span></a>, for high sample size, it is
suggested that <img class="math" src="../../_images/math/ddcec80964f0a6498b4fd8ce6219c55c766249e2.svg" alt="16 \leq \omega_i/N_r \leq 64"/>.</p>
<p>And the maximum frequency of the complementary set of frequencies is:</p>
<div class="math">
<p><img src="../../_images/math/6b16a111ddba150433220910f2bb7b1c58d28e2b.svg" alt="\max(\omega_{-i}) = \frac{\omega_i}{2M} = \frac{N - 1}{4M^2}"/></p>
</div><p>with the index â<img class="math" src="../../_images/math/884fd99f97fde80a5e810b7f89bd673df44789fc.svg" alt="-i"/>â which meaning âall but <img class="math" src="../../_images/math/9de4cabb3fd874ec0468618f22d2e54b6a4d28dd.svg" alt="i"/>â.</p>
<p>The other frequencies are distributed uniformly between <img class="math" src="../../_images/math/70ea698cda2b4a92b1d1c14d480d02319d782848.svg" alt="1"/> and
<img class="math" src="../../_images/math/768bfadec2fa27531c2665744c6869f6ce3331f3.svg" alt="\max(\omega_{-i})"/>. The set of frequencies is the same
whatever the number of resamplings is.</p>
<p>Let us make an example with eight input factors, <img class="math" src="../../_images/math/008763b3981de2573f8c7fe2c8086192b96a9d26.svg" alt="N=513"/> and
<img class="math" src="../../_images/math/fd744e857733b7ec9c0217e7920413120fc1a80f.svg" alt="M=4"/> i.e. <img class="math" src="../../_images/math/6eb98206267007123b02e05beee47ab72f29d8cf.svg" alt="\omega_i = \frac{N - 1}{2M} = 64"/> and
<img class="math" src="../../_images/math/9786dc2849ab85b987f5828137760911494998a2.svg" alt="\max(\omega_{-i}) = \frac{N - 1}{4M^2} = 8"/> with <img class="math" src="../../_images/math/9de4cabb3fd874ec0468618f22d2e54b6a4d28dd.svg" alt="i"/> the
index of the input of interest.</p>
<div class="line-block">
<div class="line">When computing the sensitivity indices for the first input, the
considered set of frequencies is :
<img class="math" src="../../_images/math/5e4c8352630fd1d5bfeace56a2e807525a9a4ff8.svg" alt="\{64, 1, 2, 3, 4, 5, 6, 8\}"/>.</div>
<div class="line">When computing the sensitivity indices for the second input, the
considered set of frequencies is :
<img class="math" src="../../_images/math/abf8512e589c2bb826833f6a6d8b05e89f215ad6.svg" alt="\{1, 64, 2, 3, 4, 5, 6, 8\}"/>.</div>
<div class="line">etc.</div>
</div>
<p>The transformation defined above provides a uniformly distributed
sample for the <img class="math" src="../../_images/math/c566c2dcf479c9024886111c49eb5c773bce4317.svg" alt="x_i, \forall i=1, \dots, n_X"/> oscillating
between <img class="math" src="../../_images/math/3f2ce07415b3bc378e63717e93094317a8053d87.svg" alt="0"/> and <img class="math" src="../../_images/math/70ea698cda2b4a92b1d1c14d480d02319d782848.svg" alt="1"/>. In order to take into account the
real distributions of the inputs, we apply an isoprobabilistic
transformation on each <img class="math" src="../../_images/math/c41ceef0ed329e09f50a5e8a4918d85931d3105d.svg" alt="x_i"/> before the next step of the
procedure.</p>
</li>
<li><p>Simulations:</p>
<p>Output is computed such as:
<img class="math" src="../../_images/math/a2dc38cb709bbea24f2662f25d7a664776c741a0.svg" alt="y = f(s) = f(x_1(s), \dots, x_{n_X}(s))"/></p>
<p>Then <img class="math" src="../../_images/math/334c3e5f3a7a9664723de24ad64e260d27631f01.svg" alt="f(s)"/> is expanded onto a Fourier series:</p>
<div class="math">
<p><img src="../../_images/math/44a8f47e5f655089024e9f35a8bf1c2ae7e7c493.svg" alt="f(s) = \sum_{k \in \Zset^N} A_k \cos(ks) + B_k \sin(ks)"/></p>
</div><p>where <img class="math" src="../../_images/math/8c9bf5dd8b8a79bf39309c09896d1593adb51251.svg" alt="A_k"/> and <img class="math" src="../../_images/math/088afde991653937bc353d217b4ec7d6d1a3bf45.svg" alt="B_k"/> are Fourier coefficients defined as
follows:</p>
<div class="math">
<p><img src="../../_images/math/6055eba4115d5f3cf12a27af0f819b2da0898dd7.svg" alt="\begin{aligned}
    A_k &amp;=&amp; \frac{1}{2\pi}\int_{-\pi}^{\pi}f(s) \cos(ks) \, ds \\
    B_k &amp;=&amp; \frac{1}{2\pi}\int_{-\pi}^{\pi}f(s) \sin(ks) \, ds
  \end{aligned}"/></p>
</div><p>These coefficients are estimated thanks to the following discrete
formulations:</p>
<div class="math">
<p><img src="../../_images/math/2e098cf03811f669c61310d3e276bf3713773a51.svg" alt="\begin{aligned}
    \hat{A}_k &amp;=&amp; \frac{1}{N} \sum_{j=1}^N f(x_j^1,\dots,x_j^{N_X}) cos \left( \frac{2k\pi (j-1)}{N} \right) \quad , \quad -\frac{N}{2} \leq k \leq \frac{N}{2}\\
    \hat{B}_k &amp;=&amp; \frac{1}{N} \sum_{j=1}^N f(x_j^1,\dots,x_j^{N_X}) sin \left( \frac{2k\pi (j-1)}{N} \right) \quad , \quad -\frac{N}{2} \leq k \leq \frac{N}{2}
  \end{aligned}"/></p>
</div></li>
<li><p>Estimations by frequency analysis:</p>
<p>The first order indices are estimated as follows:</p>
<div class="math">
<p><img src="../../_images/math/a9dcf5712260e3c824ae92dd92b8e7cc8d9bf017.svg" alt="\hat{S}_i = \frac{\hat{D}_i}{\hat{D}} \\
              = \frac{\sum_{p=1}^M(\hat{A}_{p\omega_i}^2 + \hat{B}_{p\omega_i}^2)^2}
                     {\sum_{n=1}^{(N-1)/2}(\hat{A}_n^2 + \hat{B}_n^2)^2}"/></p>
</div><p>where <img class="math" src="../../_images/math/0423e9c669ea11bfab3c214337523db2d68db790.svg" alt="\hat{D}"/> is the total variance and <img class="math" src="../../_images/math/d55e7b443b47016eb9d56e8fc55e195b6eb17050.svg" alt="\hat{D}_i"/> the
portion of <img class="math" src="../../_images/math/0e0bc55cfdad8dce56336f89bc3a9cc3f1aa54ec.svg" alt="D"/> arising from the uncertainty of the
<img class="math" src="../../_images/math/6029fa87baad8dcd62af1bc68294c58c661d0136.svg" alt="i^{th}"/> input. <img class="math" src="../../_images/math/740219495c5b12f680f503149cd6a3d24d7374cb.svg" alt="N"/> the size of the sample using to
compute the Fourier series and <img class="math" src="../../_images/math/2a2dc646b3cafced3b349b741b995cdfcf26f108.svg" alt="M"/> is the interference factor.
Saltelli et al. (1999) recommanded to set <img class="math" src="../../_images/math/2a2dc646b3cafced3b349b741b995cdfcf26f108.svg" alt="M"/> to a value in the
range <img class="math" src="../../_images/math/3bc3c595bb36015bee66bc778f7d9c2a8950213c.svg" alt="[4, 6]"/>.</p>
<p>The total order indices are estimated as follows:</p>
<div class="math">
<p><img src="../../_images/math/ed26233da533dd9b3bff1c650cb5abe43fea45e6.svg" alt="\hat{T}_i = 1 - \frac{\hat{D}_{-i}}{\hat{D}} \\
              = 1 - \frac{\sum_{k=1}^{\omega_i/2}(\hat{A}_k^2 + \hat{B}_k^2)^2}
                         {\sum_{n=1}^{(N-1)/2}(\hat{A}_n^2 + \hat{B}_n^2)^2}"/></p>
</div><p>where <img class="math" src="../../_images/math/f565bb8ca71d82ea0feb19907d569db5bfb4972b.svg" alt="\hat{D}_{-i}"/> is the part of the variance due to all the
inputs except the <img class="math" src="../../_images/math/6029fa87baad8dcd62af1bc68294c58c661d0136.svg" alt="i^{th}"/> input.</p>
</li>
</ul>
<div class="topic">
<p class="topic-title first">API:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.FAST.html#openturns.FAST" title="openturns.FAST"><code class="xref py py-class docutils literal notranslate"><span class="pre">FAST</span></code></a></p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../examples/reliability_sensitivity/sensitivity_fast.html"><span class="doc">FAST sensitivity indices</span></a></p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../bibliography.html#saltelli1999" id="id2"><span>[saltelli1999]</span></a></p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="importance_form.html" title="Importance factors from FORM method"
             >next</a> |</li>
        <li class="right" >
          <a href="sensitivity_ancova.html" title="Sensivity analysis with correlated inputs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="reliability_sensitivity.html" >Reliability, sensitivity</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2019 Airbus-EDF-IMACS-Phimeca.
      Last updated on Jun 05, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.0.
    </div>
  </body>
</html>