
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Dickey-Fuller stationarity test &#8212; OpenTURNS 1.13 documentation</title>
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Meta modeling" href="../meta_modeling/meta_modeling.html" />
    <link rel="prev" title="Process transformation" href="process_transformation.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../meta_modeling/meta_modeling.html" title="Meta modeling"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="process_transformation.html" title="Process transformation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.13 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="probabilistic_modeling.html" accesskey="U">Probabilistic modeling</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="process_transformation.html"
                        title="previous chapter">Process transformation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../meta_modeling/meta_modeling.html"
                        title="next chapter">Meta modeling</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/probabilistic_modeling/dickey_fuller.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dickey-fuller-stationarity-test">
<span id="dickey-fuller"></span><h1>Dickey-Fuller stationarity test<a class="headerlink" href="#dickey-fuller-stationarity-test" title="Permalink to this headline">¶</a></h1>
<p>The Dickey-Fuller test checks the stationarity of a scalar time series using one time series. It assumes that the <img class="math" src="../../_images/math/8d8b6956645e3e4efda04228ee4205d173645428.svg" alt="X: \Omega \times \cD \rightarrow \Rset"/> process with <img class="math" src="../../_images/math/55e9e49d1f32b8500786f787f4afaef02940b447.svg" alt="\cD \in \Rset"/>, discretized on the time grid <img class="math" src="../../_images/math/4d79d3c269d47555e7d6903814768d5455d95749.svg" alt="(t_0, \dots, t_{N-1})"/> writes:</p>
<div class="math" id="equation-dfmodel">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-dfmodel" title="Permalink to this equation">¶</a></span><img src="../../_images/math/c3ea7fd64f92748ed9bb416d73dfd8d2b99c500e.svg" alt="X_t = a + bt + \rho X_{t-1} + \varepsilon_{t}"/></p>
</div><p>where <img class="math" src="../../_images/math/0d2b689b6f80d0a7f9770ee5ae4b363e5bbc1c85.svg" alt="\rho &gt; 0"/> and where <img class="math" src="../../_images/math/ece4a7cfc2af3365b5cb135a0ee4d58bd43199d3.svg" alt="a"/> or <img class="math" src="../../_images/math/20ad63a10fc55a6380ef3785edd8861f76af7a8c.svg" alt="b"/> or both <img class="math" src="../../_images/math/1777420de2db69485edf1529c7215f3669c06fed.svg" alt="(a,b)"/> can be assumed to be equal to 0.</p>
<p>The Dickey-Fuller test checks whether the random perturbation at time <img class="math" src="../../_images/math/f7ee39ba037b4b9bf5513f078e161baacde96e69.svg" alt="t"/> vanishes with time.</p>
<p>When <img class="math" src="../../_images/math/c1a7aaf6ed95a445f2b034d047f8a01697e357b5.svg" alt="a \neq 0"/> and <img class="math" src="../../_images/math/a4aaa6b4e9a26dc9f5b413e4c03539e671bda5be.svg" alt="b=0"/>, the model <a class="reference internal" href="#equation-dfmodel">(1)</a> is said to have a <em>drift</em>. When <img class="math" src="../../_images/math/e7e5264d5083d1300173f131efca6d9c87deb4d0.svg" alt="a = 0"/> and <img class="math" src="../../_images/math/a116f6d81da0213fb1ff42325f88e0848f49550e.svg" alt="b \neq 0"/>, the model <a class="reference internal" href="#equation-dfmodel">(1)</a> is said to have a <em>linear trend</em>.</p>
<p>In the model <a class="reference internal" href="#equation-dfmodel">(1)</a>, the only way to have stochastic non stationarity is to have <img class="math" src="../../_images/math/1f98f0b32b3902f5125bbad47021128d64215f31.svg" alt="\rho = 1"/> (if <img class="math" src="../../_images/math/efec56097066b132a97eddc70e097f8de89aa138.svg" alt="\rho &gt; 1"/>, then the process diverges with time which is readily seen in the data). In the general case, the Dickey-Fuller test is a unit root test to detect whether <img class="math" src="../../_images/math/558e4c8e8cb189d2587a26561bbe651e2ea84abd.svg" alt="\rho=1"/> against <img class="math" src="../../_images/math/6c75952eda30e7e2c7d245c54882f5b0202ca7bb.svg" alt="\rho &lt; 1"/>:</p>
<p>The test statistics and its limit distribution depend on the a priori knowledge we have on <img class="math" src="../../_images/math/ece4a7cfc2af3365b5cb135a0ee4d58bd43199d3.svg" alt="a"/> and <img class="math" src="../../_images/math/20ad63a10fc55a6380ef3785edd8861f76af7a8c.svg" alt="b"/>. In case of absence of a priori knowledge on the structure of the model, several authors have proposed a global strategy to cover all the subcases of the model <a class="reference internal" href="#equation-dfmodel">(1)</a>, depending on the possible values on <img class="math" src="../../_images/math/ece4a7cfc2af3365b5cb135a0ee4d58bd43199d3.svg" alt="a"/> and <img class="math" src="../../_images/math/20ad63a10fc55a6380ef3785edd8861f76af7a8c.svg" alt="b"/>.</p>
<p>The strategy implemented is recommended by Enders (<em>Applied Econometric Times Series</em>, Enders, W., second edition, John Wiley &amp; sons editions, 2004.).</p>
<p>We note <img class="math" src="../../_images/math/3793da53207d9780e8efcf87c80969d3caa51b68.svg" alt="(X_1, \hdots, X_n)"/> the data, by <img class="math" src="../../_images/math/fedf3ab7e791414a9d9f8116c47403bda50be000.svg" alt="W(r)"/> the Wiener process, and <img class="math" src="../../_images/math/78abae6c451047622af5296b060c5ac7b88769e7.svg" alt="W^{a}(r) = W(r) - \int_{0}^{1} W(r)\di{r}"/>, <img class="math" src="../../_images/math/4eace83fca3940cba2493fcb65b1d10eca0b368c.svg" alt="W^{b}(r) = W^{a}(r) - 12 \left(r - \frac{1}{2} \right) \int_{0}^{1} \left(s - \frac{1}{2} \right) W(s)\di{s}"/>.</p>
<p><strong>1.</strong> We assume the model <a class="reference internal" href="#equation-model1">(2)</a>:</p>
<div class="math" id="equation-model1">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-model1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/fd4fee1ede495bd136894d7c0af593152a9aabf8.svg" alt="\boldsymbol{X_t = a + bt + \rho X_{t-1} + \varepsilon_{t}}"/></p>
</div><p>The coefficients <img class="math" src="../../_images/math/3958e6de8c14c9f5a0e2a727d8da2fd859d52320.svg" alt="(a,b,\rho)"/> are estimated by <img class="math" src="../../_images/math/8a4d1ecd06272626f4c96f72fc0b212a39d9fa6e.svg" alt="(\Hat{a}_n, \Hat{b}_n, \Hat{\rho}_n)"/> using ordinary least-squares fitting, which leads to:</p>
<div class="math" id="equation-model1estim">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-model1estim" title="Permalink to this equation">¶</a></span><img src="../../_images/math/19421348865aa7f1dcc64b81551de7ec3c24d82a.svg" alt="\underbrace{\left(
   \begin{array}{lll}
     \displaystyle n-1 &amp;\sum_{i=1}^n t_{i} &amp;\sum_{i=2}^n y_{i-1}\\
     \displaystyle \sum_{i=1}^n t_{i} &amp;\sum_{i=1}^n t_{i}^2 &amp;\sum_{i=2}^n t_{i} y_{i-1}\\
     \displaystyle \sum_{i=2}^n y_{i-1}&amp; \sum_{i=2}^n t_{i}y_{i-1} &amp;\sum_{i=2}^n y_{i-1}^2
   \end{array}
   \right)}_{\mat{M}}
 \left(
   \begin{array}{c}
    \hat{a}_n\\
    \hat{b}_n\\
    \hat{\rho}_n
   \end{array}
 \right)=
 \left(
 \begin{array}{l}
   \displaystyle \sum_{i=1}^n y_{i} \\
   \displaystyle \sum_{i=1}^n t_{i} y_{i}\\
   \displaystyle \sum_{i=2}^n y_{i-1} y_{i}
 \end{array}
 \right)"/></p>
</div><p>We first test:</p>
<div class="math" id="equation-testmodel1">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-testmodel1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/69827e2974d06b92c9cc19088266b29b83fd26e7.svg" alt="\left\{
\begin{array}{lr}
  \cH_0: &amp; \rho = 1 \\
  \cH_1: &amp; \rho &lt; 1
\end{array}
\right."/></p>
</div><p>thanks to the Student statistics:</p>
<div class="math">
<p><img src="../../_images/math/13faf53c383d02e8db13a0405183486186ab6fe6.svg" alt="t_{\rho=1} = \frac{\rho_n-1}{\hat{\sigma}_{\rho_n}}"/></p>
</div><p>where <img class="math" src="../../_images/math/272bf650e8ba3f11f1dbfd0e4ea0f979c3ade63a.svg" alt="\sigma_{\rho_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/0a91614590c14505b164d94811bf873c9539c8ac.svg" alt="\Hat{\rho}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/2595b7eae299d0ce9ce7eda81992a167859f3365.svg" alt="\sigma_{\rho_n}=\mat{M}^{-1}_{33}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{b}_nt_i+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><p>which converges in distribution to the Dickey-Fuller distribution associated to the model with drift and trend:</p>
<div class="math">
<p><img src="../../_images/math/9f3763844709084856bb7c42f8585b089e48b3b4.svg" alt="t_{\rho = 1} \stackrel{\mathcal{L}}{\longrightarrow} \frac{\int_{0}^{1}W^{b}(r) \di{W(r)}}{\int_{1}^{0} W^{b}(r)^2 \di{r}}"/></p>
</div><p>The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted when <img class="math" src="../../_images/math/d7901efd0a7ea16b825bbf2d5c565ecd65ffc31e.svg" alt="t_{\rho=1} &gt; C_{\alpha}"/> where <img class="math" src="../../_images/math/351b0eb2bdbd46409c4ba89fab63350fd00c8be2.svg" alt="C_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/b3ea4a8b66bdc26891f89769bec9e5f37f304158.svg" alt="\alpha"/>.</p>
<p>The quantiles of the Dickey-Fuller statistics for the model with drift and linear trend are:</p>
<div class="math">
<p><img src="../../_images/math/bd5c181c770a43d5b6b91c06b1098a5b3a057330.svg" alt="\left\{
\begin{array}{ll}
    \alpha = 0.01, &amp; C_{\alpha} = -3.96 \\
    \alpha = 0.05, &amp; C_{\alpha} = -3.41 \\
    \alpha = 0.10, &amp; C_{\alpha} = -3.13
\end{array}
\right."/></p>
</div><p><strong>1.1. Case 1:</strong> The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is rejected</p>
<p>We test whether <img class="math" src="../../_images/math/a4aaa6b4e9a26dc9f5b413e4c03539e671bda5be.svg" alt="b=0"/>:</p>
<div class="math" id="equation-testsousmodele1-1">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-testsousmodele1-1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/f02de4c13a197a20dfd5a06c6aa6ea63f877f6c2.svg" alt="\left\{
\begin{array}{lr}
  \cH_0: &amp; b = 0 \\
  \cH_1: &amp; b \neq 0
\end{array}
\right."/></p>
</div><p>where the statistics <img class="math" src="../../_images/math/3b3db7b056ad418adbd5b1ce7620493ea8d3cec2.svg" alt="t_n = \frac{|\hat{b}_n|}{\sigma_{b_n}}"/> converges in distribution to the Student distribution <a class="reference internal" href="../../user_manual/_generated/openturns.Student.html#openturns.Student" title="openturns.Student"><code class="xref py py-class docutils literal notranslate"><span class="pre">Student</span></code></a> with <img class="math" src="../../_images/math/970051d7b21f0c63861e84b1ec6e7ca9ffe84b5a.svg" alt="\nu=n-4"/>, where <img class="math" src="../../_images/math/930fed10b79465efd8edf0f3aa13177631e0bd8a.svg" alt="\sigma_{b_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/36d48c6c1c67289e28fc81b6593c788f2bd522b9.svg" alt="\Hat{b}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/41df90ed346458ee1d5323253f13a81629b39ba6.svg" alt="\sigma_{b_n}=\mat{M}^{-1}_{22}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{b}_nt_i+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><dl class="simple">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-1">(5)</a> is rejected, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is confirmed. And the test <a class="reference internal" href="#equation-testmodel1">(4)</a> proved that the unit root is rejected : <img class="math" src="../../_images/math/6c75952eda30e7e2c7d245c54882f5b0202ca7bb.svg" alt="\rho &lt; 1"/>. We then conclude that the final model is : <img class="math" src="../../_images/math/171d9a280bccc77389ef70f780b72cbc6e2246b8.svg" alt="\boldsymbol{X_t = a + bt + \rho X_{t-1} + \varepsilon_{t}}"/> with <img class="math" src="../../_images/math/894ec422e78005d00df0534728b56dc0838e08fd.svg" alt="\boldsymbol{\rho &lt; 1}"/> which is a <strong>trend stationary model</strong>.</p></li>
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-1">(5)</a> is accepted, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is not confirmed, since the trend presence is rejected and the test <a class="reference internal" href="#equation-testmodel1">(4)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the second model</strong> <a class="reference internal" href="#equation-model2">(7)</a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>1.2. Case 2:</strong> The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted</p>
<p>We test whether <img class="math" src="../../_images/math/1c834121425be63c55072bca237512d69bd4ae8a.svg" alt="(\rho, b) = (1,0)"/>:</p>
<div class="math" id="equation-testsousmodele1-2">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-testsousmodele1-2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/c94f04730e8be44f997e8b0b175c884a5c047dde.svg" alt="\left\{
\begin{array}{lr}
  \cH_0: &amp; (\rho, b) = (1,0) \\
  \cH_1: &amp; (\rho, b) \neq (1,0)
\end{array}
\right."/></p>
</div><p>with the Fisher statistics:</p>
<div class="math">
<p><img src="../../_images/math/0eb0060435d5046201a625dcd71b8622f3575cd6.svg" alt="\displaystyle \hat{F}_1 = \frac{(S_{1,0} - S_{1,b})/2}{S_{1,b}/(n-3)}"/></p>
</div><p>where <img class="math" src="../../_images/math/ec7ce93c7acd08598fd52ff73b85187447280ca4.svg" alt="S_{1,0}=\sum_{i=2}^n\left(y_i-(\hat{a}_n+y_{i-1})\right)^2"/> is the sum of the square errors of the model 1 <a class="reference internal" href="#equation-model1">(2)</a> assuming <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-2">(6)</a> and <img class="math" src="../../_images/math/4cb4b01cdc84de1274d964a285c82260cd388e28.svg" alt="S_{1,b}=\sum_{i=2}^n\left(y_i-(\hat{a}_n+\hat{b}_nt_i+\hat{\rho}_ny_{i-1})\right)^2"/> is the same sum when we make no assumption on <img class="math" src="../../_images/math/50a0e0573e3a7ae0b142adc4ebee53174be6f1fe.svg" alt="\rho"/> and <img class="math" src="../../_images/math/20ad63a10fc55a6380ef3785edd8861f76af7a8c.svg" alt="b"/>.</p>
<p>The statistics <img class="math" src="../../_images/math/9326b5ca4be0b7df79ba28fc99286da47786aaa0.svg" alt="\hat{F}_1"/> converges in distribution to the Fisher-Snedecor distribution <a class="reference internal" href="../../user_manual/_generated/openturns.FisherSnedecor.html#openturns.FisherSnedecor" title="openturns.FisherSnedecor"><code class="xref py py-class docutils literal notranslate"><span class="pre">FisherSnedecor</span></code></a> with <img class="math" src="../../_images/math/f259474e347146cec8790bfd5ba3591a1c56c58d.svg" alt="d_1=2, d_2=n-3"/>. The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted when <img class="math" src="../../_images/math/fd34e3b05c171af68b19a03ace436aa54663d4e5.svg" alt="\hat{F}_1 &lt; \Phi_{\alpha}"/> where <img class="math" src="../../_images/math/eaf0613e824f44685cef9ea679d0a5372dec6f34.svg" alt="\Phi_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/b3ea4a8b66bdc26891f89769bec9e5f37f304158.svg" alt="\alpha"/>.</p>
<dl class="simple">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-2">(6)</a> is rejected, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is confirmed since the presence of linear trend is confirmed. And the test <a class="reference internal" href="#equation-testmodel1">(4)</a> proved that the unit root is accepted: <img class="math" src="../../_images/math/1f98f0b32b3902f5125bbad47021128d64215f31.svg" alt="\rho = 1"/>. We then conclude that the model is: <img class="math" src="../../_images/math/ded84f7aaa0dd34c48995d65c63dd8189da8cc23.svg" alt="\boldsymbol{X_t = a + bt + X_{t-1} + \varepsilon_{t}}"/> which is a <strong>non stationary model</strong>.</p></li>
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele1-2">(6)</a> is accepted, then the model 1 <a class="reference internal" href="#equation-model1">(2)</a> is not confirmed, since the presence of the linear trend is rejected and the test <a class="reference internal" href="#equation-testmodel1">(4)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the second model</strong> <a class="reference internal" href="#equation-model2">(7)</a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>2.</strong> We assume the model <a class="reference internal" href="#equation-model2">(7)</a>:</p>
<div class="math" id="equation-model2">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-model2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/f11bd484f9dccf6aa16d3474cb4fd5e60c0325a4.svg" alt="\boldsymbol{X_t = a + \rho X_{t-1} + \varepsilon_{t}}"/></p>
</div><p>The coefficients <img class="math" src="../../_images/math/312bc94f0ec84b83e2eddfb55b9cedc195b97ade.svg" alt="(a,\rho)"/> are estimated as follows:</p>
<div class="math" id="equation-model2estim">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-model2estim" title="Permalink to this equation">¶</a></span><img src="../../_images/math/cf9fe1cea5a035f60264418c43dfcd9923739f0b.svg" alt="\underbrace{\left(\begin{array}{lll}
   \displaystyle n-1 &amp;\sum_{i=2}^n y_{i-1}\\
   \displaystyle \sum_{i=2}^n y_{i-1} &amp;\sum_{i=2}^n y_{i-1}^2
                  \end{array}
 \right)}_{\mat{N}}
 \left(
  \begin{array}{c}
    \hat{a}_n\\
    \hat{\rho}_n
  \end{array}
 \right)=
 \left(
  \begin{array}{l}
    \displaystyle \sum_{i=1}^n y_{i} \\
    \displaystyle \sum_{i=2}^n y_{i-1} y_{i}
   \end{array}
 \right)"/></p>
</div><p>We first test:</p>
<div class="math" id="equation-testmodel2">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-testmodel2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/730d1a455872de867b8e29b2ed0edfbc9ffc8e29.svg" alt="\left\{
 \begin{array}{lr}
   \mathcal{H}_0: &amp; \rho = 1 \\
   \mathcal{H}_1: &amp; \rho &lt; 1
 \end{array}
 \right."/></p>
</div><p>thanks to the Student statistics:</p>
<div class="math">
<p><img src="../../_images/math/a9c3b704bf97c1a334eabb2d4aba49f94740d5a6.svg" alt="t_{\rho=1} = \frac{\rho_n-1}{\sigma_{\rho_n}}"/></p>
</div><p>where <img class="math" src="../../_images/math/272bf650e8ba3f11f1dbfd0e4ea0f979c3ade63a.svg" alt="\sigma_{\rho_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/0a91614590c14505b164d94811bf873c9539c8ac.svg" alt="\Hat{\rho}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/c46f59b6db65ff6e683c3475f5eeaf4afa62e27a.svg" alt="\sigma_{\rho_n}=\mat{N}^{-1}_{22}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><p>which converges in distribution to the Dickey-Fuller distribution associated to the model with drift and no linear trend:</p>
<div class="math">
<p><img src="../../_images/math/88b3234bc96159ffe9fd5b140a86b476edd233a9.svg" alt="t_{\rho = 1} \stackrel{\mathcal{L}}{\longrightarrow} \frac{\int_{0}^{1}W^{a}(r) \di{W(r)}}{\int_{1}^{0} W^{a}(r)^2 \di{r}}"/></p>
</div><p>The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel2">(9)</a> is accepted when <img class="math" src="../../_images/math/d7901efd0a7ea16b825bbf2d5c565ecd65ffc31e.svg" alt="t_{\rho=1} &gt; C_{\alpha}"/> where <img class="math" src="../../_images/math/351b0eb2bdbd46409c4ba89fab63350fd00c8be2.svg" alt="C_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/b3ea4a8b66bdc26891f89769bec9e5f37f304158.svg" alt="\alpha"/>.</p>
<p>The quantiles of the Dickey-Fuller statistics for the model with drift are:</p>
<div class="math">
<p><img src="../../_images/math/b85e5d8699ef7e66d5aa4eabe4b97ca0c27456d7.svg" alt="\left\{
\begin{array}{ll}
    \alpha = 0.01, &amp; C_{\alpha} = -3.43 \\
    \alpha = 0.05, &amp; C_{\alpha} = -2.86 \\
    \alpha = 0.10, &amp; C_{\alpha} = -2.57
\end{array}
\right."/></p>
</div><p><strong>2.1. Case 1:</strong> The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel2">(9)</a> is rejected</p>
<p>We test whether <img class="math" src="../../_images/math/2977aec66a9d81179fe32e5a8a00922c5b8a78c9.svg" alt="a=0"/>:</p>
<div class="math" id="equation-testsousmodele2-1">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-testsousmodele2-1" title="Permalink to this equation">¶</a></span><img src="../../_images/math/f720da38519f0d45162a6e1116823c534ff19f57.svg" alt="\left\{
\begin{array}{lr}
  \mathcal{H}_0: &amp; a = 0 \\
  \mathcal{H}_1: &amp; a \neq 0
\end{array}
\right."/></p>
</div><p>where the statistics <img class="math" src="../../_images/math/73d93fc7bec3e7d3ee8b78de0c36b0c51f37e85a.svg" alt="t_n = \frac{|\hat{a}_n|}{\sigma_{a_n}}"/> converges in distribution to the Student distribution <a class="reference internal" href="../../user_manual/_generated/openturns.Student.html#openturns.Student" title="openturns.Student"><code class="xref py py-class docutils literal notranslate"><span class="pre">Student</span></code></a> with <img class="math" src="../../_images/math/98826f4b25e965be635efa8cd9070fdb390d6851.svg" alt="\nu=n-3"/>, where <img class="math" src="../../_images/math/319f353da9e3adac075324c782d5e64060002b78.svg" alt="\sigma_{a_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/e2a864bdf58a5237a8d4ad00fd2acdfdf5a825cb.svg" alt="\Hat{a}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/0432a3c4a622b7c967803c585f7e77818390284d.svg" alt="\sigma_{a_n}=\mat{N}^{-1}_{11}\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-(\hat{a}_n+\hat{\rho}_ny_{i-1})\right)^2}"/></p>
</div><dl class="simple">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-1">(10)</a> is rejected, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is confirmed. And the test <a class="reference internal" href="#equation-testmodel2">(9)</a> proved that the unit root is rejected: <img class="math" src="../../_images/math/6c75952eda30e7e2c7d245c54882f5b0202ca7bb.svg" alt="\rho &lt; 1"/>. We then conclude that the final model is: <img class="math" src="../../_images/math/8d66f0432b3320fc73f5123df42bf38623e69eaf.svg" alt="\boldsymbol{X_t = a + \rho X_{t-1} + \varepsilon_{t}}"/> with <img class="math" src="../../_images/math/894ec422e78005d00df0534728b56dc0838e08fd.svg" alt="\boldsymbol{\rho &lt; 1}"/> which is a <strong>stationary model</strong>.</p></li>
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-1">(10)</a> is accepted, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is not confirmed, since the drift presence is rejected and the test <a class="reference internal" href="#equation-testmodel1">(4)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the third model</strong> <a class="reference internal" href="#equation-model3">(12)</a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>2.2. Case 2:</strong> The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel2">(9)</a> is accepted</p>
<p>We test whether <img class="math" src="../../_images/math/2891a73f45900b67beb81d950af70f49c884567d.svg" alt="(\rho, a) = (1,0)"/>:</p>
<div class="math" id="equation-testsousmodele2-2">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-testsousmodele2-2" title="Permalink to this equation">¶</a></span><img src="../../_images/math/ff9ce806efc8312caf17ed93a13fc98f764510b8.svg" alt="\left\{
\begin{array}{lr}
  \mathcal{H}_0: &amp; (\rho, a) = (1,0) \\
  \mathcal{H}_1: &amp; (\rho, a) \neq (1,0)
\end{array}
\right."/></p>
</div><p>with a Fisher test. The statistics is:</p>
<div class="math">
<p><img src="../../_images/math/8cc04588012a2b0140d70242417bd650a13ad5ab.svg" alt="\displaystyle \hat{F}_2 = \frac{(SCR_{2,c} - SCR_{2})/2}{SCR_{2}/(n-2)}"/></p>
</div><p>where <img class="math" src="../../_images/math/905837c4d9a7caecc9d169278c41797db153b575.svg" alt="SCR_{2,c}"/> is the sum of the square errors of the model 2 <a class="reference internal" href="#equation-model2">(7)</a> assuming <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-2">(11)</a> and <img class="math" src="../../_images/math/a3ec178da0d24390293d7c470dfe31a1d34b55bd.svg" alt="SCR_{2}"/> is the same sum when we make no assumption on <img class="math" src="../../_images/math/50a0e0573e3a7ae0b142adc4ebee53174be6f1fe.svg" alt="\rho"/> and <img class="math" src="../../_images/math/ece4a7cfc2af3365b5cb135a0ee4d58bd43199d3.svg" alt="a"/>.</p>
<p>The statistics <img class="math" src="../../_images/math/88fc3c207b9b6d1070f2bcf0f280be7a70a041af.svg" alt="\hat{F}_2"/> converges in distribution to the Fisher-Snedecor distribution <a class="reference internal" href="../../user_manual/_generated/openturns.FisherSnedecor.html#openturns.FisherSnedecor" title="openturns.FisherSnedecor"><code class="xref py py-class docutils literal notranslate"><span class="pre">FisherSnedecor</span></code></a> with <img class="math" src="../../_images/math/dadc57040e0ed50420d373f537e3a8da7299cf01.svg" alt="d_1=2, d_2=n-2"/>. The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel1">(4)</a> is accepted if when <img class="math" src="../../_images/math/57af003b07cc5becac729f141dae316e904445d6.svg" alt="\hat{F}_2 &lt; \Phi_{\alpha}"/> where <img class="math" src="../../_images/math/eaf0613e824f44685cef9ea679d0a5372dec6f34.svg" alt="\Phi_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/b3ea4a8b66bdc26891f89769bec9e5f37f304158.svg" alt="\alpha"/>.</p>
<dl class="simple">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-2">(11)</a> is rejected, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is confirmed since the presence of the drift is confirmed. And the test <a class="reference internal" href="#equation-testmodel2">(9)</a> proved that the unit root is accepted: <img class="math" src="../../_images/math/813108bb5e7fbf4efeb457ae58bd8419050e9479.svg" alt="\rho =1"/>. We then conclude that the model is: <img class="math" src="../../_images/math/c505df83f97c4b0b91bc1b9587082a8b8b7c5fc7.svg" alt="\boldsymbol{X_t = a + X_{t-1} + \varepsilon_{t}}"/> which is a <strong>non stationary model</strong>.</p></li>
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testsousmodele2-2">(11)</a> is accepted, then the model 2 <a class="reference internal" href="#equation-model2">(7)</a> is not confirmed, since the drift presence is rejected and the test <a class="reference internal" href="#equation-testmodel2">(9)</a> is not conclusive (since based on a wrong model). <strong>We then have to test the third model</strong> <a class="reference internal" href="#equation-model3">(12)</a>.</p></li>
</ul>
</dd>
</dl>
<p><strong>3.</strong> We assume the model <a class="reference internal" href="#equation-model3">(12)</a>:</p>
<div class="math" id="equation-model3">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-model3" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b73e0060368cc3133b8f0dbab0cdc72339a3a10c.svg" alt="\boldsymbol{X_t = \rho X_{t-1} + \varepsilon_{t}}"/></p>
</div><p>The coefficients <img class="math" src="../../_images/math/50a0e0573e3a7ae0b142adc4ebee53174be6f1fe.svg" alt="\rho"/> are estimated as follows:</p>
<div class="math" id="equation-model3estim">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-model3estim" title="Permalink to this equation">¶</a></span><img src="../../_images/math/b6fe77073b23a9a3b42dc26f9e0e1dc2f0287582.svg" alt="\hat{\rho}_n=\frac{\sum_{i=2}^ny_{i-1}y_i}{\sum_{i=2}^ny_{i-1}^2}"/></p>
</div><p>We first test:</p>
<div class="math" id="equation-testmodel3">
<p><span class="eqno">(14)<a class="headerlink" href="#equation-testmodel3" title="Permalink to this equation">¶</a></span><img src="../../_images/math/470239dd7f96855e5bd756372bca63a0ba9cd7d6.svg" alt="\left\{
\begin{array}{lr}
  \mathcal{H}_0: &amp; \rho = 1 \\
  \mathcal{H}_1: &amp; \rho &lt; 1
\end{array}
\right."/></p>
</div><p>thanks to the Student statistics:</p>
<div class="math">
<p><img src="../../_images/math/382fbe7dde4011de79019a6421ace1fd3752f8eb.svg" alt="t_{\rho=1} = \frac{\hat{\rho}_n-1}{\sigma_{\rho_n}}"/></p>
</div><p>where <img class="math" src="../../_images/math/272bf650e8ba3f11f1dbfd0e4ea0f979c3ade63a.svg" alt="\sigma_{\rho_n}"/> is the least square estimate of the standard deviation of <img class="math" src="../../_images/math/0a91614590c14505b164d94811bf873c9539c8ac.svg" alt="\Hat{\rho}_n"/>, given by:</p>
<div class="math">
<p><img src="../../_images/math/990d8ed5dab50dfb6cf00b9cc075f60cf28d15d1.svg" alt="\sigma_{\rho_n}=\sqrt{\frac{1}{n-1}\sum_{i=2}^n\left(y_{i}-\hat{\rho}_ny_{i-1}\right)^2}/\sqrt{\sum_{i=2}^ny_{i-1}^2}"/></p>
</div><p>which converges in distribution to the Dickey-Fuller distribution associated to the random walk model:</p>
<div class="math">
<p><img src="../../_images/math/81d147c5f254b54039df27553667c5774eba9cd9.svg" alt="t_{\rho = 1} \stackrel{\mathcal{L}}{\longrightarrow} \frac{\int_{0}^{1}W(r) \di{W(r)}}{\int_{1}^{0} W(r)^2 \di{r}}"/></p>
</div><p>The null hypothesis <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel3">(14)</a> is accepted when <img class="math" src="../../_images/math/d7901efd0a7ea16b825bbf2d5c565ecd65ffc31e.svg" alt="t_{\rho=1} &gt; C_{\alpha}"/> where <img class="math" src="../../_images/math/351b0eb2bdbd46409c4ba89fab63350fd00c8be2.svg" alt="C_{\alpha}"/> is the test threshold of level <img class="math" src="../../_images/math/b3ea4a8b66bdc26891f89769bec9e5f37f304158.svg" alt="\alpha"/>.</p>
<p>The quantiles of the Dickey-Fuller statistics for the random walk model are:</p>
<div class="math">
<p><img src="../../_images/math/5336af1a2081e48f6211a792b4c14fce0a4e26c8.svg" alt="\left\{
\begin{array}{ll}
    \alpha = 0.01, &amp; C_{\alpha} = -2.57 \\
    \alpha = 0.05, &amp; C_{\alpha} = -1.94 \\
    \alpha = 0.10, &amp; C_{\alpha} = -1.62
\end{array}
\right."/></p>
</div><dl class="simple">
<dt>The decision to be taken is:</dt><dd><ul class="simple">
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel3">(14)</a> is rejected, we then conclude that the model is : <img class="math" src="../../_images/math/c036148f40218bfb916a3d37db2cace69cda9ba1.svg" alt="\boldsymbol{X_t = \rho X_{t-1} + \varepsilon_{t}}"/> where <img class="math" src="../../_images/math/6c75952eda30e7e2c7d245c54882f5b0202ca7bb.svg" alt="\rho &lt; 1"/> which is a <strong>stationary model</strong>.</p></li>
<li><p>If <img class="math" src="../../_images/math/7a86b67e16597ffb3a0cb3841fafd10ea6a1b0c8.svg" alt="\cH_0"/> from <a class="reference internal" href="#equation-testmodel3">(14)</a> is accepted, we then conclude that the model is: <img class="math" src="../../_images/math/1420d05ee99eae8713a19ef7d8ec22410d751ee3.svg" alt="\boldsymbol{X_t = X_{t-1} + \varepsilon_{t}}"/> which is a <strong>non stationary model</strong>.</p></li>
</ul>
</dd>
</dl>
<div class="topic">
<p class="topic-title first">API:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.DickeyFullerTest.html#openturns.DickeyFullerTest" title="openturns.DickeyFullerTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DickeyFullerTest</span></code></a></p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../meta_modeling/meta_modeling.html" title="Meta modeling"
             >next</a> |</li>
        <li class="right" >
          <a href="process_transformation.html" title="Process transformation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.13 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="probabilistic_modeling.html" >Probabilistic modeling</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2019 Airbus-EDF-IMACS-Phimeca.
      Last updated on Jun 06, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.0.
    </div>
  </body>
</html>