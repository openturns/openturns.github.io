
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Kolmogorov-Smirnov fitting test &#8212; OpenTURNS  documentation</title>
    <link rel="stylesheet" href="../../_static/openturns.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Cramer-Von Mises goodness-of-fit test" href="cramer_vonmises_test.html" />
    <link rel="prev" title="Chi-squared goodness of fit test" href="chi2_fitting_test.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="cramer_vonmises_test.html" title="Cramer-Von Mises goodness-of-fit test"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chi2_fitting_test.html" title="Chi-squared goodness of fit test"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="data_analysis.html" accesskey="U">Data analysis</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="chi2_fitting_test.html"
                        title="previous chapter">Chi-squared goodness of fit test</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cramer_vonmises_test.html"
                        title="next chapter">Cramer-Von Mises goodness-of-fit test</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/theory/data_analysis/kolmogorov_test.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="kolmogorov-smirnov-fitting-test">
<span id="kolmogorov-smirnov-test"></span><h1>Kolmogorov-Smirnov fitting test<a class="headerlink" href="#kolmogorov-smirnov-fitting-test" title="Permalink to this headline">Â¶</a></h1>
<p>This method deals with the modelling of a probability distribution of a random vector
<img class="math" src="../../_images/math/283037f1429a3dc0efc831e85624e1194116c0b5.svg" alt="\vect{X} = \left( X^1,\ldots,X^{n_X} \right)"/>.</p>
<p>It seeks to verify the compatibility between a sample of data
<img class="math" src="../../_images/math/1de3ddb45acc6ab0106279a135a4a8f5a1cc21c7.svg" alt="\left\{ \vect{x}_1,\vect{x}_2,\ldots,\vect{x}_N \right\}"/>
and a candidate probability distribution previously chosen.</p>
<p>The Kolmogorov-Smirnov Goodness-of-Fit test allows to answer this question in
the one dimensional case <img class="math" src="../../_images/math/65070ba84469e598fb50f47f0cdc31e5883abf66.svg" alt="n_X =1"/>, and with a continuous distribution.</p>
<p>Let us limit the case to <img class="math" src="../../_images/math/a13c9435409bcbb7c312cf0472d92061c601f8bd.svg" alt="n_X = 1"/>.</p>
<p>Thus we denote <img class="math" src="../../_images/math/6c1fd4a2775476752fd98a9f6ef0e9ce953d02be.svg" alt="\vect{X} = X^1 = X"/>.
This goodness-of-fit test is based on the maximum distance between the
cumulative distribution function <img class="math" src="../../_images/math/8c0680ea32b80002a7ff45d5d3d5e7c638e9c6c2.svg" alt="\widehat{F}_N"/> of the sample
<img class="math" src="../../_images/math/5af56280caffac440d109fe4e7d9fc2960f77e2e.svg" alt="\left\{ x_1,x_2,\ldots,x_N \right\}"/> and that of the candidate
distribution, denoted <em>F</em>.</p>
<p>This distance may be expressed as follows:</p>
<div class="math">
<p><img src="../../_images/math/5bff77f1c7acc2ef456a1384fd3df887f673140e.svg" alt="D = \sup_x \left|\widehat{F}_N\left(x\right) - F\left(x\right)\right|"/></p>
</div><p>With a sample <img class="math" src="../../_images/math/5af56280caffac440d109fe4e7d9fc2960f77e2e.svg" alt="\left\{ x_1,x_2,\ldots,x_N \right\}"/>, the distance is estimated by:</p>
<div class="math">
<p><img src="../../_images/math/9e8b711ff9653f29a577dc59489e91494d2ea7c8.svg" alt="\widehat{D}_N = \sup_{i=1 \ldots N}\left|F\left(x_i\right)-\frac{i-1}{N} ; \frac{i}{N}-F\left(x_i\right)\right|"/></p>
</div><p>Assume that the sample is drawn from the candidate distribution.
By definition, the <em>p</em>-value of the test is the probability:</p>
<div class="math">
<p><img src="../../_images/math/99fff6483553bd0da7e179c37f42c90768a42194.svg" alt="p = P(D &gt; \widehat{D}_N)"/></p>
</div><p>In the case where the fit is good, the value of <img class="math" src="../../_images/math/352f536f7b1ba0cda606392eae33057f5ea1966c.svg" alt="\widehat{D}_N"/> is
small, which leads to a p-value closer to 1.
The candidate distribution will not be rejected if and only if
<img class="math" src="../../_images/math/e9249c6624ce2eed5d9b7699218488ba3379014e.svg" alt="p"/> is larger than a given threshold probability.
In general, the threshold p-value is chosen to be 0.05:</p>
<div class="math">
<p><img src="../../_images/math/7be3489d1694c2180c60ba7f34b9dd9387da2d34.svg" alt="p_{ref} = 0.05"/></p>
</div><p>Based on the p-value,</p>
<ul class="simple">
<li><p>if  <img class="math" src="../../_images/math/d37600443b62f58ec6c311dd16ddfee6533f6b21.svg" alt="p&lt;p_{ref}"/>, we reject the candidate distribution,</p></li>
<li><p>otherwise, the candidate distribution is not rejected.</p></li>
</ul>
<p>Two situations may occur in practice.</p>
<ul class="simple">
<li><p>the parameters of the distribution under test are known,</p></li>
<li><p>the parameters of the distribution under test are estimated from a sample.</p></li>
</ul>
<p>If the parameters of the distribution under test are known,
algorithms are available to directly compute
the distribution of <img class="math" src="../../_images/math/352f536f7b1ba0cda606392eae33057f5ea1966c.svg" alt="\widehat{D}_N"/> both for <em>N</em> large
(asymptotic distribution) or for <em>N</em> small (exact distribution).
This is because the distribution of <img class="math" src="../../_images/math/352f536f7b1ba0cda606392eae33057f5ea1966c.svg" alt="\widehat{D}_N"/> does
not depend on the candidate distribution.</p>
<p>If the parameters of the distribution under test are estimated
from a sample, the <img class="math" src="../../_images/math/352f536f7b1ba0cda606392eae33057f5ea1966c.svg" alt="\widehat{D}_N"/> statistic is generally smaller, because
the parameters of the distribution have been computed from the
sample.
In general, the distribution of <img class="math" src="../../_images/math/352f536f7b1ba0cda606392eae33057f5ea1966c.svg" alt="\widehat{D}_N"/> is not known
and depends on the candidate distribution.
Therefore, sampling methods can be used in order to estimate the p-value.</p>
<p>The diagram below illustrates the principle of comparison with the empirical
cumulative distribution function for an ordered sample
<img class="math" src="../../_images/math/54db4c0f01e0f7088c0aa90b5dd612f0411ba4e0.svg" alt="\left\{5,6,10,22,27\right\}"/>; the candidate distribution considered here
is the Exponential distribution with parameters <img class="math" src="../../_images/math/81bc13b2ad00375a7a1ae7ef92bd92bbf500292c.svg" alt="\lambda = 0.07"/>,
<img class="math" src="../../_images/math/dfb135ca6687acfbef8f769c7d6afb9a32e2b111.svg" alt="\gamma = 0"/>.</p>
<p>(<a class="reference external" href="../../theory/data_analysis/kolmogorov_test-1.py">Source code</a>, <a class="reference external" href="../../theory/data_analysis/kolmogorov_test-1.png">png</a>, <a class="reference external" href="../../theory/data_analysis/kolmogorov_test-1.hires.png">hires.png</a>, <a class="reference external" href="../../theory/data_analysis/kolmogorov_test-1.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../../_images/kolmogorov_test-1.png" src="../../_images/kolmogorov_test-1.png" />
</div>
<p>The test deals with the maximum deviation between the empirical distribution
and the candidate distribution, it is by nature highly sensitive to presence of
local deviations (a candidate distribution may be rejected even if it correctly
describes the sample for almost the whole domain of variation).</p>
<p>There is no rule to determine the minimum sample size one
needs to use this test; but it is often considered a reasonable approximation
when <em>N</em> is of an order of a few dozen. But whatever the value of <em>N</em>, the
distance â and similarly the <em>p</em>-value â remains a useful tool for comparing
different probability distributions to a sample. The distribution which minimizes
<img class="math" src="../../_images/math/352f536f7b1ba0cda606392eae33057f5ea1966c.svg" alt="\widehat{D}_N"/> â or maximizes the <em>p</em>-value â will be of interest to the analyst.</p>
<p>This method is also referred to in the literature as Kolmogorovâs Test.</p>
<div class="topic">
<p class="topic-title first">API:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.FittingTest_Kolmogorov.html#openturns.FittingTest_Kolmogorov" title="openturns.FittingTest_Kolmogorov"><code class="xref py py-func docutils literal notranslate"><span class="pre">FittingTest_Kolmogorov()</span></code></a> to compare a sample with
a reference probability distribution</p></li>
<li><p>See <a class="reference internal" href="../../user_manual/_generated/openturns.FittingTest_BestModelKolmogorov.html#openturns.FittingTest_BestModelKolmogorov" title="openturns.FittingTest_BestModelKolmogorov"><code class="xref py py-func docutils literal notranslate"><span class="pre">FittingTest_BestModelKolmogorov()</span></code></a> to select the
best candidate from several probability models with respect to a sample</p></li>
<li><p>See <code class="xref py py-func docutils literal notranslate"><span class="pre">FittingTest_TwoSamplesKolmogorov()</span></code> to compare two samples</p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><p>See <a class="reference internal" href="../../examples/data_analysis/kolmogorov_test.html"><span class="doc">Test distribution fitting using Kolmogorov</span></a></p></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../bibliography.html#saporta1990" id="id1"><span>[saporta1990]</span></a></p></li>
<li><p><a class="reference internal" href="../../bibliography.html#dixon1983" id="id2"><span>[dixon1983]</span></a></p></li>
<li><p><a class="reference internal" href="../../bibliography.html#nisthandbook" id="id3"><span>[nisthandbook]</span></a></p></li>
<li><p><a class="reference internal" href="../../bibliography.html#dagostino1986" id="id4"><span>[dagostino1986]</span></a></p></li>
<li><p><a class="reference internal" href="../../bibliography.html#sprent2001" id="id5"><span>[sprent2001]</span></a></p></li>
<li><p><a class="reference internal" href="../../bibliography.html#bhattacharyya1997" id="id6"><span>[bhattacharyya1997]</span></a></p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="cramer_vonmises_test.html" title="Cramer-Von Mises goodness-of-fit test"
             >next</a> |</li>
        <li class="right" >
          <a href="chi2_fitting_test.html" title="Chi-squared goodness of fit test"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../theory.html" >Theory</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="data_analysis.html" >Data analysis</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2019 Airbus-EDF-IMACS-Phimeca.
      Last updated on Jun 04, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.0.
    </div>
  </body>
</html>