
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_data_analysis/statistical_tests/plot_kolmogorov_statistics.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_data_analysis_statistical_tests_plot_kolmogorov_statistics.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_data_analysis_statistical_tests_plot_kolmogorov_statistics.py:


Kolmogorov-Smirnov : understand the statistics
==============================================

.. GENERATED FROM PYTHON SOURCE LINES 9-14

In this example, we illustrate how the Kolmogorov-Smirnov (KS) statistic is computed.

* We generate a sample from a Normal distribution.
* We create a uniform distribution and estimate its parameters from the sample.
* Compute the Kolmogorov-Smirnov statistic and plot it on top of the empirical cumulated distribution function.

.. GENERATED FROM PYTHON SOURCE LINES 16-20

.. code-block:: Python

    import openturns as ot
    import openturns.viewer as viewer









.. GENERATED FROM PYTHON SOURCE LINES 21-27

The `computeKSStatisticsIndex` function computes the Kolmogorov-Smirnov
distance between the sample and the distribution.
Furthermore, it returns the index which achieves the maximum distance
in the sorted sample.
The following function is for teaching purposes only: use
`FittingTest` for real applications.

.. GENERATED FROM PYTHON SOURCE LINES 29-56

.. code-block:: Python



    def computeKSStatisticsIndex(sample, distribution):
        sample = ot.Sample(sample.sort())
        print("Sorted")
        print(sample)
        n = sample.getSize()
        D = 0.0
        index = -1
        D_previous = 0.0
        for i in range(n):
            F = distribution.computeCDF(sample[i])
            S1 = abs(F - float(i) / n)
            S2 = abs(float(i + 1) / n - F)
            print(
                "i=%d, x[i]=%.4f, F(x[i])=%.4f, S1=%.4f, S2=%.4f"
                % (i, sample[i, 0], F, S1, S2)
            )
            D = max(S1, S2, D)
            if D > D_previous:
                print("D max!")
                index = i
                D_previous = D
        observation = sample[index]
        return D, index, observation









.. GENERATED FROM PYTHON SOURCE LINES 57-69

The `drawKSDistance()` function plots the empirical distribution function
of the sample and the Kolmogorov-Smirnov distance at point x.
The empirical CDF is a staircase function and is discontinuous at each observation.
Denote by :math:`\hat{F}` the empirical CDF. For a given observation :math:`x`
which achieves the maximum distance to the candidate distribution CDF,
let us denote :math:`\hat{F}^- = \lim_{x \rightarrow x^-} \hat{F}(x)` and
:math:`\hat{F}^+ = \lim_{x\rightarrow x^+} \hat{F}(x)`.
The maximum distance can be achieved either by :math:`\hat{F}^-` or :math:`\hat{F}^+`.
The `computeEmpiricalCDF(x)` method computes :math:`\hat{F}^+=\mathbb{P}(X \leq x)`.
We compute :math:`\hat{F}^-` with the equation :math:`\hat{F}^- = \hat{F}^+ - 1/n`
where :math:`n` is the sample size.


.. GENERATED FROM PYTHON SOURCE LINES 72-98

.. code-block:: Python

    def drawKSDistance(sample, distribution, observation, D, distFactory):
        graph = ot.Graph("KS Distance = %.4f" % (D), "X", "CDF", True, "upper left")
        # Thick vertical line at point x
        ECDF_x_plus = sample.computeEmpiricalCDF(observation)
        ECDF_x_minus = ECDF_x_plus - 1.0 / sample.getSize()
        CDF_index = distribution.computeCDF(observation)
        curve = ot.Curve(
            [observation[0], observation[0], observation[0]],
            [ECDF_x_plus, ECDF_x_minus, CDF_index],
        )
        curve.setLegend("KS Statistics")
        curve.setLineWidth(4.0 * curve.getLineWidth())
        graph.add(curve)
        # Empirical CDF
        empiricalCDF = ot.UserDefined(sample).drawCDF()
        empiricalCDF.setLegends(["Empirical DF"])
        graph.add(empiricalCDF)
        #
        distname = distFactory.getClassName()
        distribution = distFactory.build(sample)
        cdf = distribution.drawCDF()
        cdf.setLegends([distname])
        graph.add(cdf)
        return graph









.. GENERATED FROM PYTHON SOURCE LINES 99-100

We generate a sample from a standard Normal distribution.

.. GENERATED FROM PYTHON SOURCE LINES 102-106

.. code-block:: Python

    N = ot.Normal()
    n = 10
    sample = N.getSample(n)








.. GENERATED FROM PYTHON SOURCE LINES 107-108

Compute the index which achieves the maximum Kolmogorov-Smirnov distance.

.. GENERATED FROM PYTHON SOURCE LINES 110-113

We then create a uniform distribution whose parameters are estimated
from the sample.
This way, the K.S. distance is large enough to be graphically significant.

.. GENERATED FROM PYTHON SOURCE LINES 115-119

.. code-block:: Python

    distFactory = ot.UniformFactory()
    distribution = distFactory.build(sample)
    distribution






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    Uniform
    <ul>
      <li>name=Uniform</li>
      <li>dimension=1</li>
      <li>weight=1</li>
      <li>range=[-2.48294, 1.7388]</li>
      <li>description=[X0]</li>
      <li>isParallel=true</li>
      <li>isCopula=false</li>
    </ul>

    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 120-121

Compute the index which achieves the maximum Kolmogorov-Smirnov distance.

.. GENERATED FROM PYTHON SOURCE LINES 123-126

.. code-block:: Python

    D, index, observation = computeKSStatisticsIndex(sample, distribution)
    print("D=", D, ", Index=", index, ", Obs.=", observation)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Sorted
    0 : [ -2.18139  ]
    1 : [ -1.26617  ]
    2 : [ -0.438266 ]
    3 : [ -0.355007 ]
    4 : [  0.350042 ]
    5 : [  0.608202 ]
    6 : [  0.793156 ]
    7 : [  0.810668 ]
    8 : [  1.20548  ]
    9 : [  1.43725  ]
    i=0, x[i]=-2.1814, F(x[i])=0.0714, S1=0.0714, S2=0.0286
    D max!
    i=1, x[i]=-1.2662, F(x[i])=0.2882, S1=0.1882, S2=0.0882
    D max!
    i=2, x[i]=-0.4383, F(x[i])=0.4843, S1=0.2843, S2=0.1843
    D max!
    i=3, x[i]=-0.3550, F(x[i])=0.5040, S1=0.2040, S2=0.1040
    i=4, x[i]=0.3500, F(x[i])=0.6710, S1=0.2710, S2=0.1710
    i=5, x[i]=0.6082, F(x[i])=0.7322, S1=0.2322, S2=0.1322
    i=6, x[i]=0.7932, F(x[i])=0.7760, S1=0.1760, S2=0.0760
    i=7, x[i]=0.8107, F(x[i])=0.7802, S1=0.0802, S2=0.0198
    i=8, x[i]=1.2055, F(x[i])=0.8737, S1=0.0737, S2=0.0263
    i=9, x[i]=1.4372, F(x[i])=0.9286, S1=0.0286, S2=0.0714
    D= 0.28431981766196146 , Index= 2 , Obs.= [-0.438266]




.. GENERATED FROM PYTHON SOURCE LINES 127-131

.. code-block:: Python

    graph = drawKSDistance(sample, distribution, observation, D, distFactory)
    view = viewer.View(graph)





.. image-sg:: /auto_data_analysis/statistical_tests/images/sphx_glr_plot_kolmogorov_statistics_001.svg
   :alt: KS Distance = 0.2843
   :srcset: /auto_data_analysis/statistical_tests/images/sphx_glr_plot_kolmogorov_statistics_001.svg
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 132-133

Display the graphs

.. GENERATED FROM PYTHON SOURCE LINES 133-135

.. code-block:: Python

    view.ShowAll()








.. GENERATED FROM PYTHON SOURCE LINES 136-139

We see that the K.S. statistics is achieved at the observation where the distance
between the empirical distribution function of the sample and the
candidate distribution is largest.


.. _sphx_glr_download_auto_data_analysis_statistical_tests_plot_kolmogorov_statistics.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_kolmogorov_statistics.ipynb <plot_kolmogorov_statistics.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_kolmogorov_statistics.py <plot_kolmogorov_statistics.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_kolmogorov_statistics.zip <plot_kolmogorov_statistics.zip>`
