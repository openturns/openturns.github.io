
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Estimate a GEV on the Venice sea-levels data &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bandwidth sensitivity in kernel smoothing" href="plot_smoothing_mixture.html" />
    <link rel="prev" title="Get the asymptotic distribution of the estimators" href="plot_asymptotic_estimators_distribution.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_smoothing_mixture.html" title="Bandwidth sensitivity in kernel smoothing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_asymptotic_estimators_distribution.html" title="Get the asymptotic distribution of the estimators"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate a GEV on the Venice sea-levels data</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_asymptotic_estimators_distribution.html"
                          title="previous chapter">Get the asymptotic distribution of the estimators</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_smoothing_mixture.html"
                          title="next chapter">Bandwidth sensitivity in kernel smoothing</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_data_analysis/distribution_fitting/plot_estimate_gev_venice.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-gev-venice-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="estimate-a-gev-on-the-venice-sea-levels-data">
<span id="sphx-glr-auto-data-analysis-distribution-fitting-plot-estimate-gev-venice-py"></span><h1>Estimate a GEV on the Venice sea-levels data<a class="headerlink" href="#estimate-a-gev-on-the-venice-sea-levels-data" title="Permalink to this heading">Â¶</a></h1>
<p>In this example, we illustrate various techniques of extreme value modeling applied
to the annual maximum sea-levels recorded in Venice over the period 1931-1981.
Readers should refer to <a class="reference internal" href="../../bibliography.html#coles2001" id="id1"><span>[coles2001]</span></a> to get more details.</p>
<p>We illustrate techniques to:</p>
<ul class="simple">
<li><p>estimate a stationary GEV, using the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAYK8yi3Tzzxj7v+mdfFzWggAAAAlwSFlzAAAOxAAADsQBlSsOGwAAACpJREFUCNdjYFQ0cmRgNVNQZ4iQbBBmaNBiAIKtQMxxA0iwbgASPAcYGAByEwXczOc1PgAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="r" style="vertical-align: 0px"/>-largest annual sea-levels for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAPBAMAAACLu/vuAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYK8yi3Tzzxj7v+md3UhrTZF7AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgUlEQVQY02NggACOBgYYkH4AZzKXG0BZNu8RogzMawWgLH4kUQYO3QCEKKOikSNU/LQDXJTVTEEdptwtACYaIdkgDBVkvNUAE23Qgqlk3dSAsG0rVJBlD5IbOH5A2E1XGZBEWTdAzLwIdyI/0OE8BxhQQVP9pgcMZADGuyAA9TMDAPJXIWFCOtkhAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="r\geq 1" style="vertical-align: -3px"/>,</p></li>
</ul>
<p>using:</p>
<ul class="simple">
<li><p>the log-likelihood function,</p></li>
<li><p>the profile log-likelihood function.</p></li>
</ul>
<p>First, we load the 10 largest annual sea-levels in Venice. We start by looking at them
through time. Note that for the year 1935, only the largest 6 observations are available.
For simplicity of the example, we removed that year from the data but it could be
used for all the analyses beased on the largest <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAYK8yi3Tzzxj7v+mdfFzWggAAAAlwSFlzAAAOxAAADsQBlSsOGwAAACpJREFUCNdjYFQ0cmRgNVNQZ4iQbBBmaNBiAIKtQMxxA0iwbgASPAcYGAByEwXczOc1PgAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="r" style="vertical-align: 0px"/> annual sea-levels for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAPBAMAAABgjEDtAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYK8yi3Tzzxj7v+md3UhrTZF7AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoElEQVQY02NgQAIcBiDS54wBiuDaB0CSK4CrAEmQuRYkyCDLwPcAIch4HaIxBcxRNHIE0ayXGiCyX11UgTwzBXUgmy8HKsj8i4E3gCFCskEYxNMNgIjyfWFgSWBo0IKae9oBovYjA+sPBoatMOtiNSDmgkQ5fsBdIbsYRN5h4ElgYN2AcNxzkCHPGLgFGHgOMKACvjULGcgBjHdBAOpmBgBG7SRI3ns4YwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="r \leq 6" style="vertical-align: -3px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">import</span> <span class="nn">openturns.experimental</span> <span class="k">as</span> <span class="nn">otexp</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">coles</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">coles</span><span class="o">.</span><span class="n">Coles</span><span class="p">()</span><span class="o">.</span><span class="n">venice</span>
</pre></div>
</div>
<p>The column <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAMBAMAAACzedEdAAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAYPMySHS/GPuviyJl+xMAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAvSURBVAjXY2BgVGBgYBZggAGWMAaGUg4HBgFrIGcaELcwMLAqCDBwTljAwDK1AABJtQUo+Fv6BQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="i" style="vertical-align: 0px"/> contains the largest <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAMBAMAAACzedEdAAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAYPMySHS/GPuviyJl+xMAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAvSURBVAjXY2BgVGBgYBZggAGWMAaGUg4HBgFrIGcaELcwMLAqCDBwTljAwDK1AABJtQUo+Fv6BQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="i" style="vertical-align: 0px"/> annual sea-levels.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Annual maximum sea-levels in Venice&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;level (cm)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">r</span><span class="p">]])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setIntegerXTick</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_gev_venice_001.png" srcset="../../_images/sphx_glr_plot_estimate_gev_venice_001.png" alt="Annual maximum sea-levels in Venice" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    [ Year r1   r2   r3   r4   r5   r6   r7   r8   r9   r10  ]
0 : [ 1931  103   99   98   96   94   89   86   85   84   79 ]
1 : [ 1932   78   78   74   73   73   72   71   70   70   69 ]
2 : [ 1933  121  113  106  105  102   89   89   88   86   85 ]
3 : [ 1934  116  113   91   91   91   89   88   88   86   81 ]
4 : [ 1936  147  106   93   90   87   87   87   84   82   81 ]
</pre></div>
</div>
<p><strong>Stationary GEV modeling from the annual maximum sea-levels</strong></p>
<p>We first assume that the dependence through time is negligible, so we first model the data as
independent observations over the observation period. We estimate the parameters of the
GEV distribution by maximizing the log-likelihood of the data.
We select the first column of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Estimate the parameters of the GEV by maximizing the log-likehood
and compute the parameter distribution</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GeneralizedExtremeValueFactory</span><span class="p">()</span>
<span class="n">result_LL_max</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildMethodOfLikelihoodMaximizationEstimator</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>We get the fitted GEV and its parameters of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAXBAMAAACop0HzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABR0lEQVQoz4WSO0sDURCFv81jN5uX6RRUTOEPiI221jYGBLFzsdBGwhaCgggJWCosBMEmEG1sUug/CIIWqUxpZdTOSkshEGd2s7hgEqeYe2fO3DlnhgtjbKbABHt+mgDGmOZ/M4pjn4vFoxKMWoglMJR5MSoh1wjR/D57cpSjEoqGG1yyWyckwXRHkq558twh5Y1Er5W6RFqFrXIWJI8Hg6avrq++SUb8lGd8+WC8ezmc7/xRxvjkQkkwb/3cEYlygHZWpOyKB7m+kwtGamFWA8k99XfMit8k42hkN8n1CFekvKrqm4U53Za0TQdbOxyiyQKJPh8W9YKGy9JhCd78VlViDvmN3fkDOrKW+522cN7A+quglotdIumT4oSbMIVj+xRS0q0m4/5Byb4UqcvZkHHDHL9lZomuCnUqI1Cr4lltDbwxf8OGH00pPcuV2/LgAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\hat{\mu}, \hat{\sigma}, \hat{\xi})" style="vertical-align: -5px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitted_GEV</span> <span class="o">=</span> <span class="n">result_LL_max</span><span class="o">.</span><span class="n">getDistribution</span><span class="p">()</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">fitted_GEV</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">()</span>
<span class="n">param</span> <span class="o">=</span> <span class="n">fitted_GEV</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">param</span><span class="p">)]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max log-likelihood (one max): &quot;</span><span class="p">,</span> <span class="n">result_LL_max</span><span class="o">.</span><span class="n">getLogLikelihood</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>mu: 111.090, sigma: 17.340, xi: -0.077
Max log-likelihood (one max):  -218.85953988220427
</pre></div>
</div>
<p>We get the asymptotic distribution of the estimator <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAXBAMAAACop0HzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABR0lEQVQoz4WSO0sDURCFv81jN5uX6RRUTOEPiI221jYGBLFzsdBGwhaCgggJWCosBMEmEG1sUug/CIIWqUxpZdTOSkshEGd2s7hgEqeYe2fO3DlnhgtjbKbABHt+mgDGmOZ/M4pjn4vFoxKMWoglMJR5MSoh1wjR/D57cpSjEoqGG1yyWyckwXRHkq558twh5Y1Er5W6RFqFrXIWJI8Hg6avrq++SUb8lGd8+WC8ezmc7/xRxvjkQkkwb/3cEYlygHZWpOyKB7m+kwtGamFWA8k99XfMit8k42hkN8n1CFekvKrqm4U53Za0TQdbOxyiyQKJPh8W9YKGy9JhCd78VlViDvmN3fkDOrKW+522cN7A+quglotdIumT4oSbMIVj+xRS0q0m4/5Byb4UqcvZkHHDHL9lZomuCnUqI1Cr4lltDbwxf8OGH00pPcuV2/LgAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\hat{\mu}, \hat{\sigma}, \hat{\xi})" style="vertical-align: -5px"/>.
In that case, the asymptotic distribution is normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameterEstimate</span> <span class="o">=</span> <span class="n">result_LL_max</span><span class="o">.</span><span class="n">getParameterDistribution</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Asymptotic distribution of the estimator : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parameterEstimate</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Asymptotic distribution of the estimator :
Normal(mu = [111.09,17.3401,-0.0770338], sigma = [2.90936,1.79642,0.0793379], R = [[  1         0.4502   -0.488149 ]
 [  0.4502    1        -0.438925 ]
 [ -0.488149 -0.438925  1        ]])
</pre></div>
</div>
<p>We get the covariance matrix  and the standard deviation of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAXBAMAAACop0HzAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABR0lEQVQoz4WSO0sDURCFv81jN5uX6RRUTOEPiI221jYGBLFzsdBGwhaCgggJWCosBMEmEG1sUug/CIIWqUxpZdTOSkshEGd2s7hgEqeYe2fO3DlnhgtjbKbABHt+mgDGmOZ/M4pjn4vFoxKMWoglMJR5MSoh1wjR/D57cpSjEoqGG1yyWyckwXRHkq558twh5Y1Er5W6RFqFrXIWJI8Hg6avrq++SUb8lGd8+WC8ezmc7/xRxvjkQkkwb/3cEYlygHZWpOyKB7m+kwtGamFWA8k99XfMit8k42hkN8n1CFekvKrqm4U53Za0TQdbOxyiyQKJPh8W9YKGy9JhCd78VlViDvmN3fkDOrKW+522cN7A+quglotdIumT4oSbMIVj+xRS0q0m4/5Byb4UqcvZkHHDHL9lZomuCnUqI1Cr4lltDbwxf8OGH00pPcuV2/LgAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(\hat{\mu}, \hat{\sigma}, \hat{\xi})" style="vertical-align: -5px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cov matrix = &quot;</span><span class="p">,</span> <span class="n">parameterEstimate</span><span class="o">.</span><span class="n">getCovariance</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Standard dev = &quot;</span><span class="p">,</span> <span class="n">parameterEstimate</span><span class="o">.</span><span class="n">getStandardDeviation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Cov matrix =  [[  8.46436     2.35294    -0.112676   ]
 [  2.35294     3.22713    -0.0625576  ]
 [ -0.112676   -0.0625576   0.00629451 ]]
Standard dev =  [2.90936,1.79642,0.0793379]
</pre></div>
</div>
<p>We get the marginal confidence intervals of order 0.95.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="n">parameterEstimate</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">computeBilateralConfidenceInterval</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">desc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>mu: [105.387, 116.792]
sigma: [13.8192, 20.861]
xi: [-0.232533, 0.0784657]
</pre></div>
</div>
<p>At last, we can validate the inference result thanks the 4 usual diagnostic plots:</p>
<ul class="simple">
<li><p>the probability-probability pot,</p></li>
<li><p>the quantile-quantile pot,</p></li>
<li><p>the return level plot,</p></li>
<li><p>the empirical distribution function.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validation</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">GeneralizedExtremeValueValidation</span><span class="p">(</span><span class="n">result_LL_max</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">validation</span><span class="o">.</span><span class="n">drawDiagnosticPlot</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_estimate_gev_venice_002.png" srcset="../../_images/sphx_glr_plot_estimate_gev_venice_002.png" alt=", Sample versus model PP-plot, Sample versus model QQ-plot, Return level plot, Density" class = "sphx-glr-single-img"/><p>We can also use the profile log-likehood function rather than log-likehood function  to estimate the parameters of the GEV.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_PLL_max</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildMethodOfProfileLikelihoodMaximizationEstimator</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>The following graph allows one to get the profile log-likelihood plot.
It also indicates the optimal value of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAARBAMAAAD9OpvVAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABLSURBVAjXY2BgYGQAASYTIMESVgEkJReABGaDCJ4nYMkM5wNA0vP6BqASBZAAL1i4HExqg0k5HRDJGJcIolj6NoAo5gtAgt1oAQMAGy8LVPWDKP0AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\xi" style="vertical-align: -4px"/>, the maximum profile log-likelihood and
the confidence interval for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAARBAMAAAD9OpvVAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYK90SOndi7/7Mp0Yzx4ijy0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABLSURBVAjXY2BgYGQAASYTIMESVgEkJReABGaDCJ4nYMkM5wNA0vP6BqASBZAAL1i4HExqg0k5HRDJGJcIolj6NoAo5gtAgt1oAQMAGy8LVPWDKP0AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\xi" style="vertical-align: -4px"/> of order 0.95 (which is the default value).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">result_PLL_max</span><span class="o">.</span><span class="n">setConfidenceLevel</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_PLL_max</span><span class="o">.</span><span class="n">getParameterConfidenceInterval</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-0.200118, 0.101776]
</pre></div>
</div>
<p>We can get the numerical values of the confidence interval: it appears to be a bit smaller
with the interval obtained from the profile log-likelihood function than with the log-likelihood function.
Note that if the order requested is too high, the confidence interval might not be calculated because
one of its bound is out of the definition domain of the log-likelihood function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Confidence interval for xi = &quot;</span><span class="p">,</span> <span class="n">result_PLL_max</span><span class="o">.</span><span class="n">getParameterConfidenceInterval</span><span class="p">()</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Confidence interval for xi =  [-0.200118, 0.101776]
</pre></div>
</div>
<p><strong>Stationary GEV modeling from the largest :math:`r` annual sea-levels</strong></p>
<p>We still assume that the dependence through time is negligible.  We estimate the parameters of the
GEV distribution by maximizing the log-likelihood of the data. Now, we want to model more of the
observed extremes than the annual maxima: the additional information contained in the largest
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAMBAMAAAB2C0uMAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYOlIMp0Yr8+L3XS/+7yxHmYAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABbSURBVAjXY2AQMmBgEJ0uwMDgamfAwKzAoMLAwMBnwMC1gSEGwgIiWQjLzoHBLgHMknMAcaBichCWnwHDPogsnwDDXqgpExgiQCwBBsYFIJPT+9QNGLZuF2AAABwUD0KTZvWDAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="10" style="vertical-align: 0px"/> observations can be used to improve the estimation of the GEV model.</p>
<p>Now, we drop the year column to keep only the maxima values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample_rmax</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample_rmax</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    [ r1  r2  r3  r4  r5  r6  r7  r8  r9  r10 ]
0 : [ 103  99  98  96  94  89  86  85  84  79 ]
1 : [  78  78  74  73  73  72  71  70  70  69 ]
2 : [ 121 113 106 105 102  89  89  88  86  85 ]
3 : [ 116 113  91  91  91  89  88  88  86  81 ]
4 : [ 147 106  93  90  87  87  87  84  82  81 ]
</pre></div>
</div>
<p>We estimate the parameters from the largest <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAYK8yi3Tzzxj7v+mdfFzWggAAAAlwSFlzAAAOxAAADsQBlSsOGwAAACpJREFUCNdjYFQ0cmRgNVNQZ4iQbBBmaNBiAIKtQMxxA0iwbgASPAcYGAByEwXczOc1PgAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="r" style="vertical-align: 0px"/> annual sea-levels for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAAAQBAMAAACVTi62AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYK8yi3Tzzxj7v+mdSN3nHojvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA40lEQVQoz2NgwADSF8AU8yafxwgBGScBTJUMNvehavOnG8AFeDcwbMailoEfqjYASYAvgOEUsWqBSJKBgVHRyBG72iMwJwIF7hsw3G9gYDVTUAfyucpBQAFJLccBhly4WnkDkPIIyQZhrOYCwTpkc4HKG7RwuBcITsIF7C8wxDcwMGzFoZYtgOE8wm8CDJFAZ/0A8zHdy22A5AY+B4bjDAysGzDMFWBgrmBgYGngmMxg3gARYHwAigueA2hKm+o3XeCdAmT4aBkw3HSACDDEBGGLYzBghTECGAgCUtQGoOshVS0AOzJCZnzByCoAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="r=1,5,10" style="vertical-align: -4px"/>.
For each <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAYK8yi3Tzzxj7v+mdfFzWggAAAAlwSFlzAAAOxAAADsQBlSsOGwAAACpJREFUCNdjYFQ0cmRgNVNQZ4iQbBBmaNBiAIKtQMxxA0iwbgASPAcYGAByEwXczOc1PgAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="r" style="vertical-align: 0px"/> value, we get the estimated parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GeneralizedExtremeValueFactory</span><span class="p">()</span>
<span class="n">r_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_candidate</span><span class="p">:</span>
    <span class="n">estimate</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">buildMethodOfLikelihoodMaximization</span><span class="p">(</span><span class="n">sample_rmax</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">estimate</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">()</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">estimate</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
    <span class="n">pretty_p</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">p</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;r=</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">2</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pretty_p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>r= 1 mu: 111.090, sigma: 17.340, xi: -0.077
r= 5 mu: 117.849, sigma: 13.423, xi: -0.087
r=10 mu: 116.868, sigma: 11.854, xi: -0.108
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-data-analysis-distribution-fitting-plot-estimate-gev-venice-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/2f055783e398ea9eb62857114c02ec11/plot_estimate_gev_venice.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_estimate_gev_venice.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/70f3e1a4661c46da65546200101863df/plot_estimate_gev_venice.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_estimate_gev_venice.ipynb</span></code></a></p>
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_smoothing_mixture.html" title="Bandwidth sensitivity in kernel smoothing"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_asymptotic_estimators_distribution.html" title="Get the asymptotic distribution of the estimators"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Data analysis</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Distribution fitting</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate a GEV on the Venice sea-levels data</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>