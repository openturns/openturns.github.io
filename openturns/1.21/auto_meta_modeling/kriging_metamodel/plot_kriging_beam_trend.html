
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Choose the trend basis of a kriging metamodel &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Kriging with an isotropic covariance function" href="plot_kriging_isotropic.html" />
    <link rel="prev" title="Kriging : generate trajectories from a metamodel" href="plot_kriging_simulate.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_kriging_isotropic.html" title="Kriging with an isotropic covariance function"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_kriging_simulate.html" title="Kriging : generate trajectories from a metamodel"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Kriging metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Choose the trend basis of a kriging metamodel</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Choose the trend basis of a kriging metamodel</a><ul>
<li><a class="reference internal" href="#definition-of-the-model">Definition of the model</a></li>
<li><a class="reference internal" href="#create-the-design-of-experiments">Create the design of experiments</a></li>
<li><a class="reference internal" href="#create-the-metamodel">Create the metamodel</a></li>
<li><a class="reference internal" href="#setting-the-trend">Setting the trend</a></li>
<li><a class="reference internal" href="#validate-the-metamodel">Validate the metamodel</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_kriging_simulate.html"
                          title="previous chapter">Kriging : generate trajectories from a metamodel</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_kriging_isotropic.html"
                          title="next chapter">Kriging with an isotropic covariance function</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_meta_modeling/kriging_metamodel/plot_kriging_beam_trend.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-meta-modeling-kriging-metamodel-plot-kriging-beam-trend-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="choose-the-trend-basis-of-a-kriging-metamodel">
<span id="sphx-glr-auto-meta-modeling-kriging-metamodel-plot-kriging-beam-trend-py"></span><h1>Choose the trend basis of a kriging metamodel<a class="headerlink" href="#choose-the-trend-basis-of-a-kriging-metamodel" title="Permalink to this heading">¶</a></h1>
<p>The goal of this example is to show how to configure the trend in a Kriging metamodel.
This is why this example focuses on the three available trends:</p>
<ul class="simple">
<li><p><cite>ConstantBasisFactory</cite>,</p></li>
<li><p><cite>LinearBasisFactory</cite>,</p></li>
<li><p><cite>QuadraticBasisFactory</cite>.</p></li>
</ul>
<p>For this purpose, we use the <a class="reference internal" href="../../usecases/use_case_cantilever_beam.html#use-case-cantilever-beam"><span class="std std-ref">cantilever beam</span></a> example.</p>
<section id="definition-of-the-model">
<h2>Definition of the model<a class="headerlink" href="#definition-of-the-model" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">cantilever_beam</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">from</span> <span class="nn">openturns.viewer</span> <span class="kn">import</span> <span class="n">View</span>

<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>We load the use case :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cb</span> <span class="o">=</span> <span class="n">cantilever_beam</span><span class="o">.</span><span class="n">CantileverBeam</span><span class="p">()</span>
</pre></div>
</div>
<p>We define the function which evaluates the output depending on the inputs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">model</span>
</pre></div>
</div>
<p>Then we define the distribution of the input random vector.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dimension</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">dim</span>  <span class="c1"># number of inputs</span>
<span class="n">myDistribution</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">distribution</span>
</pre></div>
</div>
</section>
<section id="create-the-design-of-experiments">
<h2>Create the design of experiments<a class="headerlink" href="#create-the-design-of-experiments" title="Permalink to this heading">¶</a></h2>
<p>We consider a simple Monte-Carlo sampling as a design of experiments.
This is why we generate an input sample using the <cite>getSample</cite> method of the distribution.
Then we evaluate the output using the <cite>model</cite> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize_train</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize_train</span><span class="p">)</span>
<span class="n">Y_train</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-the-metamodel">
<h2>Create the metamodel<a class="headerlink" href="#create-the-metamodel" title="Permalink to this heading">¶</a></h2>
<p>In order to create the Kriging metamodel, we first select a constant trend with the <cite>ConstantBasisFactory</cite> class.
Then we use a squared exponential covariance kernel.
The <cite>SquaredExponential</cite> kernel has one amplitude coefficient and 4 scale coefficients.
This is because this covariance kernel is anisotropic : each of the 4 input variables is associated with its own scale coefficient.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ConstantBasisFactory</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">covarianceModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SquaredExponential</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
</pre></div>
</div>
<p>Typically, the optimization algorithm is quite good at setting sensible optimization bounds.
In this case, however, the range of the input domain is extreme.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lower and upper bounds of X_train:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">getMin</span><span class="p">(),</span> <span class="n">X_train</span><span class="o">.</span><span class="n">getMax</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Lower and upper bounds of X_train:
[6.50185e+10,262.654,2.50948,1.40294e-07] [6.88439e+10,323.088,2.59143,1.5807e-07]
</pre></div>
</div>
<p>We need to manually define sensible optimization bounds.
Note that since the amplitude parameter is computed analytically (this is possible when the output dimension is 1), we only need to set bounds on the scale parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scaleOptimizationBounds</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0e-10</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0e11</span><span class="p">,</span> <span class="mf">1.0e3</span><span class="p">,</span> <span class="mf">1.0e1</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Finally, we use the <cite>KrigingAlgorithm</cite> class to create the Kriging metamodel.
It requires a training sample, a covariance kernel and a trend basis as input arguments.
We need to set the initial scale parameter for the optimization. The upper bound of the input domain is a sensible choice here.
We must not forget to actually set the optimization bounds defined above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">covarianceModel</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">getMax</span><span class="p">())</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KrigingAlgorithm</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">covarianceModel</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setOptimizationBounds</span><span class="p">(</span><span class="n">scaleOptimizationBounds</span><span class="p">)</span>
</pre></div>
</div>
<p>Run the algorithm and get the result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">krigingWithConstantTrend</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>getTrendCoefficients</cite> method returns the coefficients of the trend.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getTrendCoefficients</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.108219]
</pre></div>
</div>
<p>The constant trend always has only one coefficient (if there is one single output).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getCovarianceModel</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>SquaredExponential(scale=[6.88439e+10,323.088,2.59143,1.5807e-07], amplitude=[0.247034])
</pre></div>
</div>
</section>
<section id="setting-the-trend">
<h2>Setting the trend<a class="headerlink" href="#setting-the-trend" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">covarianceModel</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">getMax</span><span class="p">())</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearBasisFactory</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KrigingAlgorithm</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">covarianceModel</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setOptimizationBounds</span><span class="p">(</span><span class="n">scaleOptimizationBounds</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">krigingWithLinearTrend</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">getTrendCoefficients</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[-8.81529e-25,-1.00576e-13,-2.65632e-22,-2.22154e-24,-1.3279e-31]</p>
</div>
<br />
<br /><p>The number of coefficients in the linear and quadratic trends depends on the number of inputs, which is
equal to</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAANBAMAAADrgXVfAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0yYPudz4t0GOmvv/MXNcn2AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA2ElEQVQY02NgYGAQ+syAH7AEMPjhkJIBk2wFDCY4FLwFk0wNuMzmqAVT/Aa4FAjeBVmQOZVB8gJDW1dH4crpAqgKGkAKNBjKuSYEMjtGMMyewKkAFOAtB4EDIBsYgAo4FBjKWJg/cHI8YOgDORfFBpAC1gaGQAaeCwy8BxjKGJgSUG0AKbA3YPzAwCrAwOoAVLgexbkcd868Psggz8Cm4DCPhcGegfkDQzcLihsYGHSBVjCsPtBwhoOhG+Saaxxo/gQqYLk58cYCmVkMGQw8Exh8JqCFdOhhAICxNIqiydFAAAAACnRFWHREZXB0aAD////5EPtk2gAAAABJRU5ErkJggg==" alt="dim = 4"/></p>
</div><p>in the cantilever beam case.</p>
<p>We observe that the number of coefficients in the trend is 5, which corresponds to:</p>
<ul class="simple">
<li><p>1 coefficient for the constant part,</p></li>
<li><p>dim=4 coefficients for the linear part.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">covarianceModel</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">getMax</span><span class="p">())</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">QuadraticBasisFactory</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KrigingAlgorithm</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">covarianceModel</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">setOptimizationBounds</span><span class="p">(</span><span class="n">scaleOptimizationBounds</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">krigingWithQuadraticTrend</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">getTrendCoefficients</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">algo</span><span class="o">.</span><span class="n">getOptimizationBounds</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">getCovarianceModel</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1, 1e+11]
[1, 1000]
[1, 10]
[1e-10, 1e-05]
SquaredExponential(scale=[6.88439e+10,323.088,2.59143,1.5807e-07], amplitude=[1.74417e-10])
</pre></div>
</div>
<p>This time, the trend has 15 coefficients:</p>
<ul class="simple">
<li><p>1 coefficient for the constant part,</p></li>
<li><p>4 coefficients for the linear part,</p></li>
<li><p>10 coefficients for the quadratic part.</p></li>
</ul>
<p>This is because the number of coefficients in the quadratic part has</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANsAAAAnBAMAAAB0/SARAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0yYPudz4t0GOmvv/MXNcn2AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACoklEQVRYw82Wz2vTYBjHv2vS+PbXGr2Jkxa8qCDkIO4wRiOoIIpuiDi8uIPiBMV6WQ86zakMpxIPU1HRXEVxBQ962KEyjxsUD/MHCttVEQv+AfV9+yNN3zdJ184Ev7QJ7zd58sn7Pu/75AV4xSfhLwWb07Y/ztYW0eLep7I5nDyGE+3WedFy6JgKPBLtIWdDWizu8hudPPa3WyXRYl1qnA5kKC4hPuJXB+73Gc0HFzEcjZghWExEb5zTFJc0+SeQmQ6c6TuYaee7RDTB4nFynn/C1u/sONpMhS9OuTSP7RUUb89ee/FQRVS0eBzG+GcYdVwsD6XMcFN3dE/cbhTi5rh0cAJPzFgWg6Il4Kp811HH4S4uN5fSuheNZDEtS9UYWcM9NkNGREvAneXHsokjq6018tELFzUwjmQFqTKmEZnEDtECPhWuvy3csHE/+LFs4nCz5VzwwuW0gSqiNGc6ZSxoeC1a3XJHvi3/fN/oHUsdBk1c9cJloGT1ZzJykKqYk9lU4a3uUwX7nLlLaD6DiZdlY5lgjqVslSBhCVYHjp6lrDuOzswk6x6x4qc8K9iX+5+toceYYqv3uAnFFCwH7tWtRRXEEGrY6SV6HKb/D6xZXNE2WkClvPsEdqykiNVzWWal9ojratzr/hlwIIZ7prFSO1DCG5dLo12Dv/b+0aEzLGLiilsyzS6hRO0LR3+H3S51S7OEvnAZDRkLfStVYCpv7A6KO6kxYjhq9I4Sa/2o85OQdrtFwOVUPLfC6x2tR/MIL3d0P3IRYfVOh5x1XeZBqF5qHzzV8d9IWdkTQoitJSwYwYfYWkdqLfgQWxNIVoMPcW6oS2GEtDdpahghtt6FEtJS0ggjxNZsKCGOTYQRfIitnYeOVoIPsXWuVqv885C/vqED2Bdh27sAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\frac{dim (dim+1)}{2}=\frac{4\times 5}{2}=10"/></p>
</div><p>coefficients, associated with the symmetric matrix of the quadratic function.</p>
</section>
<section id="validate-the-metamodel">
<h2>Validate the metamodel<a class="headerlink" href="#validate-the-metamodel" title="Permalink to this heading">¶</a></h2>
<p>We finally want to validate the Kriging metamodel. This is why we generate a validation sample with size 100 and we evaluate the output of the model on this sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize_test</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">myDistribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize_test</span><span class="p">)</span>
<span class="n">Y_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drawMetaModelValidation</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">krigingMetamodel</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MetaModelValidation</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">krigingMetamodel</span><span class="p">)</span>
    <span class="n">Q2</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">computePredictivityFactor</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">drawValidation</span><span class="p">()</span><span class="o">.</span><span class="n">getGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">, Q2 = </span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">Q2</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">graph</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Different trends&quot;</span><span class="p">)</span>
<span class="n">graphConstant</span> <span class="o">=</span> <span class="n">drawMetaModelValidation</span><span class="p">(</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">krigingWithConstantTrend</span><span class="p">,</span> <span class="s2">&quot;Constant&quot;</span>
<span class="p">)</span>
<span class="n">graphLinear</span> <span class="o">=</span> <span class="n">drawMetaModelValidation</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">krigingWithLinearTrend</span><span class="p">,</span> <span class="s2">&quot;Linear&quot;</span><span class="p">)</span>
<span class="n">graphQuadratic</span> <span class="o">=</span> <span class="n">drawMetaModelValidation</span><span class="p">(</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">krigingWithQuadraticTrend</span><span class="p">,</span> <span class="s2">&quot;Quadratic&quot;</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">graphConstant</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">graphLinear</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">graphQuadratic</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">)})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_kriging_beam_trend_001.png" srcset="../../_images/sphx_glr_plot_kriging_beam_trend_001.png" alt="Different trends" class = "sphx-glr-single-img"/><p>We observe that the three trends perform very well in this case.
With more coefficients, the Kriging metamodel is more flexibile and can adjust better to the training sample.
This does not mean, however, that the trend coefficients will provide a good fit for the validation sample.</p>
<p>The number of parameters in each Kriging metamodel is the following:</p>
<ul class="simple">
<li><p>the constant trend Kriging has 6 coefficients to estimate: 5 coefficients for the covariance matrix and 1 coefficient for the trend,</p></li>
<li><p>the linear trend Kriging has 10 coefficients to estimate: 5 coefficients for the covariance matrix and 5 coefficients for the trend,</p></li>
<li><p>the quadratic trend Kriging has 20 coefficients to estimate: 5 coefficients for the covariance matrix and 15 coefficients for the trend.</p></li>
</ul>
<p>In the cantilever beam example, fitting the metamodel to a training sample with only 10 points is made much easier because the function to approximate is almost linear.
In this case, a quadratic trend is not advisable because it can interpolate all points in the training sample.</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-meta-modeling-kriging-metamodel-plot-kriging-beam-trend-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/07e83939e4f0e58db51e367618e6db5b/plot_kriging_beam_trend.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_kriging_beam_trend.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/605a80809c8bc9fa8dfd4ba7bd5503e0/plot_kriging_beam_trend.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_kriging_beam_trend.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_kriging_isotropic.html" title="Kriging with an isotropic covariance function"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_kriging_simulate.html" title="Kriging : generate trajectories from a metamodel"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Kriging metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Choose the trend basis of a kriging metamodel</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>