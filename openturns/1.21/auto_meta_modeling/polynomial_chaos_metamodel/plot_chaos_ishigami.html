
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Plot enumeration rules" href="plot_enumeratefunction.html" />
    <link rel="prev" title="Create a polynomial chaos metamodel" href="plot_functional_chaos.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_enumeratefunction.html" title="Plot enumeration rules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_functional_chaos.html" title="Create a polynomial chaos metamodel"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Polynomial chaos metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos</a><ul>
<li><a class="reference internal" href="#define-the-model">Define the model</a></li>
<li><a class="reference internal" href="#draw-the-function">Draw the function</a></li>
<li><a class="reference internal" href="#create-the-polynomial-chaos-model">Create the polynomial chaos model</a></li>
<li><a class="reference internal" href="#compute-mean-and-variance">Compute mean and variance</a></li>
<li><a class="reference internal" href="#compute-and-print-sobol-indices">Compute and print Sobol’ indices</a></li>
<li><a class="reference internal" href="#computing-the-accuracy">Computing the accuracy</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_functional_chaos.html"
                          title="previous chapter">Create a polynomial chaos metamodel</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_enumeratefunction.html"
                          title="next chapter">Plot enumeration rules</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_meta_modeling/polynomial_chaos_metamodel/plot_chaos_ishigami.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-meta-modeling-polynomial-chaos-metamodel-plot-chaos-ishigami-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="create-a-polynomial-chaos-for-the-ishigami-function-a-quick-start-guide-to-polynomial-chaos">
<span id="sphx-glr-auto-meta-modeling-polynomial-chaos-metamodel-plot-chaos-ishigami-py"></span><h1>Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos<a class="headerlink" href="#create-a-polynomial-chaos-for-the-ishigami-function-a-quick-start-guide-to-polynomial-chaos" title="Permalink to this heading">¶</a></h1>
<p>In this example, we create a polynomial chaos for the
<a class="reference internal" href="../../usecases/use_case_ishigami.html#use-case-ishigami"><span class="std std-ref">Ishigami function</span></a>.
We create a sparse polynomial with maximum total degree equal to 8
using the <a class="reference internal" href="../../user_manual/response_surface/_generated/openturns.FunctionalChaosAlgorithm.html#openturns.FunctionalChaosAlgorithm" title="openturns.FunctionalChaosAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalChaosAlgorithm</span></code></a> class.</p>
<section id="define-the-model">
<h2>Define the model<a class="headerlink" href="#define-the-model" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">ishigami_function</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>We load the Ishigami model :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">ishigami_function</span><span class="o">.</span><span class="n">IshigamiModel</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>IshigamiModel</cite> data class contains the input distribution <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIoAAAATBAMAAAC9wIjcAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMA6fvzz0gy3b+vYBidi3QixNnZAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABrElEQVQ4y42UvUvDQBjGn7Zp+pGmBP+CTi5S2sXJwVJ0EIe2k2MjOrgIGQWX7i7BRTdXdZBAd8kmiENXByGjiBVJP7QInneXflwOD/oOD/e7I8+973u5A/4Pw8eyUeC6QgZohOvxJY0anQ+9Yrg791Wh0WGsEwuZjrTBI9tkDMMR9lRhn2tjhB05TYttMkFOLFKFCa7toSanUuwxrcMVJ1WYC5hmyImcSsbm9u+eOKnCfI0rsWSXJNfUamxSiSWulZ+IslssWJ6piMexz5T4yevanMi57HO9+6ZyPz8Xjv3LGL690rLWGF4kQ9mlxSQd1Kl+zMrlqPuaKyBKGv09N9jBOwXSk1y6TI7RpvP6zIVj2jIdAWEnmlFfHgBSlfrCumu4SFgLlyki54qoP0XdLdDx1a+US4JWewiYI+6isx99iuh6IhrXHnQHB5UvaBUiXaNCgL2widbAZy7pMuaI7ThmHZg9xT3Va4shzbUo+DdtAYuOWUXGU13304VLNeZyC1/AvJ91WXGKOJqPbso2goUnIa6AeHkGzpQu+UCkIL4YR7OpfsHspd86HfgDPYuGNxq5iCEAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\vect{X}=(X_1, X_2, X_3)" style="vertical-align: -5px"/> in <cite>im.distributionX</cite> and the Ishigami function in <cite>im.model</cite>.
We also have access to the input variable names with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_names</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="draw-the-function">
<h2>Draw the function<a class="headerlink" href="#draw-the-function" title="Permalink to this heading">¶</a></h2>
<p>Create a training sample</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">inputSample</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">outputSample</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotXvsY</span><span class="p">(</span><span class="n">sampleX</span><span class="p">,</span> <span class="n">sampleY</span><span class="p">):</span>
    <span class="n">dimX</span> <span class="o">=</span> <span class="n">sampleX</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
    <span class="n">dimY</span> <span class="o">=</span> <span class="n">sampleY</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
    <span class="n">descriptionX</span> <span class="o">=</span> <span class="n">sampleX</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
    <span class="n">descriptionY</span> <span class="o">=</span> <span class="n">sampleY</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">GridLayout</span><span class="p">(</span><span class="n">dimY</span><span class="p">,</span> <span class="n">dimX</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimY</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimX</span><span class="p">):</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">descriptionX</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">descriptionY</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">sampleX</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">sampleY</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">setYTitle</span><span class="p">(</span><span class="n">descriptionY</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">setYTitle</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">dimY</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="n">descriptionX</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">setXTitle</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">setGraph</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grid</span>


<span class="n">grid</span> <span class="o">=</span> <span class="n">plotXvsY</span><span class="p">(</span><span class="n">inputSample</span><span class="p">,</span> <span class="n">outputSample</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)})</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_ishigami_001.png" srcset="../../_images/sphx_glr_plot_chaos_ishigami_001.png" alt="plot chaos ishigami" class = "sphx-glr-single-img"/><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HistogramFactory</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">outputSample</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_ishigami_002.png" srcset="../../_images/sphx_glr_plot_chaos_ishigami_002.png" alt="y PDF" class = "sphx-glr-single-img"/><p>We see that the distribution of the output has two modes.</p>
</section>
<section id="create-the-polynomial-chaos-model">
<h2>Create the polynomial chaos model<a class="headerlink" href="#create-the-polynomial-chaos-model" title="Permalink to this heading">¶</a></h2>
<p>Create a training sample</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inputTrain</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
<span class="n">outputTrain</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">inputTrain</span><span class="p">)</span>
</pre></div>
</div>
<p>Create the chaos.</p>
<p>We could use only the input and output training samples: in this case, the distribution of the input sample is computed by selecting the distribution that has the best fit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chaosalgo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FunctionalChaosAlgorithm</span><span class="p">(</span><span class="n">inputTrain</span><span class="p">,</span> <span class="n">outputTrain</span><span class="p">)</span>
</pre></div>
</div>
<p>Since the input distribution is known in our particular case, we instead create
the multivariate basis from the distribution.
We define the orthogonal basis used to expand the function.
We see that each input has the uniform distribution, which corresponds to the
Legendre polynomials.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">multivariateBasis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">OrthogonalProductPolynomialFactory</span><span class="p">([</span><span class="n">im</span><span class="o">.</span><span class="n">X1</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">X2</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">X3</span><span class="p">])</span>
<span class="n">multivariateBasis</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<ul>
  <li>dimension: 3</li>
  <li>enumerate function: class=LinearEnumerateFunction dimension=3</li>
</ul>

<table>
  <tr>
    <th>Index</th>
    <th>Name</th>
    <th>Distribution</th>
    <th>Univariate polynomial</th>
  </tr>
  <tr>
    <td>0</td>
    <td>X1</td>
    <td>Uniform</td>
    <td>LegendreFactory</td>
  </tr>
  <tr>
    <td>1</td>
    <td>X2</td>
    <td>Uniform</td>
    <td>LegendreFactory</td>
  </tr>
  <tr>
    <td>2</td>
    <td>X3</td>
    <td>Uniform</td>
    <td>LegendreFactory</td>
  </tr>
</table>

</div>
<br />
<br /><p>Then we create the sparse polynomial chaos expansion using regression and
the LARS selection model method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">selectionAlgorithm</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LeastSquaresMetaModelSelectionFactory</span><span class="p">()</span>
<span class="n">projectionStrategy</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LeastSquaresStrategy</span><span class="p">(</span><span class="n">selectionAlgorithm</span><span class="p">)</span>
<span class="n">totalDegree</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">enumerateFunction</span> <span class="o">=</span> <span class="n">multivariateBasis</span><span class="o">.</span><span class="n">getEnumerateFunction</span><span class="p">()</span>
<span class="n">basisSize</span> <span class="o">=</span> <span class="n">enumerateFunction</span><span class="o">.</span><span class="n">getBasisSizeFromTotalDegree</span><span class="p">(</span><span class="n">totalDegree</span><span class="p">)</span>
<span class="n">adaptiveStrategy</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FixedStrategy</span><span class="p">(</span><span class="n">multivariateBasis</span><span class="p">,</span> <span class="n">basisSize</span><span class="p">)</span>
<span class="n">chaosAlgo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FunctionalChaosAlgorithm</span><span class="p">(</span>
    <span class="n">inputTrain</span><span class="p">,</span> <span class="n">outputTrain</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="p">,</span> <span class="n">adaptiveStrategy</span><span class="p">,</span> <span class="n">projectionStrategy</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The coefficients of the polynomial expansion can then be estimated
using the <a class="reference internal" href="../../user_manual/response_surface/_generated/openturns.FunctionalChaosAlgorithm.html#openturns.FunctionalChaosAlgorithm.run" title="openturns.FunctionalChaosAlgorithm.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chaosAlgo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../user_manual/response_surface/_generated/openturns.FunctionalChaosAlgorithm.html#openturns.FunctionalChaosAlgorithm.getResult" title="openturns.FunctionalChaosAlgorithm.getResult"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getResult()</span></code></a> method returns the
result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chaosResult</span> <span class="o">=</span> <span class="n">chaosAlgo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
<p>The polynomial chaos result provides a pretty-print.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chaosResult</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<ul>
  <li>input dimension: 3</li>
  <li>output dimension: 1</li>
  <li>distribution dimension: 3</li>
  <li>transformation: 3 -> 3</li>
  <li>inverse transformation: 3 -> 3</li>
  <li>orthogonal basis dimension: 3</li>
  <li>indices size: 21</li>
  <li>relative errors: [9.08703e-06]</li>
  <li>residuals: [0.00577149]</li>
</ul>
<table>
  <tr>
    <th>Index</th>
    <th>Multi-index</th>
    <th>Coeff.</th>
  </tr>
  <tr>
    <th>0</th>
    <td>[0,0,0]</td>
    <td>3.517248</td>
  </tr>
  <tr>
    <th>1</th>
    <td>[1,0,0]</td>
    <td>1.622862</td>
  </tr>
  <tr>
    <th>2</th>
    <td>[0,0,1]</td>
    <td>0.0009628309</td>
  </tr>
  <tr>
    <th>3</th>
    <td>[0,2,0]</td>
    <td>-0.5898958</td>
  </tr>
  <tr>
    <th>4</th>
    <td>[3,0,0]</td>
    <td>-1.288589</td>
  </tr>
  <tr>
    <th>5</th>
    <td>[1,0,2]</td>
    <td>1.36247</td>
  </tr>
  <tr>
    <th>6</th>
    <td>[0,4,0]</td>
    <td>-1.939777</td>
  </tr>
  <tr>
    <th>7</th>
    <td>[0,3,1]</td>
    <td>0.0006953569</td>
  </tr>
  <tr>
    <th>8</th>
    <td>[5,0,0]</td>
    <td>0.1883195</td>
  </tr>
  <tr>
    <th>9</th>
    <td>[3,0,2]</td>
    <td>-1.081184</td>
  </tr>
  <tr>
    <th>10</th>
    <td>[1,0,4]</td>
    <td>0.4106924</td>
  </tr>
  <tr>
    <th>11</th>
    <td>[0,6,0]</td>
    <td>1.358584</td>
  </tr>
  <tr>
    <th>12</th>
    <td>[0,0,6]</td>
    <td>-0.002370007</td>
  </tr>
  <tr>
    <th>13</th>
    <td>[5,0,2]</td>
    <td>0.1602851</td>
  </tr>
  <tr>
    <th>14</th>
    <td>[3,0,4]</td>
    <td>-0.319932</td>
  </tr>
  <tr>
    <th>15</th>
    <td>[1,4,2]</td>
    <td>-0.02412582</td>
  </tr>
  <tr>
    <th>16</th>
    <td>[0,1,6]</td>
    <td>-0.0001260937</td>
  </tr>
  <tr>
    <th>17</th>
    <td>[3,0,5]</td>
    <td>0.02958038</td>
  </tr>
  <tr>
    <th>18</th>
    <td>[1,0,7]</td>
    <td>-0.01846124</td>
  </tr>
  <tr>
    <th>19</th>
    <td>[0,8,0]</td>
    <td>-0.3556474</td>
  </tr>
  <tr>
    <th>20</th>
    <td>[0,3,5]</td>
    <td>-0.01987799</td>
  </tr>
</table>

</div>
<br />
<br /><p>Get the metamodel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metamodel</span> <span class="o">=</span> <span class="n">chaosResult</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
</pre></div>
</div>
<p>In order to validate the metamodel, we generate a test sample.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_valid</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">inputTest</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">n_valid</span><span class="p">)</span>
<span class="n">outputTest</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">inputTest</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MetaModelValidation</span><span class="p">(</span><span class="n">inputTest</span><span class="p">,</span> <span class="n">outputTest</span><span class="p">,</span> <span class="n">metamodel</span><span class="p">)</span>
<span class="n">Q2</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">computePredictivityFactor</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Q2</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.9994752470145457
</pre></div>
</div>
<p>The Q2 is very close to 1: the metamodel is excellent.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">drawValidation</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Q2=</span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Q2</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_ishigami_003.png" srcset="../../_images/sphx_glr_plot_chaos_ishigami_003.png" alt="Q2=99.95%" class = "sphx-glr-single-img"/><p>The metamodel has a good predictivity, since the points are almost on the first diagonal.</p>
</section>
<section id="compute-mean-and-variance">
<h2>Compute mean and variance<a class="headerlink" href="#compute-mean-and-variance" title="Permalink to this heading">¶</a></h2>
<p>The mean and variance of a polynomial chaos expansion are computed
using the coefficients of the expansion.
This can be done using <a class="reference internal" href="../../user_manual/response_surface/_generated/openturns.FunctionalChaosRandomVector.html#openturns.FunctionalChaosRandomVector" title="openturns.FunctionalChaosRandomVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalChaosRandomVector</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">randomVector</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FunctionalChaosRandomVector</span><span class="p">(</span><span class="n">chaosResult</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">randomVector</span><span class="o">.</span><span class="n">getMean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean=&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span class="n">covarianceMatrix</span> <span class="o">=</span> <span class="n">randomVector</span><span class="o">.</span><span class="n">getCovariance</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Covariance=&quot;</span><span class="p">,</span> <span class="n">covarianceMatrix</span><span class="p">)</span>
<span class="n">outputDimension</span> <span class="o">=</span> <span class="n">outputTrain</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
<span class="n">stdDev</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">outputDimension</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">outputDimension</span><span class="p">):</span>
    <span class="n">stdDev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">covarianceMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Standard deviation=&quot;</span><span class="p">,</span> <span class="n">stdDev</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Mean= [3.51725]
Covariance= [[ 13.7368 ]]
Standard deviation= [3.70631]
</pre></div>
</div>
</section>
<section id="compute-and-print-sobol-indices">
<h2>Compute and print Sobol’ indices<a class="headerlink" href="#compute-and-print-sobol-indices" title="Permalink to this heading">¶</a></h2>
<p>By default, printing the object will print the Sobol’ indices
and the multi-indices ordered by decreasing part of variance.
If a multi-index has a part of variance which is lower
than some threshold, it is not printed.
This threshold can be customized using the
<cite>FunctionalChaosSobolIndices-VariancePartThreshold</cite> key of the
<a class="reference internal" href="../../user_manual/_generated/openturns.ResourceMap.html#openturns.ResourceMap" title="openturns.ResourceMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceMap</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chaosSI</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">FunctionalChaosSobolIndices</span><span class="p">(</span><span class="n">chaosResult</span><span class="p">)</span>
<span class="n">chaosSI</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<ul>
  <li>input dimension: 3</li>
  <li>output dimension: 1</li>
  <li>basis size: 21</li>
  <li>mean: [3.51725]</li>
  <li>std-dev: [3.70631]</li>
</ul>
<table>
  <tr>
    <th>Input</th>
    <th>Variable</th>
    <th>Sobol' index</th>
    <th>Total index</th>
  </tr>
  <tr>
    <td>0</td>
    <td>X1</td>
    <td>0.315184</td>
    <td>0.557148</td>
  </tr>
  <tr>
    <td>1</td>
    <td>X2</td>
    <td>0.442823</td>
    <td>0.442894</td>
  </tr>
  <tr>
    <td>2</td>
    <td>X3</td>
    <td>0.000000</td>
    <td>0.241993</td>
  </tr>
</table>
<table>
  <tr>
    <th>Index</th>
    <th>Multi-index</th>
    <th>Part of variance</th>
  </tr>
  <tr>
    <td>6</td>
    <td>[0,4,0]</td>
    <td>0.273917</td>
  </tr>
  <tr>
    <td>1</td>
    <td>[1,0,0]</td>
    <td>0.191725</td>
  </tr>
  <tr>
    <td>5</td>
    <td>[1,0,2]</td>
    <td>0.135136</td>
  </tr>
  <tr>
    <td>11</td>
    <td>[0,6,0]</td>
    <td>0.134366</td>
  </tr>
  <tr>
    <td>4</td>
    <td>[3,0,0]</td>
    <td>0.120877</td>
  </tr>
  <tr>
    <td>9</td>
    <td>[3,0,2]</td>
    <td>0.085097</td>
  </tr>
  <tr>
    <td>3</td>
    <td>[0,2,0]</td>
    <td>0.025332</td>
  </tr>
  <tr>
    <td>10</td>
    <td>[1,0,4]</td>
    <td>0.012279</td>
  </tr>
</table>

</div>
<br />
<br /><p>We notice the a coefficient with marginal degree equal to 6 has a significant impact on the output variance. Hence, we cannot get a satisfactory polynomial chaos with total degree less that 6.</p>
<p>Draw Sobol’ indices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dim_input</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
<span class="n">first_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">chaosSI</span><span class="o">.</span><span class="n">getSobolIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim_input</span><span class="p">)]</span>
<span class="n">total_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">chaosSI</span><span class="o">.</span><span class="n">getSobolTotalIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim_input</span><span class="p">)]</span>
<span class="n">input_names</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">()</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SobolIndicesAlgorithm</span><span class="o">.</span><span class="n">DrawSobolIndices</span><span class="p">(</span><span class="n">input_names</span><span class="p">,</span> <span class="n">first_order</span><span class="p">,</span> <span class="n">total_order</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_chaos_ishigami_004.png" srcset="../../_images/sphx_glr_plot_chaos_ishigami_004.png" alt="Sobol' indices" class = "sphx-glr-single-img"/><p>The variable which has the largest impact on the output is, taking
interactions into account, X1.
We see that X1 has interactions with other variables, since the first
order indice is less than the total order indice.
At first order, X3 has no interactions with other variables since its
first order indice is close to zero.</p>
</section>
<section id="computing-the-accuracy">
<h2>Computing the accuracy<a class="headerlink" href="#computing-the-accuracy" title="Permalink to this heading">¶</a></h2>
<p>The interesting point with the Ishigami function is that the exact Sobol’ indices are known.
We can use that property in order to compute the absolute error on the Sobol’ indices for the polynomial chaos.</p>
<p>To make the comparisons simpler, we gather the results into a list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S_exact</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="o">.</span><span class="n">S1</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">S2</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">S3</span><span class="p">]</span>
<span class="n">ST_exact</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="o">.</span><span class="n">ST1</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">ST2</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">ST3</span><span class="p">]</span>
</pre></div>
</div>
<p>Then we perform a loop over the input dimension and compute the absolute error on the Sobol’ indices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">dim</span><span class="p">):</span>
    <span class="n">absoluteErrorS</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">first_order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">S_exact</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">absoluteErrorST</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">total_order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ST_exact</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;X</span><span class="si">%d</span><span class="s2">, Abs.Err. on S=</span><span class="si">%.1e</span><span class="s2">, Abs.Err. on ST=</span><span class="si">%.1e</span><span class="s2">&quot;</span>
        <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">absoluteErrorS</span><span class="p">,</span> <span class="n">absoluteErrorST</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>X1, Abs.Err. on S=1.3e-03, Abs.Err. on ST=4.4e-04
X2, Abs.Err. on S=4.1e-04, Abs.Err. on ST=4.8e-04
X3, Abs.Err. on S=4.8e-07, Abs.Err. on ST=1.7e-03
</pre></div>
</div>
<p>We see that the indices are correctly estimated with a low accuracy even if we have use only 100 function evaluations. This shows the good performance of the polynomial chaos in this case.</p>
<p>We can compute the part of the variance of the output explained by each multi-index.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">partOfVariance</span> <span class="o">=</span> <span class="n">chaosSI</span><span class="o">.</span><span class="n">getPartOfVariance</span><span class="p">()</span>
<span class="n">chaosResult</span> <span class="o">=</span> <span class="n">chaosSI</span><span class="o">.</span><span class="n">getFunctionalChaosResult</span><span class="p">()</span>
<span class="n">orthogonalBasis</span> <span class="o">=</span> <span class="n">chaosResult</span><span class="o">.</span><span class="n">getOrthogonalBasis</span><span class="p">()</span>
<span class="n">enumerateFunction</span> <span class="o">=</span> <span class="n">orthogonalBasis</span><span class="o">.</span><span class="n">getEnumerateFunction</span><span class="p">()</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">chaosResult</span><span class="o">.</span><span class="n">getIndices</span><span class="p">()</span>
<span class="n">basisSize</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Index, global index, multi-index, coefficient&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">basisSize</span><span class="p">):</span>
    <span class="n">globalIndex</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">multiIndex</span> <span class="o">=</span> <span class="n">enumerateFunction</span><span class="p">(</span><span class="n">globalIndex</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">partOfVariance</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.0e-3</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">globalIndex</span><span class="p">,</span> <span class="n">multiIndex</span><span class="p">,</span> <span class="n">partOfVariance</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Index, global index, multi-index, coefficient
1, 1, [1,0,0], 0.1917
3, 7, [0,2,0], 0.0253
4, 10, [3,0,0], 0.1209
5, 15, [1,0,2], 0.1351
6, 30, [0,4,0], 0.2739
8, 35, [5,0,0], 0.0026
9, 40, [3,0,2], 0.0851
10, 49, [1,0,4], 0.0123
11, 77, [0,6,0], 0.1344
13, 89, [5,0,2], 0.0019
14, 98, [3,0,4], 0.0075
19, 156, [0,8,0], 0.0092
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-meta-modeling-polynomial-chaos-metamodel-plot-chaos-ishigami-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b5b388a4bd0d7f16d5f7321b11cbfdb8/plot_chaos_ishigami.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_chaos_ishigami.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6e6bb380f03902debf6a4c4045cdf204/plot_chaos_ishigami.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_chaos_ishigami.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_enumeratefunction.html" title="Plot enumeration rules"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_functional_chaos.html" title="Create a polynomial chaos metamodel"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Polynomial chaos metamodel</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Create a polynomial chaos for the Ishigami function: a quick start guide to polynomial chaos</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>