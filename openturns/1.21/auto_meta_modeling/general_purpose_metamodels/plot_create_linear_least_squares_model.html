
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Create a linear least squares model &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Create a general linear model metamodel" href="plot_general_linear_model.html" />
    <link rel="prev" title="General purpose metamodels" href="index.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_general_linear_model.html" title="Create a general linear model metamodel"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="General purpose metamodels"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">General purpose metamodels</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Create a linear least squares model</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Create a linear least squares model</a><ul>
<li><a class="reference internal" href="#define-the-model">Define the model</a></li>
<li><a class="reference internal" href="#linear-least-squares">Linear least squares</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">General purpose metamodels</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_general_linear_model.html"
                          title="next chapter">Create a general linear model metamodel</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_meta_modeling/general_purpose_metamodels/plot_create_linear_least_squares_model.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-meta-modeling-general-purpose-metamodels-plot-create-linear-least-squares-model-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="create-a-linear-least-squares-model">
<span id="sphx-glr-auto-meta-modeling-general-purpose-metamodels-plot-create-linear-least-squares-model-py"></span><h1>Create a linear least squares model<a class="headerlink" href="#create-a-linear-least-squares-model" title="Permalink to this heading">Â¶</a></h1>
<p>In this example we are going to create a global approximation of a model
response based on a linear function using the <a class="reference internal" href="../../user_manual/response_surface/_generated/openturns.LinearLeastSquares.html#openturns.LinearLeastSquares" title="openturns.LinearLeastSquares"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearLeastSquares</span></code></a> class.</p>
<p>We consider the function <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAAARBAMAAACiB9bZAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0YYPuvz+mLMnSd87/dC9arAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABUUlEQVQoz2NgwAQ78xiwAu5pD7CIch1gT8CqfA1DGRZRxgZOBazKJRgmMTDqG8D5M9pv6GoDaTY00zk7apsubQAy0hgYXBHCzAkFXNlA99kaoJlrxs6wbB9Q/jIDQzqKcoaCUwwMhQyYytl5FjCwCzAwdKIpl2TgEVgAFzKGK2ecwHCQi4HhF5ryLQwuDAfgQnJw5dwOLA48DCyBOwtAwREFdfuTAq7//xFeZYIpX+fOsP7/Nwa2QAZNUGAXg5Wrq/agupqlAKycqSgCYiPHAYbbCMdUPS5A8+V2A7Dp68whXP4FDJ+R3J54GsZhVwID/QawcjaZDWBRVwbOBiTl7ExoYf4G6vYCZTA3nYFpwgaEcu5ZqK7hPABVvnM5mN/JwG/lAPfqA4biPSjKoSHDx8BuDdZ4mYFtNywgd/RdF1j0FCXB+IBTbsfbQi69MAaSAQAd7VHq/rB4NAAAAAp0RVh0RGVwdGgAAAAAAVAk0ZoAAAAASUVORK5CYII=" alt="h : \Rset^2 \rightarrow \Rset^2" style="vertical-align: -1px"/> is defined by:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUIAAAAXBAMAAACMt1tfAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0YYPuvz+mLMnSd87/dC9arAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEIUlEQVRIx81XTYgcRRT+Zrp3erp7ZrcJCBs87EBAiB4sCIiJjttIMhIWNCEHyW0W1g06IgmCk0PACR7UJMIkhIVsNtJINDlothNEnazECQRFksPAegleFhII/hx2WRHxsr7qrv6rnu5FQiB16Xqvu7731Xuv3qsGHsPRe+dhVl999ASNvtYU09L/X602Hz3DQkevBdOVQKn0h3+cUpcl+cVcW5XN8CMT6o2pbqgrNafu97zZDLF8ltFEy1j+kqx4W5IP5zJUAhdo2d8IEzu1W83nLKGr7+gea5jf2MDzJO3hqlsZy82upNgnOcneJOfFMwNfPR6aYGUHr9r4cXaWnHBEwQlsVQa0NRc4xN93skxIL8IEyQi6kpEUMj7zj8TNtehdHawk9luxHGWgoEDGTArSx8NcFY5WUtT6w30U7kDyackdHoqz4rkWmrh9zXQChrtxZ6l2HZpDm1gF/iVV0cli+EpSHJEYPL0JQ9XP0xR+nKFvYm/jawiGxsbGzNmW7X+0BnV/7zBGaDr1+957IUIojCSRx8hUY8HC9ws2zvdqPC3VGxc/ZRLDSLcvREngxxnSS/O8F5tSYn+qzQNwF6X92I4qnWl3S/cX5ZooQ1ww5+gkjnHxQZvGe3y2yGDW0Kk08VuhSQeZcvnJwvaq/UItwdDTeZ1h1ZOrcUiZIZk4RoGl8fJ0nOHnn/AAnEK5j19xmZeuCdY1vwvqGAlfgkiNsIQPJ3igjQOTDIvmCVgGZXm/sK5jqZNgyHV+ZzjgyZfjkCkfMn2At7LS7Cket3WM8/lPPpQ/SBjHGdp9iuEEaX6gndvvv+4UOLEKbdXo+L4++qHva9L5nWHZWzYeh8Rou/1Ru90MGFZZ9ZkFO5vhHugdOuk0TsYZcgGzqTykKL8WMDS+XecVC2U3YBidFK6jzhDkYT0Omc7DSSe7op6icljsusRDNdapAQmGvqAsC4ZRHhLWpAWFiE7sdPAHJ2AvsorM0NOhzmInJYIcwjCn5t+lcji2yy4zXNCXdYczNN6FEDRqQp+lqk2phnnyzp/6CqbxAfTBBTYvMfR1OEJgNVwiniG+ZiUZ/gVuomplX5nWKFFKS6i4+OJ646oX5cJBCOGmAZxLfl+kqjB3zsLCnKv/3HNxG0brYsuSGPo66gzQu3iCqnWIzyEjhsqhf6a5CaPVY1k3sVXxDC4AX/EGENYjitQ2qU9LN4VLAdAgXbF3U1SLZNmN8D3IuA/52JbX2M1a8iv1jfmI4eLG3xH1jJtDUey9cdBPdiXyBXWGprcDN8LnkN7YEfNS7vVIc8XkSkzpxuajsvfflIKwkn+3uSc2fCX7k1GWB1APO4w7nOFpeUVRkqdyCeqWYBjHl8bpXISZcJZRkVJqVbrcGPl/HJvh575J/AU8Vn9S8dsb8B+d9yBtcYkCggAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="h(x_1, x_2) = \left(\cos(x_1 + x_2), (x_2 + 1) e^{x_1 - 2 x_2} \right)"/></p>
</div><p>for any <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAARBAMAAACP9fljAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdM/d6WCLv/P7GJ1IMq+qQHN+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA00lEQVQY02NgwAHEnuOSYeDdwPQAlxyPA5sBpmiKU4uFIZDmw6KP64EC78MCBoYVC7DKMSjsZWDQQRFMNzaEyR1j4D5wAUkuOQqhT5QhlGEDA4OQSZhRAlCM7QHCvlIF3v//HzCwFTB95pgAFFsMt8/I0hvCZGFg+boEqJ0hDC6nW6UAs2f9BzC1xdgY5pY3G2Fy8ZAAiEb4gYkZ4jemgvoNPECvMjAj5BhzIYaer/qfsATkFcYCmFwBg5Y0mMmudM5JF9l/Iu5NBy5XogUmNFwQAAAFzzsPKYxevwAAAAp0RVh0RGVwdGgAAAAAAVAk0ZoAAAAASUVORK5CYII=" alt="\vect{x} \in \Rset^2" style="vertical-align: -1px"/>.
Since the output is a dimension 2 vector, the model has vector
coefficients.
We use the linear model:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANUAAAA1BAMAAAAkKrMyAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGM/p3XQyr4udYPNIv/vElxQ+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADh0lEQVRYw+1YXUgUQRz/732s9+mdoUWIen5VhKIVFPnS9VDSQ9wFBb2IElEJlWcRB5FpYNSDwVH4VrhGH74E5rN4Fxo9lZoRGYQ+B51XmV2it83OzC6369wm6u5L/kFm1pn9/eb/PXsA6xD7nQkwS1php2lco9AN5knUPCrupXlcloR5XA9506hcgtM0rjbxN2zKfycf/OZVutsN+hvyxSQWURQX10eVNwl5+u3CIQbJ5ELd/Pq4bqC/S/pWDKXlmjjTYrSVS0WZwr4xDXM7HWOM+iQOytP2NUIQcSaJNwL0uYSxp3NZ/35ARz0ICoTt4hTkF7tWbrGKYT2uInpqPQjqeYxjVZ7rGX1ybkGP6wQ9kR4EEREH4Wnl+RpjT/NPPS6qRg4IZ3ISqYpJPBn8n6PK2mMGmleM/JtLBcFVlkMhttj9czfDYCG081f2IUPPIu6qhu5dqEyw4OKqiuGqarwuz19PcOFSnBMqCOv5NHTGSMS4vr3qwHttmYQP7UJRfQ/qgiMAPqJJhSSKNm2Z7HTv7LIsA3cMuzI8bPe7hcKYBuK5ewniCap13gjJS98ilKWAr5c8eqj/IDqUn1mnAlkxPg+WXwC7sYp8ygFOv0XQQowPcqIWZXwWmoPgkUKHLLqZBasuK+rdacj/jm0m1dMA4pKspoHojNlJ9fQmd8ix0ReQop6TKoMLLzL9BQey5mULMF6PXhmQbOQWisABxa4eDURI8JIy+qngRXXBSZpenIiSDx2y1vsH3spcGn9ZAtlcKeiLBO2fWyVdfS39yCVNz3o1EDNC24JcsUpGyvF0zu/6YfXDHvAsl6W5/QBnWWo9UJWRFB8/FfOStmcLdzlaYAqFshpiy1BoVosyBDBVA9AL8L7magUK3rusiqe6YHOVtaN7wT2GXchNV98CGD6ihUgg3XPk4xlldpix+o7Rt4rtH8m1G1Fyg00X1RCONMRzdUWbvMAHVi7yXxlvvOGmSWKjc3giJTE1hGXJm/PCwMtd0Ms4jVsp3AyzOJgQfMXx3D38KR17GGuNCu5E7u6lD6FWjI6M03iDyn1DWCPEqoUG/NaBUMbwzyFREcO/VZxfFJnc/ErYFJUU0ouspzdm/E8bNINtzB6wsZKvXMXGDOdCDR6Pj+Cd4VyowW+LRqPtHXDZcK4p6i8z9JIaPPHXE8N/zUMNHtvQanwc4gZP8iuy2nf+Ao6oAlfzcgJBAAAACnRFWHREZXB0aAD////+jp/xeQAAAABJRU5ErkJggg==" alt="\vect{y} \, \approx \, \widehat{\vect{h}}(\vect{x}) \,
= \, \sum_{k=0}^2 \; \vect{a}_k \; \psi_k(\vect{x})"/></p>
</div><p>for any <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAARBAMAAACP9fljAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdM/d6WCLv/P7GJ1IMq+qQHN+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA00lEQVQY02NgwAHEnuOSYeDdwPQAlxyPA5sBpmiKU4uFIZDmw6KP64EC78MCBoYVC7DKMSjsZWDQQRFMNzaEyR1j4D5wAUkuOQqhT5QhlGEDA4OQSZhRAlCM7QHCvlIF3v//HzCwFTB95pgAFFsMt8/I0hvCZGFg+boEqJ0hDC6nW6UAs2f9BzC1xdgY5pY3G2Fy8ZAAiEb4gYkZ4jemgvoNPECvMjAj5BhzIYaer/qfsATkFcYCmFwBg5Y0mMmudM5JF9l/Iu5NBy5XogUmNFwQAAAFzzsPKYxevwAAAAp0RVh0RGVwdGgAAAAAAVAk0ZoAAAAASUVORK5CYII=" alt="\vect{x} \in \Rset^2" style="vertical-align: -1px"/> where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAAYBAMAAADAJejWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL9g6Z0ySHTd88+vi/v/7mDBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB60lEQVQ4y2NgIAB6DzFQBNgCuA8QUMKoZIBHlt2BdwK7AV4DWAKwi1/xXjJrBpDmOcBgcgGfAfwJOFx2YAPbCQUGBikBBvaPZBrAsCGMgWE7kPmNJAMYL82cATOgloG1AChPmgE3DREuaGYwZgggYIA80ADmnXMOw/i8BxBhoLyB7f//AwQMqAfi8xe4P8H4kvAwmD3PFcr+jC+iPRgYOH4ycP9gYJwKFrCFG7BNcQOUbdKA2wBLRQYGrr8MfMCY2gwWCJk5ExaIxyOgioQ243FCFDAYvjHUOzAwPADzTRHRyM0pAGH7AH0GTW/sEUgJj+MOMKHICzDIf2CIPzCBcYFtAVCQE2EAxzWoH74zMHBD0zMnw12EAakMe8DRyPKBbX1HAIdyKsirHAowAxQYNrZC2MBY4IPqsWaoRBhQwnATbADjlk0l3gxMzijpoMVpdUGm3gGYAVLM18HMIIY65AA4g5SQuCobkFMiMgAa0GQWIXPmzJmDhxjykFPtQiQDpDjUCnBkC6ABKtAwQHUBN1AHPyyOaxhVcaWVDwwMy2fAwsASSSacDRhoKwgWS8B0xLigKR3sBRaGu2wMMMhswAqUZi4goB9UIrEfEAqApoMDnAGcDWAYkP//D1kFZQMaTSpgNEClSQYcyDQAKR2Fp4fTNIYAAAAKdEVYdERlcHRoAAAAAAgp+Gk+AAAAAElFTkSuQmCC" alt="\left\{\vect{a}_k \in \Rset^2\right\}_{k = 0,..., 2}" style="vertical-align: -8px"/>
are the vector coefficients and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAAAYBAMAAACLjTs7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL9g6Z0ySHTd84v7r89QcTzUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACMElEQVQ4y2NgwAM49iowUBekMrwlRxujkgEuqRKGndglivGayBIAphqQxbhdXnmuBIncRVO8xW/JrBkMDMze+EzkTwC7FMVEBlk+htwmoOhCdA9deMB2Axi49QIETeQQQDeRjzWBga8A00SGB2EMDPIJBE3kZsAwkX0DQzgbXEQQYWI1TBOpJnIYMBuwwkWKECY2EzAR6AH2JgYJxmNQfk0CxMQkO4b8/3/hyjjh4aj8gICJ9QwMElwFjQyLofw8UIjKcr48EoCijPkBxMR5c1xBHjPAbSC7BwODQT7DBoZAxqnIvk6SQ1PYJwA28ZkiyGhmD9wmWioCiXtAEwMYHiObyFsKS098M8FgvgPE19cjQLQeHkdGAfFiYHLcwHAAJWYeTERVpwoNRz5OoGNZLjDAvVTailYSyAMVfGMW4GZgXGBdgGRidx6KgdwBUBM5toFiBqgS5qUJ3BtQSwJQtM3gZtjGwKGc2gCPGSYGPgmUqIHFtQLDw1aIpgOwKGOfgFoSgCSF4roFGJic4amHw0XrOduks8gmmoLJFqd1BZk6F0CaYF5iVWBHCi5QSQBOWhxAzFXZQHSBBdQE9FLjXSCQVWBDMhFUEoBNNANiKQ61AmJNBGYLqJfQ3AgqCfhBLgOFbS2jKtFurEd4ifkBMyIcwSUBxwr00pEwACVwoJcKQb4WcODekMAAhZCSgLmA5HK/GNlLpb0MUxlmgOFU5JKAIsCBRlMOhNFoykEDEg0AgL+Tw8We5rMAAAAKdEVYdERlcHRoAAAAAAgp+Gk+AAAAAElFTkSuQmCC" alt="\left\{\psi_k : \Rset^2 \rightarrow \Rset\right\}_{k = 0, ..., 2}" style="vertical-align: -8px"/>
are the basis functions.
This implies that each marginal output <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAYBAMAAACVaMnNAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv90YSOmLdGCvMvvPnfNF+vn1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABDElEQVQoz2NgYGBUZsAELGGlDZiiEw0YJmIIcjowMHAJM5AIbKH0BbBt+gYQ3gGoqCGY7IZweGEuYU8AkXMgHFa4UQEgIgzCLoOLTgcRvyBsLbhoDxBzbCkD27MBaOKhiKRjDAzcIG9sYVADiT5gYEhkOK/wmoGBH2TLBYbnQHu5AkDWxDfHAtUCncq/gOEzyNkgm5n/g3TxGYCcywYWeACy4xNIlBvsXKaEghywbQcZ/zI4QkTDGPit2oCaghlYPtp/Y45iYFgEFH3MwFnOsJSB4ToDg8yRqWcWMDCkwRw+jYFhDdwX8Bh7nMDABA06Bi5Y4DGILWDgEoCyGQ2QQ70dSqegxAUXlAbaBwDOmzQt4onbqgAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\widehat{h}_i(\vect{x})" style="vertical-align: -5px"/>
is approximated by the linear model:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALMAAAA1BAMAAAD408cFAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv90YSOmLdGCvMvvPnfNF+vn1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADf0lEQVRYw+1XX0gUQRj/7nbv/x+vxIooPIgUomBPMIlILyHCevAgCInEVawHEbqj8iniKLCwwJMIkXqwKBA0FHwJe9DCIuOgkx6uhx4OjBB6MYUy+7PNzM6Ou91wd9bumx/czuztfL/55vd9830zACVLzwBYJN6MP2URtBhzhq0yGzwpy6DrJcugZy1DDkSHrYK+CRmrgk9RrHPjpvy32PZYhSyevpwsNmb6xzMs04qiJDcAPSBB0Wx5YZkGYLeygRTliSKN8iKD7IpMe5E1k0kTphli4p/06T4OcL71/2arLJz+jtBWxWpcUd/82hQhDm1KqLBdcdrOaMSRp3tCfXvPiiBHte1b4RVT6IAWQC7iHA+dKaaNc3B0DysFM6pL+luVoDlk3TxkrjhHV4kVgnbmLXgQP8pUe+zMLPcMR7nyeynQ+9g/t/Hj1vFu3PjQ78re3v3I+AmOctC4DwPZE+v7OQF1whTpIk3Xi5aOVyoc3IvaZbSSIJo75F8Ooq9LZNiuNJK59UowqYeugpdQk1EZqAtGL8KicAB1cwDt8Db8GXGBR7VCEJP7GDvBsVqLxk9yN/tPPQFhmAM/XUdyHGR4B6/R/DHsv7brrchq7Ng1KMPNMTyqgRi8wIP268PPJ8NTdc1Y7iPoDCZDxL4WFEKgRML6HDhnoJ7sujBlLF8c+so4PiwuQb2700k8vojCWhZyvVEhh6NgWXMdCusql7yA+/5QZUYMadBGriGtn6cZAuFkoi8rkwWuuSUnuHY8iWPN57ZfcFSFRmG9MoJIckjQXK7ItcPg5SXOgCGufVCbkiuShFyAaid0ga0F9U6B+KXhq3AG4KFKymDcI0MgDrZ009k3yEcyB/qqIS25t1/aJn2sBg8ZGvnQI0GwEQVDFi129m4abZHzLGoPgpdtFDsnuYlT+Xkjl3iE9MhexSdC184ojLGvrCraunQvYxyjR/MLl5iKZLAekj70axJ266zyGnb0A63DqzmfWILhRQ9j0KvlXpuRP5qVnFFOBWOR114oWwPcoG2ncQDNT16O7latE1ktcjI0YpVw/lUjTxjpUCZMLrv9ChOzT6vzW5hYd+nYFMulhp6sxKzpVyWtVtnXM5pZ4mNHgEbT79BuNSnMw0mzoVGtOjQ0NHRnAEbNhq6gXFtgNapVlOtrZt8KUK0ihDhMjxBcq2hcl575/gAuXd3DiEBD+wAAAAp0RVh0RGVwdGgA/////o6f8XkAAAAASUVORK5CYII=" alt="\widehat{h}_i(\vect{x}) \,
= \, \sum_{k=0}^2 \; a_{ki} \; \psi_k(\vect{x})"/></p>
</div><p>for any <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAARBAMAAACP9fljAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdM/d6WCLv/P7GJ1IMq+qQHN+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA00lEQVQY02NgwAHEnuOSYeDdwPQAlxyPA5sBpmiKU4uFIZDmw6KP64EC78MCBoYVC7DKMSjsZWDQQRFMNzaEyR1j4D5wAUkuOQqhT5QhlGEDA4OQSZhRAlCM7QHCvlIF3v//HzCwFTB95pgAFFsMt8/I0hvCZGFg+boEqJ0hDC6nW6UAs2f9BzC1xdgY5pY3G2Fy8ZAAiEb4gYkZ4jemgvoNPECvMjAj5BhzIYaer/qfsATkFcYCmFwBg5Y0mMmudM5JF9l/Iu5NBy5XogUmNFwQAAAFzzsPKYxevwAAAAp0RVh0RGVwdGgAAAAAAVAk0ZoAAAAASUVORK5CYII=" alt="\vect{x} \in \Rset^2" style="vertical-align: -1px"/> and any <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAAQBAMAAACxV6F2AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYPMySHS/GPuvi8/pnd2jAyobAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAmUlEQVQY02NgYFRgQAaMRyA077SnQJJZAFmO+coXCGMyQ/0CBgwAlVRhYFPAKdnFwPmBgSUMuyQDA98BhlIOByAjezcQ7ESVtHdgELDHpfMUEE/DIckJcmwLDslVQMyqIIDVTsYAhgUMnBPQ/PqRgcG6gIHBTVA0gYFlagGyFPvsP1MYPIDq+///T2DACgIY8AB8kqwMREgCAP2SKfcFMA+6AAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="i = 1, 2" style="vertical-align: -4px"/>
where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALBAMAAACNJ7BwAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnXRIMt2Lz+mv+2AYv/OLvb/5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAaElEQVQI12NgYBQyYYCCMIYKKIstgKGS4agAA4MaA1cCw2oG9g0gUX8H5g8MXGAF9gyMARvOcSezFQAFTkxI0N0ilPCGgfuS8rUDNzYwsDRAjHkcxMCZAGbxPNB15jsGZjJPOCvAmwIAnagXfMHM1zAAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="a_{ki}" style="vertical-align: -3px"/> is the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMASN0YYPuvz+mLnXTzARr72wAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAERJREFUCNdjYNQ1YAACVxDBkA4mO8HkRRDBcoFxFgMDm4KgKAMDR6KDNQMDrwpI3FdMAUgmMRxhBCk/yM3AcJhh1wYGADN9CmFZY5CnAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="k" style="vertical-align: 0px"/>-th coefficient of the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAMBAMAAACzedEdAAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAYPMySHS/GPuviyJl+xMAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAvSURBVAjXY2BgVGBgYBZggAGWMAaGUg4HBgFrIGcaELcwMLAqCDBwTljAwDK1AABJtQUo+Fv6BQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="i" style="vertical-align: 0px"/>-th output
marginal:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAAAsBAMAAAAX/bLtAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYM/dr4u/dPP7GDJI6Z3Po2ubAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACHUlEQVQ4y5WVP2gUQRTGv93cZm9nN38EDQQRjIFUClcE7GS1kHQJ2omEWItyjTmLFNckhQheExsbQdDr7rAWc2BIJ7cGa1lIEdPoBhMPTjHum9tL9ub2TS6vGPbN/piZ9+Z98wDeFtPOe+jNXkp7RkFPX+p172hh8azXNxd09JDyV7zS0U/ViVs6elWdqDU0GYnUmdxlnh7xafyxUj85eJunN+oyUjMQN4B3MtnfeHqOhrswfUwBpYC87zy9RsM6nHFUAFfSG2yYohUP7h80IcoXGh3aYe/HppC8CDuG/eBjsUMPsUnJVWisiK/W8JfuSYbL7L3L/xOlrXv5T8WEtiKOzh/vWrUfNly5qveXox2/+7UpHuP8OmXfbXH0WEb84jAWxfTszcFo/APmF8zfeBPKoK+QyTPUihn0AexfMFswx9UyyaJfIn8Ipw1H/dHMpmvx7QaoGvcHWPsAtQg//cLyxV3l3NlRjkTui1L4SD33WJhBtyCuzXzexvPrKu33w+5+kvfy8gfl5pf6aSO5ec9/q+xsBv20xQpztFNvaRUnVZxlRhuJilNVzD+c+10Vk+af3GbzpKp4Cm5oUoqa/GO111VxrHkvsArJFGP06kkVk+aRo7VneVruTSomzaP6Wu7EmlFJVEyax1WqomCAF5k0P9qo619kTKY0fw5x8na0nSQ81rx7dOSf0knO1qXO1gFh9RStd0p3zejc/wH1UZRcF3YzjAAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect{a}_k = \begin{pmatrix}a_{k1} \\ a_{k2} \end{pmatrix}"/></p>
</div><p>for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAARBAMAAACFqVcxAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0YYPuvz+mLnXTzvzKi8MdSAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA9UlEQVQoz2Ng1DdgIAa4ovFZVqZAGY0QmitXG0imoymTYOB4AKL5Fn6ECOQx2E9gYOhEU6bNwHUBwoIqO8jAewDOgYOPDCwBKMoiGdg+MLB8YJyFrIrxHwPjZxRlDAxMDQxsCoKiQBZvOQgkAB3+D6QSVdl7AQaORAdrNNNY0JUBnc+vguo0vo8M3GiWsgE96i+mgKruCwM3qhcYZgJxEsMRRmS3MWgycBWgKGPZwDABaO9BbhTTnIDBy1cMMZfhOTAmZV28LzAcZti1AUUZ9+oUBsZIBgbm9B+JDKJAZ8X//38BR0TDLdiANz0QqWwDunLilAEApfpAc14utC4AAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="k = 0, 1, 2" style="vertical-align: -4px"/>.
We consider the basis functions:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAABHBAMAAACExRb5AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdBiLSL/7MvNgna/P3en9R5X1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACNUlEQVRIx+2Uv2sUQRTHv7e7OrebvfP0SKcyVwgBIS6EcIEgrI2NmCz5BxQtbK9RTBAvpEu3YCFiohvRQrC4FLHRwkKwUPDUVuR6LcRGROSc2Z13P5KbHRsl4D3Ym5nHZ9/OzD0+QD+sJBs95EQlG3x6J9KjlmIfU6K6C7gX9qYFno0dSpSH0ZXFPmurVwJKTFSG4UN72FKDEu6L0awziZp1Rc4Oiufop1sfRfmLo9laMTyCdTkrii9E/q+iAL+K5YE3MlqDbNxEgAfOVoKb8lDlH9Pili9p9vtcsEkJM1iQq1OyJNY07Lq43mAD5zElV/fb8lezX3x3uY1HOCvP5kcXEifK2BH7xTsbdezgGsoci0vdYLoB1t5VN1aTE0+qPK3rVUStc19eiesIhtCTbz9T4YJ4NrAJ1vsHSlzXOrfTDpgB3lPmhrbN5AedLXGIq5RZMnWvaAM1s0OYQzUPwzj+Rvxz7wyEyTuDYfTOXlbvHYo/8I47uTzL+96xjuV454zzoRjX2uSdwnHovZM432wc7pB3JKj3jif2zzrkHcnqvVOuKDb1jmS13omb3MvY1DvpZjXesVfneD1jU+9IVucdtr28HWZs6h1ch8E7bJW84z6tG7xz93JDeSeNsXfG3vkPvFOYjwzeqe6Qd1bwOt87LPFbyjsLOJ3vHadjt8k7eGbwDiZa5B1rzeAdTHHyjh8avIOXPe88ZAbveGFDeceNPYN37iBR3ml2f+Z7h3W7rf3gnd8y+tMrzEMhRgAAAAp0RVh0RGVwdGgA//////mYwe8AAAAASUVORK5CYII=" alt="\psi_0(\vect{x}) &amp; = 1 \\
\psi_1(\vect{x}) &amp; = x_1 \\
\psi_2(\vect{x}) &amp; = x_2 \\"/></p>
</div><p>for any <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAARBAMAAACP9fljAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdM/d6WCLv/P7GJ1IMq+qQHN+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA00lEQVQY02NgwAHEnuOSYeDdwPQAlxyPA5sBpmiKU4uFIZDmw6KP64EC78MCBoYVC7DKMSjsZWDQQRFMNzaEyR1j4D5wAUkuOQqhT5QhlGEDA4OQSZhRAlCM7QHCvlIF3v//HzCwFTB95pgAFFsMt8/I0hvCZGFg+boEqJ0hDC6nW6UAs2f9BzC1xdgY5pY3G2Fy8ZAAiEb4gYkZ4jemgvoNPECvMjAj5BhzIYaer/qfsATkFcYCmFwBg5Y0mMmudM5JF9l/Iu5NBy5XogUmNFwQAAAFzzsPKYxevwAAAAp0RVh0RGVwdGgAAAAAAVAk0ZoAAAAASUVORK5CYII=" alt="\vect{x} \in \Rset^2" style="vertical-align: -1px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<section id="define-the-model">
<h2>Define the model<a class="headerlink" href="#define-the-model" title="Permalink to this heading">Â¶</a></h2>
<p>Prepare an input sample.
Each point is a pair of coordinates <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAATBAMAAADGyIhVAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFUlEQVQoz2NgYFRgwArAwszY5RhkQYQKDkm2AiARgEMSJAFWgBU8Y2DgmIBL0pmBgQtIud10vwgTYsmdUisAZgFluBkYeBJOFGyBSR7jaed2ALP4GRimMjAwMZwXKGDMgHqP5yM7Q/pbkE4BhqMgEWWgw1KhWpkMGDgVmB8AzRRgkAYJhDGAjQAD1gQGngD2BrCdQMTC+REYWFBJh/kCTAwMfA/AMqwCDNXsG9kngCQnCzCwb6gWqGRgkAY6eAbQigSGeZl+OWBjTxUwcD6b8uwAA4MN0IxyBgZOA6hdIGMTYI46AAyaRgYIBoHZSJIuQDeAdc2FhsyrSgY2qBzn//8PGHhB4cSSgIgl5KCtAZM4Qh4oDABjgjLiXUA8SwAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(x_1, x_2)" style="vertical-align: -5px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputTrain</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]]</span>
<span class="n">inputTrain</span> <span class="o">+=</span> <span class="p">[[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">]]</span>
<span class="n">inputTrain</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">inputTrain</span><span class="p">)</span>
<span class="n">inputTrain</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">])</span>
<span class="n">inputTrain</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>x1</th><th>x2</th></tr>
  <tr><th>0</th><td>0.5</td><td>0.5</td></tr>
  <tr><th>1</th><td>-0.5</td><td>-0.5</td></tr>
  <tr><th>2</th><td>-0.5</td><td>0.5</td></tr>
  <tr><th>3</th><td>0.5</td><td>-0.5</td></tr>
  <tr><th>4</th><td>0.25</td><td>0.25</td></tr>
  <tr><th>5</th><td>-0.25</td><td>-0.25</td></tr>
  <tr><th>6</th><td>-0.25</td><td>0.25</td></tr>
  <tr><th>7</th><td>0.25</td><td>-0.25</td></tr>
</table>
</div>
<br />
<br /><p>Compute the output sample from the input sample and a function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">formulas</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cos(x1 + x2)&quot;</span><span class="p">,</span> <span class="s2">&quot;(x2 + 1) * exp(x1 - 2 * x2)&quot;</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">([</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">],</span> <span class="n">formulas</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">setOutputDescription</span><span class="p">([</span><span class="s2">&quot;y1&quot;</span><span class="p">,</span> <span class="s2">&quot;y2&quot;</span><span class="p">])</span>
<span class="n">outputTrain</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputTrain</span><span class="p">)</span>
<span class="n">outputTrain</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>y1</th><th>y2</th></tr>
  <tr><th>0</th><td>0.5403023</td><td>0.909796</td></tr>
  <tr><th>1</th><td>0.5403023</td><td>0.8243606</td></tr>
  <tr><th>2</th><td>1</td><td>0.3346952</td></tr>
  <tr><th>3</th><td>1</td><td>2.240845</td></tr>
  <tr><th>4</th><td>0.8775826</td><td>0.973501</td></tr>
  <tr><th>5</th><td>0.8775826</td><td>0.9630191</td></tr>
  <tr><th>6</th><td>1</td><td>0.5904582</td></tr>
  <tr><th>7</th><td>1</td><td>1.58775</td></tr>
</table>
</div>
<br />
<br /></section>
<section id="linear-least-squares">
<h2>Linear least squares<a class="headerlink" href="#linear-least-squares" title="Permalink to this heading">Â¶</a></h2>
<p>Create a linear least squares model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearLeastSquares</span><span class="p">(</span><span class="n">inputTrain</span><span class="p">,</span> <span class="n">outputTrain</span><span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Get the linear term.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">getLinear</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[[  9.93014e-17  0.998189    ]<br>
 [  4.96507e-17 -0.925648    ]]</p>
</div>
<br />
<br /><p>Get the constant term.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">getConstant</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[0.854471,1.05305]</p>
</div>
<br />
<br /><p>Get the metamodel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">responseSurface</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getMetaModel</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the second output of our model with <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAPBAMAAACmSdRUAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYHS/MosYSN3znc/pr/uvp9FeAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA0klEQVQY02NgwAYYl14EUT5XVzhglWeoYeAByXj+24JdnqGJgcsASDkx4ALfGRgfwBUImYiaocmzf2Fg/wakvUKBTmFXqAiYCBFn3g0CF4Bu/AJSw8CQxcBZwMDFUJ8QwKaBbgLjF4ieBiCxmoGBSQdFAct3BqZvYBYXyCmHQD5GdcRHBiaQzCQGrg8MjCzfGBZAFMDdwNDKwLUBSB0BWRHJOo3VAd0ECWBAsWxjCGPIc2DwVZFVx7CCadFFBvYnDKxrTWAiPgwEgCcBecZ7IbikAKlNNLy14LrOAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="x_1=0.5" style="vertical-align: -3px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Model&quot;</span><span class="p">])</span>
<span class="n">curve</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">responseSurface</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">])</span>
    <span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Linear L.S.&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_create_linear_least_squares_model_001.png" srcset="../../_images/sphx_glr_plot_create_linear_least_squares_model_001.png" alt="y2 as a function of x2" class = "sphx-glr-single-img"/><div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-meta-modeling-general-purpose-metamodels-plot-create-linear-least-squares-model-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/83c06f447edee9c0e809df5ff479ab78/plot_create_linear_least_squares_model.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_create_linear_least_squares_model.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/eecaa7f58e33af77285eb60d37dacae4/plot_create_linear_least_squares_model.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_create_linear_least_squares_model.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_general_linear_model.html" title="Create a general linear model metamodel"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="General purpose metamodels"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Meta modeling</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >General purpose metamodels</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Create a linear least squares model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>