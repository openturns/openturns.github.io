
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis &#8212; OpenTURNS 1.21 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The HSIC sensitivity indices: the Ishigami model" href="plot_hsic_estimators_ishigami.html" />
    <link rel="prev" title="Use the ANCOVA indices" href="plot_sensitivity_ancova.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_hsic_estimators_ishigami.html" title="The HSIC sensitivity indices: the Ishigami model"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_ancova.html" title="Use the ANCOVA indices"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#define-the-model">Define the model</a></li>
<li><a class="reference internal" href="#draw-the-function">Draw the function</a></li>
<li><a class="reference internal" href="#estimate-the-sobol-indices">Estimate the Sobol’ indices</a></li>
<li><a class="reference internal" href="#estimate-the-second-order-indices">Estimate the second order indices</a></li>
<li><a class="reference internal" href="#using-a-different-estimator">Using a different estimator</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_sensitivity_ancova.html"
                          title="previous chapter">Use the ANCOVA indices</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_hsic_estimators_ishigami.html"
                          title="next chapter">The HSIC sensitivity indices: the Ishigami model</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/sensitivity_analysis/plot_sensitivity_sobol.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="estimate-sobol-indices-for-the-ishigami-function-by-a-sampling-method-a-quick-start-guide-to-sensitivity-analysis">
<span id="sphx-glr-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-py"></span><h1>Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis<a class="headerlink" href="#estimate-sobol-indices-for-the-ishigami-function-by-a-sampling-method-a-quick-start-guide-to-sensitivity-analysis" title="Permalink to this heading">¶</a></h1>
<p>In this example, we estimate the Sobol’ indices for the <a class="reference internal" href="../../usecases/use_case_ishigami.html#use-case-ishigami"><span class="std std-ref">Ishigami function</span></a> by sampling methods.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>In this example we are going to quantify the correlation between the input variables and the output variable of a model thanks to Sobol indices.</p>
<p>Sobol indices are designed to evaluate the importance of a single variable or a specific set of variables.
Here the Sobol indices are estimated by sampling from the distributions of the input variables and propagating uncertainty through a function.</p>
<p>In theory, Sobol indices range from 0 to 1; the closer an index value is to 1, the better the associated input variable explains the function output.</p>
<p>Let us denote by <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMASN0yYPudz4t0GOmvv40dxUsAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABMSURBVAjXY2BgYBB6DCQYWAJAJFsBiGRqAJF8BkB+5lQgS4OhnIGBQ4GhjIGBtYEhkIHBzoDxAQODHAObggMDK8PqAw0MLDcn3lgAAEoSDEBZQZ8MAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="d" style="vertical-align: 0px"/> the input dimension of the model.</p>
<p>Sobol’ indices can be computed at different orders.</p>
<ul class="simple">
<li><p>First order indices evaluate the importance of one input variable at a time.</p></li>
<li><p>Total indices give the relative importance of one input variable and all its interactions with other variables.
Alternatively, they can be viewed as measuring how much wriggle room remains to the output when all but one input variables are fixed.</p></li>
<li><p>In general, we are only interested in first order and total Sobol’ indices.
There are situations, however, where we want to estimate interactions.
Second order indices evaluate the importance of every pair of input variables. The number of second order indices is:</p></li>
</ul>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJcAAAAsBAMAAACavDf8AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi510v2DpGPPdrzL7z0hlKVRSAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC+UlEQVRIx61XTWgTQRR+uybN72ZTEcRDpfgDtlgJ1IMHlYgIehAKtQWhQvToQXIo4q0VCt4kQbDopRE9iFLNQQUPpRG8CRo8CoUciiAIicYaaKHxvTebuLuZyW6aPsjM2zcz37z55s2bCQDKXipgBXxIaFhq/m/dk8YisfQ2J+uWWCraPw0qfmy5e822tWkuZ2BIOumM4+soFcGS3RS8hf4kW57f42oMjKQMbMzxlaFCL9sssRPbLTtKRGDkIfRJBpa3fwgPIs5ZCeyppZ8SFfKwLAMjfmLIqj5BMEygWewAu2bpd6k4NI48zFU6oNgOcAZglOo4LfLwaegAi1ue19hxA3mIlt1Ywg6gpfUC1WFe91onmCnUAep1AAwMlVDDDSbsKPuOcPUOcXPwVeJZltVVIuADxGmJN9xglh3ja56r7zgsCZ9Ru/oIJd8GCwuw50TwFlRJP+bCatnRM6YM7tDkiZqSswUK8xqMBMlL1w607G3OcEwV9NyEAixUp7IUuqkBL8Eplp128wUTnMVhtwvObhv4ey82k0m/Mr6+nzbPvZ2WPUZbTe7oKQieP3suaz/6y39fAQyyHrWfs8C8R9KIlRUNiyKSMjaTVvNKQYtdJwnb50pse4G9kZsDYuHxgn2CuhdYMCU1HxSVad+Z0C/PVFvsZnWAwW/oS+Ycfm9yeXkN5dsOwFYdYB+djWbTv1D/ajew/jzb7JMzyQbsmDPTcavW+3BrJQumI2g3+gD7WYRwmm/CZw84vrd9DBq9lFI1GXzQXwrutIY3VrSoPic6J4r7Ivs48pFCwhW4qDy5DXFxRPnGy3mDYTZ+rWy0OOe8Zg77ovqhsmXBCl66S6oVP1gx9TYdF9V1m+4hA0n1EWBvotzhsS+wJ+omg6N20LpzfYiW7JKISyIbY5dAxg/YJGjqRnpSrU9NpqVPKskj98LUSXUrPVq/NJsINuLHsXiz+UfdGmkFl/wZ2ptYD2RQPJB7lGmrHtoFLHwvCWZzuwHWy9+drvIPPlrWzQZ1peUAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\binom{d}{2} = \frac{d \times \left( d-1\right)}{2}."/></p>
</div><p>In practice, when the number of input variables is not small (say, when <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAOBAMAAACr0JNIAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0yYPudz4t0GOmvv/MXNcn2AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAqklEQVQY02NgYGAQ+syABbAEIPOsTyQZgGi2AmRRu6/FYJqpgYGBawFM1BJK8wN1cN0VQBFly5wKoriOO0BEzTqOAEkNhnIIt6kBTC1j4BNg4FBgKIPqdT8FoXkVGFgbGAJhFs2HmM0WwGBvwPgBpvYyiHzJwPaBQZ6BTQFiT1MCmNoMNoFh9QGQNVxJEyA6uhiWGjCw3Jx4A+gDrusw93LkXIb7k3kBsq8ByYciPnShbI4AAAAKdEVYdERlcHRoAAAAAAFQJNGaAAAAAElFTkSuQmCC" alt="d&gt;5" style="vertical-align: -1px"/>), then the number of second order indices is too large to be easily analyzed.
In these situations, we limit the analysis to the first order and total Sobol’ indices.</p>
</section>
<section id="define-the-model">
<h2>Define the model<a class="headerlink" href="#define-the-model" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">ishigami_function</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>We load the Ishigami model from the usecases model :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">ishigami_function</span><span class="o">.</span><span class="n">IshigamiModel</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>IshigamiModel</cite> data class contains the input distribution <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAAATBAMAAAC5NVjhAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABpUlEQVQ4y42Uv0sDMRTHv1d7PU/bcnQQB8Fi/4EKgjjZH+LcSbpo6+DgZIfSQVC7OXogglNrEZxbcXCzS50PF0UQ6+ii0ipFRTRJbS8JDTRw7/J5L/ney8slwMA2gaGbjxot8m7p7bgYiQGhxTgyc1bPo0StyqQ60IqSep2YrRwmOZ8SV1kqLXikFIPUTIcR5nxKZIORFKJ9cW9U0FaiJ0VtecWSRPapMT/WeZ8S/TFqx+blikeZPc0JTiWy0eOdLlwskZagvRPGV+IsJb5R0/iWEjGaLM0M2Twt3XMy1G+qAjZqpDtLV5dKSiImEznykjz1tZ6TYQEJHkewTLoV8uyg7IgiGl2O4Zg/5LXby45hCXc8Gnju1kQLI9iUakJLFQJeOJF/xIyAhWx3dB4IfErreSIfIRv3aDORvOWiVhFwitTEKOK4baP0lRVFNmAeLMB8PWMih46LXltAXJIUnMEnM+926XJSLm4aPKZxD4xag0U4/7Yg4q/7eLzGufBF8Uep9mdFbqG7gb3fFo+BB3LqaqqbpsGDLsYkDNgqEWP4m40M/QMSNm/JTkY16wAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="X=(X_1, X_2, X_3)" style="vertical-align: -5px"/> in <cite>im.distributionX</cite> and the Ishigami function in <cite>im.model</cite>.
We also have access to the input variable names with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_names</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="draw-the-function">
<h2>Draw the function<a class="headerlink" href="#draw-the-function" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">sampleX</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">sampleY</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">sampleX</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotXvsY</span><span class="p">(</span><span class="n">sampleX</span><span class="p">,</span> <span class="n">sampleY</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span>
    <span class="n">dimX</span> <span class="o">=</span> <span class="n">sampleX</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
    <span class="n">inputdescr</span> <span class="o">=</span> <span class="n">sampleX</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimX</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dimX</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">inputdescr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">sampleX</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">sampleY</span><span class="p">)</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">ax</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">fig</span>


<span class="n">plotXvsY</span><span class="p">(</span><span class="n">sampleX</span><span class="p">,</span> <span class="n">sampleY</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sensitivity_sobol_001.png" srcset="../../_images/sphx_glr_plot_sensitivity_sobol_001.png" alt="plot sensitivity sobol" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x400 with 3 Axes&gt;
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">HistogramFactory</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sampleY</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sensitivity_sobol_002.png" srcset="../../_images/sphx_glr_plot_sensitivity_sobol_002.png" alt="y PDF" class = "sphx-glr-single-img"/><p>We see that the distribution of the output has two modes.</p>
</section>
<section id="estimate-the-sobol-indices">
<h2>Estimate the Sobol’ indices<a class="headerlink" href="#estimate-the-sobol-indices" title="Permalink to this heading">¶</a></h2>
<p>We first create a design of experiments with the <cite>SobolIndicesExperiment</cite>.
Since we are not interested in second order indices for the moment, we use the default value of the third argument (we will come back to this topic later).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sie</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SobolIndicesExperiment</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="n">inputDesign</span> <span class="o">=</span> <span class="n">sie</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">input_names</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span>
<span class="n">inputDesign</span><span class="o">.</span><span class="n">setDescription</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span>
<span class="n">inputDesign</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>5000
</pre></div>
</div>
<p>We see that 5000 function evaluations are required to estimate the first order and total Sobol’ indices.</p>
<p>Then we evaluate the outputs corresponding to this design of experiments.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">outputDesign</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we estimate the Sobol’ indices with the <cite>SaltelliSensitivityAlgorithm</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SaltelliSensitivityAlgorithm</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">,</span> <span class="n">outputDesign</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>getFirstOrderIndices</cite> and <cite>getTotalOrderIndices</cite> method respectively return estimates of all first order and total Sobol’ indices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getFirstOrderIndices</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[0.240497,0.42218,-0.0275219]</p>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getTotalOrderIndices</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[0.590134,0.424195,0.269467]</p>
</div>
<br />
<br /><p>The <cite>draw</cite> method produces the following graph. The vertical bars represent the 95% confidence intervals of the estimates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sensitivity_sobol_003.png" srcset="../../_images/sphx_glr_plot_sensitivity_sobol_003.png" alt="Sobol' indices - SaltelliSensitivityAlgorithm" class = "sphx-glr-single-img"/><ul class="simple">
<li><p>We see that the variable <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbUlEQVQI12NgYFT+IsD62ZEBDNi+MzA2QJgMjJ8YmBhgwJlBAc6eHyYAZ3OZw5kM3N8R7KO/gYQo2CjOAGcgGfoAxK5lmH+BgYEdxGZUYOB7AGWXMDDw/oSwZ3yewDDvVwJEHApQ2AsQ7EO2BQAbtBrHh8JVCgAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="X_1" style="vertical-align: -3px"/>, with a total Sobol’ index close
to 0.6, is the most significant variable, taking into account both its direct
effect and its interactions with other variables.
Its first order index is close to 0.3, which implies that its interactions
alone produce almost 30% (0.6 - 0.3) of the total variance.</p></li>
<li><p>The variable <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAf0lEQVQI12NgYFT+IsD62ZEBDNi+MzA2QJgMjJ8YmBhgwJlBAc6eHyYAZ3OZw5kM3N8R7KO/gUSsNojJGeDMwMCewAIyoJZh/gUGzge8QDsYFRj4HgCFmIDiJQwMvD+BbCkBhhmfJzDM+5XAwOCJMIxtQgGcfYYhAcZk//9fAQCnnxnZlvcbmgAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="X_2" style="vertical-align: -3px"/> has the highest first order index: approximately 0.4.
However, it has little interaction with other variables since its total order indice is close to its first order index.</p></li>
<li><p>The variable <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgElEQVQI12NgYFT+IsD62ZEBDNi+MzA2QJgMjJ8YmBhgwJlBAc6eHyYAZ3OZw5kM3N8R7KO/gURMNEghZ4AzkDRgSQCStQzzLzAwFPBNABqvwMD3gIGBPQ0oXMLAwPsTKHRagGHG5wkM834B1XLD3MHA2sC7AMbmSeBGOOTuJQYA3YoaGbLZriYAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="X_3" style="vertical-align: -3px"/> has a first order index close to zero.
However, it has an impact to the total variance thanks to its interactions with <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbUlEQVQI12NgYFT+IsD62ZEBDNi+MzA2QJgMjJ8YmBhgwJlBAc6eHyYAZ3OZw5kM3N8R7KO/gYQo2CjOAGcgGfoAxK5lmH+BgYEdxGZUYOB7AGWXMDDw/oSwZ3yewDDvVwJEHApQ2AsQ7EO2BQAbtBrHh8JVCgAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="X_1" style="vertical-align: -3px"/>.</p></li>
<li><p>We see that the variability of the estimates is quite high even with a relatively large sample size.
Moreover, since the exact first order Sobol’ index for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgElEQVQI12NgYFT+IsD62ZEBDNi+MzA2QJgMjJ8YmBhgwJlBAc6eHyYAZ3OZw5kM3N8R7KO/gURMNEghZ4AzkDRgSQCStQzzLzAwFPBNABqvwMD3gIGBPQ0oXMLAwPsTKHRagGHG5wkM834B1XLD3MHA2sC7AMbmSeBGOOTuJQYA3YoaGbLZriYAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="X_3" style="vertical-align: -3px"/> is zero, its estimate has a 50% chance of being nonpositive.</p></li>
</ul>
</section>
<section id="estimate-the-second-order-indices">
<h2>Estimate the second order indices<a class="headerlink" href="#estimate-the-second-order-indices" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">computeSecondOrder</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sie</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SobolIndicesExperiment</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">distributionX</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">computeSecondOrder</span><span class="p">)</span>
<span class="n">inputDesign</span> <span class="o">=</span> <span class="n">sie</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inputDesign</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span>
<span class="n">inputDesign</span><span class="o">.</span><span class="n">setDescription</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span>
<span class="n">outputDesign</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>8000
</pre></div>
</div>
<p>We see that 8000 function evaluations are now required; that is 3000 more evaluations than in the previous situation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SaltelliSensitivityAlgorithm</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">,</span> <span class="n">outputDesign</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">second_order</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">getSecondOrderIndices</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">dim</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2nd order indice (</span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">)=</span><span class="si">%g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">second_order</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2nd order indice (1,0)=0.097439
2nd order indice (2,0)=0.353784
2nd order indice (2,1)=0.121106
</pre></div>
</div>
<p>This shows that the only significant interaction is the one between <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbUlEQVQI12NgYFT+IsD62ZEBDNi+MzA2QJgMjJ8YmBhgwJlBAc6eHyYAZ3OZw5kM3N8R7KO/gYQo2CjOAGcgGfoAxK5lmH+BgYEdxGZUYOB7AGWXMDDw/oSwZ3yewDDvVwJEHApQ2AsQ7EO2BQAbtBrHh8JVCgAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="X_1" style="vertical-align: -3px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGK/7z3SdMt1I879gi+loGlKnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgElEQVQI12NgYFT+IsD62ZEBDNi+MzA2QJgMjJ8YmBhgwJlBAc6eHyYAZ3OZw5kM3N8R7KO/gURMNEghZ4AzkDRgSQCStQzzLzAwFPBNABqvwMD3gIGBPQ0oXMLAwPsTKHRagGHG5wkM834B1XLD3MHA2sC7AMbmSeBGOOTuJQYA3YoaGbLZriYAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="X_3" style="vertical-align: -3px"/> (beware of Python’s index shift: 0 denotes the first input variable).</p>
</section>
<section id="using-a-different-estimator">
<h2>Using a different estimator<a class="headerlink" href="#using-a-different-estimator" title="Permalink to this heading">¶</a></h2>
<p>We have used the <cite>SaltelliSensitivityAlgorithm</cite> class to estimate the indices. Others are available in the library:</p>
<ul class="simple">
<li><p><cite>SaltelliSensitivityAlgorithm</cite></p></li>
<li><p><cite>MartinezSensitivityAlgorithm</cite></p></li>
<li><p><cite>JansenSensitivityAlgorithm</cite></p></li>
<li><p><cite>MauntzKucherenkoSensitivityAlgorithm</cite></p></li>
</ul>
<p>In order to compare the results with another method, we use the <cite>MartinezSensitivityAlgorithm</cite> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivityAnalysis</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MartinezSensitivityAlgorithm</span><span class="p">(</span><span class="n">inputDesign</span><span class="p">,</span> <span class="n">outputDesign</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">sensitivityAnalysis</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_sensitivity_sobol_004.png" srcset="../../_images/sphx_glr_plot_sensitivity_sobol_004.png" alt="Sobol' indices - MartinezSensitivityAlgorithm" class = "sphx-glr-single-img"/><p>We see that the results do not change significantly in this particular situation.</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-sensitivity-analysis-plot-sensitivity-sobol-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/70f0c96883d438ab1e87001437f5ac80/plot_sensitivity_sobol.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sensitivity_sobol.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7e8f69061f9adc89a7f4e5b7604a39b9/plot_sensitivity_sobol.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sensitivity_sobol.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_hsic_estimators_ishigami.html" title="The HSIC sensitivity indices: the Ishigami model"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_sensitivity_ancova.html" title="Use the ANCOVA indices"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Sensitivity analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimate Sobol’ indices for the Ishigami function by a sampling method: a quick start guide to sensitivity analysis</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 21, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>