
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Cross Entropy Importance Sampling &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reliability processes" href="../reliability_processes/index.html" />
    <link rel="prev" title="An illustrated example of a FORM probability estimate" href="plot_form_explained.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../reliability_processes/index.html" title="Reliability processes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_form_explained.html" title="An illustrated example of a FORM probability estimate"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Reliability</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cross Entropy Importance Sampling</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Cross Entropy Importance Sampling</a><ul>
<li><a class="reference internal" href="#create-the-probabilistic-model">Create the probabilistic model</a></li>
<li><a class="reference internal" href="#create-the-event-y-g-vect-x-leq-0">Create the event <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAAATBAMAAACuF8goAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL9g6Z0ySHTd8/vPi6+kdlH6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACDklEQVQ4y32UPUwUQRTH/8t+3MJd9vQSKPWkssOCwktMDqhsIJBQIMa4oTMxcQsqG68lweSERM9CobAgoaEmIWwgsRHDVWKDQmwMIYEL5FAMjvPe7N1ebuec4r2ZNzO/ee/NmwGM/jvo2Hrj7rhmOsVbrXHM/MkDA4uaJaGc3xTLGbEe5HQnDFalyPrArtT7mgU2nfHsHFgA3GrT3EfCfPRDOlGLCMUSUiUNwSKREUHmQOqhhjX3huQsLB9GPSKky60Rx+0lByvCLdI/I+NTBqACW8beIHg1HOgIr1ku/c6TuqdshY9KX8BcU4SbkpC68q61776xfx1r3Cues0qznDuMrqHOSSDCCxp/+KLsXTvUyB9n2NjAstoqGJ8l8XwiOsCsEwRnknWfxieJmrBKqDsqeUeCQ0wTx6ug6YOEYLCEwi1elEhBUYaZYoJX3uRoetgTe1TNOxdwZRS5bWCaxiMJwiS80OAoHuDxVZwHuO9Vys7gSvAYZZIMv9Ceh35YVc6kXUb2soUAc8En9Q52SDeibtOsJXyYx3cfw+wMPEHl9qT5Gj7zrVJFNerBOPobtBO8rw+BKTirooxP4jJIlL07Jau6WVHadizLr3X8Srfov4QVoLulzpxQs0a9C92Tgj3kyqt08rGli2mFt7JV4g/ilOJZ0RHc299I3Y0te9r/gY83g85/lBN3/Q5/1D+y8oiyQcjJ1AAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\{ Y = g(\vect{X}) \leq 0 \}" style="vertical-align: -5px"/></a></li>
<li><a class="reference internal" href="#evaluate-the-probability-with-the-standard-space-cross-entropy">Evaluate the probability with the Standard Space Cross Entropy</a></li>
<li><a class="reference internal" href="#draw-initial-samples-and-final-samples">Draw initial samples and final samples</a></li>
<li><a class="reference internal" href="#estimation-of-the-probability-with-the-physical-space-cross-entropy">Estimation of the probability with the Physical Space Cross Entropy</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_form_explained.html"
                          title="previous chapter">An illustrated example of a FORM probability estimate</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../reliability_processes/index.html"
                          title="next chapter">Reliability processes</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_reliability_sensitivity/reliability/plot_crossentropy.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-reliability-sensitivity-reliability-plot-crossentropy-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="cross-entropy-importance-sampling">
<span id="sphx-glr-auto-reliability-sensitivity-reliability-plot-crossentropy-py"></span><h1>Cross Entropy Importance Sampling<a class="headerlink" href="#cross-entropy-importance-sampling" title="Permalink to this heading">Â¶</a></h1>
<p>The objective is to evaluate a failure probability using Cross Entropy Importance Sampling.
Two versions in the standard or physical spaces are implemented.
See <a class="reference internal" href="../../user_manual/_generated/openturns.experimental.StandardSpaceCrossEntropyImportanceSampling.html#openturns.experimental.StandardSpaceCrossEntropyImportanceSampling" title="openturns.experimental.StandardSpaceCrossEntropyImportanceSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">StandardSpaceCrossEntropyImportanceSampling</span></code></a> and <a class="reference internal" href="../../user_manual/_generated/openturns.experimental.PhysicalSpaceCrossEntropyImportanceSampling.html#openturns.experimental.PhysicalSpaceCrossEntropyImportanceSampling" title="openturns.experimental.PhysicalSpaceCrossEntropyImportanceSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalSpaceCrossEntropyImportanceSampling</span></code></a>.
We consider the simple stress beam example: <a class="reference internal" href="../../usecases/use_case_beam.html#use-case-stressed-beam"><span class="std std-ref">axial stressed beam</span></a>.</p>
<p>First, we import the python modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.experimental</span> <span class="k">as</span> <span class="nn">otexp</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">stressed_beam</span>

<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<section id="create-the-probabilistic-model">
<h2>Create the probabilistic model<a class="headerlink" href="#create-the-probabilistic-model" title="Permalink to this heading">Â¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">axialBeam</span> <span class="o">=</span> <span class="n">stressed_beam</span><span class="o">.</span><span class="n">AxialStressedBeam</span><span class="p">()</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">axialBeam</span><span class="o">.</span><span class="n">distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial distribution:&quot;</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Initial distribution: ComposedDistribution(LogNormal(muLog = 14.9091, sigmaLog = 0.0997513, gamma = 0), Normal(mu = 750, sigma = 50), IndependentCopula(dimension = 2))
</pre></div>
</div>
<p>Draw the limit state function <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMBAMAAABCcoqQAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAGK+LMun7dGCdz7/z+qwmQAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAEtJREFUCNdjYGBUNhRgYHAVEDNgYAhn4HVg4LjA0MbAwBnAoMXAwL2BIZiBgX0B8xUGBgblygQgycC0AETyFDAwTGUoBbKqixUYGABabgpEH3HNBQAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="g" style="vertical-align: -4px"/> to help to understand the shape of the limit state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">axialBeam</span><span class="o">.</span><span class="n">model</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Simple stress beam&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">drawfunction</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">draw</span><span class="p">([</span><span class="mf">1.8e6</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">,</span> <span class="mf">950.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">drawfunction</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_crossentropy_001.png" srcset="../../_images/sphx_glr_plot_crossentropy_001.png" alt="Simple stress beam" class = "sphx-glr-single-img"/><p>Create the output random vector <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAATBAMAAAAjVk05AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMr/73WDPi3RIGJ2v8+l0lYufAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABTUlEQVQoz2NgwAlWI5gbgFjoswIDg74rFoUJDAx89v8vsP23nbAIxM8H4nIs6rgDgIT8PwYGJwYGjgIgO76BgbMBi0I+EMH2fwLbASD9AIiZHZBdgwDtIILzf0ISiD4BxDy/GA5gU+gIJv2/KICoMJCm7zwL0NRwHa9awGAAZsb/A1PMIOJeIURaLQ0IckAsuQWLCxguQFT8B5vCDyLOB6Db+oKBX4DxAZh59j/YXcwg5WfR1bF+YAhm4AQr5HGwBzuBF6TwEUYIPmA4xsAFtnoLw/7vcDf+YEBzI5MCw3MGsGe4HRj4/8IUsv5CN5Ejgf0jA8MrIGsf0PL/oNgQAQbF2T8T0FUe7wYat4OB8fJ/B4bk/38nYI9jsB+ACUIMWcALh0JeoHUsSNHAmIBV2T6GPpCkAkKEaQFWhU3t4ECOQIhUMuADjAimAAMDAPluUWYCBOOEAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="Y = g(\vect{X})" style="vertical-align: -5px"/> with <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAAATBAMAAADvz3fSAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMA6fvzz0gy3b+vYBidi3QixNnZAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABd0lEQVQoz3VSO0sDQRD+8rzc5ZIc1haxEyxiY2VhBBsLSfQP5MQUYuMVFj4K00UQJBBE00QbKwuD9iI2go33E+4PBEI0GhVdd26XEDe5hZ2Zb/ZjHjsDjD/Jh1Gf6csJ9opCd+7/U5Tfev98ryVgfbpR/UlWyIwzC1pFifTMr5ZHwhJQc4Am2r5d6GFZTUy0jIt0T8AMr+0KId8uvUXV4GmX/DbMb4FLReAauudnYrtqcM3m4hG4dQV+gQEbRp5sg1kqPUxiB/f7Ei9CJ5X1QU6mTCzRqXErQrDfrsqPwVRjklSHhL7wqUZf5zf2DlOmjX/hlPQMibNwV6Wv0lSySHUE5NpvYp7cjslchX4nvz0rhyazEHwC2KxSe1h8e8RKis5rAzrVd/GrRA/xHm+KCDlbZep2+1K04GAj94FojikrY3rQj04QW3HXeJ36oZh6yg1YyHh+YHpDw2sF0HEwjl4OYmNzsD1DzuNAuuGN0lPFQDrsMQ0Bf1UGVT6O6fv4AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\vect{X} = (R,F)" style="vertical-align: -5px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RandomVector</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CompositeRandomVector</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-the-event-y-g-vect-x-leq-0">
<h2>Create the event <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAAATBAMAAACuF8goAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL9g6Z0ySHTd8/vPi6+kdlH6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACDklEQVQ4y32UPUwUQRTH/8t+3MJd9vQSKPWkssOCwktMDqhsIJBQIMa4oTMxcQsqG68lweSERM9CobAgoaEmIWwgsRHDVWKDQmwMIYEL5FAMjvPe7N1ebuec4r2ZNzO/ee/NmwGM/jvo2Hrj7rhmOsVbrXHM/MkDA4uaJaGc3xTLGbEe5HQnDFalyPrArtT7mgU2nfHsHFgA3GrT3EfCfPRDOlGLCMUSUiUNwSKREUHmQOqhhjX3huQsLB9GPSKky60Rx+0lByvCLdI/I+NTBqACW8beIHg1HOgIr1ku/c6TuqdshY9KX8BcU4SbkpC68q61776xfx1r3Cues0qznDuMrqHOSSDCCxp/+KLsXTvUyB9n2NjAstoqGJ8l8XwiOsCsEwRnknWfxieJmrBKqDsqeUeCQ0wTx6ug6YOEYLCEwi1elEhBUYaZYoJX3uRoetgTe1TNOxdwZRS5bWCaxiMJwiS80OAoHuDxVZwHuO9Vys7gSvAYZZIMv9Ceh35YVc6kXUb2soUAc8En9Q52SDeibtOsJXyYx3cfw+wMPEHl9qT5Gj7zrVJFNerBOPobtBO8rw+BKTirooxP4jJIlL07Jau6WVHadizLr3X8Srfov4QVoLulzpxQs0a9C92Tgj3kyqt08rGli2mFt7JV4g/ilOJZ0RHc299I3Y0te9r/gY83g85/lBN3/Q5/1D+y8oiyQcjJ1AAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\{ Y = g(\vect{X}) \leq 0 \}" style="vertical-align: -5px"/><a class="headerlink" href="#create-the-event-y-g-vect-x-leq-0" title="Permalink to this heading">Â¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ThresholdEvent</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">ot</span><span class="o">.</span><span class="n">Less</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="evaluate-the-probability-with-the-standard-space-cross-entropy">
<h2>Evaluate the probability with the Standard Space Cross Entropy<a class="headerlink" href="#evaluate-the-probability-with-the-standard-space-cross-entropy" title="Permalink to this heading">Â¶</a></h2>
<p>We choose to set the intermediate quantile level to 0.35.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">standardSpaceIS</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">StandardSpaceCrossEntropyImportanceSampling</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">)</span>
</pre></div>
</div>
<p>The sample size at each iteration can be changed by the following accessor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">standardSpaceIS</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can run the algorithm and get the results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">standardSpaceIS</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">standardSpaceISResult</span> <span class="o">=</span> <span class="n">standardSpaceIS</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">proba</span> <span class="o">=</span> <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Proba Standard Space Cross Entropy IS = &quot;</span><span class="p">,</span> <span class="n">proba</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Current coefficient of variation = &quot;</span><span class="p">,</span>
    <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getCoefficientOfVariation</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Proba Standard Space Cross Entropy IS =  0.029465848610494363
Current coefficient of variation =  0.045029988245260714
</pre></div>
</div>
<p>The length of the confidence interval of level <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAPBAMAAAB3rtAkAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYL+dzzJ06fP7i0gYr93HczAKAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA1ElEQVQI12NggAMrGwYG3g0IPteCczLc94AMIZMAhvBbdgEcAVyMqW8YGNgKGFoZIn66MvAzcAFVMTBwJjAoMYQBVXIe4GI4B6TjBRhWggX4NnAxuIIENjCsPxC86iIDt8JuNgOgAH8Cw/2AwwwcGxi2bTjHcPAAA5cDg/4BBgamB0BJbVadNQwMa1etB7KZJzAwMF5gAZoDBOYMbQzMH4DGgq1m3MBQyFAK1nIRLMB+gUuBYQ3DyQCgNWC3cBtbAf1hqwrUcYCBN+EYwnMMaUB8bQEAHp8xS7W0FtgAAAAKdEVYdERlcHRoAAAAAAFQJNGaAAAAAElFTkSuQmCC" alt="95\%" style="vertical-align: -1px"/> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">length95</span> <span class="o">=</span> <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getConfidenceLength</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confidence length (0.95) = &quot;</span><span class="p">,</span> <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getConfidenceLength</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Confidence length (0.95) =  0.005201143946946643
</pre></div>
</div>
<p>which enables to build the confidence interval.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Confidence interval (0.95) = [&quot;</span><span class="p">,</span>
    <span class="n">proba</span> <span class="o">-</span> <span class="n">length95</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;, &quot;</span><span class="p">,</span>
    <span class="n">proba</span> <span class="o">+</span> <span class="n">length95</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;]&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Confidence interval (0.95) = [ 0.02686527663702104 ,  0.032066420583967685 ]
</pre></div>
</div>
<p>We can analyze the simulation budget.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Numerical budget: &quot;</span><span class="p">,</span>
    <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getBlockSize</span><span class="p">()</span> <span class="o">*</span> <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getOuterSampling</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Numerical budget:  3000
</pre></div>
</div>
<p>We can also retrieve the optimal auxiliary distribution in the standard space.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Auxiliary distribution in Standard space: &quot;</span><span class="p">,</span>
    <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getAuxiliaryDistribution</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Auxiliary distribution in Standard space:  Normal(mu = [-1.565,0.931278], sigma = [0.635602,0.863718], R = [[ 1 0 ]
 [ 0 1 ]])
</pre></div>
</div>
</section>
<section id="draw-initial-samples-and-final-samples">
<h2>Draw initial samples and final samples<a class="headerlink" href="#draw-initial-samples-and-final-samples" title="Permalink to this heading">Â¶</a></h2>
<p>First we get the auxiliary samples in the standard space and we project them in physical space.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auxiliaryInputSamples</span> <span class="o">=</span> <span class="n">standardSpaceISResult</span><span class="o">.</span><span class="n">getAuxiliaryInputSample</span><span class="p">()</span>
<span class="n">auxiliaryInputSamplesPhysicalSpace</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">distribution</span><span class="o">.</span><span class="n">getInverseIsoProbabilisticTransformation</span><span class="p">()(</span><span class="n">auxiliaryInputSamples</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Cloud of samples and failure domain&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="c1"># Generation of samples with initial distribution</span>
<span class="n">initialSamples</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span>
    <span class="n">distribution</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;plus&quot;</span><span class="p">,</span> <span class="s2">&quot;Initial samples&quot;</span>
<span class="p">)</span>
<span class="n">auxiliarySamples</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span>
    <span class="n">auxiliaryInputSamplesPhysicalSpace</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;fsquare&quot;</span><span class="p">,</span> <span class="s2">&quot;Auxiliary samples&quot;</span>
<span class="p">)</span>
<span class="c1"># Plot failure domain</span>
<span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">nx</span><span class="p">],</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mf">1.80e6</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">]))</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">ny</span><span class="p">],</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mf">600.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">950.0</span><span class="p">]))</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">inputData</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">],</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mf">1.80e6</span><span class="p">,</span> <span class="mf">600.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">,</span> <span class="mf">950.0</span><span class="p">]))</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">outputData</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">inputData</span><span class="p">)</span>
<span class="n">mycontour</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Contour</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">outputData</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;0.0&quot;</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">mycontour</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Failure domain&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">initialSamples</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">auxiliarySamples</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mycontour</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_crossentropy_002.png" srcset="../../_images/sphx_glr_plot_crossentropy_002.png" alt="Cloud of samples and failure domain" class = "sphx-glr-single-img"/><p>In the previous graph, the blue crosses stand for samples drawn with the initial distribution and the orange squares stand for the samples drawn at the final iteration.</p>
</section>
<section id="estimation-of-the-probability-with-the-physical-space-cross-entropy">
<h2>Estimation of the probability with the Physical Space Cross Entropy<a class="headerlink" href="#estimation-of-the-probability-with-the-physical-space-cross-entropy" title="Permalink to this heading">Â¶</a></h2>
<p>For a more advanced usage, it is possible to work in the physical space to specify the auxiliary distribution.
In this second example, we take the auxiliary distribution in the same family as the initial distribution and we want to optimize all the parameters.</p>
<p>The parameters to be optimized are the parameters of the native distribution.
It is necessary to define among all the distribution parameters, which ones will be optimized through the indices of the parameters.
In this case, all the parameters will be optimized.</p>
<p>Be careful that the native parameters of the auxiliary distribution will be considered.
Here for the <a class="reference internal" href="../../user_manual/_generated/openturns.LogNormalMuSigma.html#openturns.LogNormalMuSigma" title="openturns.LogNormalMuSigma"><code class="xref py py-class docutils literal notranslate"><span class="pre">LogNormalMuSigma</span></code></a> distribution, this corresponds
to <cite>muLog</cite>, <cite>sigmaLog</cite> and <cite>gamma</cite>.</p>
<p>The user can use <cite>getParameterDescription()</cite> method to access to the parameters of the auxiliary distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">marginR</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LogNormalMuSigma</span><span class="p">()</span><span class="o">.</span><span class="n">getDistribution</span><span class="p">()</span>
<span class="n">marginF</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">()</span>
<span class="n">auxiliaryMarginals</span> <span class="o">=</span> <span class="p">[</span><span class="n">marginR</span><span class="p">,</span> <span class="n">marginF</span><span class="p">]</span>
<span class="n">auxiliaryDistribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">auxiliaryMarginals</span><span class="p">)</span>
<span class="c1"># Definition of parameters to be optimized</span>
<span class="n">activeParameters</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Indices</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">activeParameters</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>
<span class="c1"># WARNING : native parameters of distribution have to be considered</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">70</span><span class="p">])</span>
<span class="n">initialParameters</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">auxiliaryDistribution</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">auxiliaryDistribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Parameters of the auxiliary distribution:&quot;</span><span class="p">,</span>
    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">p</span><span class="p">)]),</span>
<span class="p">)</span>

<span class="n">physicalSpaceIS1</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">PhysicalSpaceCrossEntropyImportanceSampling</span><span class="p">(</span>
    <span class="n">event</span><span class="p">,</span> <span class="n">auxiliaryDistribution</span><span class="p">,</span> <span class="n">activeParameters</span><span class="p">,</span> <span class="n">initialParameters</span><span class="p">,</span> <span class="n">bounds</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters of the auxiliary distribution: muLog_marginal_0: 0.000, sigmaLog_marginal_0: 1.000, gamma_marginal_0: 0.000, mean_0_marginal_1: 0.000, standard_deviation_0_marginal_1: 1.000
</pre></div>
</div>
<p>Custom optimization algorithm can be also specified for the auxiliary distribution parameters optimization, here for example we choose <a class="reference internal" href="../../user_manual/_generated/openturns.TNC.html#openturns.TNC" title="openturns.TNC"><code class="xref py py-class docutils literal notranslate"><span class="pre">TNC</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">physicalSpaceIS1</span><span class="o">.</span><span class="n">setOptimizationAlgorithm</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">TNC</span><span class="p">())</span>
</pre></div>
</div>
<p>The number of samples per step can also be specified.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">physicalSpaceIS1</span><span class="o">.</span><span class="n">setMaximumOuterSampling</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we run the algorithm and get the results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">physicalSpaceIS1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">physicalSpaceISResult1</span> <span class="o">=</span> <span class="n">physicalSpaceIS1</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Probability of failure:&quot;</span><span class="p">,</span> <span class="n">physicalSpaceISResult1</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficient of variation:&quot;</span><span class="p">,</span> <span class="n">physicalSpaceISResult1</span><span class="o">.</span><span class="n">getCoefficientOfVariation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Probability of failure: 0.029702353119720654
Coefficient of variation: 0.04321365594527282
</pre></div>
</div>
<p>We can also decide to optimize only the means of the marginals and keep the other parameters identical to the initial distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">marginR</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LogNormalMuSigma</span><span class="p">(</span><span class="mf">3e6</span><span class="p">,</span> <span class="mf">3e5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">getDistribution</span><span class="p">()</span>
<span class="n">marginF</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">750.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
<span class="n">auxiliaryMarginals</span> <span class="o">=</span> <span class="p">[</span><span class="n">marginR</span><span class="p">,</span> <span class="n">marginF</span><span class="p">]</span>
<span class="n">auxiliaryDistribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">auxiliaryMarginals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameters of initial distribution&quot;</span><span class="p">,</span> <span class="n">auxiliaryDistribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">())</span>

<span class="c1"># Definition of parameters to be optimized</span>
<span class="n">activeParameters</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Indices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="c1"># WARNING : native parameters of distribution have to be considered</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">initialParameters</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">750</span><span class="p">]</span>
<span class="n">physicalSpaceIS2</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">PhysicalSpaceCrossEntropyImportanceSampling</span><span class="p">(</span>
    <span class="n">event</span><span class="p">,</span> <span class="n">auxiliaryDistribution</span><span class="p">,</span> <span class="n">activeParameters</span><span class="p">,</span> <span class="n">initialParameters</span><span class="p">,</span> <span class="n">bounds</span>
<span class="p">)</span>
<span class="n">physicalSpaceIS2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">physicalSpaceISResult2</span> <span class="o">=</span> <span class="n">physicalSpaceIS2</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Probability of failure:&quot;</span><span class="p">,</span> <span class="n">physicalSpaceISResult2</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficient of variation:&quot;</span><span class="p">,</span> <span class="n">physicalSpaceISResult2</span><span class="o">.</span><span class="n">getCoefficientOfVariation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters of initial distribution [14.9091,0.0997513,0,750,50]
Probability of failure: 0.027545561342593866
Coefficient of variation: 0.08610020947245134
</pre></div>
</div>
<p>Let us analyze the auxiliary output samples for the two previous simulations.
We can plot initial (in blue) and auxiliary samples in physical space (orange
for the first simulation and black for the second simulation).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Cloud of samples and failure domain&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">auxiliarySamples1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span>
    <span class="n">physicalSpaceISResult1</span><span class="o">.</span><span class="n">getAuxiliaryInputSample</span><span class="p">(),</span>
    <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fsquare&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Auxiliary samples, first case&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">auxiliarySamples2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span>
    <span class="n">physicalSpaceISResult2</span><span class="o">.</span><span class="n">getAuxiliaryInputSample</span><span class="p">(),</span>
    <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bullet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Auxiliary samples, second case&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">initialSamples</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">auxiliarySamples1</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">auxiliarySamples2</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mycontour</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_crossentropy_003.png" srcset="../../_images/sphx_glr_plot_crossentropy_003.png" alt="Cloud of samples and failure domain" class = "sphx-glr-single-img"/><p>By analyzing the failure samples, one may want to include correlation parameters in the auxiliary distribution.
In this last example, we add a Normal copula. The correlation parameter will be optimized with associated interval between 0 and 1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">marginR</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LogNormalMuSigma</span><span class="p">(</span><span class="mf">3e6</span><span class="p">,</span> <span class="mf">3e5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">getDistribution</span><span class="p">()</span>
<span class="n">marginF</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">750.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
<span class="n">auxiliaryMarginals</span> <span class="o">=</span> <span class="p">[</span><span class="n">marginR</span><span class="p">,</span> <span class="n">marginF</span><span class="p">]</span>
<span class="n">copula</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NormalCopula</span><span class="p">()</span>
<span class="n">auxiliaryDistribution</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">(</span><span class="n">auxiliaryMarginals</span><span class="p">,</span> <span class="n">copula</span><span class="p">)</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">auxiliaryDistribution</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">auxiliaryDistribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Initial parameters of the auxiliary distribution:&quot;</span><span class="p">,</span>
    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">p</span><span class="p">)]),</span>
<span class="p">)</span>

<span class="c1"># Definition of parameters to be optimized</span>
<span class="n">activeParameters</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Indices</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">activeParameters</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>

<span class="n">bounds</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">initialParameters</span> <span class="o">=</span> <span class="n">auxiliaryDistribution</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>

<span class="n">physicalSpaceIS3</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">PhysicalSpaceCrossEntropyImportanceSampling</span><span class="p">(</span>
    <span class="n">event</span><span class="p">,</span> <span class="n">auxiliaryDistribution</span><span class="p">,</span> <span class="n">activeParameters</span><span class="p">,</span> <span class="n">initialParameters</span><span class="p">,</span> <span class="n">bounds</span>
<span class="p">)</span>
<span class="n">physicalSpaceIS3</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">physicalSpaceISResult3</span> <span class="o">=</span> <span class="n">physicalSpaceIS3</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">desc</span> <span class="o">=</span> <span class="n">physicalSpaceISResult3</span><span class="o">.</span><span class="n">getAuxiliaryDistribution</span><span class="p">()</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">physicalSpaceISResult3</span><span class="o">.</span><span class="n">getAuxiliaryDistribution</span><span class="p">()</span><span class="o">.</span><span class="n">getParameter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Optimized parameters of the auxiliary distribution:&quot;</span><span class="p">,</span>
    <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">p</span><span class="p">)]),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Probability of failure: &quot;</span><span class="p">,</span> <span class="n">physicalSpaceISResult3</span><span class="o">.</span><span class="n">getProbabilityEstimate</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coefficient of variation: &quot;</span><span class="p">,</span> <span class="n">physicalSpaceISResult3</span><span class="o">.</span><span class="n">getCoefficientOfVariation</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Initial parameters of the auxiliary distribution: muLog_marginal_0: 14.909, sigmaLog_marginal_0: 0.100, gamma_marginal_0: 0.000, mean_0_marginal_1: 750.000, standard_deviation_0_marginal_1: 50.000, R_2_1_copula: 0.000
Optimized parameters of the auxiliary distribution: muLog_marginal_0: 14.735, sigmaLog_marginal_0: 0.060, gamma_marginal_0: 0.000, mean_0_marginal_1: 750.001, standard_deviation_0_marginal_1: 50.001, R_2_1_copula: 0.000
Probability of failure:  0.027282009127094012
Coefficient of variation:  0.06193432381407314
</pre></div>
</div>
<p>Finally, we plot the new auxiliary samples in black.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Cloud of samples and failure domain&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;topright&quot;</span><span class="p">)</span>
<span class="n">auxiliarySamples1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span>
    <span class="n">physicalSpaceISResult1</span><span class="o">.</span><span class="n">getAuxiliaryInputSample</span><span class="p">(),</span>
    <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fsquare&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Auxiliary samples, first case&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">auxiliarySamples3</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span>
    <span class="n">physicalSpaceISResult3</span><span class="o">.</span><span class="n">getAuxiliaryInputSample</span><span class="p">(),</span>
    <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bullet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Auxiliary samples, second case&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">initialSamples</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">auxiliarySamples1</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">auxiliarySamples3</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mycontour</span><span class="p">)</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 4</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_crossentropy_004.png" srcset="../../_images/sphx_glr_plot_crossentropy_004.png" alt="Cloud of samples and failure domain" class = "sphx-glr-single-img"/><p>The <cite>quantileLevel</cite> parameter can be also changed using the <a class="reference internal" href="../../user_manual/_generated/openturns.ResourceMap.html#openturns.ResourceMap" title="openturns.ResourceMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceMap</span></code></a> key : <cite>CrossEntropyImportanceSampling-DefaultQuantileLevel</cite>.
Be careful that this key changes the value number of both <a class="reference internal" href="../../user_manual/_generated/openturns.experimental.StandardSpaceCrossEntropyImportanceSampling.html#openturns.experimental.StandardSpaceCrossEntropyImportanceSampling" title="openturns.experimental.StandardSpaceCrossEntropyImportanceSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">StandardSpaceCrossEntropyImportanceSampling</span></code></a>
and <a class="reference internal" href="../../user_manual/_generated/openturns.experimental.PhysicalSpaceCrossEntropyImportanceSampling.html#openturns.experimental.PhysicalSpaceCrossEntropyImportanceSampling" title="openturns.experimental.PhysicalSpaceCrossEntropyImportanceSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalSpaceCrossEntropyImportanceSampling</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsScalar</span><span class="p">(</span><span class="s2">&quot;CrossEntropyImportanceSampling-DefaultQuantileLevel&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">physicalSpaceIS4</span> <span class="o">=</span> <span class="n">otexp</span><span class="o">.</span><span class="n">PhysicalSpaceCrossEntropyImportanceSampling</span><span class="p">(</span>
    <span class="n">event</span><span class="p">,</span> <span class="n">auxiliaryDistribution</span><span class="p">,</span> <span class="n">activeParameters</span><span class="p">,</span> <span class="n">initialParameters</span><span class="p">,</span> <span class="n">bounds</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modified quantile level:&quot;</span><span class="p">,</span> <span class="n">physicalSpaceIS4</span><span class="o">.</span><span class="n">getQuantileLevel</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Modified quantile level: 0.4
</pre></div>
</div>
<p>The optimized auxiliary distribution with a dependency between the two marginals allows one to better fit the failure domain, resulting in a lower coefficient of variation.</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-reliability-sensitivity-reliability-plot-crossentropy-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/43a19656707647a5138ed9527cf554ed/plot_crossentropy.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_crossentropy.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/473e8a0dde65ce0f075969c44679d1e5/plot_crossentropy.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_crossentropy.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../reliability_processes/index.html" title="Reliability processes"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_form_explained.html" title="An illustrated example of a FORM probability estimate"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Reliability &amp; Sensitivity</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Reliability</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cross Entropy Importance Sampling</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>