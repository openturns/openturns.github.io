
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Bayesian calibration of a computer code &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sampling from an unnormalized probability density" href="plot_imh_python_distribution.html" />
    <link rel="prev" title="Gibbs sampling of the posterior distribution" href="plot_gibbs.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_imh_python_distribution.html" title="Sampling from an unnormalized probability density"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_gibbs.html" title="Gibbs sampling of the posterior distribution"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bayesian calibration of a computer code</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Bayesian calibration of a computer code</a><ul>
<li><a class="reference internal" href="#test-the-metropolis-hastings-sampler">Test the Metropolis-Hastings sampler</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_gibbs.html"
                          title="previous chapter">Gibbs sampling of the posterior distribution</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_imh_python_distribution.html"
                          title="next chapter">Sampling from an unnormalized probability density</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/bayesian_calibration/plot_bayesian_calibration.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-calibration-bayesian-calibration-plot-bayesian-calibration-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="bayesian-calibration-of-a-computer-code">
<span id="sphx-glr-auto-calibration-bayesian-calibration-plot-bayesian-calibration-py"></span><h1>Bayesian calibration of a computer code<a class="headerlink" href="#bayesian-calibration-of-a-computer-code" title="Permalink to this heading">Â¶</a></h1>
<p>In this example we are going to compute the parameters of a computer model thanks to Bayesian estimation.</p>
<p>Let us denote <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAAATBAMAAAAT2lwYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFUlEQVQoz42SsUoDQRBA38XkkrtEclWaEBCxsBKtREhxIFiKn7CVnRDS2IQQ/YJrBBvBLthZ+AHXCHaJlR8gWCe9hbNzmMiZhR1uZrl7b5e9YSDYwSfU2vJS6dmy5+eGAykXfq711PeJL2hknu4pxNC6Ipw7jDUTsQmdOG+4GrdmbbiDdEacdyYbXWXFuQmvsnwy49LRD8s0mgldWV7YJ3K4lv3eV55gya3LtSw4OHtXsZbAIvq2bnTEv7Ss3s6lufdQMTAeL6zbmkqPnv6kvCt7ow/XsvlQPlTmeoewPAMUbJdHuMFmLY0zoueNrrJ+9STVMx9kKj/gfJphSq6hYJPgmG35L6qmPjQrVnZXbKTVb3jE+gGWpzwqW0A90wAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(y_1, \dots, y_n)" style="vertical-align: -5px"/> the observation sample,
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAR0AAAATBAMAAABfOcSMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADKElEQVRIx42WT2gTQRTGv03zZ7dNzCLYgyIJKh4lKviPgoFCL1KJ3tUFQQ9FEA8WseL2UETwEGgLvRTjQUqtpfFcwVwU8dL0Jl701IsHW7FVWiS+N7Ob3ZnsxgyZJPMe32+/eft2EsAooreR0ANt5f4glvM+u0NDAjQDuhD19WgHRlMLCGXiPlAKYibN6akiDsdvSxXABaxzVwVdiI716ge3tbVQ3htDoqz4yS5nd5C+G0fRBOznU3PNYboQVXr2k9LWQvl2RomTn4N1/OmC1QTkx1hC3hXBCrpspGPsc5SlUFqbat3Iz8W7xi6wEQPRBeSn7zcKNUEnkVnt2U+ypCyFMk1beqr4MVp2lvwMx0B0AfkpbGGtJugk6ueNLzmj8VUJkjUlwUrj+/Uyh5N3Zh7Z0k9mm18iG/VQ6ALy87jCL46SaIBCP16txndRKLnJD/RpHt8glTDpptWBD9knA2XpJ9VaffcXyMfgdAH5ubG32moKOolmKVTFTWDQjQaIpBwvlMSsKFIDFtktZrcygmAi/wv9O5Swo3FhgeenVcaKI+gkei9OMdrvrbgScVKON0pcKAv0fLMwUZIEE4VN7gYMxPgJC6QfowVuOKaT6BD3/DN+i/EjklH9w0pcopao81ngSILJj8rXYmz/KALPzy5yP+H3D+uGbetMrB9OGidG1j0/Qf+IKx6V4fJzO+H5yVeMPcT7CQkk1cU2CvW2n5SN9MuVVoVp1kl0TJHM5Bt0NFhqh6X4jpyieQWZ+kP7gecnV+tbpOBcJE0RSKqLL7hQlfQ5uo8ODthjy6La2QW6uYuhSWuZ/IghIKMenQmu+Guax2FtzGw0PD/4fI2NjkfSVIGgushNcfGZPk42/L5iWlo/vPwvR7iaptqirDT4CJgOEUw/OxlNUwSC6hed6ZNSKGn1Ln6GkufLbUxwyeRgCYFPJpghsxE0VSCovp9przbz3vryQhWORmivXeMssK5l55EfbfC1mwHB95OzEUVTBYLq+1mXIiSdiOtHrTMN/ffMyYyLLyPq/x8eE9G0ToHvh+kT3gHc27Aiju6OTFZL/R/VCEIk+geaUNzUj1OrCwAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="(\vect z_1, \ldots, \vect z_n) = (f(x_1|\vect\theta), \ldots, f(x_n|\vect\theta))" style="vertical-align: -5px"/> the model prediction,
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAATBAMAAAAkFJMsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABGklEQVQY012RMU7DMBSGvybBVhVaogoQI1XVS5SBIvUAGRASW8QFKBdAQUhMdGNALGSBuQIOEBbEhMIJ6NQyVoIBFuC5bhKVN/h/9vfs/9kGGwdWQisORSRWhlZUmK87/QXAag7qLIJ8XlTkoBrMk/t/QItno9ULieE1ZM2Ay0ct1jFq/ZNdUlQw4E5A9ev8RbZM0Trmyh2ha1MGAlwqpvUz6TThpjYSv0SQ8dg3Jk/gB5yoFJb7ztCArcwAMV2JdGr0MPI3BehbOsEMvEX1jLEUsJ0J2Hj//QFXtrZ3WtAE7+Ja7qHGlWfp1uvCgzmyY4Z2eUE/go95MuG0BFIoPUq4IclStwR7cPw9y47oNcu38rLio1wrWTH7AwsdQ/X8BTt5AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="p(y |\vect z)" style="vertical-align: -5px"/> the density function of observation <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMBAMAAABCcoqQAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPvdnWCvz/Myi+k+AKxlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATElEQVQI12NgVGZgMmBwYhVgK2BokGdgFWBgmMUgz8DAsIOhjIGB5QtDOpD9gecjkLx58wOQZGA3YGDga2A9wMDAxWAL5PNeV2BgAACoTwyCcycjxwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="y" style="vertical-align: -4px"/>
conditional on model prediction <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAr/vzdGC/6TLP3UgYdzMtfAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADNJREFUCNdjYGBUdghjYJBVMi5gYGhg8GQAAjYBIMGxGsSMPMAxhYFFXfduAcPxA85qDACagwh5AU8/MwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect z" style="vertical-align: 0px"/>,
and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAAOBAMAAAB9dUktAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA60lEQVQY02NgYBAyCWBAAB4XbefNExiW9pwDctgq2H4iyTGsY2KQm8FwoIopgYFh+QaGz2hyTKwCbAbMFxgY9A9wfQcLrmk2ngCVYzvAE8C+gIHr/wI2sByP7QK4Ps4LTBeA9vF8ASEgOIcwU+ISA/dJoANZ/u/e/wMoxGUAk2NWLglgWA1i8v9lYAe5k/cAXJ/EIgaGGyDm+g8M+QVAmtXZ2BjqFr7UCVzGIMvXFzD0g/zOG4CwT8EKwuR34PoNZhgg5OYIQZgcBUyFYMYMmBwHA9NKqCHNHhB/Qf3H6dKtxmhRx4AKoOGCAACSN0DVL162WgAAAAp0RVh0RGVwdGgAAAAAAVAk0ZoAAAAASUVORK5CYII=" alt="\vect\theta \in \mathbb{R}^p" style="vertical-align: -1px"/> the calibration parameters we wish to estimate.</p>
<p>The posterior distribution is given by Bayes theorem:</p>
<p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAIBAMAAADQCGj8AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdM/z3TJgv68Yi537SOmpBYj6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAPklEQVQI12NgVHZlYKuYwJDFsD5hNwMDwwYG7oMNQHoBA4M/A4TOXwChvb4C6VwGpgvNAQwMjDtKGRjfTQAAvwwO5OgokOsAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\propto" style="vertical-align: 0px"/> means âproportional toâ, regarded as a function of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/>.</p>
<p>The posterior distribution is approximated here by the empirical distribution
of the sample <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFEAAAAVBAMAAADMaB9/AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA3klEQVQoz2NgAIOVBgy4AZf6At59MM5MBzwqGQ4FMATA2Ix4VR4rYDhAnMoDnrwCIFrIJAC3SpAkW8IUHhCbrYLtJ06VYEkeBvYcEGf5BobPOFWCJXkYWHVAHP0DXN8ZGDdgVwmWZGXg+gYKrP8L2L4z3KsRwBqSIEmuZgGGBiCH5wsI4QAokiz/d+//gUsliiT/Xwb2n7hUokiu/8CQX4BLJYrk+gKG/gCcKpEl+R24fuOMRhRJjgKmQkjUa2FiuCQYNHssgERcDRAXIuEaJElUwEmAT47KCQT4RKsEAETmRelMfKogAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\vect\theta^1, \ldots, \vect\theta^N" style="vertical-align: -4px"/> generated by the Metropolis-Hastings algorithm.
This means that any quantity characteristic of the posterior distribution
(mean, variance, quantile, â¦) is approximated by its empirical counterpart.</p>
<p>Our model (i.e. the compute code to calibrate) is a standard normal linear regression, where</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMQAAAAVBAMAAADr6lzSAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPvdnWCvz/Myi+k+AKxlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACV0lEQVRIx7WVzWsTQRjGn2w33U12p40exFsileLBSA5FaDGw+AGCSD34B+ipJ2XxIOJBloKoh0Jo7aGiEk/qgrKHHKqi7EkrBbPgocZEiB57kAg9eKsz+72TTUBI3su8zOxvnpl35pkFRhLlNYw5VD1fG7NEpkuujHsbyP3vLsqPB40ILTu1/4I2jOoPUvs4aKilplfk2VCqP7YxHeZa8lwt9IJcjPVLBXsIlRJLWAzzb4mRSV0MJYgR9d+HPoTqD3EPzQEfL2pqmoS6v19Lo85cv8ru2wyESlJC6qLNf7x8amWONndALE5Cntn6qqVT4kMcps3pbGFSFxyaLZg0XtJEebOxK84mPs6UDjmbKOPdxtN64GRf4mDmmmL4lLA8F6eIezthFJEtJHcxbeC9cCIhIaGosWX8hdIJnOxL6Jk9ElBZPI9TwoGjbvsIRe4smqzgX1g2YZq/TdOd8bZbc1pv38kL5utdd8+Q6nQyx6VU/IxT4tsb7oSbuInvCYm7yFU8idhx/6LLrsuXsBY6OTjuqVJEfdL5QpE6uz5LRNHiZ7GNcxonIdP1605DtcTLnpMjCaOpSQio84mzYNpOA+ipf8L5vFDwApxEmzSIrXZh5Q3XyZEEsdpah5XBpXAyTh2DWKIQWq0eniQk5B2Dl/h8/MER5Bys3PKcHEmoq1urBVYGRs0G99a/JB9eMYgmFTSclEekz3rKxdDJvLv9Bd3DPE9RaMrI2qj2PZ/yesdLzkZ9E53AyZ6xYg+RXwbyo8ZTFMqjOoLfRUoZYg/3TmkEElV78Ng/i2zAC4/3ja4AAAAKdEVYdERlcHRoAP////6On/F5AAAAAElFTkSuQmCC" alt="y_i = \theta_1 + x_i \theta_2 + x_i^2 \theta_3 + \varepsilon_i"/></p>
</div><p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGsAAAAYBAMAAAAPJx5QAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL/d6UivYIt088+dMvsDE45VAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB3klEQVQ4y52TzysEYRjHv7O7Y/bdZtbkIEpZuXBDtmxR6+A/8OO6DkIScZBc5qKU1DpRHHZrb0orB1y0F8XJiBPJlouTkh+rpDzvvDO7+4bNeuqZ98c8n/d9fr1AUZglFEov/iUH/8Py1RivulqzHa+CCoZMRxHVE9XcdiVUTflmy3Z990CTbJiTVhNCgxF+pZPaJH2OY0BWxuqkVdqyubLEdaPhbIQpRoUc1mehnY4LI23ArVJR2uyYo+1bOT+/B81PhNhAABhEwOZbxskrfSunbO6dQqNxE4hBj4hNjk1yT7ujv2DLGaoGjX3cWMuXsCVyfhQjv2CRcxsLTvXVT6hPJSxMiSs3ZLuUAWZ62F0OvIQpaJ+cLGK1ZDS07njvyODtvvDLCd8KpEARGXHOaGVY2ISyc1a6rQW+Dvi9trGDBYVKq8ZhvIKVOcn7SYoGaL048voD+GDUMEoKKIDlpdh4hYJeG1Ad9Uevd+qBmWH3QfRAz0rYBpSklf4hj+Y0FbyLz/qBeSq3sccXBdJLOj1zyIP+JuyZjtff+JSCZ2fjUB/I4amXMWBFmNRY3zEtYwqvgRvvJO9fpxhCDRWbzG/KmOGG6VuriBluOya9FJt/e8CLMrb8x3dvyEt6Ql/jN2zEcjPPCAAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\varepsilon_i \stackrel{i.i.d.}{\sim} \mathcal N(0, 1)" style="vertical-align: -5px"/>.</p>
<p>The âtrueâ value of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/> is:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALsAAAAWBAMAAABqPPBpAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACh0lEQVRIx7VVTWgTQRT+Nslu0u0mXaNSxINREESwVhRR6CHeRKUEpIcixAXR9KTpxYoEXX8OVajuJZ6C7EXqrRGkaD24tJciFQKeeiikB/+wloBCDUXizO5kZzckMTlkCO+bNzPvmzffm50AvWmjSyOX0LMWLQWtWO/oFYTVvk4WvuieW6RmsO7FT6TarE10Ty/rxCwxR7olVdtkUuL969Ts2riossAytc/ThrPw22kXCqRzkAXNFvGrNX3I039Dzd6t/czt1+0aYtz21jFn1YEGzbNVRy15qzV9wVOuQ9Tucf1FSh8w8dL25hEp1iFmQK4woWqm1Ib+GO9em/bRSxM2fYJlkEOsUodoAos508npN/21bFnetWz63Ss/2WEilF7aXiuz+WDSBR4Vqr17/weyn/T+AdKGaK/oucrTzkXt15zdbHoMurnt01youFEDfxGuIqg2T15Icm0ceiAybGuj2fTyzOVXbMEFDrfdqLkKbmQRbqGNROg/HSdtBFadXsw6h7Hpg6Z83hmOWRwWOH0WT1PSQ0v8/lFJiJqYN31fiCuO8mTz9ReCbyHaR1/e/DFKZIiT8zsRK+DAtR9IytvAGIybeWshpB6Jlnzae0qLU9ScYeKQxGn2Owk6j5gBywUeFckGJoGT2DFMhA4L1bxfnXM+euEwPmBWJeDQx82AhqsEgIm1VZ2MU4DAEqDjD86adDslBbF8pU9vEH/c8yZMrUuTUNL3IOVoWb7eUTMq0mMGMiThu7WaTqYpQHHKgAy7MHLSCpTIx/b5WQKajz7etOKNb63hd4Nmw/wjjSgozSwbG4X/rOyEPt7x4yrozUaN9rs97vzxXu2eXtE6pxe6/zvxhPwDKNGmLHG8I4MAAAAKdEVYdERlcHRoAP/////5mMHvAAAAAElFTkSuQmCC" alt="\vect \theta_{true} = (-4.5,4.8,2.2)^T."/></p>
</div><p>We use a normal prior on <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/>:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAI8AAAATBAMAAABb6UOYAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACY0lEQVQ4y3VUQWgTQRR9m02ym6bZLlovQmgUbyqmpScvBuxJkAY8Krg3ySkrikUQU+rJU+LFm1RFzEGQHLyJEKre1ATsQQ+1iwfpQbQx0rRJ6vpnZrOZ3aSf7M7Pn/fe/Pz/J4AwLS9WbwlZ9KwPGGvSXoqe9NM8boYxcYten59zQMAi7tzxt+4u9yXWZUCf13cQd0J4NUPpVjggaLpbJ4UdcdqQRfAbdXS5E7BSB4iZo3Hg9z69Xvp0+JKbjtYGHobgr/5RiTCaKVXDpVhB+D5rwoTm2joJvQnBt9aABAeMWKMF3BIusZQzrtuGChh/2Id5ActdNfFahI1ZxB5LW+X+sJKUtpm/BkyyLnxo/AWmWPziBtlXITSTR4UDoLZQ2paEDNdvO7GWFYtwh8jvQaUeqHYgIcWJ1JHjAMxkUZQzwmk+gT8gWAmbcCtgh5WzdHRQyDCNHpvFFdamJhblsYw2gSP4ns4J1gTolDsklOWwUI2oYfvxGgdg00KDan7X8vYW6CnovVhWsArY5s5URuvDExrW6Dawet8LnzOVdtQ0jq177adMtE+RelTwcRI05hEb0Wxqlr4eDSRkP6BUn4EDFHc51Y2gXLuENPv960tL13/2Su/OZzhLq+MFzS6le+EE2/4VuGhdKkNsDxxgtD9+ufIEp7CIew6bR2a7xVqpIrGU5sCrykLJNabtCECK3yutvzAHWD6kaNOgSazqiGLIqlA7PMmeticLle33Adb0oEv2AULTbIyYUCfWQnwYT2w4AVbSO2ProP+upHWY31u9M5mXhUZYZmAZY4OdR9/G7v0HISOuEM6yUaoAAAAKdEVYdERlcHRoAP////6On/F5AAAAAElFTkSuQmCC" alt="\pi(\vect\theta) = \mathcal N(\vect{\mu}_\vect{\theta}, \mat{\Sigma}_\vect{\theta})"/></p>
</div><p>where</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF8AAABCCAMAAAAG2vqCAAAAPFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAo1xBWAAAAE3RSTlMAi/synd0YdM+/80jpYK/jcJHTlcmn7AAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAoNJREFUWMO1WdmCqyAMlU1Zc5f8/78OWO3MSBAaWh76IO0x24GTdFn4K6rGRjDLG5aD9paeh0+yvbfKMI0v082m8LPwEClYoe0jNH4yQgoJ80HkD9yRN1yn8C1lPpS6kfbhgJuBX3Fr7ohHqKYcgGbx6NMxnMmAbHgv3HPDSj78hs36FuaIS8LEz+5pWzLPJY5H5gzQkWjOQjo8tnjlzsQa5IdnozlRHtsTVrAD5Bq1B2s5evTzdVwK+NbpokHbb9ek55JrLHOGSbGEMBhGXgKgeThcqMCksEU19L2APAZ4HM1T5LFLvvuLF7NG606yGBxwVH7EwURdT4fRtBlWgQqa9wGIQtsY+JrGJy5ci4JFL4q+wjqCwByCkb8KwblBS/r0JfDF0sYXspSRNsP4goCn8I9MyVKmK1ZkcPa54B4/hBt8tdN4G2aNqauuvJDAf1Sy2PlyZG0V3ZL9g38r1QMAPsJVtPzD/08W+J3LIirrXrd/f9yyfw9/CZJTIRNay278X8JXWMSYzeGPS/QlUIz6yaeDlKAofIHSWxu0NyqfvM7JyMFvnCTwy90th2ftcs4N40OpGfmtIkrTobtnNgyfKpAtUT8usZDx+42THj5VXA6Nkj+8BWv7vm/Dus+y7pf0wv3IaYPVsOzwPIX+YX0yLDu4+sp8WB9SujjFQBQaT9/WuljpQJQKMPW5ovwm8NkNHtX4EPjc/og0rMbn93dU51nj8/vTlbCsxuf31/s918VH/nxA1Ayr8BNLPJ8Bgi6+m5jPED+ukjk1X7qM91aweJFXem7AZ3p3zNx8LzsQOpfc3HxycfcORJiDX9YPz4eX5O9ePj/fvpvPW1jesEb+X/gC6T0YIrIJnCcAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\vect{\mu}_\vect{\theta} =
\begin{pmatrix}
 -3 \\
  4 \\
  1
\end{pmatrix}"/></p>
</div><p>is the mean of the prior and</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAABCCAMAAAD5VB0lAAAAPFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAo1xBWAAAAE3RSTlMA6fvzSBi/dIvP3a8ynWDjcJHTSNmCqAAAAAlwSFlzAAAOxAAADsQBlSsOGwAABCBJREFUaN69mumSpCAMgAHlEmWPvP+7LiLaPUI3kMjyY6p6CjGGXB+BMcLg6/svbZxiI8a8PLKMcu+/1o0x64bIq7YHFvHipw44Y2YZIq4UM30R4bN/uTHaZWYiL+F4roVJ1nZkM843bNx92kQ1hxXy19ranu0Gc3PQtmkaJE1cmyt3m1lFkkXv06rxozBtogUdCTrbwaDuyp7BnLto2zRDU68TLzeAMESwjjC+u9oMa/xbeXNxGpCsV5ybY5Vcl8alfJJjRUyzgiCthuRVMdJ63pieogS+Jm5xmgdPcLTzW2MA10trNJlbvLw8TVi8uJBsYRWvbCydq4WoqCFdd7XStAUItpDiwmEGIurBSllTwGL2CFVVU3GawVuDujZqV4GNshvHZM2G/dKUJorTVkCH3unK4fOmt8PrpnWv9KT7mtn0pluScHGawBYOEmzBP4xRinlFcOCKiWAzhS+kAx2+YAmiumHiKqzxujwDMxNSxb5b48Q12MRmC4Heb4ek48SdARl5p1IIdCaqfJy4EjjuQRBfYpCbR8kLAvmZFBbBA7MApBERCJIAzBxWlH6AUG0QgHkJkYyH0ppzPolQXM+tEUVhmbERmMur2RA/Z0iWKFUhmhbHlovbyIyNwPxhNQtm19W5t7EQasoSDsmMjcD8YTUV84QFOOTUjR6g8vTSyIyNwPxhtaSmwIbxedloDDYTt4EZTwJtAOZPqyVxL/NtzsGmmxkvAm0A5k+rnT4TzPf1vdJcSlb2Gu6ruFVmfIRALxfnr0Bq+GpVLf7pXmZ8hEDPAKrslXDmEIq3isv8gt+dzPgMgf6Bv3GZpM09MvBp9/xe7daY8RkCPbR77r2czF69KCV4zXZ1LzM+QqBR3OCz+1hDpPHBYHwQ2fVGhioz3gkUg5ZRXAuvMUf73mqFT0nc5oLsIFCtEWX8lulxj83Vk2pFEPcg0DmYXX/N7PJs6qw1iMfa+TARKKb75HBq2gDfMTkJlNn+Uru5ZLyX54ST90SgBkGgFnfQ4IHcPgt1Tr+mOMw47+ZEaVfBJ9sNoBPyyBQEGzyKAIp9rYDR4pYAFH0ssuAIutcp3UOHToWzQGz3tANANTbc52eB6O5pB4A67IHpmm0LvnvaDqD4Xkp27o7vnn4OzHcARR/2Zx9K6Z4WebkAoIRWyr1pROmeFnm54Z0dQ96+lNI9beVlQhswIl0PCbdNe+PlHEApx57mpiFK97TIyxmAelz1eFqD6yHhtmlvvJwDqCLVKbenKd3TEi/nAEq7fnG/OUTpnua8nADU+KsvsxHvDi1jbri9A6h0TJ8RiHh1KHn5oHECqDwLB0+9mMXUQPWeAKpVsnNOvv4nhR8nbwLQo4R75FIh8xMbO/SWQvEjVzZvF2KfH9Kk2xEP3bPl/4OBfhz4/AMgLDCvgEEeEQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\mat{\Sigma}_\vect{\theta} =
\begin{pmatrix}
  \sigma_{\theta_1}^2 &amp; 0 &amp; 0 \\
  0 &amp; \sigma_{\theta_2}^2 &amp; 0 \\
  0 &amp; 0 &amp; \sigma_{\theta_3}^2
\end{pmatrix}"/></p>
</div><p>is the prior covariance matrix with</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARMAAAARBAMAAAAMOFU0AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABo0lEQVRIx2NgwAE4n/YykAi49pCng32fZDs+Vc8Z8gVIM5d9zh8GsnSw65sU4FOmw8CqQKonSXUKVAf7BfyKDBn4PtDbKYz6/z9jVcaxAYd+nDpwOgW/DvaJcgvAPNf0TiS5EBcg8AMz6w/gMBinDpxOwa+DbQIwOYAc3MCwmoEh7zmm/o24vIhTxx+ydUSACOYDDDcYGNxSMFTx4cpAOHXgdAphHZNBRDEDQxwD44NsDFWCuEIbpw6cTiGgg+kCw3wQDQw5MwamghPo8ch1gQFHsODSgdspBHRwF0AjiIHlAkO9YCjbG1TtR1etDWB3wxrcUB289xagyfxiYChJwKODcd0BbDoYE9jMQRp55s5hYLjC0MUVharI/v//AB5DbE6B6TjIhloGsj35/YbhsAAeHXm8AVh0FDBIPi0AUWAgyaDA8AqLGbw4yyaQDp4GLBIX8OlIOUCw0FvJt4BEp4B0sBSQ4hSQjqsFBJ3CJ8uA1SkX8OqQIsnxIB08G4iqDkhzCiiPLbhAilOA4Ca7AVFNh74DDKSB4k0OJOpIXLoAjywA3ZaUfngFZ8YAAAAKdEVYdERlcHRoAP////6On/F5AAAAAElFTkSuQmCC" alt="\sigma_{\theta_1} = 2, \qquad \sigma_{\theta_2} = 1, \qquad \sigma_{\theta_3} = 1.5."/></p>
</div><p>The following objects need to be defined in order to perform Bayesian calibration:</p>
<ul class="simple">
<li><p>The conditional density <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAATBAMAAAAkFJMsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABGklEQVQY012RMU7DMBSGvybBVhVaogoQI1XVS5SBIvUAGRASW8QFKBdAQUhMdGNALGSBuQIOEBbEhMIJ6NQyVoIBFuC5bhKVN/h/9vfs/9kGGwdWQisORSRWhlZUmK87/QXAag7qLIJ8XlTkoBrMk/t/QItno9ULieE1ZM2Ay0ct1jFq/ZNdUlQw4E5A9ev8RbZM0Trmyh2ha1MGAlwqpvUz6TThpjYSv0SQ8dg3Jk/gB5yoFJb7ztCArcwAMV2JdGr0MPI3BehbOsEMvEX1jLEUsJ0J2Hj//QFXtrZ3WtAE7+Ja7qHGlWfp1uvCgzmyY4Z2eUE/go95MuG0BFIoPUq4IclStwR7cPw9y47oNcu38rLio1wrWTH7AwsdQ/X8BTt5AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="p(y|\vect z)" style="vertical-align: -5px"/> must be defined as a probability distribution.</p></li>
<li><p>The computer model must be implemented thanks to the ParametricFunction class.
This takes a value of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/> as input, and outputs the vector of model predictions <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAr/vzdGC/6TLP3UgYdzMtfAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADNJREFUCNdjYGBUdghjYJBVMi5gYGhg8GQAAjYBIMGxGsSMPMAxhYFFXfduAcPxA85qDACagwh5AU8/MwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect z" style="vertical-align: 0px"/>,
as defined above (the vector of covariates <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAAATBAMAAABPUB88AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdM/d6WCLv/P7GJ1IMq+qQHN+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABTElEQVQ4y2NgwAJWMxAHNuAQVyBS/3LswtwBROpnTMAqzMJALHDAKipGtP6HWEVtidYfBMRCJmFGqP6YwMDAKn41fQEuXQhJTgYGtgKmzxxAHQxFSkCgBxJtYGA4yGPGgTMUEZL8oMBi+boEJSJ5gaGygecXG8NCAxzRDpKE2A9yxvoPqNI8oFDlBqYBQQccDuCGJRAOkP54NGu4GkBxKABxCPYIFoAygP5nKqjfwFOA4n9gaATcX8CNUz9IkmtfYBVY//mq/wlLLqDIezGwNWQsyAXp59ViwMBgSTb+A8DIv8zAwK50zkkX1fyNDLwPrz48ANLPMw0YHnORMJAPkTzMoMPAkIbVfZeQIoIRPcnDGLtB3rTCqp8ZmnJ4G/Do12HVDeDFnlF5CyB03LQLDAJocnC+AZcaAzuOJBqIRT02fg6O+OUlMvsAow0AIKZKfePAitcAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\vect x = (x_1, \ldots, x_n)" style="vertical-align: -5px"/> is treated as a known constant).
When doing that, we have to keep in mind that <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAr/vzdGC/6TLP3UgYdzMtfAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADNJREFUCNdjYGBUdghjYJBVMi5gYGhg8GQAAjYBIMGxGsSMPMAxhYFFXfduAcPxA85qDACagwh5AU8/MwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect z" style="vertical-align: 0px"/> will be used as the vector of parameters corresponding
to the distribution specified for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAATBAMAAAAkFJMsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABGklEQVQY012RMU7DMBSGvybBVhVaogoQI1XVS5SBIvUAGRASW8QFKBdAQUhMdGNALGSBuQIOEBbEhMIJ6NQyVoIBFuC5bhKVN/h/9vfs/9kGGwdWQisORSRWhlZUmK87/QXAag7qLIJ8XlTkoBrMk/t/QItno9ULieE1ZM2Ay0ct1jFq/ZNdUlQw4E5A9ev8RbZM0Trmyh2ha1MGAlwqpvUz6TThpjYSv0SQ8dg3Jk/gB5yoFJb7ztCArcwAMV2JdGr0MPI3BehbOsEMvEX1jLEUsJ0J2Hj//QFXtrZ3WtAE7+Ja7qHGlWfp1uvCgzmyY4Z2eUE/go95MuG0BFIoPUq4IclStwR7cPw9y47oNcu38rLio1wrWTH7AwsdQ/X8BTt5AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="p(y |\vect z)" style="vertical-align: -5px"/>. For instance, if <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAATBAMAAAAkFJMsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ0yi78YYPuvz93zSOn0RRdxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABGklEQVQY012RMU7DMBSGvybBVhVaogoQI1XVS5SBIvUAGRASW8QFKBdAQUhMdGNALGSBuQIOEBbEhMIJ6NQyVoIBFuC5bhKVN/h/9vfs/9kGGwdWQisORSRWhlZUmK87/QXAag7qLIJ8XlTkoBrMk/t/QItno9ULieE1ZM2Ay0ct1jFq/ZNdUlQw4E5A9ev8RbZM0Trmyh2ha1MGAlwqpvUz6TThpjYSv0SQ8dg3Jk/gB5yoFJb7ztCArcwAMV2JdGr0MPI3BehbOsEMvEX1jLEUsJ0J2Hj//QFXtrZ3WtAE7+Ja7qHGlWfp1uvCgzmyY4Z2eUE/go95MuG0BFIoPUq4IclStwR7cPw9y47oNcu38rLio1wrWTH7AwsdQ/X8BTt5AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="p(y|\vect z)" style="vertical-align: -5px"/> is normal,
this means that <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAr/vzdGC/6TLP3UgYdzMtfAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADNJREFUCNdjYGBUdghjYJBVMi5gYGhg8GQAAjYBIMGxGsSMPMAxhYFFXfduAcPxA85qDACagwh5AU8/MwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect z" style="vertical-align: 0px"/> must be a vector containing the mean and standard deviation of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMBAMAAABCcoqQAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPvdnWCvz/Myi+k+AKxlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATElEQVQI12NgVGZgMmBwYhVgK2BokGdgFWBgmMUgz8DAsIOhjIGB5QtDOpD9gecjkLx58wOQZGA3YGDga2A9wMDAxWAL5PNeV2BgAACoTwyCcycjxwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="y" style="vertical-align: -4px"/>.</p></li>
<li><p>The prior density <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAATBAMAAADojanHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA5UlEQVQY012QsWrCUBSGv9TYpGpqKJ2EgoNbByP4AJ1dmr1LNul2wY6FSl+gTs7i0qHPUPABCvUNzNiphEZEtBBPck0CHu7l/+93Dj/3XtBl+VqPkpYj+2bu81SiB7D79obzsEBtGC3YZUZX2lyFVgzTHNVcrETZgj7B6CZJTAUu/9KVOtP1h9CAs+Trew1NGBvBBK7E76lsZErBhbqDV3iJePNkXlCNGTwL8rj3syweiTLTbFv/aHTLVrIVpuf05NiS9y74gGoAg47E8Jtf1Vjm7p1TV/a4PqqpClQPtP6U/4VbyAFsFy/PI2fLywAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\pi(\vect\theta)" style="vertical-align: -5px"/> encoding the set of possible values for the calibration parameters,
each value being weighted by its a priori probability, reflecting the beliefs about the possible values
of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/> before consideration of the experimental data.
Again, this is implemented as a probability distribution.</p></li>
<li><p>Metropolis-Hastings algorithm(s), possibly used in tandem with a Gibbs algorithm
in order to sample from the posterior distribution of the calibration parameters.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>Dimension of the vector of parameters to calibrate</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">paramDim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># The number of obesrvations</span>
<span class="n">obsSize</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<p>Define the observed inputs <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAALBAMAAAC9q6FRAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHS/MosYSN3znc/pr6KgYnQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABKSURBVAjXY2AQMhE1Y2BgYFeoCJgIpLkY6hICGFSBrNUMEHAITDKyPGNYwLqBIZJ1GqtDwDQGXxVZdQaWAxAlvAEQmjMVQjOHAAAvOQvWwMJClwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="x_i" style="vertical-align: -3px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">obsSize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rg</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">RegularGrid</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">obsSize</span><span class="p">)</span>
<span class="n">x_obs</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">getVertices</span><span class="p">()</span>
</pre></div>
</div>
<p>Define the parametric model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAATBAMAAADmJNeoAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/vzdGC/6TLP3UgYnYs5CaG8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABaklEQVQoz2NgwAXOovF5cSm858DAMAGJzzGrloEnAbtavisGDLwBSAKbEvY7MPhhV8y8I4CBHYnPo8zAvwBFBAn0AzGyOZz/GM4rMDA6YFXsDsQrkPjn/zDsV2BgBfqCUdkhDFXtQXNRBgYFBgZWt9ZnB0AC7wtACCQkr2QMZDCwzQQBAbDqdUBswMCwhXsdM9ib9Z+N/wPD4gMDQwODJ7oztIGBBTTgAvcfPjD/fwCDPtDBOiAzBdDU8gCN4AbZxgsJa57/DNyfgLQN0IzV6AazAp3AA8QM7BD/83xiYPvLAHZz5AGOKahuBhsIlAnoPwCJ4+8M5w3AQizq+v8LUE3mvAAkahj4DB4feMHQCQyPJIZJDUAnLGA4fsBZDc0ZTBuAxBUGDpFWkQ0Mmx4AbV2eA0oED7DFyXkQ0QnjweON6wAWtTGeKFJwxZ3YDP6aDU6V0BTJAhfPwab4HcRtIWiK+TYw4AYcmHwApNlU4ZbFmxMAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\vect z = f(x,\vect\theta)" style="vertical-align: -5px"/> that associates each
observation <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHS/MosYSN3znc/pr6KgYnQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA0SURBVAjXY2AQMhE1Y2BXqAiYyMDFUJcQwMDAsJoBBA4BMSPLM4YFDJGs01gdGHxVZNUZAL+NCDB40g3+AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="x" style="vertical-align: 0px"/> and value of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect \theta" style="vertical-align: 0px"/> to the parameters
of the distribution of the corresponding observation <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMBAMAAABCcoqQAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPvdnWCvz/Myi+k+AKxlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATElEQVQI12NgVGZgMmBwYhVgK2BokGdgFWBgmMUgz8DAsIOhjIGB5QtDOpD9gecjkLx58wOQZGA3YGDga2A9wMDAxWAL5PNeV2BgAACoTwyCcycjxwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="y" style="vertical-align: -4px"/>:
here <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAATBAMAAADMlCYHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/vzdGC/6TLP3UgYnYs5CaG8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABIklEQVQoz2NgwAQ8F9AEeBmwAk4MjQlY1V3FEPHDqq4AQ4QdmzKWBxhCjA5Y1HE1YAixTgCqVXYIQxFkAnklgGE1hPf4/38FBgYgklcyBjmIbSYICABZzEDM38DzB+L3nC5QKH1gYGhg8ES1pB2IgxhYDMCcVwysIFN0QCYJoKrbDsSSDGyQMNNmYFkApGwYGDhWozn6MBCXMDCDvcihADEG6L7IAxxTUNwH8scPhvOnD4A8WsDAdACsjkVd/z9qwLIfYGD9zSDEx9B5AKQAZAjHAobjB5zV0GLdgYGx0uXYU4ZNwADf67sBKMT3AEs4c0xgYIeEPzwWuA5gi7g1wOBDVdeJNR20AYMPHNFwkRys6lgdHFHV8W3AnlDREwIHAwMAfwQ6XlErYl4AAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\vect z=(\mu, \sigma)" style="vertical-align: -5px"/> where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAMBAMAAABGh1qtAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAz2DdSDIY+3Tzr7/pi4mQ6v4AAAAJcEhZcwAADsQAAA7EAZUrDhsAAABJSURBVAjXY2BgVGAwYWBg4Atgewak1Bk4JgCphQzcG4DUCQbOBiD1lCEvJYGB6QnDcl4GBq6DHdmXGBh4QBIgbWBKHUwydIFJAEhtDOg0qsToAAAACnRFWHREZXB0aAAAAAAEIE4lFQAAAABJRU5ErkJggg==" alt="\mu" style="vertical-align: -4px"/>,
the first output of the model, is the mean and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAANUlEQVQI12NgYNT//5mBgcE1vRNIMjYwrAZSzAcYbgCpYgaGOCAFFDEDCTKwXABSPHPnAEkAOqcJ7ewSY/oAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\sigma" style="vertical-align: 0px"/>,
the second output of the model, is the standard deviation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fullModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">SymbolicFunction</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;theta1&quot;</span><span class="p">,</span> <span class="s2">&quot;theta2&quot;</span><span class="p">,</span> <span class="s2">&quot;theta3&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;theta1+theta2*x+theta3*x^2&quot;</span><span class="p">,</span> <span class="s2">&quot;1.0&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To differentiate between the two classes of inputs (<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHS/MosYSN3znc/pr6KgYnQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA0SURBVAjXY2AQMhE1Y2BXqAiYyMDFUJcQwMDAsJoBBA4BMSPLM4YFDJGs01gdGHxVZNUZAL+NCDB40g3+AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="x" style="vertical-align: 0px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/>),
we define a <a class="reference internal" href="../../user_manual/_generated/openturns.ParametricFunction.html#openturns.ParametricFunction" title="openturns.ParametricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParametricFunction</span></code></a> from <cite>fullModel</cite>
and make the first input (the observations <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHS/MosYSN3znc/pr6KgYnQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA0SURBVAjXY2AQMhE1Y2BXqAiYyMDFUJcQwMDAsJoBBA4BMSPLM4YFDJGs01gdGHxVZNUZAL+NCDB40g3+AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="x" style="vertical-align: 0px"/>) its <em>parameter</em>:
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAAATBAMAAABCTm97AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAnYt080gyYOkYr937z7+pyr0UAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACBUlEQVQ4y21SPWgUQRT+7mf3MuT+0MJKWC+GlC7+BBthi4imMpUEItx2ipJ4GBsDkRPBIkVc0ErEEyLYhlSxO8RYmksZjJhGJRjw8gNJMGQz783c3t5NHnv3Zr6ft/PeLBCFKKpcxMkhugm9T/Rxysnf+GIR707ynnKZj8L+/qwlPHeZ0xnA+mbtIOWY7uRpj/h23Fkvu1p4/S6nKvDWw39edEf6dqUDFl9QmFeI3WSEav10xCEwZ9ofovNQuW3U6kqYUmV7fYgwsKR92rRfZb4dtQOU6ywUH2YqhGRlh/v00Eo2F1e/ufmR0cnfjzYYuFClh4W96lRpoCccunUEFGg7HuR/ULxncoF5yx1zbvD+5e5QuK6E2RFG7knfHrI7EgiMwy8xn0A5UO8KK1h2lbCmFKNy1aSOkDbsosk8cFbvQ9CQWPhYQa9Bw/xX1L13RMZjHniu7YfIb2mhrDj55yKtC1Wxi8ge6z3RYDRjH+gvdR81TwtXIJyVKfQEyNdzXyXwQI0ufs3SJPnzyeGkb69KYBNrvhYuQeCFfIML/J0lU8m4OJqu5O8PTl2B9ZlOtrihhTQW4QnYjZb4k9E7TTfiU4gJM68aSFyaH2y72nVa8eRavGpkJ2Hh6QgyA3Pyw5vQaN64t71f9N/iXcSEyVJ0OxrvN85ecuJ8ZO8S+h3JDN/cHwMc94PdIto6jQAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="f_x(\vect \theta) := f(x, \vect \theta)" style="vertical-align: -5px"/>.
We set <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAMBAMAAADmGDJDAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHS/MosYSN3znc/pr6KgYnQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVBjTY2DAAIzHMcUYWJY/Z8AGcIsKmYiaYYiyK1QETAQyrXcDwV6YKBdDXUIAFnNXY7XtEBZRRpZnDAswzI1kncbqgKr2IQODr4qsOooY2+031wGzKB0PNaYLWgAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="x = 1" style="vertical-align: 0px"/> as a placeholder,
but <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHS/MosYSN3znc/pr6KgYnQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA0SURBVAjXY2AQMhE1Y2BXqAiYyMDFUJcQwMDAsJoBBA4BMSPLM4YFDJGs01gdGHxVZNUZAL+NCDB40g3+AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="x" style="vertical-align: 0px"/> will actually take the values <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAALBAMAAAC9q6FRAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHS/MosYSN3znc/pr6KgYnQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABKSURBVAjXY2AQMhE1Y2BgYFeoCJgIpLkY6hICGFSBrNUMEHAITDKyPGNYwLqBIZJ1GqtDwDQGXxVZdQaWAxAlvAEQmjMVQjOHAAAvOQvWwMJClwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="x_i" style="vertical-align: -3px"/> of the observations
when we sample <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">linkFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">fullModel</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linkFunction</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>ParametricEvaluation([x,theta1,theta2,theta3]-&gt;[theta1+theta2*x+theta3*x^2,1.0], parameters positions=[0], parameters=[x : 1], input positions=[1,2,3])
</pre></div>
</div>
<p>Define the observation noise <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAATBAMAAAAjVk05AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL/d6UivYIt088+d+zL7k5hGAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABdklEQVQoz3WSP0gCURzHP16el3WeR0NLDUJzZFBQBKJDS0NTETTZEBItQlO1tARNpZPVkkNby7U1tgQ5VEIRDQ1CS+AUJS5h/Z566mU++P14932f3/v9eQfdazzKqFe57mJOxAYfMzheeagLfBIbBjONcZtqSMY8BPf+cL4fG+7BD0v4S0qybiri439AY0JCI3AMs5iRhqjADZV/aroF9q9KaBJi6tgotsFdybbGSgvUzBpGGoroNfSPNhiSS9T+9FlcVkDrm4Bs8xg1xbbAsDS0nEVfLEfrKd9ZQJMG4ooyOsCQje+igGYzBsIecpSWWetxrArBjtQDdj21XKLFRjKq4bCTk7rzUCVY9NSYoVHn3asASQIVqUCaYQbT8YA5fBl33IESvk81vQRsycCtSyVXxd7ktc6v3OGczYl7UDcWpMlCCv1Foje/1uHA8y47iWYZlJtK0D2a5P/VZ3tBy+kBWs1ndqvX7B4g215wvxeH5f2UH+4XD9tSWbE/s/gAAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\varepsilon {\sim} \mathcal N(0, 1)" style="vertical-align: -5px"/> and create a sample from it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">noiseStandardDeviation</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noiseStandardDeviation</span><span class="p">)</span>
<span class="n">noiseSample</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">obsSize</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the vector of observations <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAMBAMAAABLmSrqAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPvdnWCvz/Myi+k+AKxlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAXklEQVQI12NgVGZgMmBgYHBiFWArANIN8gysAkwXGBhmMcgzgMAOhjIQxfKFIZ3hFpDxgecjL7cDA8PNmx8YzoFk2A0Y5jIw8DWwHmDYcoGBi8GWgcH2AAPvdQWQJAAFMhJyUlktDwAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="y_i" style="vertical-align: -4px"/>,
here sampled using the âtrueâ value of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect \theta" style="vertical-align: 0px"/>: <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAQBAMAAABuGdtpAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAsklEQVQY02NgYBAyCWBABWwVbD/RhJZvYPiMJqR/gOs7qgjX/wVsaEI8X0AIBbD8373/B6oQ/18G9p8MXMhC6z8w5BcwMAsgCxUw9AcwsKNodOD6zcDWcoD15VkeBdYE1qkLGDgKmAoZGEIZJpRNPbCLRUCX9wIDQ7PHAgYGMwZBAwZGB3bGn1Nh2gsYeAIYWB8kczbAveBwgOkCA9+Ep9MUGBKgYp0JzMAw6T0x4c0cBgAYWy/Wf4mcrQAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="\vect \theta_{true}" style="vertical-align: -3px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaTrue</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y_obs</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">(</span><span class="n">obsSize</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obsSize</span><span class="p">):</span>
    <span class="n">linkFunction</span><span class="o">.</span><span class="n">setParameter</span><span class="p">(</span><span class="n">x_obs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">y_obs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">linkFunction</span><span class="p">(</span><span class="n">thetaTrue</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">noiseSample</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Draw the model predictions vs the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">functionnalModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">fullModel</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">thetaTrue</span><span class="p">)</span>
<span class="n">graphModel</span> <span class="o">=</span> <span class="n">functionnalModel</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">observations</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">x_obs</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">)</span>
<span class="n">observations</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">x_obs</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">)</span>
<span class="n">observations</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">graphModel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
<span class="n">graphModel</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="s2">&quot;Observations&quot;</span><span class="p">])</span>
<span class="n">graphModel</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graphModel</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_bayesian_calibration_001.png" srcset="../../_images/sphx_glr_plot_bayesian_calibration_001.png" alt="y0 as a function of x" class = "sphx-glr-single-img"/><p>Define the distribution of observations <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAATBAMAAAB4ntAIAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASHS/GPvdnWCvz/Myi+k+AKxlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgklEQVQI12NgAAFmBiTARgGHUZmByQDI4YxWaGZwYhVgKwBy5ofufsDQIM8A5DIwHGDQAqqbxSAP1sM8AUjsYCgDcXgSgWyWLwzpIE6XA88iBoYPPB+BHKa4+P8PGBhu3vwA5Pg5aAeDbGI3gFvK18B6AM7hYrBFOIf3ugKaQxkhFAA8qheOUoML9gAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="y | \vect{z}" style="vertical-align: -5px"/> conditional on model predictions.</p>
<p>Note that its parameter dimension is the one of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAr/vzdGC/6TLP3UgYdzMtfAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADNJREFUCNdjYGBUdghjYJBVMi5gYGhg8GQAAjYBIMGxGsSMPMAxhYFFXfduAcPxA85qDACagwh5AU8/MwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect{z}" style="vertical-align: 0px"/>, so the model must be adjusted accordingly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conditional</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">()</span>
</pre></div>
</div>
<p>Define the mean <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAMBAMAAAB2C0uMAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAa0lEQVQI12NgYFRgMGEAA/4Atm8QljoDxwQGtlUBDAwLGbg3MDCmCTAwnGDgbGC4xXaAgeErQ35KwlQWAwamLwzLeVn/3t7AwHWwI/sShwCzAgNPA1A/7wNOkHFAFtODRSDjQGAtUKaLAQoAbAwXaoHaJfoAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="\mu_\theta" style="vertical-align: -4px"/>, the covariance matrix <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAQBAMAAAAG6llRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMA+6/P8510vzIY3YtgSOmj3+YAAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAf0lEQVQI12Ng/KSkZPKVAQTYQJQ6mMlg38DAwA5hTlzAwMAKYXL/ZmDghDAZFk5ggIF+BTiTGURwKgF1M0QwMHAwMM80ABp8gIGBiWET5wMGhqsMIHM9eBcwcBYAFZpz/N5ewMC1atWq91/ZDLgOQE3hDmCBGcgToAM3XDuBAQDXXRe9RmIRIQAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="\Sigma_\theta" style="vertical-align: -3px"/>, then the prior distribution <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAATBAMAAADojanHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA5UlEQVQY012QsWrCUBSGv9TYpGpqKJ2EgoNbByP4AJ1dmr1LNul2wY6FSl+gTs7i0qHPUPABCvUNzNiphEZEtBBPck0CHu7l/+93Dj/3XtBl+VqPkpYj+2bu81SiB7D79obzsEBtGC3YZUZX2lyFVgzTHNVcrETZgj7B6CZJTAUu/9KVOtP1h9CAs+Trew1NGBvBBK7E76lsZErBhbqDV3iJePNkXlCNGTwL8rj3syweiTLTbFv/aHTLVrIVpuf05NiS9y74gGoAg47E8Jtf1Vjm7p1TV/a4PqqpClQPtP6U/4VbyAFsFy/PI2fLywAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\pi(\vect\theta)" style="vertical-align: -5px"/> of the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPriorMean</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigma0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>  <span class="c1"># standard deviations</span>
<span class="n">thetaPriorCovarianceMatrix</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="n">paramDim</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">paramDim</span><span class="p">):</span>
    <span class="n">thetaPriorCovarianceMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">prior</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">thetaPriorMean</span><span class="p">,</span> <span class="n">thetaPriorCovarianceMatrix</span><span class="p">)</span>
<span class="n">prior</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;theta1&quot;</span><span class="p">,</span> <span class="s2">&quot;theta2&quot;</span><span class="p">,</span> <span class="s2">&quot;theta3&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The proposed steps for
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQBAMAAADUulMJAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABeSURBVAjXY2BgEDJhAAEmA1cw7cbAB6bDGfpAFMcLBj8QzT6BQQ1EsyUbzwLRfBsYkjhEGRj8GlgeMEoyMOxhYL7A4AnS3tMAotkYVjOAaG71DWAaDGC0G4TitlEBAKCcDsO+DDn2AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="\theta_1" style="vertical-align: -3px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQBAMAAADUulMJAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIuvMt3znRjpz2D7v0jPYBFiAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAa0lEQVQI12NgYBAyYQABJgNXMO3GwA+mwxn6QRTHDwZ/EM0+gUENRLMlG88C0fwbGJIYlS8w+DewfHBnWMywh4H5wksGVaD2ngYGBmMGNobVQM0ZDNzqGxgYuB6AjWSoYwFT3BvYwbT//88AVQEUkWKKB+YAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="\theta_2" style="vertical-align: -3px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQBAMAAADUulMJAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIuvMt3znRjpz2D7v0jPYBFiAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAaklEQVQI12NgYBAyYQABJgNXMO3GwA+mwxn6QRTHDwZ/EM0+gUENRLMlG88C0fwbGJIYN95g8G9g+cDDsJxhDwPzBRaGeUDtPQ0M7gUMbAyrGRi6bzBwq28Aqr4KNlIUYgTDdobLECuVDACK5RR6iIAEKwAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="\theta_3" style="vertical-align: -3px"/>
will all follow a uniform distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proposal</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<section id="test-the-metropolis-hastings-sampler">
<h2>Test the Metropolis-Hastings sampler<a class="headerlink" href="#test-the-metropolis-hastings-sampler" title="Permalink to this heading">Â¶</a></h2>
<p>Creation of a single component random walk Metropolis-Hastings (RWMH) sampler.
This involves a combination of the RWMH and the Gibbs algorithms.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialState</span> <span class="o">=</span> <span class="n">thetaPriorMean</span>
</pre></div>
</div>
<p>We create a <a class="reference internal" href="../../user_manual/_generated/openturns.RandomWalkMetropolisHastings.html#openturns.RandomWalkMetropolisHastings" title="openturns.RandomWalkMetropolisHastings"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomWalkMetropolisHastings</span></code></a> sampler for each component.
Each sampler must be aware of the joint prior distribution.
We also use the same proposal distribution, but this is not mandatory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mh_coll</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">RandomWalkMetropolisHastings</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">initialState</span><span class="p">,</span> <span class="n">proposal</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">paramDim</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Each sampler must be made aware of the likelihood.
Otherwise we would sample from the prior!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">mh</span> <span class="ow">in</span> <span class="n">mh_coll</span><span class="p">:</span>
    <span class="n">mh</span><span class="o">.</span><span class="n">setLikelihood</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">linkFunction</span><span class="p">,</span> <span class="n">x_obs</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the <a class="reference internal" href="../../user_manual/_generated/openturns.Gibbs.html#openturns.Gibbs" title="openturns.Gibbs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gibbs</span></code></a> algorithm is constructed from all Metropolis-Hastings samplers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Gibbs</span><span class="p">(</span><span class="n">mh_coll</span><span class="p">)</span>
</pre></div>
</div>
<p>Generate a sample from the posterior distribution of the parameters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect \theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
</pre></div>
</div>
<p>Look at the acceptance rate (basic check of the sampling efficiency:
values close to <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAMBAMAAAB7FTvLAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYJ2Lr0jpMt10v/sYz/O0T7d0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAiElEQVQI12NgEDIRYAAClRUTGBhYExjSgWyWAp7PDAwcExi0gBy+AIZ1DAz8AQzSQA63AYM/A0N8AUP8AZAmhjYGBvkCEB8I2L+CZeTBHDYDBob6AIb5YGXOQMwvwDAbxGYGSjBwGDDogjiSDMwMDIwNQEtrD7AuFJwFFJo0RYAhuoD7//9fDADVrxl/FDuXtwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="0.2" style="vertical-align: 0px"/> are usually recommended
for Normal posterior distributions).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">mh</span><span class="o">.</span><span class="n">getAcceptanceRate</span><span class="p">()</span> <span class="k">for</span> <span class="n">mh</span> <span class="ow">in</span> <span class="n">sampler</span><span class="o">.</span><span class="n">getMetropolisHastingsCollection</span><span class="p">()]</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.282, 0.2944, 0.3035]
</pre></div>
</div>
<p>Build the distribution of the posterior by kernel smoothing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>Display prior vs posterior for each parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">parameter_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">paramDim</span><span class="p">):</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">parameter_index</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">priorGraph</span> <span class="o">=</span> <span class="n">prior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">parameter_index</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">priorGraph</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="s2">&quot;blue&quot;</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">priorGraph</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Posterior&quot;</span><span class="p">,</span> <span class="s2">&quot;Prior&quot;</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">paramDim</span><span class="p">,</span> <span class="n">parameter_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">ax</span><span class="p">])</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Bayesian calibration&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_bayesian_calibration_002.png" srcset="../../_images/sphx_glr_plot_bayesian_calibration_002.png" alt="Bayesian calibration" class = "sphx-glr-single-img"/><div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-bayesian-calibration-plot-bayesian-calibration-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/557f6965239dde7b8b9613eb917dc826/plot_bayesian_calibration.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_bayesian_calibration.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4c9fe30a2a1c939510fb7d6a12aa86d9/plot_bayesian_calibration.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_bayesian_calibration.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_imh_python_distribution.html" title="Sampling from an unnormalized probability density"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_gibbs.html" title="Gibbs sampling of the posterior distribution"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bayesian calibration of a computer code</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>