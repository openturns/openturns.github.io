
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Bayesian calibration of the flooding model &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Posterior sampling using a PythonDistribution" href="plot_rwmh_python_distribution.html" />
    <link rel="prev" title="Sampling from an unnormalized probability density" href="plot_imh_python_distribution.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_rwmh_python_distribution.html" title="Posterior sampling using a PythonDistribution"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_imh_python_distribution.html" title="Sampling from an unnormalized probability density"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bayesian calibration of the flooding model</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Bayesian calibration of the flooding model</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#parameters-to-calibrate">Parameters to calibrate</a></li>
<li><a class="reference internal" href="#observations">Observations</a></li>
<li><a class="reference internal" href="#variables">Variables</a></li>
<li><a class="reference internal" href="#analysis">Analysis</a></li>
<li><a class="reference internal" href="#generate-the-observations">Generate the observations</a></li>
<li><a class="reference internal" href="#setting-the-calibration-parameters">Setting the calibration parameters</a></li>
<li><a class="reference internal" href="#build-a-gibbs-sampler">Build a Gibbs sampler</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_imh_python_distribution.html"
                          title="previous chapter">Sampling from an unnormalized probability density</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_rwmh_python_distribution.html"
                          title="next chapter">Posterior sampling using a PythonDistribution</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/bayesian_calibration/plot_bayesian_calibration_flooding.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-calibration-bayesian-calibration-plot-bayesian-calibration-flooding-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="bayesian-calibration-of-the-flooding-model">
<span id="sphx-glr-auto-calibration-bayesian-calibration-plot-bayesian-calibration-flooding-py"></span><h1>Bayesian calibration of the flooding model<a class="headerlink" href="#bayesian-calibration-of-the-flooding-model" title="Permalink to this heading">¶</a></h1>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this heading">¶</a></h2>
<p>The goal of this example is to present the Bayesian calibration of the <a class="reference internal" href="../../usecases/use_case_flood_model.html#use-case-flood-model"><span class="std std-ref">flooding model</span></a>.</p>
</section>
<section id="parameters-to-calibrate">
<h2>Parameters to calibrate<a class="headerlink" href="#parameters-to-calibrate" title="Permalink to this heading">¶</a></h2>
<p>The vector of parameters to calibrate is:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIcAAAATBAMAAABIPgNsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACIElEQVQ4y41UTWgTQRT+Nj+b7LpJlqLorUGlB6GaQ09eukdvLoh6UhdUehBMeqgUEYl6s8XuxZvg3nqI0CgIGg/uSVAQc1UU91ZBaAMWjcQS3+xm5yca6LD75r1vdr+Z+d6bAf5tpou9tnzqTM2N/ZSh93vfx+PnHFp7trXtpEFxcHxrZzRfM+n1Zf23SnKB3mwNeCigl8BmkAb7fJRvjvxHSbfexg+VhE1ZcWF4HNFcWD95dAD4kI7lku5EaP5SOIyQTN3DOwFZBPg8CiHWXo5hcxjoKknWJnMJTxRQW5Kjg1zFUjWeZIc9ciswc0S/oYCtppy+F8JvxJsavnrdZ5IfZi1iujF46cuyQjKnrNURfo+Zyi4Kanb2s9X37W0ZK3bkaCUQfpymjR7qDYXkCttkD9OhhJ23IYTNL8LgQcy+0cCaWmwtVm+OsubSLiA++toVlZpoUnHMARRNmLCFCAYVhjWqJVqV7lrVVpKoP8BV8+LHO2+jlKTYyCyqtZajHU93AVL2uuVpxygbt4FrdtjJYYrG1iPoT62KdwZtYqzF2L1Twdihoqqen0V52ER9Bvotykb/29EBNMfCAgk1/+Du6TYuY9YkEivEgv2fk6lVuatvQmiYd8nl8p5Fx6DayQYTzvdJzlHNSCRl/5NEMmO2M5/pCph0SRzilfn+jfSbttqVUlvTo/w54P4kkpIvR0pgjH1qeRPvK3vPN5sW27/XXH0KOE/Y4wAAAAp0RVh0RGVwdGgA/////o6f8XkAAAAASUVORK5CYII=" alt="\vect{\theta} = (K_s,Z_v,Z_m)."/></p>
</div><p>The variables to calibrate are <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF4AAAATBAMAAADrOqfvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ3PYOl0i90y+/NIv69ILDK6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABdElEQVQoz42TPUvDQBjH/23aXK6Nsbg4ZAni5GKECg4OFfwA/QjBpVM1gqNDHJwNiDhJaxcXFargnMVJaOPkqINTRdvBzRZ9rmJykRQauHvye/jfy/NyQMbCtF9WTAqNt5GDnZvI/3z70a+mUCakaZGG5gFb8T53QK+URjUaYumsBTWIBNwCG6ZSHlBdst0Au/H2jBxOKhkONJ/sMuYTgfFWOuVsFIRd0y8TejOcQE0UhWltXiX0h5NogBNx4Mjvy4KZ9iQ6x70IaYCGKymWfDjp1IYpSlaFFtcHuU/ASqfmON7CC1RKMav9Ouks3WK2KdHca/10e6zPU+kaFYAC7rCAr1DVr4EH323nIdEw61FmuIesA+OoDOM7RHcd+gU1x+h99Qu8yiTSPaVC5zEX3I5uqveo3FEvWmqCiqU6LabLHERyW5EUhrMhkRKYKLs4pt+zP19mbx9x5vhTRSINHSwEeBT5cuTiJOAfgY172J/6fXHgB8E0YOPIYzk1AAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="(K_s,Z_v,Z_m)" style="vertical-align: -5px"/> and are set to the following values:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARsAAAARBAMAAAAf7xXAAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dJ3dSIsYz/tgMunYU1txAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACa0lEQVRIx7WVz2vUQBTHv9kmnWRN3PXHQXDBgIp4EFcFD4ViPAiCh+6i1rIemoMHPdjGg14KbgSLrRTMRRB6aS8WS8WCFLVQ2IOKoLDBHxeF7voHFItVtqJVJ5u2ks1Ml1lwDsPMy3zefPPmzRsAW5csdO2FWGv7Or7lN/4H1G4DJ2LWoUIOek+GByUsSM8ajfM7un28uFESgkLM+Dx4OZylcpCdxiWSi++4js0+x/MH4E4MevvzIUgVCxCBQsw4OLu6VdHBcGyJZGMWF6BkOZ5dkG8x4/sg1hZOQwQKMcNam/XiHovVllGDPs094085pt+Ug9cQgRrl3CdPWKRSJSsgP3iOtd2MwxjKoOij6IlAIWb0rKXczJvH6186JmkbD0bqEehUzgr3AlTX70vATKbp6C4STtkPFDWFGjEth311s7Hk72Kh6iWqRefKOcwMQZtNtZR9MSjAaHc03HYRFZe1ps+oQeYdljIHmWWerjjo8sSgAKPd+fowWY3EcLUlHRzzfkHmpXK5BCVm3ANlMVXCKYhAIUZLUm99sikNuUaDdDKSOxULj3ARyhjbsbEMXMVtzYwkwQKNeruLAjaAtPzzzpvpGEYLXHhYFZrRNJevqJECJXnaDF7SMmg8YHkeTYMcUBNeNKzDGPV1m7r/6PGhlNMNM4apnjYXYFL/FKQ/WRQnomy+YEE+kwF5yvLcf6jji4l5RJNOzXfS9+Z4CQMuH7qGKc2MY4PbfAz8uwNkJyfEMr+onYXF+WJtBO2Xs83eUTKWFJezXffE5UxoZvJVMznayC1xz+9GxH8BNkkr59Bys1pg5FY3+wvJwr8l/7KNMwAAAAp0RVh0RGVwdGgA/////ReWoMMAAAAASUVORK5CYII=" alt="K_s = 30, \qquad Z_v = 50, \qquad Z_m = 55."/></p>
</div></section>
<section id="observations">
<h2>Observations<a class="headerlink" href="#observations" title="Permalink to this heading">¶</a></h2>
<p>In this section, we describe the statistical model associated with the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAIBAMAAADdFhi7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LGM9IMmD73fO/r+mGTbZDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVQI12NgVHY2TWBgqMg0YFzAwCBgzcAUwMDAcJaBVQFIzWDgL2BgYP/AIMfBwMD8gOEsMwMDkwFDrggDAP0FCNj5FTHGAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="n" style="vertical-align: 0px"/> observations.
The errors of the water heights are associated with a gaussian distribution with a zero mean and a standard variation equal to:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAMBAMAAADIXRPRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAn0lEQVQY02NgwABcE1+B6dUHGLCC0wzcBUCq8jwO+V4GzgAQzY9D/g8DlwGSPKP+/8/I0jzfGXi+Icm7pneCKFYXEHgAdN53kBK4PGMDw2oGNP1cSPLMBxhuoMiz/2HgRTK/mIEhDtV9vxh4kdwHNNwMxX6GRgZOByTzGVguoOpfAQwfdjeg/AIGIMUzdw6a/3nnvmLgMWfI8993gMccAAGuLgZnugqyAAAACnRFWHREZXB0aAD////5EPtk2gAAAABJRU5ErkJggg==" alt="\sigma=0.1."/></p>
</div><p>Therefore, the observed water heights are:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANYAAAATBAMAAAAe6O4aAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dBj7YN3pz52LSDLi5wBxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACvElEQVRIx51VTWgTQRh9m2Sbv9k1UWhVhKgYlQqSi5cQcLVHhazxWA8VKQhVyEERPOUi6EVz8VJB0oO0FYRIxYMR3INFqChbz0Jz9QcajCD+pPrtbNyd3UwqdmGXefO9mTfzfW9mgc2fSWztScu7t3eNMwfHwr3qs2zzE9Bw9J4vmSIb5SMePD6ezdUlSC1ItRI1YHag96SBs4eQrgLsBvTpAPuUTzsAjJoydFqqta0J/BrIwVEg3kGSmjv7r8eO2R7Sm2A9KUr20xOcds1GfCOsVW7Tp+6sLu7sqSyyl30aow5DihS3waqBaV9QYCqsdd75ZHAbGLFcBY99LkDUZ+Qo3pBpLVARGuEU8o2aoDXk+Da9mixolwPMSmEImgpoPXbNdzGbzVluT/EhPXPUiPS9tRc4zA3mTTFz7UJA69Yw1BG1km5G9R5PUcwK+MVdn06SP53G+N+43m3nRGI0PwxNi1pF15msw0s26M2l75ZWh/rVSb7nHWKvi6t62oYhR3mep8VZnqcfWT4oRWu/GdYaycBRUSmHl5yUemUgdsI/u4h/A5pyJNZL3fCnJfesBOql1N0N04Ci2rKL/ThnxyjprH9UaY9akzUqApocm/h8IuwN0mLkv/WqUzIWMQMb2wdcJ727ZK33WMk4cf0BOBtkjlVmO1Clo/GubeWTEFAvXYtQYWuiVgmw8lDuzKu7ulV8CJl+rmUT7Qk1d7++jzbFNcomsaH8LmDtEYeJ7o7FL+QgJiCtlqrSPpklaikvl3U/9Xuk99dH/m2ohhOP+f3aqADTzVgARcwJEjZDZ1nxLZW3pPcyH5GP8rivpTVSwuyKcVVAKbuCeau/SqheaSL+fVNqy7R0bsD993jcN7f66g18qJeqAkpgFS0bx8JTRd/+6593hR8b9wozgiFjEwRm////Vd/if1k27g8+v8VunXkZAQAAAAp0RVh0RGVwdGgA/////o6f8XkAAAAASUVORK5CYII=" alt="H_i = G(Q_i,K_s,Z_v,Z_m) + \epsilon_i"/></p>
</div><p>for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFEAAAAQBAMAAACcpY7MAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAYPMySHS/GPuvi8/pnd2jAyobAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAqklEQVQoz2NgYFRgQAaMRxhwAWYBFN6VLwzEAiqoZAkjqJL1VtVqBwaGUg4gwZC9Gwh24lBp6LGA9QEDg4A9QTMDFjHwbgDS0wi7M5OB+wKQaiGsspGB3wDoXAUBQu5k/sAQw8jAwDlhAar4RwYG6wIQZt4OIRi4DjBkcgFDaWoBsjr22X+mMHgANXsYsDSDiC4GBt4FDJ7hOAI5ACkw8ccT0SpZsWsiViUAI+cuJFx6gSEAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="i=1,...,n" style="vertical-align: -4px"/> where</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAAAWBAMAAAAiD+/pAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAna9g6XS/z4sYMvP7SN2t3s6tAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABsElEQVQ4y5VTTUgCQRT+dHN1/VshKIgiEQKP26lDgV46ZJe1CIoCvQZRInQXT1FkW4c6dGiDyE567mbRtTDoVuDewm51DMrejGutukg+eDOP9833zZt5M8C/zZVPoz87R7ZPxhMKveANA1KoMxlByHbxErn7QYW7E5CucWzLuCM/Ih8EJvOKBXBX4crZEKSGBoxQEEcgjoQFGfOyZLcJW6RD90hyQRVDFkBxABM2DM8z6YSBoA65ipk/oNz4AKYocESUNobo+CQ5wA/UdNQ0ntxrNCo8oCxmebR6S8MKZ3jf4aTZB8R0RmJnXi+Z9yrTggwLAomiwWsBrjAPkeYLvkeMMwoQzCP7NcjZKBPWsAkYLLeLA+WQtxjlKlK8qnu4jCbDp+GMi5Co+HaisjANObNI8ymVoGCNpbwViGG0ziFzhod89Ia3IwznV7iJBXMY5vcaZ9W0GGJ7FyWnDumbPesBDYJBHSzS2gq2TbxEHl3WLIzUKw3jbA8H1ZhcUPBCko/JqonvdPVves6sEd6MmVKteL3Xg6/bMH5lbO3S/KxtD0LrxRDUbsZ+72+q26Z+AHpfWEoYyA+YAAAACnRFWHREZXB0aAD/////+ZjB7wAAAABJRU5ErkJggg==" alt="\epsilon \sim \mathcal{N}(0,\sigma^2)"/></p>
</div><p>and we make the hypothesis that the observation errors are independent.
We consider a sample size equal to:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAAMBAMAAAAqgQioAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LGM9IMmD73fO/r+mGTbZDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAvUlEQVQY02NgwABMdxYyMDTZNjBgBdcZ/A3YHjA8xy67jYFnA5cAgw522ckMvB/4Exg6QWxGZWfTBDR5rgf5BQz5DkBWRaYB4wIgzRMKAhfAsvUJ/UDZAiBLwJqBKQBN72OQVD9IluEsA6sCqiSvAVA3gzzIZIYZDPwFqLLGDAz8DQySICb7BwY5DhR7OQQYDLgMGFRBsswPGM4yo2jN6Wg8wLEAGBqlDgxMBgy5Iiiy8///P8AgJNvAkFkAAL7HLFRjWTSdAAAACnRFWHREZXB0aAD////5EPtk2gAAAABJRU5ErkJggg==" alt="n=20."/></p>
</div><p>The observations are the couples <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH4AAAAUBAMAAAC5YpSHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL9g6Z0ySHTd88+L+6+Dk2LmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACCUlEQVQ4y5VUPWgUURD+Nnt5d3u3d25zjZH82J7glgabWCQEYnEEhBAUD0yVFC7YCreIjSDk0gSs9DpNEFZS2W1jmjSxsBAsEpJGo5sQyE9h4ffeu93c3XJ3OMvsm5k3376Z7w0LGDddoIweMkx9hn6SqfIVUMsP550k+uvUH/14ABjjgHm/H/5ajaewBHsN4msStRrAnDReU+vOAHyG68+WtqKs6q8qjzpWG4DnIaY8ezWJ1j2Y59Io+TqlL34dKIYa1ZLHRO5KwwwG4GVxzDyW9mrS6GdSEChrdwC+Tn0HfJD27ST6PYqOQ2WdEO/2hmdnATEFnElnEzkNEheqGemRF3NW3wOv81U3fnKC35iCcSl7PY+j9omiQEqTqEpcQO5lqoBF7rP+HzTz43GwwIreIO4/s5dkL6X5c1ROxXjgVYAdHSwS8U17kj8PdpDGlw9eOJrce8D159jZg513xCduPXUlBfQgGiolbI5GUbTfgQ8v4uFYoHf0ZQY17mfZSentlnF46spsO1QpkuLu87ONgqfxK8oPDB+/ydFVBj1Ll1gK0/jharE1f5aam+YQNWzH01vRI5a/oetfhkiegnf3CfHsQSjiN6aBWzX4V3h6E3rEhrZVwPyzbVUtXz1VCyOsKvee8Tty85Hm2G+/HdvT49MmftdqMkX0Gk+R+v8Ybuf6v5LrWP8BqIR72S4dPfEAAAAKdEVYdERlcHRoAAAAAAbOQEQ5AAAAAElFTkSuQmCC" alt="\{(Q_i,H_i)\}_{i=1,...,n}" style="vertical-align: -6px"/>,
i.e. each observation is a couple made of the flowrate and the corresponding river height.</p>
</section>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAARBAMAAAAf5oCsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ2Lv90y+69gdEjzz+k90WGTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAcUlEQVQI12NgYGBUMnJkAAJTAYZ0AQYGjgAIng5kc31gYCgGSnH/ZuAAMhm4PjLwAKUYWD4w8CsAaZ4LDPILgPT8BAZ2AyB9BCh1QUib5QLQ1NMGzDdAxnJc1ktgAzEYeBmkwDSPgAOEPqcApplqGRgAUOkTS0IYTsgAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="Q" style="vertical-align: -4px"/> : Input. Observed.</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dJ3dSIsYz/tgMunYU1txAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAeklEQVQI12NgYBD67MDgr8oABmwJDAyuECYDfwADSwGUXV/A0AllMsQzzIAxGZaxb4ezt57ZDGPyfr4gD2NzfGC43wBlcz1gYHsAZXMLMLB8B0p7ANn3DzAwADUXchQwMOavYWD8b8BQvxxuMAO7NIK5gAvO5uxpZwAAMp0ZVwjna2YAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="K_s" style="vertical-align: -3px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQBAMAAADpKDJvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/PPr+l0+xgynYtI3WBzLvw+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbUlEQVQI12NgYPxk4vKVAQSYEhhYKsCsWQwM+w+AWRsYeL4xQMH0BVAGhyJMiDcAxhJqgDK4KhnYIKz3Dxi4wAzO3wwMpxg2cygwtDsw8GhyMzUEMNwXEY5XYJgKtAACVjEkQFlufDCjJu5jAADmYRY0Jy22YAAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="Z_v" style="vertical-align: -3px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAQBAMAAAAPAfkrAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/PPr+l0+xgynYtI3WBzLvw+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfklEQVQI12NgYPxk4vKVAQqYEhhYKmCcWQwM+w/AOBsYeL4xIMD0BQg2hyKSBG8AEkeoAcHmqmRgg3PeP2DggrE5fzMwnOJY8kxymwMDQ7sDA48mN/+BtQwKDAz3RYTjFRjOMthxKMAUr2LQYBOAcWw4FJhfwzgXeBy41jAAAL5tGZE1SZVEAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="Z_m" style="vertical-align: -3px"/> : Input. Calibrated.</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANBAMAAABSlfMXAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dBj7YN3pz52LSDLi5wBxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAZUlEQVQI12NgYBD67BCoJs7AwMDRwMAwC0gz8G9gYPgDYty/wMD+D8TYz8DAmABirAAqWwBiZAgKyh8A0nx/wcoYGHg+gJUxMHBNYGDoADHYBBgYskGM9wVgZQyM/ctZJT8XMAAA8OAWeIvNF8EAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="H" style="vertical-align: 0px"/>: Output. Observed.</p></li>
</ul>
</section>
<section id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading">¶</a></h2>
<p>In the description of the <a class="reference internal" href="../../usecases/use_case_flood_model.html#use-case-flood-model"><span class="std std-ref">flooding model</span></a>, we see that only one parameter
can be identified.
Hence, calibrating this model requires some regularization.
In this example, we use Bayesian methods as a way to regularize the model.</p>
</section>
<section id="generate-the-observations">
<h2>Generate the observations<a class="headerlink" href="#generate-the-observations" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">flood_model</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">viewer</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>A basic implementation of the probabilistic model is available in the usecases module :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fm</span> <span class="o">=</span> <span class="n">flood_model</span><span class="o">.</span><span class="n">FloodModel</span><span class="p">()</span>
</pre></div>
</div>
<p>We define the model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMBAMAAABCcoqQAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAGK+LMun7dGCdz7/z+qwmQAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAEtJREFUCNdjYGBUNhRgYHAVEDNgYAhn4HVg4LjA0MbAwBnAoMXAwL2BIZiBgX0B8xUGBgblygQgycC0AETyFDAwTGUoBbKqixUYGABabgpEH3HNBQAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="g" style="vertical-align: -4px"/> which has 4 inputs and one output H.</p>
<p>The nonlinear least squares does not take into account for bounds in the parameters. Therefore, we ensure that the output is computed whatever the inputs. The model fails into two situations:</p>
<ul class="simple">
<li><p>if <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAAQBAMAAABAXPr7AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dJ3dSIsYz/tgMunYU1txAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA3klEQVQY02NgYBD67MDgr8qAHbAlMDC4YogebTwAovgDGFgK0OXYHzC8BdH1BQydKBI3QcY5MASD2PEMM1DkqixBxhUwnAZxlrFvR5ZziwQbd4GhfgKQ3npmM0KKM8wBTJ+/AJJn4P18QR4ux2sFdRpQBijPwPGB4X4DTPL0ASjjfgGDP9BYrgcMbA8wdPIfYPAGUtwCDCzfgQZ4QOyUgtjJ1sAQBTIAaBLQRYUcUD1tASCSJwEUCIz5axgY/xsw1C+HGX1KEkS6Oh5ACi9plBBCDcsFXAw4AWdPO6YgAA5yNs3592b6AAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="K_s&lt;0" style="vertical-align: -3px"/>,</p></li>
<li><p>if <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAAAQBAMAAADwo9zJAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/PPr+l0+xgynYtI3WBzLvw+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABLUlEQVQoz2NgYPxk4vKVAQ1gFYQDpgQGlgqiBIHg1ZYHQHIWA8P+A+hSWAUZGHgCGCKB1AYGnm8YclgEZwAxbwLDQjBn+gIsTkAXPCwBJPgPMDwHcTgUsehAF8xdASLPT2A43wCyLQCLFlRBjrUJYPr9BJAuBgahBixaUAQ5haFBAVQP1MXAVcnABpV6excIboNYSIJA8PwBlDH/AEM+0Kz3Dxi4MCxBFYTbwv+AIR3I/c3AcIphM4cCsg6wIMeSZ5LbHCB+cYb4hXcDw2IGhnYHBh5NbqYGFO9CBPkPrGWAmbQXHOZ8F0BReV9EOF6BYSow8pAARPAsgx3C8sceIDIrBeYthlUMCZihtopBg00AJfaRgRsflpC24VBgfo0zOU/ch0XwAo8D1xpMYQCaiFYxY0LlvAAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="Z_v-Z_m&lt;0" style="vertical-align: -3px"/>.</p></li>
</ul>
<p>In these cases, we return an infinite number.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">functionFlooding</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">5.0e3</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mf">300.0</span>
    <span class="n">Q</span><span class="p">,</span> <span class="n">K_s</span><span class="p">,</span> <span class="n">Z_v</span><span class="p">,</span> <span class="n">Z_m</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z_m</span> <span class="o">-</span> <span class="n">Z_v</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">K_s</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="n">K_s</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">alpha</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">H</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">functionFlooding</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MemoizeFunction</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">setOutputDescription</span><span class="p">([</span><span class="s2">&quot;H (m)&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>We load the input distribution for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAARBAMAAAAf5oCsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ2Lv90y+69gdEjzz+k90WGTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAcUlEQVQI12NgYGBUMnJkAAJTAYZ0AQYGjgAIng5kc31gYCgGSnH/ZuAAMhm4PjLwAKUYWD4w8CsAaZ4LDPILgPT8BAZ2AyB9BCh1QUib5QLQ1NMGzDdAxnJc1ktgAzEYeBmkwDSPgAOEPqcApplqGRgAUOkTS0IYTsgAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="Q" style="vertical-align: -4px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">Q</span>
</pre></div>
</div>
<p>Set the parameters to be calibrated.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">K_s</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Dirac</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
<span class="n">Z_v</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Dirac</span><span class="p">(</span><span class="mf">50.0</span><span class="p">)</span>
<span class="n">Z_m</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Dirac</span><span class="p">(</span><span class="mf">55.0</span><span class="p">)</span>
<span class="n">K_s</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Ks (m^(1/3)/s)&quot;</span><span class="p">])</span>
<span class="n">Z_v</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Zv (m)&quot;</span><span class="p">])</span>
<span class="n">Z_m</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Zm (m)&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>We create the joint input distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputRandomVector</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ComposedDistribution</span><span class="p">([</span><span class="n">Q</span><span class="p">,</span> <span class="n">K_s</span><span class="p">,</span> <span class="n">Z_v</span><span class="p">,</span> <span class="n">Z_m</span><span class="p">])</span>
</pre></div>
</div>
<p>Create a Monte-Carlo sample of the output <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANBAMAAABSlfMXAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dBj7YN3pz52LSDLi5wBxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAZUlEQVQI12NgYBD67BCoJs7AwMDRwMAwC0gz8G9gYPgDYty/wMD+D8TYz8DAmABirAAqWwBiZAgKyh8A0nx/wcoYGHg+gJUxMHBNYGDoADHYBBgYskGM9wVgZQyM/ctZJT8XMAAA8OAWeIvNF8EAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="H" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nbobs</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">inputSample</span> <span class="o">=</span> <span class="n">inputRandomVector</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">nbobs</span><span class="p">)</span>
<span class="n">outputH</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">inputSample</span><span class="p">)</span>
</pre></div>
</div>
<p>Generate the observation noise and add it to the output of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaObservationNoiseH</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># (m)</span>
<span class="n">noiseH</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigmaObservationNoiseH</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">RandomGenerator</span><span class="o">.</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sampleNoiseH</span> <span class="o">=</span> <span class="n">noiseH</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">nbobs</span><span class="p">)</span>
<span class="n">Hobs</span> <span class="o">=</span> <span class="n">outputH</span> <span class="o">+</span> <span class="n">sampleNoiseH</span>
</pre></div>
</div>
<p>Plot the Y observations versus the X observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Qobs</span> <span class="o">=</span> <span class="n">inputSample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;Observations&quot;</span><span class="p">,</span> <span class="s2">&quot;Q (m3/s)&quot;</span><span class="p">,</span> <span class="s2">&quot;H (m)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">Qobs</span><span class="p">,</span> <span class="n">Hobs</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_bayesian_calibration_flooding_001.png" srcset="../../_images/sphx_glr_plot_bayesian_calibration_flooding_001.png" alt="Observations" class = "sphx-glr-single-img"/></section>
<section id="setting-the-calibration-parameters">
<h2>Setting the calibration parameters<a class="headerlink" href="#setting-the-calibration-parameters" title="Permalink to this heading">¶</a></h2>
<p>Define the parametric model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAUBAMAAAA+U32BAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/vzdGC/6TLP3UgYnYs5CaG8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABZ0lEQVQoz2NgwAd4LkDoC7gU3HOA0JxA3Ln8AsMxHOr4rhhAGFcZGLjVuL8wsDzArpB5RwCEUcDAcMiA4ReYgQ30Q2mQQfMf8HxiYBDBrtAdSnM1MPD8P8ANVBgJ5DEqO4ShqjtoLgphMAGd+x2EQCwGeSVjkAvYZoKAAFjBOphbGRjY/xvbf2Ng4AfyGhg80a3WBoag7LMGhnagiq8MTF+AJh4AmSWAHswfQI7iMWDYzsBw/gPDfgWg2UCFHKvRDWQ1YOAABuQShsNAhQoM+Rcgbow8wDEF1Y28ExjYgQEzFyTNX8DzGeItFnX9/2jByXmB4TyQMmVgP8DApsCpAWR3MTAcP+CshmY10wYGZ6CT/jDwAqM8qwzkj3dYwxtoXDDYXI4JMKE12NTFAIOLudVbEEkeoQMZfM0GhlDaqwCglW1QIbYD2BS+A6cpTo4NwICCpsvXeBI3uxsDONoYkCisgNEalQ8A8PdVgWz82IIAAAAKdEVYdERlcHRoAAAAAAbOQEQ5AAAAAElFTkSuQmCC" alt="\vect z = f_Q(\vect\theta)" style="vertical-align: -6px"/> that associates each observation
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAARBAMAAAAf5oCsAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGJ2Lv90y+69gdEjzz+k90WGTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAcUlEQVQI12NgYGBUMnJkAAJTAYZ0AQYGjgAIng5kc31gYCgGSnH/ZuAAMhm4PjLwAKUYWD4w8CsAaZ4LDPILgPT8BAZ2AyB9BCh1QUib5QLQ1NMGzDdAxnJc1ktgAzEYeBmkwDSPgAOEPqcApplqGRgAUOkTS0IYTsgAAAAKdEVYdERlcHRoAAAAAAQgTiUVAAAAAElFTkSuQmCC" alt="Q" style="vertical-align: -4px"/> and value of the parameters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAAATBAMAAACuF8goAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMs/d6Z1I+790GPOLYK92xBV1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABz0lEQVQ4y42UMUjDQBSG/6Q1beO1DeLgIFhUHASxQycXOzpmEScxg5tg46CIiBTcRDCL4CCaRRwqKIKDdTCTgyB0FgQ3BVELilZE6juF9K5ewUfucd+f5Od49+6Av2Ha+G+0/eSOXNMfOo2Hmofdk1DaOH56zivILFIyFo0P2WGSRiQLbDakU+DOV9E2jf0jvMgO3D5tI+GEimaDvSkpSmM4MN8lg0RAqeDgsiExEjwlpTyYdd+QHSIWpSkcSKI2r6ZkBuyVP2LEeOozFiSxVGxBLqL1s/MazeK9PG5p1s5fzN8sSg65VlRF+gsxeS86+TJr1rOoxcutaAmHVRRcyWGaF6uKnkDQJix4airj0MWG3FEl3lR5RBodhOQXYKvJRTpvfkKqA69k7BYJ2nK2/fsZrcewWaYk0N7jVvfOj0Pc1efkhopSu/VUACrlLHO0QerdFWDGCspRCPTWlqWaa9S7q2N+02nxkBodQqpeRGEAxjJ1SO2+/xNanglkZPUKrYkFivOmZcKpcUctGjrbCYna/S2y81VHdiQ0yOjCPynvWiDdKWEoQIfy0HeFF8XVBRr7pq1XBIpgFuMO1pQOSU8kCZoIzFHfPNa/7ygN+AbYCHstVuVf1gAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\vect \theta = (K_s, Z_v, Z_m)" style="vertical-align: -5px"/>
to the parameters of the distribution of the corresponding observation:
here <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAATBAMAAADMlCYHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/vzdGC/6TLP3UgYnYs5CaG8AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABIklEQVQoz2NgwAQ8F9AEeBmwAk4MjQlY1V3FEPHDqq4AQ4QdmzKWBxhCjA5Y1HE1YAixTgCqVXYIQxFkAnklgGE1hPf4/38FBgYgklcyBjmIbSYICABZzEDM38DzB+L3nC5QKH1gYGhg8ES1pB2IgxhYDMCcVwysIFN0QCYJoKrbDsSSDGyQMNNmYFkApGwYGDhWozn6MBCXMDCDvcihADEG6L7IAxxTUNwH8scPhvOnD4A8WsDAdACsjkVd/z9qwLIfYGD9zSDEx9B5AKQAZAjHAobjB5zV0GLdgYGx0uXYU4ZNwADf67sBKMT3AEs4c0xgYIeEPzwWuA5gi7g1wOBDVdeJNR20AYMPHNFwkRys6lgdHFHV8W3AnlDREwIHAwMAfwQ6XlErYl4AAAAKdEVYdERlcHRoAAAAAAVXSRWDAAAAAElFTkSuQmCC" alt="\vect z=(\mu, \sigma)" style="vertical-align: -5px"/> with <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKYAAAATBAMAAADooWuCAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAz2DdSDIY+3Tzr7/pi50GME+FAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACWUlEQVQ4y51US2jUUBQ9+TaTTMZYxUWpEFzYZWchrgpmaxEaVy5UzMKFgzhVEBeKJUtp0SpIKVikuhn80M5KcCEdd26EUMWlRimIIG2RqSAD6n3JMHkPXrroZcLk3Hdz3v0cLlBqZoo9WK3E3xxZMVIojHfz86u+81kvxvzjQczag+erHQky21JKaxHmax/f6PVDhDNR7tXqwL0iaBFoRTJ0V8r5IwTGAbrXrucPs30prGAQQ3W4XSmqStPcyU6sBBiju63t3D0V4FMR5JIjliI7lnAOLbMTaJTtbXrT+wls4YoQZszIkeoBio9jQvBWyFqNISJmKVq/c/cB/boQ1miXoKvUp9BkXzn7mbEUl/KjCv1YK51+7TNHbgmcE2WI4sdg3ReOe/nfuWwsROzlxfXCVT7KWShDN4AncERJ/SXhrr3HKWCatXs8zMewjQsJF/U9RCxHRP8OFXFSN5GxNWhajORR7lU60AqNQ/0FpHJE/dzB9MWI7+dLer6AzcjxmhuON1CDRQpw+5KmnPXU9Rocaj6dOz+bcapdtFwhz8oy1FFSaATzYeKOUCsPsc98gIY06QYMmlTMyTBZqIJD3VqdBmvUYb+9c3ldFOjXlQ2VekodsQ//DA3oJFP7xDDsf21MHcyg1nsx+gdGx+WQXld8yttNUI1LFomRFa3gEkm08OotDtZSS0CVaI4uiEieZVvreNaIqM1z6p7CQTs+yiElaGA4wWkmzzI7m3Eu0TyLUsz1jxw03vgc0jCJzQC0G2dLOVUWXbsGnjOzeBcEN9h1ZYd72fMG8B+W5JvbL7/SUwAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\mu = G(Q, K_s, Z_v, Z_m)" style="vertical-align: -5px"/>
and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAMBAMAAADBtrOrAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAi/P7z78YMt2dYOlIdK/O4RSDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAuUlEQVQY02NgwABcE1+BqOqHMwowJRlOM3CDhIs+u2ORZOhl4AwAUrUMWMEfBi4DuCyj/v/PyJI83xl4vgHpSkGQ9a7pnSBBVhcQeAB01HeQAgaGTAamAwyMDQyrGdD0cn0Hs1gbGJgPMNxAkWX/w8D7DcziNGAoZmCIQ3XVLwZekKt0GTg/gIw1Q7GXoZGB0wFIbQebzMByAVXvCmBosLsxiDEkFzDwzJ2D5l/eua8YeMwZGOeFMwAAnn4tSfrjA+UAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="\sigma = 0.5" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fullModelPy</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">Q</span><span class="p">,</span> <span class="n">K_s</span><span class="p">,</span> <span class="n">Z_v</span><span class="p">,</span> <span class="n">Z_m</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># (m^2) The standard deviation of the observation error.</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">]</span>


<span class="n">fullModel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fullModelPy</span><span class="p">)</span>
<span class="n">linkFunction</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">fullModel</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linkFunction</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>ParametricEvaluation(class=PythonEvaluation name=OpenTURNSPythonFunction, parameters positions=[0], parameters=[x0 : nan], input positions=[1,2,3])
</pre></div>
</div>
<p>Define the value of the reference values of the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/> parameter.
In the Bayesian framework, this is called the mean of the <em>prior</em> Gaussian distribution. In the data assimilation framework, this is called the <em>background</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KsInitial</span> <span class="o">=</span> <span class="mf">20.0</span>
<span class="n">ZvInitial</span> <span class="o">=</span> <span class="mf">49.0</span>
<span class="n">ZmInitial</span> <span class="o">=</span> <span class="mf">51.0</span>
<span class="n">parameterPriorMean</span> <span class="o">=</span> <span class="p">[</span><span class="n">KsInitial</span><span class="p">,</span> <span class="n">ZvInitial</span><span class="p">,</span> <span class="n">ZmInitial</span><span class="p">]</span>
<span class="n">paramDim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameterPriorMean</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the covariance matrix of the parameters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/> to calibrate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sigmaKs</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">sigmaZv</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sigmaZm</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameterPriorCovariance</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">CovarianceMatrix</span><span class="p">(</span><span class="n">paramDim</span><span class="p">)</span>
<span class="n">parameterPriorCovariance</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaKs</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">parameterPriorCovariance</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaZv</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">parameterPriorCovariance</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigmaZm</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Define the prior distribution <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAATBAMAAADojanHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAMun7v510GEiv3WDzz4vfXEUjAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA5UlEQVQY012QsWrCUBSGv9TYpGpqKJ2EgoNbByP4AJ1dmr1LNul2wY6FSl+gTs7i0qHPUPABCvUNzNiphEZEtBBPck0CHu7l/+93Dj/3XtBl+VqPkpYj+2bu81SiB7D79obzsEBtGC3YZUZX2lyFVgzTHNVcrETZgj7B6CZJTAUu/9KVOtP1h9CAs+Trew1NGBvBBK7E76lsZErBhbqDV3iJePNkXlCNGTwL8rj3syweiTLTbFv/aHTLVrIVpuf05NiS9y74gGoAg47E8Jtf1Vjm7p1TV/a4PqqpClQPtP6U/4VbyAFsFy/PI2fLywAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="\pi(\vect\theta)" style="vertical-align: -5px"/> of the parameter <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect\theta" style="vertical-align: 0px"/></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prior</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">parameterPriorMean</span><span class="p">,</span> <span class="n">parameterPriorCovariance</span><span class="p">)</span>
<span class="n">prior</span><span class="o">.</span><span class="n">setDescription</span><span class="p">([</span><span class="s2">&quot;Ks&quot;</span><span class="p">,</span> <span class="s2">&quot;Zv&quot;</span><span class="p">,</span> <span class="s2">&quot;Zm&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Define the distribution of observations <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAATBAMAAAB8awA1AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGM/p3XQyr4udYPNIv/vElxQ+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAkElEQVQY02NgAANeBmTAQiGPUVmRQSQAyGN/HbCWgTn9B0P9BCCv/t1uA4bl3H8Y9h8A8hIYgoBKz29g/A/Wx1sAJOonsH4B8dh8QMb4L+D9AeItEmBTZWC4vyD/G5DH+vj9fwMGBqFN/g+APGGB6LdAlQcY5hfAbef4wbBfAM5j+sP7C+EyNiXfBHRX80AoAGMZI4Wl1o4CAAAACnRFWHREZXB0aAAAAAAFV0kVgwAAAABJRU5ErkJggg==" alt="\vect{y} | \vect{z}" style="vertical-align: -5px"/> conditional on model predictions.</p>
<p>Note that its parameter dimension is the one of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAr/vzdGC/6TLP3UgYdzMtfAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADNJREFUCNdjYGBUdghjYJBVMi5gYGhg8GQAAjYBIMGxGsSMPMAxhYFFXfduAcPxA85qDACagwh5AU8/MwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect{z}" style="vertical-align: 0px"/>, so the model must be adjusted accordingly.
In other words, the input argument of the <cite>setParameter</cite> method of the conditional distribution must be equal to the dimension of the output of the <cite>model</cite>.
Hence, we do not have to set the actual parameters: only the type of distribution is used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conditional</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Normal</span><span class="p">()</span>
</pre></div>
</div>
<p>The proposed steps for <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAQBAMAAAAL9CkWAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dJ3dSIsYz/tgMunYU1txAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAeklEQVQI12NgYBD67MDgr8oABmwJDAyuECYDfwADSwGUXV/A0AllMsQzzIAxGZaxb4ezt57ZDGPyfr4gD2NzfGC43wBlcz1gYHsAZXMLMLB8B0p7ANn3DzAwADUXchQwMOavYWD8b8BQvxxuMAO7NIK5gAvO5uxpZwAAMp0ZVwjna2YAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="K_s" style="vertical-align: -3px"/> <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQBAMAAADpKDJvAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/PPr+l0+xgynYtI3WBzLvw+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbUlEQVQI12NgYPxk4vKVAQSYEhhYKsCsWQwM+w+AWRsYeL4xQMH0BVAGhyJMiDcAxhJqgDK4KhnYIKz3Dxi4wAzO3wwMpxg2cygwtDsw8GhyMzUEMNwXEY5XYJgKtAACVjEkQFlufDCjJu5jAADmYRY0Jy22YAAAAAp0RVh0RGVwdGgAAAAAA74qsLYAAAAASUVORK5CYII=" alt="Z_v" style="vertical-align: -3px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAQBAMAAAAPAfkrAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/PPr+l0+xgynYtI3WBzLvw+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfklEQVQI12NgYPxk4vKVAQqYEhhYKmCcWQwM+w/AOBsYeL4xIMD0BQg2hyKSBG8AEkeoAcHmqmRgg3PeP2DggrE5fzMwnOJY8kxymwMDQ7sDA48mN/+BtQwKDAz3RYTjFRjOMthxKMAUr2LQYBOAcWw4FJhfwzgXeBy41jAAAL5tGZE1SZVEAAAACnRFWHREZXB0aAAAAAADviqwtgAAAABJRU5ErkJggg==" alt="Z_m" style="vertical-align: -3px"/>
will all follow uniform distributions,
but with different supports.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">proposal</span> <span class="o">=</span> <span class="p">[</span><span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">ot</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<section id="build-a-gibbs-sampler">
<h2>Build a Gibbs sampler<a class="headerlink" href="#build-a-gibbs-sampler" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initialState</span> <span class="o">=</span> <span class="n">parameterPriorMean</span>
<span class="n">mh_coll</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">RandomWalkMetropolisHastings</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">initialState</span><span class="p">,</span> <span class="n">proposal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">paramDim</span><span class="p">)</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">mh</span> <span class="ow">in</span> <span class="n">mh_coll</span><span class="p">:</span>
    <span class="n">mh</span><span class="o">.</span><span class="n">setLikelihood</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">Hobs</span><span class="p">,</span> <span class="n">linkFunction</span><span class="p">,</span> <span class="n">Qobs</span><span class="p">)</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Gibbs</span><span class="p">(</span><span class="n">mh_coll</span><span class="p">)</span>
</pre></div>
</div>
<p>Generate a sample from the posterior distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAANBAMAAABiGeI2AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs/d6Z1I+790GPOLYBc+lckAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABWSURBVAjXY2BgEDIJYGBgq2B7ycCwfAPDYwYGvQNczxm43i1ge87A8wSEWN7t3veCge8tA/tLhnUPGPIKGNYVMPQFMPA5cL1mYOAoYCpkYGBo9ljAAACdeRfBAyHp+gAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\vect \theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">getSample</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">)</span>
</pre></div>
</div>
<p>Look at the acceptance rates of the random walk Metropolis-Hastings samplers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">mh</span><span class="o">.</span><span class="n">getAcceptanceRate</span><span class="p">()</span> <span class="k">for</span> <span class="n">mh</span> <span class="ow">in</span> <span class="n">sampler</span><span class="o">.</span><span class="n">getMetropolisHastingsCollection</span><span class="p">()]</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.365, 0.359, 0.333]
</pre></div>
</div>
<p>Build the distribution of the posterior by kernel smoothing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">KernelSmoothing</span><span class="p">()</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>Display prior vs posterior for each parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">parameter_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">paramDim</span><span class="p">):</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">parameter_index</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">priorGraph</span> <span class="o">=</span> <span class="n">prior</span><span class="o">.</span><span class="n">getMarginal</span><span class="p">(</span><span class="n">parameter_index</span><span class="p">)</span><span class="o">.</span><span class="n">drawPDF</span><span class="p">()</span>
    <span class="n">priorGraph</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="s2">&quot;blue&quot;</span><span class="p">])</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">priorGraph</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">setLegends</span><span class="p">([</span><span class="s2">&quot;Posterior&quot;</span><span class="p">,</span> <span class="s2">&quot;Prior&quot;</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">paramDim</span><span class="p">,</span> <span class="n">parameter_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">ax</span><span class="p">])</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Bayesian calibration&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_bayesian_calibration_flooding_002.png" srcset="../../_images/sphx_glr_plot_bayesian_calibration_flooding_002.png" alt="Bayesian calibration" class = "sphx-glr-single-img"/><div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-bayesian-calibration-plot-bayesian-calibration-flooding-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e4d2551968c198c67c79607b0f3bcbe8/plot_bayesian_calibration_flooding.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_bayesian_calibration_flooding.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/0fa2e639c50bf6244840c021087984b7/plot_bayesian_calibration_flooding.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_bayesian_calibration_flooding.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_rwmh_python_distribution.html" title="Posterior sampling using a PythonDistribution"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_imh_python_distribution.html" title="Sampling from an unnormalized probability density"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Bayesian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bayesian calibration of the flooding model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>