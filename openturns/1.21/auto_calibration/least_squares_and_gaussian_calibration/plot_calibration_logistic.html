
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Calibration of the logistic model &#8212; OpenTURNS 1.21 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Calibration of the deflection of a tube" href="plot_calibration_deflection_tube.html" />
    <link rel="prev" title="Calibration without observed inputs" href="plot_calibration_withoutobservedinputs.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_calibration_deflection_tube.html" title="Calibration of the deflection of a tube"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_withoutobservedinputs.html" title="Calibration without observed inputs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the logistic model</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Calibration of the logistic model</a><ul>
<li><a class="reference internal" href="#variables">Variables</a></li>
<li><a class="reference internal" href="#analysis-of-the-data">Analysis of the data</a></li>
<li><a class="reference internal" href="#calibration-with-linear-least-squares">Calibration with linear least squares</a></li>
<li><a class="reference internal" href="#calibration">Calibration</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_calibration_withoutobservedinputs.html"
                          title="previous chapter">Calibration without observed inputs</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_calibration_deflection_tube.html"
                          title="next chapter">Calibration of the deflection of a tube</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/least_squares_and_gaussian_calibration/plot_calibration_logistic.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-logistic-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="calibration-of-the-logistic-model">
<span id="sphx-glr-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-logistic-py"></span><h1>Calibration of the logistic model<a class="headerlink" href="#calibration-of-the-logistic-model" title="Permalink to this heading">¶</a></h1>
<p>We present a calibration study of the logistic growth model defined <a class="reference internal" href="../../usecases/use_case_logistic.html#use-case-logistic"><span class="std std-ref">here</span></a>.
The data set that we use is the U.S. population from 1790 to 2000.
One of the specific properties of this study is that the observations
that we use are real world observations.
Hence when we calibrate the model on the data, there is a discrepancy that will
be seen.
In this example, we calibrate the parameters of a model which predicts
the dynamics of the size of a population.
This shows how we can calibrate a model which predicts a time
dependent output.
The output of the model is a time series representing the evolution of the
population.
This requires a transpose of the sample, so that we can benefit from
the visualization methods.</p>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Permalink to this heading">¶</a></h2>
<p>In the particular situation where we want to calibrate this model, the
following list presents which variables are observed input variables,
input calibrated variables and observed output variables.</p>
<ul class="simple">
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAMBAMAAACzedEdAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAGN2dSPtgr+mLMs908zTxv1QAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA4SURBVAjXY2BgFGBgYDJgYOBzYGBwZWBI76hkYNBkYGB4xcDAFsDAwL6BgYFjggwDr4MBA4/NAgB9KgZ4Ll8hGwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="t" style="vertical-align: 0px"/>: Input. Observed.</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAALBAMAAAC9q6FRAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAv/t0SIudYN0yzxjzr+kgV3wLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAUElEQVQI12NgYFRmcWAAgrCKNBDFMIEhgCU5AciYzMDBEMrAwO7AUMXgwcBgycCWyODEwJwV3nmRYRLDZu4zBSA+CFQxVIBpPpB6IGBJvgAAQgwN+HsV4pgAAAAKdEVYdERlcHRoAAAAAAO+KrC2AAAAAElFTkSuQmCC" alt="z_0" style="vertical-align: -3px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIBAMAAADZ48iGAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAnXRIMt2Lz+mv+2AYvwxtY48AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA5SURBVAjXY2BgFDJhYGAIY6hgYGALYKhkYOBKYFjNwODnwPyAgcGOgTFgAwMXw4kJCQzcl5SvHQAAp/IKAtW27qgAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="a" style="vertical-align: 0px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAdIsyz6+d6RhI8xONfKYAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAuSURBVAjXY2BgVBRmYHBicGVgK2CQYOBWYGBgsG4AErMZGDgYuAwYlBmYA4UaAEZkBBeN279pAAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="c" style="vertical-align: 0px"/>: Inputs. Calibrated.</p></li>
<li><p><img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIBAMAAADZ48iGAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAv/t0SIudYN0yzxjzRJk6YgAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADJJREFUCNdjYGBUZnFgYAirSGNgYJjAEAAkGSaDCHYHEGnJwMbAwJwV3snAsJn7TAEDAIm7Bt2vf1g6AAAACnRFWHREZXB0aAAAAAAAJyPhDAAAAABJRU5ErkJggg==" alt="z" style="vertical-align: 0px"/>: Output. Observed.</p></li>
</ul>
</section>
<section id="analysis-of-the-data">
<h2>Analysis of the data<a class="headerlink" href="#analysis-of-the-data" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">logistic_model</span>
<span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
<p>We load the logistic model from the usecases module :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">logistic_model</span><span class="o">.</span><span class="n">LogisticModel</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inputs:&quot;</span><span class="p">,</span> <span class="n">lm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outputs: &quot;</span><span class="p">,</span> <span class="n">lm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getOutputDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Inputs: [t0,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13,t14,t15,t16,t17,t18,t19,t20,t21,a,c]#24
Outputs:  [z0,z1,z2,z3,z4,z5,z6,z7,z8,z9,z10,z11,z12,z13,z14,z15,z16,z17,z18,z19,z20,z21]#22
</pre></div>
</div>
<p>We see that there are 24 inputs.
The first 22 inputs are the timestamps and the last two inputs are the
a and c parameters to calibrate.
The 22 outputs are the population of the U.S. in millions.</p>
<p>The data is based on 22 dates from 1790 to 2000. The observation points are
stored in the <cite>data</cite> field :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">observedSample</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">data</span>
<span class="n">observedSample</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Time</th><th>U.S. Population</th></tr>
  <tr><th>0</th><td>1790</td><td>3.9</td></tr>
  <tr><th>1</th><td>1800</td><td>5.3</td></tr>
  <tr><th>2</th><td>1810</td><td>7.2</td></tr>
  <tr><th>3</th><td>1820</td><td>9.6</td></tr>
  <tr><th>4</th><td>1830</td><td>13</td></tr>
</table>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nbobs</span> <span class="o">=</span> <span class="n">observedSample</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="n">nbobs</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timeObservations</span> <span class="o">=</span> <span class="n">observedSample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">timeObservations</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Time</th></tr>
  <tr><th>0</th><td>1790</td></tr>
  <tr><th>1</th><td>1800</td></tr>
  <tr><th>2</th><td>1810</td></tr>
  <tr><th>3</th><td>1820</td></tr>
  <tr><th>4</th><td>1830</td></tr>
</table>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">populationObservations</span> <span class="o">=</span> <span class="n">observedSample</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">populationObservations</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>U.S. Population</th></tr>
  <tr><th>0</th><td>3.9</td></tr>
  <tr><th>1</th><td>5.3</td></tr>
  <tr><th>2</th><td>7.2</td></tr>
  <tr><th>3</th><td>9.6</td></tr>
  <tr><th>4</th><td>13</td></tr>
</table>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">palette</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Time (years)&quot;</span><span class="p">,</span> <span class="s2">&quot;Population (Millions)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">timeObservations</span><span class="p">,</span> <span class="n">populationObservations</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Observations&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="s2">&quot;CalibrationResult-ObservationPointStyle&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">timeObservations</span><span class="p">,</span> <span class="n">populationObservations</span><span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLineStyle</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="s2">&quot;CalibrationResult-ObservationLineStyle&quot;</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">([</span><span class="n">palette</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_logistic_001.png" srcset="../../_images/sphx_glr_plot_calibration_logistic_001.png" alt="plot calibration logistic" class = "sphx-glr-single-img"/><p>We see that there is a very smooth growth of the U.S. population.
This is a good candidate for model calibration.</p>
<p>We consider the times and populations as dimension 22 vectors.
The <cite>logisticModel</cite> function takes a dimension 24 vector as input and
returns a dimension 22 vector.
The first 22 components of the input vector contains the dates and the
remaining 2 components are <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIBAMAAADZ48iGAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAnXRIMt2Lz+mv+2AYvwxtY48AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA5SURBVAjXY2BgFDJhYGAIY6hgYGALYKhkYOBKYFjNwODnwPyAgcGOgTFgAwMXw4kJCQzcl5SvHQAAp/IKAtW27qgAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="a" style="vertical-align: 0px"/> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAANBAMAAABm7DILAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs9Ii92d+2B0GK/z6Q9P1rkAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABBSURBVAjXY2DUE2BgYLADYgZXEKEGIiqAmPHltAkMLIUMVQxMG4AC7A0MjxnWMXA+YJBhYEpg4GHoZWDg2JnAAAAY7wrDWCVedQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="b" style="vertical-align: 0px"/>.</p>
<p>Print the number of dates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">getSize</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
<p>Get the physical model to calibrate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logisticModelPy</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">model</span>
</pre></div>
</div>
<p>The reference values of the parameters.</p>
<p>Because <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAANBAMAAABm7DILAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs9Ii92d+2B0GK/z6Q9P1rkAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABBSURBVAjXY2DUE2BgYLADYgZXEKEGIiqAmPHltAkMLIUMVQxMG4AC7A0MjxnWMXA+YJBhYEpg4GHoZWDg2JnAAAAY7wrDWCVedQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="b" style="vertical-align: 0px"/> is so small with respect to <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIBAMAAADZ48iGAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAnXRIMt2Lz+mv+2AYvwxtY48AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA5SURBVAjXY2BgFDJhYGAIY6hgYGALYKhkYOBKYFjNwODnwPyAgcGOgTFgAwMXw4kJCQzcl5SvHQAAp/IKAtW27qgAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="a" style="vertical-align: 0px"/>, we use the logarithm.
In other words, we calibrate <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAATBAMAAADIYfY6AAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIsyz6+d6RhI87/dYPuR7he1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABQklEQVQoz4WSPUsDQRCGn7vNnZdPjwhiJae2FlsIAS0MYmxNFK3PQEohP+HATgTTWRiwsLFMYWFpaSOksw3YpBEiWpyFH3Nek4RcMsXOvsyzszOzC9PM8aPVnhBpfwyJFGpf43QmcMPYKdyIK87AmrAubm46ZniwJ95yp2AOOQ1vssuX5cjKwhhm1KWm48ZJtQDqfVFS9WCHigTvd8UqMdYg61nVlE8GzFf6MMBusjSazQlRg4wrgZKMpBpd22feG6/NGMB3yrfKXEGhyxfcsR1MxPK3pYBzuCSSvWh8zmhtKiQd2kZXUsEmUqNgGc3aWKdHZH2rFY01kC5epN1HVK04cu31Z9es11C/P8/YLvmaJDO9pL9xoc+WtSrHIhckYXXIujzFYiPxp7WlMs1WLB4SsfTB6qE85v+bmy1mmI4WBX8xIUjCj8oU1gAAAAp0RVh0RGVwdGgAAAAABVdJFYMAAAAASUVORK5CYII=" alt="c = \log(b)" style="vertical-align: -5px"/> instead of calibrating
<img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAANBAMAAABm7DILAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs9Ii92d+2B0GK/z6Q9P1rkAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABBSURBVAjXY2DUE2BgYLADYgZXEKEGIiqAmPHltAkMLIUMVQxMG4AC7A0MjxnWMXA+YJBhYEpg4GHoZWDg2JnAAAAY7wrDWCVedQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="b" style="vertical-align: 0px"/>.
This makes the calibration much easier.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.5587e-10</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>-22.581998789427587
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.03134</span>
<span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">22.58</span>
<span class="n">thetaPrior</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
</pre></div>
</div>
<p>In the physical model, the inputs and parameters are ordered as
presented in the next table.
Notice that there are no parameters in the physical model.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>t1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>t2</p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>t22</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>a</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>c</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>∅</p></td>
<td><p>∅</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 1.</strong> Indices and names of the inputs and parameters of the physical model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Inputs:&quot;</span><span class="p">,</span> <span class="n">lm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Parameters:&quot;</span><span class="p">,</span> <span class="n">lm</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Physical Model Inputs: [t0,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13,t14,t15,t16,t17,t18,t19,t20,t21,a,c]#24
Physical Model Parameters: []
</pre></div>
</div>
<p>In order to perform calibration, we have to define a parametric model,
with observed inputs and parameters to calibrate.
In order to do this, we create a <a class="reference internal" href="../../user_manual/_generated/openturns.ParametricFunction.html#openturns.ParametricFunction" title="openturns.ParametricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParametricFunction</span></code></a> where the parameters
are <cite>a</cite> and <cite>c</cite> which have the indices 22 and 23 in the physical model.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>t1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>t2</p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>t22</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>a</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>c</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 2.</strong> Indices and names of the inputs and parameters of the parametric model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logisticParametric</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">logisticModelPy</span><span class="p">,</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="n">thetaPrior</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parametric Model Inputs:&quot;</span><span class="p">,</span> <span class="n">logisticParametric</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parametric Model Parameters:&quot;</span><span class="p">,</span> <span class="n">logisticParametric</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Parametric Model Inputs: [t0,t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13,t14,t15,t16,t17,t18,t19,t20,t21]#22
Parametric Model Parameters: [a,c]
</pre></div>
</div>
<p>Check that we can evaluate the parametric function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">populationPredicted</span> <span class="o">=</span> <span class="n">logisticParametric</span><span class="p">(</span><span class="n">timeObservations</span><span class="o">.</span><span class="n">asPoint</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">populationPredicted</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[3.9,5.29757,7.17769,9.69198,13.0277]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
    <span class="s2">&quot;Before calibration&quot;</span><span class="p">,</span> <span class="s2">&quot;Time (years)&quot;</span><span class="p">,</span> <span class="s2">&quot;Population (Millions)&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;topleft&quot;</span>
<span class="p">)</span>
<span class="c1"># Observations</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">timeObservations</span><span class="p">,</span> <span class="n">populationObservations</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Observations&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span>
    <span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="s2">&quot;CalibrationResult-ObservationPointStyle&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="c1"># Predictions</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">timeObservations</span><span class="o">.</span><span class="n">asPoint</span><span class="p">(),</span> <span class="n">populationPredicted</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Predictions&quot;</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setPointStyle</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="s2">&quot;CalibrationResult-PriorPointStyle&quot;</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_logistic_002.png" srcset="../../_images/sphx_glr_plot_calibration_logistic_002.png" alt="Before calibration" class = "sphx-glr-single-img"/><p>We see that the fit is not good: the observations continue to grow after 1950, while the growth of the prediction seems to fade.</p>
</section>
<section id="calibration-with-linear-least-squares">
<h2>Calibration with linear least squares<a class="headerlink" href="#calibration-with-linear-least-squares" title="Permalink to this heading">¶</a></h2>
<p>The calibration algorithm takes input and output samples as arguments.
In this case, we choose to consider one single observation in dimension 22.
In order to perform calibration, we create a <cite>Sample</cite> of input times which has
one observation in dimension 22.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timeObservationsSample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([</span><span class="n">timeObservations</span><span class="o">.</span><span class="n">asPoint</span><span class="p">()])</span>
<span class="n">timeObservationsSample</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[1790,1800,1810,1820,1830]</p>
</div>
<br />
<br /><p>Similarly, we create a <cite>Sample</cite> of output populations which has
one observation in dimension 22.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">populationObservationsSample</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="p">([</span><span class="n">populationObservations</span><span class="o">.</span><span class="n">asPoint</span><span class="p">()])</span>
<span class="n">populationObservationsSample</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[3.9,5.3,7.2,9.6,13]</p>
</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logisticParametric</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">logisticModelPy</span><span class="p">,</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
<p>Check that we can evaluate the parametric function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">populationPredicted</span> <span class="o">=</span> <span class="n">logisticParametric</span><span class="p">(</span><span class="n">timeObservationsSample</span><span class="p">)</span>
<span class="n">populationPredicted</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<p>[3.9,5.29757,7.17769,9.69198,13.0277]</p>
</div>
<br />
<br /></section>
<section id="calibration">
<h2>Calibration<a class="headerlink" href="#calibration" title="Permalink to this heading">¶</a></h2>
<p>We are now able to perform the calibration, using linear least squares
using the <a class="reference internal" href="../../user_manual/_generated/openturns.LinearLeastSquaresCalibration.html#openturns.LinearLeastSquaresCalibration" title="openturns.LinearLeastSquaresCalibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearLeastSquaresCalibration</span></code></a> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">LinearLeastSquaresCalibration</span><span class="p">(</span>
    <span class="n">logisticParametric</span><span class="p">,</span> <span class="n">timeObservationsSample</span><span class="p">,</span> <span class="n">populationObservationsSample</span><span class="p">,</span> <span class="n">thetaPrior</span>
<span class="p">)</span>
<span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
<span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta After = &quot;</span><span class="p">,</span> <span class="n">thetaMAP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta Before = &quot;</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>theta After =  [0.0265958,-23.1714]
theta Before =  [0.03134, -22.58]
</pre></div>
</div>
<p>Compared to the value of the parameters before calibration, we can see that the
parameters were significantly updated.</p>
<p>In order to see if the optimum parameters are sensitive to the
observation errors, we compute 95% confidence intervals.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaPosterior</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterPosterior</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thetaPosterior</span><span class="o">.</span><span class="n">computeBilateralConfidenceIntervalWithMarginalProbability</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.0246465, 0.028545]
[-23.3182, -23.0247]
</pre></div>
</div>
<p>The 95% confidence intervals of the optimum are relatively narrow:
this means that the optimum is not very sensitive to the observation errors.
In this case, the parameters are accurately estimated.</p>
<p>In this example, we have considered a single observation in dimension 22.
In this case, the parametric model has has 22 outputs, which
create a large number of plots.
Transpose samples to interpret the data as a Sample in dimension 1
with 22 observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getInputObservations</span><span class="p">()</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">calibrationResult</span><span class="o">.</span><span class="n">setInputObservations</span><span class="p">(</span><span class="n">timeObservations</span><span class="p">)</span>
    <span class="n">calibrationResult</span><span class="o">.</span><span class="n">setOutputObservations</span><span class="p">(</span><span class="n">populationObservations</span><span class="p">)</span>
    <span class="n">outputPriorMeanDimension22</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getOutputAtPriorMean</span><span class="p">()</span>
    <span class="n">outputAtPriorDimension1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">BuildFromPoint</span><span class="p">(</span><span class="n">outputPriorMeanDimension22</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">outputPosteriorMeanDimension22</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getOutputAtPosteriorMean</span><span class="p">()</span>
    <span class="n">outputPosteriorMeanDimension1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">BuildFromPoint</span><span class="p">(</span>
        <span class="n">outputPosteriorMeanDimension22</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">calibrationResult</span><span class="o">.</span><span class="n">setOutputAtPriorAndPosteriorMean</span><span class="p">(</span>
        <span class="n">outputAtPriorDimension1</span><span class="p">,</span> <span class="n">outputPosteriorMeanDimension1</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Increase the default number of points in the plots.
This produces smoother spiky distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">SetAsUnsignedInteger</span><span class="p">(</span><span class="s2">&quot;Distribution-DefaultPointNumber&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>The next plot presents the U.S. population depending on the time.
We see that the calibrated model fits to the data more
than the uncalibrated model, especially on the second part
of the time interval.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 3</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_logistic_003.png" srcset="../../_images/sphx_glr_plot_calibration_logistic_003.png" alt="plot calibration logistic" class = "sphx-glr-single-img"/><p>As a metamodel, we can compare the predicted U.S. population
depending on the observed U.S. population.
We see that the model fits to the data accurately for
a population up to 150 million people, but diverges when the population
gets larger.
On the other hand, the calibrated model under-predicts the
population for the [0,150] population interval, and
over-predicts for the [150,300] interval, balancing the errors
so that the model globally fits.
The “S” shape of the graph after calibration reveals that
the calibrated model has a structure with residuals that do
not follow a normal distribution (otherwise the calibrated
cloud would be spread over and under the diagonal).
In other words, the model and the data do not fit very well.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsPredictions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_logistic_004.png" srcset="../../_images/sphx_glr_plot_calibration_logistic_004.png" alt="plot calibration logistic" class = "sphx-glr-single-img"/><p>The residuals analysis shows that some residuals were very
large before calibration.
After calibration, most residuals are in the [-20,20] interval,
which explains why the calibrated model fits the data better.
We notice that the distribution of the
calibrated residuals is relatively close to a normal distribution.
This may show that the least squares model is appropriate in
this case with respect to this criterion.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_logistic_005.png" srcset="../../_images/sphx_glr_plot_calibration_logistic_005.png" alt="Residual analysis" class = "sphx-glr-single-img"/><p>The next plot shows that there is a significant improvement
after the calibration: the initial point is very different
from the distribution of the optimum parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawParameterDistributions</span><span class="p">()</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">,</span>
    <span class="n">figure_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)},</span>
    <span class="n">legend_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;upper left&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_logistic_006.png" srcset="../../_images/sphx_glr_plot_calibration_logistic_006.png" alt="plot calibration logistic" class = "sphx-glr-single-img"/><p>Reset default settings</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ot</span><span class="o">.</span><span class="n">ResourceMap</span><span class="o">.</span><span class="n">Reload</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-logistic-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f8a2578878f6115c87149032b59c95b7/plot_calibration_logistic.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_calibration_logistic.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c6fe754747e3196b49491332d2b0437e/plot_calibration_logistic.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_calibration_logistic.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_calibration_deflection_tube.html" title="Calibration of the deflection of a tube"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_calibration_withoutobservedinputs.html" title="Calibration without observed inputs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibration of the logistic model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 21, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>