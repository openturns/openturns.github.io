
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Calibrate a parametric model: a quick-start guide to calibration &#8212; OpenTURNS 1.21rc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/openturns.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/mysearchtools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Generate observations of the Chaboche mechanical model" href="plot_generate_chaboche.html" />
    <link rel="prev" title="Generate flooding model observations" href="plot_generate_flooding.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="http://www.openturns.org/">Home</a></li>
    <li><a href="../../install.html">Get it</a></li>
    <li><a href="../../contents.html">Doc</a></li>
    <li><a href="https://openturns.discourse.group/">Forum</a></li>
    <li><a href="https://gitter.im/openturns/community">Chat</a></li>
    <li><a href="https://github.com/openturns/openturns/wiki/Modules">Modules</a></li>
    <li><a href="https://github.com/openturns">Code</a></li>
    <li><a href="https://github.com/openturns/openturns/issues">Bugs</a></li>
  </ul>
  <a href="../../index.html">
    <h1>
      <img src="../../_static/logo-openturns-wo-bg.png" alt="" width=100px height=100px />
      OpenTURNS
    </h1>
    <h2> An Open source initiative for the Treatment of Uncertainties, Risks'N Statistics</h2>
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plot_generate_chaboche.html" title="Generate observations of the Chaboche mechanical model"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_generate_flooding.html" title="Generate flooding model observations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" accesskey="U">Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibrate a parametric model: a quick-start guide to calibration</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Calibrate a parametric model: a quick-start guide to calibration</a><ul>
<li><a class="reference internal" href="#parameters-to-calibrate-and-observations">Parameters to calibrate and observations</a></li>
<li><a class="reference internal" href="#define-the-observations">Define the observations</a></li>
<li><a class="reference internal" href="#create-the-physical-model">Create the physical model</a></li>
<li><a class="reference internal" href="#setting-the-calibration-parameters">Setting the calibration parameters</a></li>
<li><a class="reference internal" href="#create-the-parametric-function">Create the parametric function</a></li>
<li><a class="reference internal" href="#calibration-with-non-linear-least-squares">Calibration with non linear least squares</a></li>
<li><a class="reference internal" href="#analysis-of-the-results">Analysis of the results</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_generate_flooding.html"
                          title="previous chapter">Generate flooding model observations</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_generate_chaboche.html"
                          title="next chapter">Generate observations of the Chaboche mechanical model</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_calibration/least_squares_and_gaussian_calibration/plot_calibration_quickstart.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-quickstart-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="calibrate-a-parametric-model-a-quick-start-guide-to-calibration">
<span id="sphx-glr-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-quickstart-py"></span><h1>Calibrate a parametric model: a quick-start guide to calibration<a class="headerlink" href="#calibrate-a-parametric-model-a-quick-start-guide-to-calibration" title="Permalink to this heading">¶</a></h1>
<p>In this example we present the calibration of a parametric module.
To do this, we show how to define the observations.
Then we create a Python function and create the parametric model that is
to be calibrated.
Finally, we calibrate the parameters of the model using least squares
and we validate the hypotheses of the method.</p>
<p>Please read <a class="reference internal" href="../../theory/data_analysis/code_calibration.html#code-calibration"><span class="std std-ref">Code calibration</span></a> for more details on code calibration and least squares.
In this example we are interested in the calibration of the <a class="reference internal" href="../../usecases/use_case_flood_model.html#use-case-flood-model"><span class="std std-ref">flooding model</span></a>.
Once the reader has mastered this example, the <a class="reference internal" href="plot_calibration_chaboche.html"><span class="doc">calibration of the Chaboche mechanical model</span></a> may be
considered to make an in-depth study of these algorithms.
The goal of this script is to be relatively small, so please consider reading
the other examples if this is relevant.</p>
<section id="parameters-to-calibrate-and-observations">
<h2>Parameters to calibrate and observations<a class="headerlink" href="#parameters-to-calibrate-and-observations" title="Permalink to this heading">¶</a></h2>
<p>The parametric model is:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAAAVBAMAAAATJmVgAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAr/O/dBj7YN3pz52LSDLi5wBxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABI0lEQVQoz2NgIAB4FBiIALwLiFHFfYAYVRwyBmBa6LNDoJo4FgWsu0+bMrAFrIWobmBgmIXNmBMBDM8CbjC0gzn8GxgY/mBRxNgAwgcZUsG8+xcY2P9hUVUWwMDA8qGaRQDM2w/UkoBFVQ4oHP4yn4bwVgCdhh4ou30fMH4A0ixfYSIZgoLy4EBhXgUCIAs4DnBNYGoACX2AKuL7C3Yaqu8YuARAnmJgglnC8wHsNDQnsRXEOwAZ9Q+gIlwTGBg6UBXx/WO4z8AGcoUyTIgN6JBsBhR38X5g2MHOvCB6LzPcV+8LwE5DAQmsE3lYdQ/wLIQYvZSBsX85q+TnAlRVxS6XjzIwrtn5gA+cePLwpgcuhhAiUg1TgAExqjQ3EJNOs6AMAFILSbsNQhiXAAAACnRFWHREZXB0aAD////+jp/xeQAAAABJRU5ErkJggg==" alt="H = a Q^b."/></p>
</div><p>The vector of parameters to calibrate is:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE0AAAATBAMAAAAno50EAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdIuvMt3znRjpz2D7v0jPYBFiAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABOUlEQVQoz2NgwAAcBShcdhhDyARVHReCybLegYHjAoTNZOCKqq4aif0eZA6E6cbAj6puAhJbFYg5Icxwhn4UZYwKSJzlQMwsAHb1DwZ/FHWsDkic00DMvQDsnQkMaijqeECChU8g/vgoDjTsAIjJlmw8C0jxrgIBA5AAEAcxrIT48QjDCQaGDyAm/waGJBTzPIHSAQyLIUFkALL5BIjp38DyAUXdS6DVCmCHARkbGP4xMGSAmHsYmC+gqGsD6nXgg+jtZ2D8AHWfG0NPA4r7eEChyx6wASLJVQDzB8Nq1GDmbAAq7TRQ8GoASe4EejqAAcjmVt+Aqo5dgIH7otylhjfA8OY2BBrHpMDwxgEzubAsgDIEYAHfwIAVRKCp88KujMEXGs8w/g0c6rgFUNQxPcChjgHV0SxgEgDQOD5L1nA1VQAAAAp0RVh0RGVwdGgA/////o6f8XkAAAAASUVORK5CYII=" alt="\theta = (a,b)."/></p>
</div><p>We consider a sample size equal to:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAAMBAMAAAAqgQioAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAdJ2LGM9IMmD73fO/r+mGTbZDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAo0lEQVQY02NgwAR9CQwMTbYNDFhBUX4CA9sDhufYZRn4Exi4BBh0cMsCUSeIyajsbJqAIZtfwJDvAGRWZBowLgDSPKEgcAEq218AUsDAIGDNwBSATW8/SJbhLAOrAoZsfQKDPMhkhhkM/AWYrmpgkAQx2T8wyHFg2MtlwKAKYjI/YDjLjKa3gYFjATA0Sh0YmAwYckVQJH3j3yYwCMk2MGQWAACamyW2Qg8fJAAAAAp0RVh0RGVwdGgA////+RD7ZNoAAAAASUVORK5CYII=" alt="n = 10."/></p>
</div><p>The observations are the couples <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH4AAAAUBAMAAAC5YpSHAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMAGL9g6Z0ySHTd88+L+6+Dk2LmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACCUlEQVQ4y5VUPWgUURD+Nnt5d3u3d25zjZH82J7glgabWCQEYnEEhBAUD0yVFC7YCreIjSDk0gSs9DpNEFZS2W1jmjSxsBAsEpJGo5sQyE9h4ffeu93c3XJ3OMvsm5k3376Z7w0LGDddoIweMkx9hn6SqfIVUMsP550k+uvUH/14ABjjgHm/H/5ajaewBHsN4msStRrAnDReU+vOAHyG68+WtqKs6q8qjzpWG4DnIaY8ezWJ1j2Y59Io+TqlL34dKIYa1ZLHRO5KwwwG4GVxzDyW9mrS6GdSEChrdwC+Tn0HfJD27ST6PYqOQ2WdEO/2hmdnATEFnElnEzkNEheqGemRF3NW3wOv81U3fnKC35iCcSl7PY+j9omiQEqTqEpcQO5lqoBF7rP+HzTz43GwwIreIO4/s5dkL6X5c1ROxXjgVYAdHSwS8U17kj8PdpDGlw9eOJrce8D159jZg513xCduPXUlBfQgGiolbI5GUbTfgQ8v4uFYoHf0ZQY17mfZSentlnF46spsO1QpkuLu87ONgqfxK8oPDB+/ydFVBj1Ll1gK0/jharE1f5aam+YQNWzH01vRI5a/oetfhkiegnf3CfHsQSjiN6aBWzX4V3h6E3rEhrZVwPyzbVUtXz1VCyOsKvee8Tty85Hm2G+/HdvT49MmftdqMkX0Gk+R+v8Ybuf6v5LrWP8BqIR72S4dPfEAAAAKdEVYdERlcHRoAAAAAAbOQEQ5AAAAAElFTkSuQmCC" alt="\{(Q_i,H_i)\}_{i=1,...,n}" style="vertical-align: -6px"/>, i.e. each observation is a
couple made of the flowrate and the corresponding river height.</p>
<p>We choose to calibrate this model using non linear least squares, because
this is a relatively flexible method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openturns</span> <span class="k">as</span> <span class="nn">ot</span>
<span class="kn">import</span> <span class="nn">openturns.viewer</span> <span class="k">as</span> <span class="nn">otv</span>
<span class="kn">from</span> <span class="nn">openturns.usecases</span> <span class="kn">import</span> <span class="n">flood_model</span>

<span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-the-observations">
<h2>Define the observations<a class="headerlink" href="#define-the-observations" title="Permalink to this heading">¶</a></h2>
<p>In practice, we generally use a data set which has been obtained from
measurements.
This data set can be loaded using e.g. <a class="reference internal" href="../../user_manual/_generated/openturns.Sample.html#openturns.Sample.ImportFromCSVFile" title="openturns.Sample.ImportFromCSVFile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImportFromCSVFile()</span></code></a>.
Here we import the data from the
<a class="reference internal" href="../../user_manual/_generated/openturns.usecases.flood_model.FloodModel.html#openturns.usecases.flood_model.FloodModel" title="openturns.usecases.flood_model.FloodModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FloodModel</span></code></a>
class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fm</span> <span class="o">=</span> <span class="n">flood_model</span><span class="o">.</span><span class="n">FloodModel</span><span class="p">()</span>
<span class="n">Qobs</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Hobs</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">nbobs</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="n">fm</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr><td></td><th>Q ($m^3/s$)</th><th>H (m)</th></tr>
  <tr><th>0</th><td>130</td><td>0.59</td></tr>
  <tr><th>1</th><td>530</td><td>1.33</td></tr>
  <tr><th>2</th><td>960</td><td>2.03</td></tr>
  <tr><th>3</th><td>1400</td><td>2.72</td></tr>
  <tr><th>4</th><td>1830</td><td>2.83</td></tr>
  <tr><th>5</th><td>2260</td><td>3.5</td></tr>
  <tr><th>6</th><td>2700</td><td>3.82</td></tr>
  <tr><th>7</th><td>3130</td><td>4.36</td></tr>
  <tr><th>8</th><td>3560</td><td>4.63</td></tr>
  <tr><th>9</th><td>4010</td><td>4.96</td></tr>
</table>
</div>
<br />
<br /></section>
<section id="create-the-physical-model">
<h2>Create the physical model<a class="headerlink" href="#create-the-physical-model" title="Permalink to this heading">¶</a></h2>
<p>We define the model <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMBAMAAABCcoqQAAAAKlBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADmU0mKAAAADXRSTlMAGK+LMun7dGCdz7/z+qwmQAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAEtJREFUCNdjYGBUNhRgYHAVEDNgYAhn4HVg4LjA0MbAwBnAoMXAwL2BIZiBgX0B8xUGBgblygQgycC0AETyFDAwTGUoBbKqixUYGABabgpEH3HNBQAAAAp0RVh0RGVwdGgAAAAABCBOJRUAAAAASUVORK5CYII=" alt="g" style="vertical-align: -4px"/> which has 3 inputs and one output <cite>H</cite>.
This model has a parametric shape that may correspond to the data,
which has some power shape.
In the model, the parameters are <cite>a</cite> and <cite>b</cite>, the input is <cite>Q</cite>
and the output is <cite>H</cite>:
- <cite>Q</cite> : the flowrate of the river,
- <cite>a</cite>, <cite>b</cite> : the parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">functionSimpleFlooding</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">Q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">**</span> <span class="n">b</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">H</span><span class="p">]</span>


<span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">PythonFunction</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">functionSimpleFlooding</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">MemoizeFunction</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">setInputDescription</span><span class="p">([</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span>
<span class="n">g</span><span class="o">.</span><span class="n">setOutputDescription</span><span class="p">([</span><span class="s2">&quot;H&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="setting-the-calibration-parameters">
<h2>Setting the calibration parameters<a class="headerlink" href="#setting-the-calibration-parameters" title="Permalink to this heading">¶</a></h2>
<p>Define the value of the reference values of the <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/> parameter.
There is no particular method to set these values: we used
trial-and-error to see the order of magnitude of the parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aInitial</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">bInitial</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">thetaPrior</span> <span class="o">=</span> <span class="p">[</span><span class="n">aInitial</span><span class="p">,</span> <span class="n">bInitial</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="create-the-parametric-function">
<h2>Create the parametric function<a class="headerlink" href="#create-the-parametric-function" title="Permalink to this heading">¶</a></h2>
<p>In the physical model, the inputs and parameters are ordered as
presented in the next table.
Notice that there are no parameters in the physical model.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Q</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>a</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>b</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>∅</p></td>
<td><p>∅</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 1.</strong> Indices and names of the inputs and parameters of the physical model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Inputs:&quot;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">getInputDescription</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Physical Model Parameters:&quot;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">getParameterDescription</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Physical Model Inputs: [Q,a,b]
Physical Model Parameters: []
</pre></div>
</div>
<p>In order to perform calibration, we have to define a parametric model,
with observed inputs and parameters to calibrate.
In order to do this, we create a <a class="reference internal" href="../../user_manual/_generated/openturns.ParametricFunction.html#openturns.ParametricFunction" title="openturns.ParametricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParametricFunction</span></code></a>
where the parameters are <cite>a</cite> and <cite>b</cite> which have the indices 1 and
and 2 in the physical model.
Please read <a class="reference internal" href="../../auto_functional_modeling/vectorial_functions/plot_parametric_function.html"><span class="doc">Create a parametric function</span></a>
for more details on this topic.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Input variable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Q</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Index</p></th>
<th class="head"><p>Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>a</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>b</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 2.</strong> Indices and names of the inputs and parameters of the parametric model.</p>
<p>The following statement create the calibrated function from the model.
The calibrated parameters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIBAMAAADZ48iGAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAnXRIMt2Lz+mv+2AYvwxtY48AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA5SURBVAjXY2BgFDJhYGAIY6hgYGALYKhkYOBKYFjNwODnwPyAgcGOgTFgAwMXw4kJCQzcl5SvHQAAp/IKAtW27qgAAAAKdEVYdERlcHRoAAAAAAAnI+EMAAAAAElFTkSuQmCC" alt="a" style="vertical-align: 0px"/>, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAANBAMAAABm7DILAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAMs9Ii92d+2B0GK/z6Q9P1rkAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABBSURBVAjXY2DUE2BgYLADYgZXEKEGIiqAmPHltAkMLIUMVQxMG4AC7A0MjxnWMXA+YJBhYEpg4GHoZWDg2JnAAAAY7wrDWCVedQAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="b" style="vertical-align: 0px"/> are at
indices 1, 2 in the inputs arguments of the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calibratedIndices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">mycf</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">ParametricFunction</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">calibratedIndices</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the Y observations versus the X observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Before calibration : a = </span><span class="si">%.4f</span><span class="s2">, b = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aInitial</span><span class="p">,</span> <span class="n">bInitial</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># Plot the model before calibration</span>
<span class="n">curve</span> <span class="o">=</span> <span class="n">mycf</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">4000.0</span><span class="p">)</span><span class="o">.</span><span class="n">getDrawable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">curve</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Model, before calibration&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
<span class="c1"># Plot the noisy observations</span>
<span class="n">cloud</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">Cloud</span><span class="p">(</span><span class="n">Qobs</span><span class="p">,</span> <span class="n">Hobs</span><span class="p">)</span>
<span class="n">cloud</span><span class="o">.</span><span class="n">setLegend</span><span class="p">(</span><span class="s2">&quot;Observations&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cloud</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setColors</span><span class="p">(</span><span class="n">ot</span><span class="o">.</span><span class="n">Drawable</span><span class="o">.</span><span class="n">BuildDefaultPalette</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_quickstart_001.png" srcset="../../_images/sphx_glr_plot_calibration_quickstart_001.png" alt="Before calibration : a = 0.1000, b = 0.5000" class = "sphx-glr-single-img"/><p>Wee see that the model does not fit to the data.
The goal of calibration is to find which parameter best fit to the
observations.</p>
</section>
<section id="calibration-with-non-linear-least-squares">
<h2>Calibration with non linear least squares<a class="headerlink" href="#calibration-with-non-linear-least-squares" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.NonLinearLeastSquaresCalibration.html#openturns.NonLinearLeastSquaresCalibration" title="openturns.NonLinearLeastSquaresCalibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">NonLinearLeastSquaresCalibration</span></code></a> class performs
non linear least squares calibration by minimizing the squared Euclidian norm
between the predictions and the observations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">NonLinearLeastSquaresCalibration</span><span class="p">(</span><span class="n">mycf</span><span class="p">,</span> <span class="n">Qobs</span><span class="p">,</span> <span class="n">Hobs</span><span class="p">,</span> <span class="n">thetaPrior</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.NonLinearLeastSquaresCalibration.html#openturns.NonLinearLeastSquaresCalibration.run" title="openturns.NonLinearLeastSquaresCalibration.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method computes
the solution of the problem.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">calibrationResult</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">getResult</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="analysis-of-the-results">
<h2>Analysis of the results<a class="headerlink" href="#analysis-of-the-results" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../user_manual/_generated/openturns.CalibrationResult.html#openturns.CalibrationResult.getParameterMAP" title="openturns.CalibrationResult.getParameterMAP"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getParameterMAP()</span></code></a> method returns the
maximum of the posterior distribution of <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAANBAMAAACJLlk1AAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAdIuvMt3znRjpz2D7v9Xui1gAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABQSURBVAjXY2BgEDJhYGBgMnAFkm4MfEAynKGPgYHjBYMfAwP7BAY1Bga2ZONZDAx8GxiSGBj8GlgeMDDsYWC+AFLe0wCUZVgN1MStvoGBAQCe2gxuywa9BwAAAAp0RVh0RGVwdGgAAAAAACcj4QwAAAAASUVORK5CYII=" alt="\theta" style="vertical-align: 0px"/>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thetaMAP</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">getParameterMAP</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">thetaMAP</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.0258034,0.634465]
</pre></div>
</div>
<p>In order to see if the parameters fit the data,
we plot the input depending on the output before and after calibration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawObservationsVsInputs</span><span class="p">()</span>
<span class="n">aEstimated</span><span class="p">,</span> <span class="n">bEstimated</span> <span class="o">=</span> <span class="n">thetaMAP</span>
<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;After calibration : a = </span><span class="si">%.4f</span><span class="s2">, b = </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aEstimated</span><span class="p">,</span> <span class="n">bEstimated</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_quickstart_002.png" srcset="../../_images/sphx_glr_plot_calibration_quickstart_002.png" alt="After calibration : a = 0.0258, b = 0.6345" class = "sphx-glr-single-img"/><p>One of the hypotheses of the least squares method is that
the residuals follow a normal distribution: the next
cell checks if this hypothesis is satisfied here.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">calibrationResult</span><span class="o">.</span><span class="n">drawResiduals</span><span class="p">()</span>
<span class="n">graph</span><span class="o">.</span><span class="n">setLegendPosition</span><span class="p">(</span><span class="s2">&quot;topleft&quot;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_calibration_quickstart_003.png" srcset="../../_images/sphx_glr_plot_calibration_quickstart_003.png" alt="Residual analysis" class = "sphx-glr-single-img"/><p>The analysis of the residuals shows that the distribution is centered on
zero and symmetric.
This indicates that the calibration performed well.
Moreover, the distribution of the residuals is close to being Gaussian.</p>
<p><em>Remark.</em> The logarithm of the height is:</p>
<div class="math">
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANMAAAATBAMAAAD4wSVeAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMASN0yv89gdJ2Lrxjz6fv9xBs/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC9klEQVQ4y4WVT0gUURzHv+vbP/NndxXxFJRLQpcODpR0svUSFR5aAsWEYA5BEFHbJbVDbh3yD0iLJzWIjahMioY6JBG4UdAhioXwkhcxiqLLylgQC9nvzcwbZ2Zn14H5+77v8533+755A3g3tSCuJDTZlneX+GiOst30NMZof7KVf/Xpodrn6xXp1jx3OZvkl/SYYTR1cq7fVXobb9HekgFWgTH/G7Z6rCTdPvslkWoYbdbAUUMovY0VDqVh/wVSja1S/rNqn+RMCE3JWHuqzipRpENnG+L0TMk3tBKjcSSyPchYIYR2yaBzVSjdRhUtnHebGOtAPNfAykCXc+VIHKu0HkL7ySu7KZQmElNU1cXpiVKa35+muHjLetBqdE6HMrl4zWqZvKIJiWOVHZmooyk8v0RNKE1MI1pUSlSAJL/fWFp6xgvJVdEBvpUsK6mEk1jCEFCmlynGKrbEtbqrpY0gLcnzi1aF0lRrYNVkXqqgl27ZphUX8CswqhUDWbzHDBiZzCJWEhLHatgqoZ/GpxiSOaE0KTb8iRWUHPbyjlUrLuBDwGqcDvoQHiBS4RlwLpccGzi7OjBMF9/R2hakrfDpcFkTMLsx/rbXwGs+kQi0HyFZWVYXD61BLYOZ6IQ/K7WK8TpamifxzlWarIZITUpQBz4t0lSYH8LKm1XWQKdRuGq10Od6M+63YmUeY4AWzS3fiO7MMZOyjhYUHk+Kcs3qVlxgmcColBJO4B6/XqOu6hdZSJysyvFKHU19U5SHbViPgY7fujz1CGz73wFIeSjdg+rTLeosF32rzqlBzC3kkd3e0EGT+txIxx0hcawujNIhQINyZkZjFmyf+2E+115c15jns20xwtbqLvXIV/T4JY6Vd/PQYngZgE1RYfM46Fmow34LEo3juNvRkaj1L+WhJY2+AKydaqvh8M6D/jCrCKXzGayviSRIS34sBJSRx/P3aVVz11i5LZSxZ36Ban6+mSRAk741ULrZsWa/V7a7xEezlf8BUBj1UusLoqwAAAAKdEVYdERlcHRoAP////6On/F5AAAAAElFTkSuQmCC" alt="\log(H) = \log(a) + b \log(Q)."/></p>
</div><p>Hence, transforming the data on a logarithmic scale leads to a parametric
model that is linear in the parameters.
The parameters of this transformed model can be estimated using linear
linear squares, which may lead to a significant improvement in terms
of number of function evaluations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">otv</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">ShowAll</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-calibration-least-squares-and-gaussian-calibration-plot-calibration-quickstart-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/772ed6ccb12169487a89e3a784176e42/plot_calibration_quickstart.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_calibration_quickstart.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5862a0abfa8a6362cec243d0a28e3928/plot_calibration_quickstart.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_calibration_quickstart.ipynb</span></code></a></p>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plot_generate_chaboche.html" title="Generate observations of the Chaboche mechanical model"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_generate_flooding.html" title="Generate flooding model observations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">OpenTURNS 1.21rc1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../contents.html" >Contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../examples/examples.html" >Examples</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../index.html" >Calibration</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="index.html" >Least squares and gaussian calibration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Calibrate a parametric model: a quick-start guide to calibration</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005-2023 Airbus-EDF-IMACS-ONERA-Phimeca.
      Last updated on Jun 20, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>